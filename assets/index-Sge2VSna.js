var ov=p=>{throw TypeError(p)};var O_=(p,h,g)=>h.has(p)||ov("Cannot "+g);var Le=(p,h,g)=>(O_(p,h,"read from private field"),g?g.call(p):h.get(p)),mi=(p,h,g)=>h.has(p)?ov("Cannot add the same private member more than once"):h instanceof WeakSet?h.add(p):h.set(p,g),Zt=(p,h,g,b)=>(O_(p,h,"write to private field"),b?b.call(p,g):h.set(p,g),g),Vi=(p,h,g)=>(O_(p,h,"access private method"),g);var Lg=(p,h,g,b)=>({set _(C){Zt(p,h,C,g)},get _(){return Le(p,h,b)}});function c1(p,h){for(var g=0;g<h.length;g++){const b=h[g];if(typeof b!="string"&&!Array.isArray(b)){for(const C in b)if(C!=="default"&&!(C in p)){const R=Object.getOwnPropertyDescriptor(b,C);R&&Object.defineProperty(p,C,R.get?R:{enumerable:!0,get:()=>b[C]})}}}return Object.freeze(Object.defineProperty(p,Symbol.toStringTag,{value:"Module"}))}(function(){const h=document.createElement("link").relList;if(h&&h.supports&&h.supports("modulepreload"))return;for(const C of document.querySelectorAll('link[rel="modulepreload"]'))b(C);new MutationObserver(C=>{for(const R of C)if(R.type==="childList")for(const T of R.addedNodes)T.tagName==="LINK"&&T.rel==="modulepreload"&&b(T)}).observe(document,{childList:!0,subtree:!0});function g(C){const R={};return C.integrity&&(R.integrity=C.integrity),C.referrerPolicy&&(R.referrerPolicy=C.referrerPolicy),C.crossOrigin==="use-credentials"?R.credentials="include":C.crossOrigin==="anonymous"?R.credentials="omit":R.credentials="same-origin",R}function b(C){if(C.ep)return;C.ep=!0;const R=g(C);fetch(C.href,R)}})();function jx(p){return p&&p.__esModule&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p}var B_={exports:{}},ym={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lv;function u1(){if(lv)return ym;lv=1;var p=Symbol.for("react.transitional.element"),h=Symbol.for("react.fragment");function g(b,C,R){var T=null;if(R!==void 0&&(T=""+R),C.key!==void 0&&(T=""+C.key),"key"in C){R={};for(var o in C)o!=="key"&&(R[o]=C[o])}else R=C;return C=R.ref,{$$typeof:p,type:b,key:T,ref:C!==void 0?C:null,props:R}}return ym.Fragment=h,ym.jsx=g,ym.jsxs=g,ym}var cv;function h1(){return cv||(cv=1,B_.exports=u1()),B_.exports}var pe=h1(),N_={exports:{}},Ei={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uv;function d1(){if(uv)return Ei;uv=1;var p=Symbol.for("react.transitional.element"),h=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),R=Symbol.for("react.consumer"),T=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),L=Symbol.for("react.suspense"),N=Symbol.for("react.memo"),Z=Symbol.for("react.lazy"),Y=Symbol.iterator;function ee(be){return be===null||typeof be!="object"?null:(be=Y&&be[Y]||be["@@iterator"],typeof be=="function"?be:null)}var U={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},le=Object.assign,ie={};function me(be,Ke,wt){this.props=be,this.context=Ke,this.refs=ie,this.updater=wt||U}me.prototype.isReactComponent={},me.prototype.setState=function(be,Ke){if(typeof be!="object"&&typeof be!="function"&&be!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,be,Ke,"setState")},me.prototype.forceUpdate=function(be){this.updater.enqueueForceUpdate(this,be,"forceUpdate")};function Ce(){}Ce.prototype=me.prototype;function Se(be,Ke,wt){this.props=be,this.context=Ke,this.refs=ie,this.updater=wt||U}var Ee=Se.prototype=new Ce;Ee.constructor=Se,le(Ee,me.prototype),Ee.isPureReactComponent=!0;var ke=Array.isArray,Ve={H:null,A:null,T:null,S:null,V:null},ct=Object.prototype.hasOwnProperty;function tt(be,Ke,wt,ft,Et,Kt){return wt=Kt.ref,{$$typeof:p,type:be,key:Ke,ref:wt!==void 0?wt:null,props:Kt}}function Qe(be,Ke){return tt(be.type,Ke,void 0,void 0,void 0,be.props)}function at(be){return typeof be=="object"&&be!==null&&be.$$typeof===p}function ht(be){var Ke={"=":"=0",":":"=2"};return"$"+be.replace(/[=:]/g,function(wt){return Ke[wt]})}var Ct=/\/+/g;function Rt(be,Ke){return typeof be=="object"&&be!==null&&be.key!=null?ht(""+be.key):Ke.toString(36)}function Lt(){}function Gt(be){switch(be.status){case"fulfilled":return be.value;case"rejected":throw be.reason;default:switch(typeof be.status=="string"?be.then(Lt,Lt):(be.status="pending",be.then(function(Ke){be.status==="pending"&&(be.status="fulfilled",be.value=Ke)},function(Ke){be.status==="pending"&&(be.status="rejected",be.reason=Ke)})),be.status){case"fulfilled":return be.value;case"rejected":throw be.reason}}throw be}function Ht(be,Ke,wt,ft,Et){var Kt=typeof be;(Kt==="undefined"||Kt==="boolean")&&(be=null);var kt=!1;if(be===null)kt=!0;else switch(Kt){case"bigint":case"string":case"number":kt=!0;break;case"object":switch(be.$$typeof){case p:case h:kt=!0;break;case Z:return kt=be._init,Ht(kt(be._payload),Ke,wt,ft,Et)}}if(kt)return Et=Et(be),kt=ft===""?"."+Rt(be,0):ft,ke(Et)?(wt="",kt!=null&&(wt=kt.replace(Ct,"$&/")+"/"),Ht(Et,Ke,wt,"",function(bi){return bi})):Et!=null&&(at(Et)&&(Et=Qe(Et,wt+(Et.key==null||be&&be.key===Et.key?"":(""+Et.key).replace(Ct,"$&/")+"/")+kt)),Ke.push(Et)),1;kt=0;var At=ft===""?".":ft+":";if(ke(be))for(var Nt=0;Nt<be.length;Nt++)ft=be[Nt],Kt=At+Rt(ft,Nt),kt+=Ht(ft,Ke,wt,Kt,Et);else if(Nt=ee(be),typeof Nt=="function")for(be=Nt.call(be),Nt=0;!(ft=be.next()).done;)ft=ft.value,Kt=At+Rt(ft,Nt++),kt+=Ht(ft,Ke,wt,Kt,Et);else if(Kt==="object"){if(typeof be.then=="function")return Ht(Gt(be),Ke,wt,ft,Et);throw Ke=String(be),Error("Objects are not valid as a React child (found: "+(Ke==="[object Object]"?"object with keys {"+Object.keys(be).join(", ")+"}":Ke)+"). If you meant to render a collection of children, use an array instead.")}return kt}function Oe(be,Ke,wt){if(be==null)return be;var ft=[],Et=0;return Ht(be,ft,"","",function(Kt){return Ke.call(wt,Kt,Et++)}),ft}function it(be){if(be._status===-1){var Ke=be._result;Ke=Ke(),Ke.then(function(wt){(be._status===0||be._status===-1)&&(be._status=1,be._result=wt)},function(wt){(be._status===0||be._status===-1)&&(be._status=2,be._result=wt)}),be._status===-1&&(be._status=0,be._result=Ke)}if(be._status===1)return be._result.default;throw be._result}var Xe=typeof reportError=="function"?reportError:function(be){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Ke=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof be=="object"&&be!==null&&typeof be.message=="string"?String(be.message):String(be),error:be});if(!window.dispatchEvent(Ke))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",be);return}console.error(be)};function St(){}return Ei.Children={map:Oe,forEach:function(be,Ke,wt){Oe(be,function(){Ke.apply(this,arguments)},wt)},count:function(be){var Ke=0;return Oe(be,function(){Ke++}),Ke},toArray:function(be){return Oe(be,function(Ke){return Ke})||[]},only:function(be){if(!at(be))throw Error("React.Children.only expected to receive a single React element child.");return be}},Ei.Component=me,Ei.Fragment=g,Ei.Profiler=C,Ei.PureComponent=Se,Ei.StrictMode=b,Ei.Suspense=L,Ei.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Ve,Ei.__COMPILER_RUNTIME={__proto__:null,c:function(be){return Ve.H.useMemoCache(be)}},Ei.cache=function(be){return function(){return be.apply(null,arguments)}},Ei.cloneElement=function(be,Ke,wt){if(be==null)throw Error("The argument must be a React element, but you passed "+be+".");var ft=le({},be.props),Et=be.key,Kt=void 0;if(Ke!=null)for(kt in Ke.ref!==void 0&&(Kt=void 0),Ke.key!==void 0&&(Et=""+Ke.key),Ke)!ct.call(Ke,kt)||kt==="key"||kt==="__self"||kt==="__source"||kt==="ref"&&Ke.ref===void 0||(ft[kt]=Ke[kt]);var kt=arguments.length-2;if(kt===1)ft.children=wt;else if(1<kt){for(var At=Array(kt),Nt=0;Nt<kt;Nt++)At[Nt]=arguments[Nt+2];ft.children=At}return tt(be.type,Et,void 0,void 0,Kt,ft)},Ei.createContext=function(be){return be={$$typeof:T,_currentValue:be,_currentValue2:be,_threadCount:0,Provider:null,Consumer:null},be.Provider=be,be.Consumer={$$typeof:R,_context:be},be},Ei.createElement=function(be,Ke,wt){var ft,Et={},Kt=null;if(Ke!=null)for(ft in Ke.key!==void 0&&(Kt=""+Ke.key),Ke)ct.call(Ke,ft)&&ft!=="key"&&ft!=="__self"&&ft!=="__source"&&(Et[ft]=Ke[ft]);var kt=arguments.length-2;if(kt===1)Et.children=wt;else if(1<kt){for(var At=Array(kt),Nt=0;Nt<kt;Nt++)At[Nt]=arguments[Nt+2];Et.children=At}if(be&&be.defaultProps)for(ft in kt=be.defaultProps,kt)Et[ft]===void 0&&(Et[ft]=kt[ft]);return tt(be,Kt,void 0,void 0,null,Et)},Ei.createRef=function(){return{current:null}},Ei.forwardRef=function(be){return{$$typeof:o,render:be}},Ei.isValidElement=at,Ei.lazy=function(be){return{$$typeof:Z,_payload:{_status:-1,_result:be},_init:it}},Ei.memo=function(be,Ke){return{$$typeof:N,type:be,compare:Ke===void 0?null:Ke}},Ei.startTransition=function(be){var Ke=Ve.T,wt={};Ve.T=wt;try{var ft=be(),Et=Ve.S;Et!==null&&Et(wt,ft),typeof ft=="object"&&ft!==null&&typeof ft.then=="function"&&ft.then(St,Xe)}catch(Kt){Xe(Kt)}finally{Ve.T=Ke}},Ei.unstable_useCacheRefresh=function(){return Ve.H.useCacheRefresh()},Ei.use=function(be){return Ve.H.use(be)},Ei.useActionState=function(be,Ke,wt){return Ve.H.useActionState(be,Ke,wt)},Ei.useCallback=function(be,Ke){return Ve.H.useCallback(be,Ke)},Ei.useContext=function(be){return Ve.H.useContext(be)},Ei.useDebugValue=function(){},Ei.useDeferredValue=function(be,Ke){return Ve.H.useDeferredValue(be,Ke)},Ei.useEffect=function(be,Ke,wt){var ft=Ve.H;if(typeof wt=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ft.useEffect(be,Ke)},Ei.useId=function(){return Ve.H.useId()},Ei.useImperativeHandle=function(be,Ke,wt){return Ve.H.useImperativeHandle(be,Ke,wt)},Ei.useInsertionEffect=function(be,Ke){return Ve.H.useInsertionEffect(be,Ke)},Ei.useLayoutEffect=function(be,Ke){return Ve.H.useLayoutEffect(be,Ke)},Ei.useMemo=function(be,Ke){return Ve.H.useMemo(be,Ke)},Ei.useOptimistic=function(be,Ke){return Ve.H.useOptimistic(be,Ke)},Ei.useReducer=function(be,Ke,wt){return Ve.H.useReducer(be,Ke,wt)},Ei.useRef=function(be){return Ve.H.useRef(be)},Ei.useState=function(be){return Ve.H.useState(be)},Ei.useSyncExternalStore=function(be,Ke,wt){return Ve.H.useSyncExternalStore(be,Ke,wt)},Ei.useTransition=function(){return Ve.H.useTransition()},Ei.version="19.1.1",Ei}var hv;function Ny(){return hv||(hv=1,N_.exports=d1()),N_.exports}var J=Ny();const bh=jx(J),Fx=c1({__proto__:null,default:bh},[J]);var j_={exports:{}},vm={},F_={exports:{}},U_={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dv;function f1(){return dv||(dv=1,(function(p){function h(Oe,it){var Xe=Oe.length;Oe.push(it);e:for(;0<Xe;){var St=Xe-1>>>1,be=Oe[St];if(0<C(be,it))Oe[St]=it,Oe[Xe]=be,Xe=St;else break e}}function g(Oe){return Oe.length===0?null:Oe[0]}function b(Oe){if(Oe.length===0)return null;var it=Oe[0],Xe=Oe.pop();if(Xe!==it){Oe[0]=Xe;e:for(var St=0,be=Oe.length,Ke=be>>>1;St<Ke;){var wt=2*(St+1)-1,ft=Oe[wt],Et=wt+1,Kt=Oe[Et];if(0>C(ft,Xe))Et<be&&0>C(Kt,ft)?(Oe[St]=Kt,Oe[Et]=Xe,St=Et):(Oe[St]=ft,Oe[wt]=Xe,St=wt);else if(Et<be&&0>C(Kt,Xe))Oe[St]=Kt,Oe[Et]=Xe,St=Et;else break e}}return it}function C(Oe,it){var Xe=Oe.sortIndex-it.sortIndex;return Xe!==0?Xe:Oe.id-it.id}if(p.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var R=performance;p.unstable_now=function(){return R.now()}}else{var T=Date,o=T.now();p.unstable_now=function(){return T.now()-o}}var L=[],N=[],Z=1,Y=null,ee=3,U=!1,le=!1,ie=!1,me=!1,Ce=typeof setTimeout=="function"?setTimeout:null,Se=typeof clearTimeout=="function"?clearTimeout:null,Ee=typeof setImmediate<"u"?setImmediate:null;function ke(Oe){for(var it=g(N);it!==null;){if(it.callback===null)b(N);else if(it.startTime<=Oe)b(N),it.sortIndex=it.expirationTime,h(L,it);else break;it=g(N)}}function Ve(Oe){if(ie=!1,ke(Oe),!le)if(g(L)!==null)le=!0,ct||(ct=!0,Rt());else{var it=g(N);it!==null&&Ht(Ve,it.startTime-Oe)}}var ct=!1,tt=-1,Qe=5,at=-1;function ht(){return me?!0:!(p.unstable_now()-at<Qe)}function Ct(){if(me=!1,ct){var Oe=p.unstable_now();at=Oe;var it=!0;try{e:{le=!1,ie&&(ie=!1,Se(tt),tt=-1),U=!0;var Xe=ee;try{t:{for(ke(Oe),Y=g(L);Y!==null&&!(Y.expirationTime>Oe&&ht());){var St=Y.callback;if(typeof St=="function"){Y.callback=null,ee=Y.priorityLevel;var be=St(Y.expirationTime<=Oe);if(Oe=p.unstable_now(),typeof be=="function"){Y.callback=be,ke(Oe),it=!0;break t}Y===g(L)&&b(L),ke(Oe)}else b(L);Y=g(L)}if(Y!==null)it=!0;else{var Ke=g(N);Ke!==null&&Ht(Ve,Ke.startTime-Oe),it=!1}}break e}finally{Y=null,ee=Xe,U=!1}it=void 0}}finally{it?Rt():ct=!1}}}var Rt;if(typeof Ee=="function")Rt=function(){Ee(Ct)};else if(typeof MessageChannel<"u"){var Lt=new MessageChannel,Gt=Lt.port2;Lt.port1.onmessage=Ct,Rt=function(){Gt.postMessage(null)}}else Rt=function(){Ce(Ct,0)};function Ht(Oe,it){tt=Ce(function(){Oe(p.unstable_now())},it)}p.unstable_IdlePriority=5,p.unstable_ImmediatePriority=1,p.unstable_LowPriority=4,p.unstable_NormalPriority=3,p.unstable_Profiling=null,p.unstable_UserBlockingPriority=2,p.unstable_cancelCallback=function(Oe){Oe.callback=null},p.unstable_forceFrameRate=function(Oe){0>Oe||125<Oe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Qe=0<Oe?Math.floor(1e3/Oe):5},p.unstable_getCurrentPriorityLevel=function(){return ee},p.unstable_next=function(Oe){switch(ee){case 1:case 2:case 3:var it=3;break;default:it=ee}var Xe=ee;ee=it;try{return Oe()}finally{ee=Xe}},p.unstable_requestPaint=function(){me=!0},p.unstable_runWithPriority=function(Oe,it){switch(Oe){case 1:case 2:case 3:case 4:case 5:break;default:Oe=3}var Xe=ee;ee=Oe;try{return it()}finally{ee=Xe}},p.unstable_scheduleCallback=function(Oe,it,Xe){var St=p.unstable_now();switch(typeof Xe=="object"&&Xe!==null?(Xe=Xe.delay,Xe=typeof Xe=="number"&&0<Xe?St+Xe:St):Xe=St,Oe){case 1:var be=-1;break;case 2:be=250;break;case 5:be=1073741823;break;case 4:be=1e4;break;default:be=5e3}return be=Xe+be,Oe={id:Z++,callback:it,priorityLevel:Oe,startTime:Xe,expirationTime:be,sortIndex:-1},Xe>St?(Oe.sortIndex=Xe,h(N,Oe),g(L)===null&&Oe===g(N)&&(ie?(Se(tt),tt=-1):ie=!0,Ht(Ve,Xe-St))):(Oe.sortIndex=be,h(L,Oe),le||U||(le=!0,ct||(ct=!0,Rt()))),Oe},p.unstable_shouldYield=ht,p.unstable_wrapCallback=function(Oe){var it=ee;return function(){var Xe=ee;ee=it;try{return Oe.apply(this,arguments)}finally{ee=Xe}}}})(U_)),U_}var fv;function p1(){return fv||(fv=1,F_.exports=f1()),F_.exports}var V_={exports:{}},Va={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pv;function m1(){if(pv)return Va;pv=1;var p=Ny();function h(L){var N="https://react.dev/errors/"+L;if(1<arguments.length){N+="?args[]="+encodeURIComponent(arguments[1]);for(var Z=2;Z<arguments.length;Z++)N+="&args[]="+encodeURIComponent(arguments[Z])}return"Minified React error #"+L+"; visit "+N+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function g(){}var b={d:{f:g,r:function(){throw Error(h(522))},D:g,C:g,L:g,m:g,X:g,S:g,M:g},p:0,findDOMNode:null},C=Symbol.for("react.portal");function R(L,N,Z){var Y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:C,key:Y==null?null:""+Y,children:L,containerInfo:N,implementation:Z}}var T=p.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(L,N){if(L==="font")return"";if(typeof N=="string")return N==="use-credentials"?N:""}return Va.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=b,Va.createPortal=function(L,N){var Z=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!N||N.nodeType!==1&&N.nodeType!==9&&N.nodeType!==11)throw Error(h(299));return R(L,N,null,Z)},Va.flushSync=function(L){var N=T.T,Z=b.p;try{if(T.T=null,b.p=2,L)return L()}finally{T.T=N,b.p=Z,b.d.f()}},Va.preconnect=function(L,N){typeof L=="string"&&(N?(N=N.crossOrigin,N=typeof N=="string"?N==="use-credentials"?N:"":void 0):N=null,b.d.C(L,N))},Va.prefetchDNS=function(L){typeof L=="string"&&b.d.D(L)},Va.preinit=function(L,N){if(typeof L=="string"&&N&&typeof N.as=="string"){var Z=N.as,Y=o(Z,N.crossOrigin),ee=typeof N.integrity=="string"?N.integrity:void 0,U=typeof N.fetchPriority=="string"?N.fetchPriority:void 0;Z==="style"?b.d.S(L,typeof N.precedence=="string"?N.precedence:void 0,{crossOrigin:Y,integrity:ee,fetchPriority:U}):Z==="script"&&b.d.X(L,{crossOrigin:Y,integrity:ee,fetchPriority:U,nonce:typeof N.nonce=="string"?N.nonce:void 0})}},Va.preinitModule=function(L,N){if(typeof L=="string")if(typeof N=="object"&&N!==null){if(N.as==null||N.as==="script"){var Z=o(N.as,N.crossOrigin);b.d.M(L,{crossOrigin:Z,integrity:typeof N.integrity=="string"?N.integrity:void 0,nonce:typeof N.nonce=="string"?N.nonce:void 0})}}else N==null&&b.d.M(L)},Va.preload=function(L,N){if(typeof L=="string"&&typeof N=="object"&&N!==null&&typeof N.as=="string"){var Z=N.as,Y=o(Z,N.crossOrigin);b.d.L(L,Z,{crossOrigin:Y,integrity:typeof N.integrity=="string"?N.integrity:void 0,nonce:typeof N.nonce=="string"?N.nonce:void 0,type:typeof N.type=="string"?N.type:void 0,fetchPriority:typeof N.fetchPriority=="string"?N.fetchPriority:void 0,referrerPolicy:typeof N.referrerPolicy=="string"?N.referrerPolicy:void 0,imageSrcSet:typeof N.imageSrcSet=="string"?N.imageSrcSet:void 0,imageSizes:typeof N.imageSizes=="string"?N.imageSizes:void 0,media:typeof N.media=="string"?N.media:void 0})}},Va.preloadModule=function(L,N){if(typeof L=="string")if(N){var Z=o(N.as,N.crossOrigin);b.d.m(L,{as:typeof N.as=="string"&&N.as!=="script"?N.as:void 0,crossOrigin:Z,integrity:typeof N.integrity=="string"?N.integrity:void 0})}else b.d.m(L)},Va.requestFormReset=function(L){b.d.r(L)},Va.unstable_batchedUpdates=function(L,N){return L(N)},Va.useFormState=function(L,N,Z){return T.H.useFormState(L,N,Z)},Va.useFormStatus=function(){return T.H.useHostTransitionStatus()},Va.version="19.1.1",Va}var mv;function Ux(){if(mv)return V_.exports;mv=1;function p(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(p)}catch(h){console.error(h)}}return p(),V_.exports=m1(),V_.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gv;function g1(){if(gv)return vm;gv=1;var p=p1(),h=Ny(),g=Ux();function b(i){var s="https://react.dev/errors/"+i;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)s+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function C(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function R(i){var s=i,u=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,(s.flags&4098)!==0&&(u=s.return),i=s.return;while(i)}return s.tag===3?u:null}function T(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function o(i){if(R(i)!==i)throw Error(b(188))}function L(i){var s=i.alternate;if(!s){if(s=R(i),s===null)throw Error(b(188));return s!==i?null:i}for(var u=i,_=s;;){var E=u.return;if(E===null)break;var I=E.alternate;if(I===null){if(_=E.return,_!==null){u=_;continue}break}if(E.child===I.child){for(I=E.child;I;){if(I===u)return o(E),i;if(I===_)return o(E),s;I=I.sibling}throw Error(b(188))}if(u.return!==_.return)u=E,_=I;else{for(var q=!1,te=E.child;te;){if(te===u){q=!0,u=E,_=I;break}if(te===_){q=!0,_=E,u=I;break}te=te.sibling}if(!q){for(te=I.child;te;){if(te===u){q=!0,u=I,_=E;break}if(te===_){q=!0,_=I,u=E;break}te=te.sibling}if(!q)throw Error(b(189))}}if(u.alternate!==_)throw Error(b(190))}if(u.tag!==3)throw Error(b(188));return u.stateNode.current===u?i:s}function N(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i;for(i=i.child;i!==null;){if(s=N(i),s!==null)return s;i=i.sibling}return null}var Z=Object.assign,Y=Symbol.for("react.element"),ee=Symbol.for("react.transitional.element"),U=Symbol.for("react.portal"),le=Symbol.for("react.fragment"),ie=Symbol.for("react.strict_mode"),me=Symbol.for("react.profiler"),Ce=Symbol.for("react.provider"),Se=Symbol.for("react.consumer"),Ee=Symbol.for("react.context"),ke=Symbol.for("react.forward_ref"),Ve=Symbol.for("react.suspense"),ct=Symbol.for("react.suspense_list"),tt=Symbol.for("react.memo"),Qe=Symbol.for("react.lazy"),at=Symbol.for("react.activity"),ht=Symbol.for("react.memo_cache_sentinel"),Ct=Symbol.iterator;function Rt(i){return i===null||typeof i!="object"?null:(i=Ct&&i[Ct]||i["@@iterator"],typeof i=="function"?i:null)}var Lt=Symbol.for("react.client.reference");function Gt(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===Lt?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case le:return"Fragment";case me:return"Profiler";case ie:return"StrictMode";case Ve:return"Suspense";case ct:return"SuspenseList";case at:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case U:return"Portal";case Ee:return(i.displayName||"Context")+".Provider";case Se:return(i._context.displayName||"Context")+".Consumer";case ke:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case tt:return s=i.displayName||null,s!==null?s:Gt(i.type)||"Memo";case Qe:s=i._payload,i=i._init;try{return Gt(i(s))}catch{}}return null}var Ht=Array.isArray,Oe=h.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,it=g.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Xe={pending:!1,data:null,method:null,action:null},St=[],be=-1;function Ke(i){return{current:i}}function wt(i){0>be||(i.current=St[be],St[be]=null,be--)}function ft(i,s){be++,St[be]=i.current,i.current=s}var Et=Ke(null),Kt=Ke(null),kt=Ke(null),At=Ke(null);function Nt(i,s){switch(ft(kt,s),ft(Kt,i),ft(Et,null),s.nodeType){case 9:case 11:i=(i=s.documentElement)&&(i=i.namespaceURI)?Eg(i):0;break;default:if(i=s.tagName,s=s.namespaceURI)s=Eg(s),i=lm(s,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}wt(Et),ft(Et,i)}function bi(){wt(Et),wt(Kt),wt(kt)}function wi(i){i.memoizedState!==null&&ft(At,i);var s=Et.current,u=lm(s,i.type);s!==u&&(ft(Kt,i),ft(Et,u))}function gi(i){Kt.current===i&&(wt(Et),wt(Kt)),At.current===i&&(wt(At),Ae._currentValue=Xe)}var ni=Object.prototype.hasOwnProperty,Ti=p.unstable_scheduleCallback,ki=p.unstable_cancelCallback,fr=p.unstable_shouldYield,Mr=p.unstable_requestPaint,zn=p.unstable_now,wa=p.unstable_getCurrentPriorityLevel,Ar=p.unstable_ImmediatePriority,jo=p.unstable_UserBlockingPriority,Za=p.unstable_NormalPriority,io=p.unstable_LowPriority,As=p.unstable_IdlePriority,Fo=p.log,no=p.unstable_setDisableYieldValue,Sa=null,Yn=null;function oa(i){if(typeof Fo=="function"&&no(i),Yn&&typeof Yn.setStrictMode=="function")try{Yn.setStrictMode(Sa,i)}catch{}}var Me=Math.clz32?Math.clz32:re,W=Math.log,Q=Math.LN2;function re(i){return i>>>=0,i===0?32:31-(W(i)/Q|0)|0}var de=256,we=4194304;function Pe(i){var s=i&42;if(s!==0)return s;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function je(i,s,u){var _=i.pendingLanes;if(_===0)return 0;var E=0,I=i.suspendedLanes,q=i.pingedLanes;i=i.warmLanes;var te=_&134217727;return te!==0?(_=te&~I,_!==0?E=Pe(_):(q&=te,q!==0?E=Pe(q):u||(u=te&~i,u!==0&&(E=Pe(u))))):(te=_&~I,te!==0?E=Pe(te):q!==0?E=Pe(q):u||(u=_&~i,u!==0&&(E=Pe(u)))),E===0?0:s!==0&&s!==E&&(s&I)===0&&(I=E&-E,u=s&-s,I>=u||I===32&&(u&4194048)!==0)?s:E}function ze(i,s){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&s)===0}function Je(i,s){switch(i){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dt(){var i=de;return de<<=1,(de&4194048)===0&&(de=256),i}function nt(){var i=we;return we<<=1,(we&62914560)===0&&(we=4194304),i}function It(i){for(var s=[],u=0;31>u;u++)s.push(i);return s}function Ie(i,s){i.pendingLanes|=s,s!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function ei(i,s,u,_,E,I){var q=i.pendingLanes;i.pendingLanes=u,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=u,i.entangledLanes&=u,i.errorRecoveryDisabledLanes&=u,i.shellSuspendCounter=0;var te=i.entanglements,ve=i.expirationTimes,qe=i.hiddenUpdates;for(u=q&~u;0<u;){var rt=31-Me(u),ut=1<<rt;te[rt]=0,ve[rt]=-1;var He=qe[rt];if(He!==null)for(qe[rt]=null,rt=0;rt<He.length;rt++){var We=He[rt];We!==null&&(We.lane&=-536870913)}u&=~ut}_!==0&&_i(i,_,0),I!==0&&E===0&&i.tag!==0&&(i.suspendedLanes|=I&~(q&~s))}function _i(i,s,u){i.pendingLanes|=s,i.suspendedLanes&=~s;var _=31-Me(s);i.entangledLanes|=s,i.entanglements[_]=i.entanglements[_]|1073741824|u&4194090}function jt(i,s){var u=i.entangledLanes|=s;for(i=i.entanglements;u;){var _=31-Me(u),E=1<<_;E&s|i[_]&s&&(i[_]|=s),u&=~E}}function si(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Yi(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Wn(){var i=it.p;return i!==0?i:(i=window.event,i===void 0?32:Ut(i.type))}function ir(i,s){var u=it.p;try{return it.p=i,s()}finally{it.p=u}}var en=Math.random().toString(36).slice(2),Wt="__reactFiber$"+en,ti="__reactProps$"+en,fn="__reactContainer$"+en,pt="__reactEvents$"+en,Pr="__reactListeners$"+en,Cn="__reactHandles$"+en,Ps="__reactResources$"+en,cs="__reactMarker$"+en;function Tt(i){delete i[Wt],delete i[ti],delete i[pt],delete i[Pr],delete i[Cn]}function ci(i){var s=i[Wt];if(s)return s;for(var u=i.parentNode;u;){if(s=u[fn]||u[Wt]){if(u=s.alternate,s.child!==null||u!==null&&u.child!==null)for(i=wu(i);i!==null;){if(u=i[Wt])return u;i=wu(i)}return s}i=u,u=i.parentNode}return null}function ri(i){if(i=i[Wt]||i[fn]){var s=i.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return i}return null}function Zn(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i.stateNode;throw Error(b(33))}function Ta(i){var s=i[Ps];return s||(s=i[Ps]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function pn(i){i[cs]=!0}var ui=new Set,Mc={};function ta(i,s){Rs(i,s),Rs(i+"Capture",s)}function Rs(i,s){for(Mc[i]=s,i=0;i<s.length;i++)ui.add(s[i])}var us=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Uo={},En={};function zu(i){return ni.call(En,i)?!0:ni.call(Uo,i)?!1:us.test(i)?En[i]=!0:(Uo[i]=!0,!1)}function pr(i,s,u){if(zu(s))if(u===null)i.removeAttribute(s);else{switch(typeof u){case"undefined":case"function":case"symbol":i.removeAttribute(s);return;case"boolean":var _=s.toLowerCase().slice(0,5);if(_!=="data-"&&_!=="aria-"){i.removeAttribute(s);return}}i.setAttribute(s,""+u)}}function Ni(i,s,u){if(u===null)i.removeAttribute(s);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(s);return}i.setAttribute(s,""+u)}}function hs(i,s,u,_){if(_===null)i.removeAttribute(u);else{switch(typeof _){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(u);return}i.setAttributeNS(s,u,""+_)}}var Vo,Iu;function la(i){if(Vo===void 0)try{throw Error()}catch(u){var s=u.stack.trim().match(/\n( *(at )?)/);Vo=s&&s[1]||"",Iu=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Vo+i+Iu}var ds=!1;function Ac(i,s){if(!i||ds)return"";ds=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var _={DetermineComponentFrameRoot:function(){try{if(s){var ut=function(){throw Error()};if(Object.defineProperty(ut.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ut,[])}catch(We){var He=We}Reflect.construct(i,[],ut)}else{try{ut.call()}catch(We){He=We}i.call(ut.prototype)}}else{try{throw Error()}catch(We){He=We}(ut=i())&&typeof ut.catch=="function"&&ut.catch(function(){})}}catch(We){if(We&&He&&typeof We.stack=="string")return[We.stack,He.stack]}return[null,null]}};_.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var E=Object.getOwnPropertyDescriptor(_.DetermineComponentFrameRoot,"name");E&&E.configurable&&Object.defineProperty(_.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var I=_.DetermineComponentFrameRoot(),q=I[0],te=I[1];if(q&&te){var ve=q.split(`
`),qe=te.split(`
`);for(E=_=0;_<ve.length&&!ve[_].includes("DetermineComponentFrameRoot");)_++;for(;E<qe.length&&!qe[E].includes("DetermineComponentFrameRoot");)E++;if(_===ve.length||E===qe.length)for(_=ve.length-1,E=qe.length-1;1<=_&&0<=E&&ve[_]!==qe[E];)E--;for(;1<=_&&0<=E;_--,E--)if(ve[_]!==qe[E]){if(_!==1||E!==1)do if(_--,E--,0>E||ve[_]!==qe[E]){var rt=`
`+ve[_].replace(" at new "," at ");return i.displayName&&rt.includes("<anonymous>")&&(rt=rt.replace("<anonymous>",i.displayName)),rt}while(1<=_&&0<=E);break}}}finally{ds=!1,Error.prepareStackTrace=u}return(u=i?i.displayName||i.name:"")?la(u):""}function Yd(i){switch(i.tag){case 26:case 27:case 5:return la(i.type);case 16:return la("Lazy");case 13:return la("Suspense");case 19:return la("SuspenseList");case 0:case 15:return Ac(i.type,!1);case 11:return Ac(i.type.render,!1);case 1:return Ac(i.type,!0);case 31:return la("Activity");default:return""}}function Bh(i){try{var s="";do s+=Yd(i),i=i.return;while(i);return s}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}function mr(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Nh(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Sp(i){var s=Nh(i)?"checked":"value",u=Object.getOwnPropertyDescriptor(i.constructor.prototype,s),_=""+i[s];if(!i.hasOwnProperty(s)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var E=u.get,I=u.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return E.call(this)},set:function(q){_=""+q,I.call(this,q)}}),Object.defineProperty(i,s,{enumerable:u.enumerable}),{getValue:function(){return _},setValue:function(q){_=""+q},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function Du(i){i._valueTracker||(i._valueTracker=Sp(i))}function Wd(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var u=s.getValue(),_="";return i&&(_=Nh(i)?i.checked?"true":"false":i.value),i=_,i!==u?(s.setValue(i),!0):!1}function Rl(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var zl=/[\n"\\]/g;function ia(i){return i.replace(zl,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Pc(i,s,u,_,E,I,q,te){i.name="",q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"?i.type=q:i.removeAttribute("type"),s!=null?q==="number"?(s===0&&i.value===""||i.value!=s)&&(i.value=""+mr(s)):i.value!==""+mr(s)&&(i.value=""+mr(s)):q!=="submit"&&q!=="reset"||i.removeAttribute("value"),s!=null?Rc(i,q,mr(s)):u!=null?Rc(i,q,mr(u)):_!=null&&i.removeAttribute("value"),E==null&&I!=null&&(i.defaultChecked=!!I),E!=null&&(i.checked=E&&typeof E!="function"&&typeof E!="symbol"),te!=null&&typeof te!="function"&&typeof te!="symbol"&&typeof te!="boolean"?i.name=""+mr(te):i.removeAttribute("name")}function Go(i,s,u,_,E,I,q,te){if(I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"&&(i.type=I),s!=null||u!=null){if(!(I!=="submit"&&I!=="reset"||s!=null))return;u=u!=null?""+mr(u):"",s=s!=null?""+mr(s):u,te||s===i.value||(i.value=s),i.defaultValue=s}_=_??E,_=typeof _!="function"&&typeof _!="symbol"&&!!_,i.checked=te?i.checked:!!_,i.defaultChecked=!!_,q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"&&(i.name=q)}function Rc(i,s,u){s==="number"&&Rl(i.ownerDocument)===i||i.defaultValue===""+u||(i.defaultValue=""+u)}function ro(i,s,u,_){if(i=i.options,s){s={};for(var E=0;E<u.length;E++)s["$"+u[E]]=!0;for(u=0;u<i.length;u++)E=s.hasOwnProperty("$"+i[u].value),i[u].selected!==E&&(i[u].selected=E),E&&_&&(i[u].defaultSelected=!0)}else{for(u=""+mr(u),s=null,E=0;E<i.length;E++){if(i[E].value===u){i[E].selected=!0,_&&(i[E].defaultSelected=!0);return}s!==null||i[E].disabled||(s=i[E])}s!==null&&(s.selected=!0)}}function Kd(i,s,u){if(s!=null&&(s=""+mr(s),s!==i.value&&(i.value=s),u==null)){i.defaultValue!==s&&(i.defaultValue=s);return}i.defaultValue=u!=null?""+mr(u):""}function Zo(i,s,u,_){if(s==null){if(_!=null){if(u!=null)throw Error(b(92));if(Ht(_)){if(1<_.length)throw Error(b(93));_=_[0]}u=_}u==null&&(u=""),s=u}u=mr(s),i.defaultValue=u,_=i.textContent,_===u&&_!==""&&_!==null&&(i.value=_)}function fs(i,s){if(s){var u=i.firstChild;if(u&&u===i.lastChild&&u.nodeType===3){u.nodeValue=s;return}}i.textContent=s}var qa=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function yi(i,s,u){var _=s.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?_?i.setProperty(s,""):s==="float"?i.cssFloat="":i[s]="":_?i.setProperty(s,u):typeof u!="number"||u===0||qa.has(s)?s==="float"?i.cssFloat=u:i[s]=(""+u).trim():i[s]=u+"px"}function ao(i,s,u){if(s!=null&&typeof s!="object")throw Error(b(62));if(i=i.style,u!=null){for(var _ in u)!u.hasOwnProperty(_)||s!=null&&s.hasOwnProperty(_)||(_.indexOf("--")===0?i.setProperty(_,""):_==="float"?i.cssFloat="":i[_]="");for(var E in s)_=s[E],s.hasOwnProperty(E)&&u[E]!==_&&yi(i,E,_)}else for(var I in s)s.hasOwnProperty(I)&&yi(i,I,s[I])}function ps(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zs=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),qo=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function pi(i){return qo.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var Is=null;function Il(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Ds=null,Kn=null;function nr(i){var s=ri(i);if(s&&(i=s.stateNode)){var u=i[ti]||null;e:switch(i=s.stateNode,s.type){case"input":if(Pc(i,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),s=u.name,u.type==="radio"&&s!=null){for(u=i;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+ia(""+s)+'"][type="radio"]'),s=0;s<u.length;s++){var _=u[s];if(_!==i&&_.form===i.form){var E=_[ti]||null;if(!E)throw Error(b(90));Pc(_,E.value,E.defaultValue,E.defaultValue,E.checked,E.defaultChecked,E.type,E.name)}}for(s=0;s<u.length;s++)_=u[s],_.form===i.form&&Wd(_)}break e;case"textarea":Kd(i,u.value,u.defaultValue);break e;case"select":s=u.value,s!=null&&ro(i,!!u.multiple,s,!1)}}}var gr=!1;function qn(i,s,u){if(gr)return i(s,u);gr=!0;try{var _=i(s);return _}finally{if(gr=!1,(Ds!==null||Kn!==null)&&(Rf(),Ds&&(s=Ds,i=Kn,Kn=Ds=null,nr(s),i)))for(s=0;s<i.length;s++)nr(i[s])}}function Li(i,s){var u=i.stateNode;if(u===null)return null;var _=u[ti]||null;if(_===null)return null;u=_[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(_=!_.disabled)||(i=i.type,_=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!_;break e;default:i=!1}if(i)return null;if(u&&typeof u!="function")throw Error(b(231,s,typeof u));return u}var ms=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_r=!1;if(ms)try{var yr={};Object.defineProperty(yr,"passive",{get:function(){_r=!0}}),window.addEventListener("test",yr,yr),window.removeEventListener("test",yr,yr)}catch{_r=!1}var Mn=null,tn=null,gs=null;function Yt(){if(gs)return gs;var i,s=tn,u=s.length,_,E="value"in Mn?Mn.value:Mn.textContent,I=E.length;for(i=0;i<u&&s[i]===E[i];i++);var q=u-i;for(_=1;_<=q&&s[u-_]===E[I-_];_++);return gs=E.slice(i,1<_?1-_:void 0)}function ii(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function Ca(){return!0}function Ci(){return!1}function sn(i){function s(u,_,E,I,q){this._reactName=u,this._targetInst=E,this.type=_,this.nativeEvent=I,this.target=q,this.currentTarget=null;for(var te in i)i.hasOwnProperty(te)&&(u=i[te],this[te]=u?u(I):I[te]);return this.isDefaultPrevented=(I.defaultPrevented!=null?I.defaultPrevented:I.returnValue===!1)?Ca:Ci,this.isPropagationStopped=Ci,this}return Z(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Ca)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Ca)},persist:function(){},isPersistent:Ca}),s}var Rr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ca=sn(Rr),so=Z({},Rr,{view:0,detail:0}),jh=sn(so),oo,$o,lo,Ho=Z({},so,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Wo,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==lo&&(lo&&i.type==="mousemove"?(oo=i.screenX-lo.screenX,$o=i.screenY-lo.screenY):$o=oo=0,lo=i),oo)},movementY:function(i){return"movementY"in i?i.movementY:$o}}),zc=sn(Ho),$a=Z({},Ho,{dataTransfer:0}),lr=sn($a),Dl=Z({},so,{relatedTarget:0}),Xo=sn(Dl),Yo=Z({},Rr,{animationName:0,elapsedTime:0,pseudoElement:0}),In=sn(Yo),Qd=Z({},Rr,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Ic=sn(Qd),Fh=Z({},Rr,{data:0}),Jd=sn(Fh),kl={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Dc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _s(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=Dc[i])?!!s[i]:!1}function Wo(){return _s}var kc=Z({},so,{key:function(i){if(i.key){var s=kl[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=ii(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?vr[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Wo,charCode:function(i){return i.type==="keypress"?ii(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?ii(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Lc=sn(kc),zr=Z({},Ho,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Uh=sn(zr),ku=Z({},so,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Wo}),Tp=sn(ku),Vh=Z({},Rr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Cp=sn(Vh),Ep=Z({},Ho,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Lu=sn(Ep),Gh=Z({},Rr,{newState:0,oldState:0}),Ko=sn(Gh),Zh=[9,13,27,32],Ll=ms&&"CompositionEvent"in window,Gr=null;ms&&"documentMode"in document&&(Gr=document.documentMode);var Mp=ms&&"TextEvent"in window&&!Gr,Oc=ms&&(!Ll||Gr&&8<Gr&&11>=Gr),Ol=" ",Bl=!1;function ef(i,s){switch(i){case"keyup":return Zh.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bc(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Nl=!1;function Qo(i,s){switch(i){case"compositionend":return Bc(s);case"keypress":return s.which!==32?null:(Bl=!0,Ol);case"textInput":return i=s.data,i===Ol&&Bl?null:i;default:return null}}function tf(i,s){if(Nl)return i==="compositionend"||!Ll&&ef(i,s)?(i=Yt(),gs=tn=Mn=null,Nl=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Oc&&s.locale!=="ko"?null:s.data;default:return null}}var qh={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function nf(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!qh[i.type]:s==="textarea"}function $h(i,s,u,_){Ds?Kn?Kn.push(_):Kn=[_]:Ds=_,s=Ed(s,"onChange"),0<s.length&&(u=new ca("onChange","change",null,u,_),i.push({event:u,listeners:s}))}var Jo=null,jl=null;function Ou(i){Sg(i,0)}function Nc(i){var s=Zn(i);if(Wd(s))return i}function Hh(i,s){if(i==="change")return s}var co=!1;if(ms){var jc;if(ms){var Fc="oninput"in document;if(!Fc){var Fl=document.createElement("div");Fl.setAttribute("oninput","return;"),Fc=typeof Fl.oninput=="function"}jc=Fc}else jc=!1;co=jc&&(!document.documentMode||9<document.documentMode)}function rf(){Jo&&(Jo.detachEvent("onpropertychange",Ul),jl=Jo=null)}function Ul(i){if(i.propertyName==="value"&&Nc(jl)){var s=[];$h(s,jl,i,Il(i)),qn(Ou,s)}}function af(i,s,u){i==="focusin"?(rf(),Jo=s,jl=u,Jo.attachEvent("onpropertychange",Ul)):i==="focusout"&&rf()}function Ap(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Nc(jl)}function sf(i,s){if(i==="click")return Nc(s)}function of(i,s){if(i==="input"||i==="change")return Nc(s)}function Xh(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var Zr=typeof Object.is=="function"?Object.is:Xh;function Vl(i,s){if(Zr(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var u=Object.keys(i),_=Object.keys(s);if(u.length!==_.length)return!1;for(_=0;_<u.length;_++){var E=u[_];if(!ni.call(s,E)||!Zr(i[E],s[E]))return!1}return!0}function Uc(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function ys(i,s){var u=Uc(i);i=0;for(var _;u;){if(u.nodeType===3){if(_=i+u.textContent.length,i<=s&&_>=s)return{node:u,offset:s-i};i=_}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=Uc(u)}}function Pi(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?Pi(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function Bu(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var s=Rl(i.document);s instanceof i.HTMLIFrameElement;){try{var u=typeof s.contentWindow.location.href=="string"}catch{u=!1}if(u)i=s.contentWindow;else break;s=Rl(i.document)}return s}function Vc(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}var lf=ms&&"documentMode"in document&&11>=document.documentMode,uo=null,ks=null,el=null,Yh=!1;function cf(i,s,u){var _=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Yh||uo==null||uo!==Rl(_)||(_=uo,"selectionStart"in _&&Vc(_)?_={start:_.selectionStart,end:_.selectionEnd}:(_=(_.ownerDocument&&_.ownerDocument.defaultView||window).getSelection(),_={anchorNode:_.anchorNode,anchorOffset:_.anchorOffset,focusNode:_.focusNode,focusOffset:_.focusOffset}),el&&Vl(el,_)||(el=_,_=Ed(ks,"onSelect"),0<_.length&&(s=new ca("onSelect","select",null,s,u),i.push({event:s,listeners:_}),s.target=uo)))}function tl(i,s){var u={};return u[i.toLowerCase()]=s.toLowerCase(),u["Webkit"+i]="webkit"+s,u["Moz"+i]="moz"+s,u}var Gl={animationend:tl("Animation","AnimationEnd"),animationiteration:tl("Animation","AnimationIteration"),animationstart:tl("Animation","AnimationStart"),transitionrun:tl("Transition","TransitionRun"),transitionstart:tl("Transition","TransitionStart"),transitioncancel:tl("Transition","TransitionCancel"),transitionend:tl("Transition","TransitionEnd")},Nu={},uf={};ms&&(uf=document.createElement("div").style,"AnimationEvent"in window||(delete Gl.animationend.animation,delete Gl.animationiteration.animation,delete Gl.animationstart.animation),"TransitionEvent"in window||delete Gl.transitionend.transition);function ho(i){if(Nu[i])return Nu[i];if(!Gl[i])return i;var s=Gl[i],u;for(u in s)if(s.hasOwnProperty(u)&&u in uf)return Nu[i]=s[u];return i}var Gc=ho("animationend"),Zc=ho("animationiteration"),qc=ho("animationstart"),Wh=ho("transitionrun"),il=ho("transitionstart"),$c=ho("transitioncancel"),nl=ho("transitionend"),ua=new Map,ju="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ju.push("scrollEnd");function Ea(i,s){ua.set(i,s),ta(s,[i])}var Fu=new WeakMap;function cr(i,s){if(typeof i=="object"&&i!==null){var u=Fu.get(i);return u!==void 0?u:(s={value:i,source:s,stack:Bh(s)},Fu.set(i,s),s)}return{value:i,source:s,stack:Bh(s)}}var qr=[],Ls=0,rl=0;function al(){for(var i=Ls,s=rl=Ls=0;s<i;){var u=qr[s];qr[s++]=null;var _=qr[s];qr[s++]=null;var E=qr[s];qr[s++]=null;var I=qr[s];if(qr[s++]=null,_!==null&&E!==null){var q=_.pending;q===null?E.next=E:(E.next=q.next,q.next=E),_.pending=E}I!==0&&Kh(u,E,I)}}function Hc(i,s,u,_){qr[Ls++]=i,qr[Ls++]=s,qr[Ls++]=u,qr[Ls++]=_,rl|=_,i.lanes|=_,i=i.alternate,i!==null&&(i.lanes|=_)}function fo(i,s,u,_){return Hc(i,s,u,_),Zl(i)}function ha(i,s){return Hc(i,null,null,s),Zl(i)}function Kh(i,s,u){i.lanes|=u;var _=i.alternate;_!==null&&(_.lanes|=u);for(var E=!1,I=i.return;I!==null;)I.childLanes|=u,_=I.alternate,_!==null&&(_.childLanes|=u),I.tag===22&&(i=I.stateNode,i===null||i._visibility&1||(E=!0)),i=I,I=I.return;return i.tag===3?(I=i.stateNode,E&&s!==null&&(E=31-Me(u),i=I.hiddenUpdates,_=i[E],_===null?i[E]=[s]:_.push(s),s.lane=u|536870912),I):null}function Zl(i){if(50<gu)throw gu=0,hc=null,Error(b(185));for(var s=i.return;s!==null;)i=s,s=i.return;return i.tag===3?i.stateNode:null}var fi={};function Xc(i,s,u,_){this.tag=i,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=_,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function da(i,s,u,_){return new Xc(i,s,u,_)}function Uu(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Ir(i,s){var u=i.alternate;return u===null?(u=da(i.tag,s,i.key,i.mode),u.elementType=i.elementType,u.type=i.type,u.stateNode=i.stateNode,u.alternate=i,i.alternate=u):(u.pendingProps=s,u.type=i.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=i.flags&65011712,u.childLanes=i.childLanes,u.lanes=i.lanes,u.child=i.child,u.memoizedProps=i.memoizedProps,u.memoizedState=i.memoizedState,u.updateQueue=i.updateQueue,s=i.dependencies,u.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},u.sibling=i.sibling,u.index=i.index,u.ref=i.ref,u.refCleanup=i.refCleanup,u}function Qh(i,s){i.flags&=65011714;var u=i.alternate;return u===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=u.childLanes,i.lanes=u.lanes,i.child=u.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=u.memoizedProps,i.memoizedState=u.memoizedState,i.updateQueue=u.updateQueue,i.type=u.type,s=u.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i}function Vu(i,s,u,_,E,I){var q=0;if(_=i,typeof i=="function")Uu(i)&&(q=1);else if(typeof i=="string")q=M(i,u,Et.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case at:return i=da(31,u,s,E),i.elementType=at,i.lanes=I,i;case le:return po(u.children,E,I,s);case ie:q=8,E|=24;break;case me:return i=da(12,u,s,E|2),i.elementType=me,i.lanes=I,i;case Ve:return i=da(13,u,s,E),i.elementType=Ve,i.lanes=I,i;case ct:return i=da(19,u,s,E),i.elementType=ct,i.lanes=I,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case Ce:case Ee:q=10;break e;case Se:q=9;break e;case ke:q=11;break e;case tt:q=14;break e;case Qe:q=16,_=null;break e}q=29,u=Error(b(130,i===null?"null":typeof i,"")),_=null}return s=da(q,u,s,E),s.elementType=i,s.type=_,s.lanes=I,s}function po(i,s,u,_){return i=da(7,i,_,s),i.lanes=u,i}function Jh(i,s,u){return i=da(6,i,null,s),i.lanes=u,i}function Yc(i,s,u){return s=da(4,i.children!==null?i.children:[],i.key,s),s.lanes=u,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}var Os=[],vs=0,mo=null,ql=0,fa=[],Dr=0,Ha=null,pa=1,Ma="";function Bs(i,s){Os[vs++]=ql,Os[vs++]=mo,mo=i,ql=s}function go(i,s,u){fa[Dr++]=pa,fa[Dr++]=Ma,fa[Dr++]=Ha,Ha=i;var _=pa;i=Ma;var E=32-Me(_)-1;_&=~(1<<E),u+=1;var I=32-Me(s)+E;if(30<I){var q=E-E%5;I=(_&(1<<q)-1).toString(32),_>>=q,E-=q,pa=1<<32-Me(s)+E|u<<E|_,Ma=I+i}else pa=1<<I|u<<E|_,Ma=i}function Wc(i){i.return!==null&&(Bs(i,1),go(i,1,0))}function $l(i){for(;i===mo;)mo=Os[--vs],Os[vs]=null,ql=Os[--vs],Os[vs]=null;for(;i===Ha;)Ha=fa[--Dr],fa[Dr]=null,Ma=fa[--Dr],fa[Dr]=null,pa=fa[--Dr],fa[Dr]=null}var $n=null,vn=null,Oi=!1,_o=null,ma=!1,Kc=Error(b(519));function sl(i){var s=Error(b(418,""));throw Ns(cr(s,i)),Kc}function Gu(i){var s=i.stateNode,u=i.type,_=i.memoizedProps;switch(s[Wt]=i,s[ti]=_,u){case"dialog":Ii("cancel",s),Ii("close",s);break;case"iframe":case"object":case"embed":Ii("load",s);break;case"video":case"audio":for(u=0;u<Td.length;u++)Ii(Td[u],s);break;case"source":Ii("error",s);break;case"img":case"image":case"link":Ii("error",s),Ii("load",s);break;case"details":Ii("toggle",s);break;case"input":Ii("invalid",s),Go(s,_.value,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name,!0),Du(s);break;case"select":Ii("invalid",s);break;case"textarea":Ii("invalid",s),Zo(s,_.value,_.defaultValue,_.children),Du(s)}u=_.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||s.textContent===""+u||_.suppressHydrationWarning===!0||om(s.textContent,u)?(_.popover!=null&&(Ii("beforetoggle",s),Ii("toggle",s)),_.onScroll!=null&&Ii("scroll",s),_.onScrollEnd!=null&&Ii("scrollend",s),_.onClick!=null&&(s.onclick=aa),s=!0):s=!1,s||sl(i)}function xn(i){for($n=i.return;$n;)switch($n.tag){case 5:case 13:ma=!1;return;case 27:case 3:ma=!0;return;default:$n=$n.return}}function na(i){if(i!==$n)return!1;if(!Oi)return xn(i),Oi=!0,!1;var s=i.tag,u;if((u=s!==3&&s!==27)&&((u=s===5)&&(u=i.type,u=!(u!=="form"&&u!=="button")||ko(i.type,i.memoizedProps)),u=!u),u&&vn&&sl(i),xn(i),s===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(b(317));e:{for(i=i.nextSibling,s=0;i;){if(i.nodeType===8)if(u=i.data,u==="/$"){if(s===0){vn=Qs(i.nextSibling);break e}s--}else u!=="$"&&u!=="$!"&&u!=="$?"||s++;i=i.nextSibling}vn=null}}else s===27?(s=vn,wl(i.type)?(i=um,um=null,vn=i):vn=s):vn=$n?Qs(i.stateNode.nextSibling):null;return!0}function kr(){vn=$n=null,Oi=!1}function Qc(){var i=_o;return i!==null&&(Ba===null?Ba=i:Ba.push.apply(Ba,i),_o=null),i}function Ns(i){_o===null?_o=[i]:_o.push(i)}var Zu=Ke(null),ga=null,Aa=null;function Lr(i,s,u){ft(Zu,s._currentValue),s._currentValue=u}function Xa(i){i._currentValue=Zu.current,wt(Zu)}function qu(i,s,u){for(;i!==null;){var _=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,_!==null&&(_.childLanes|=s)):_!==null&&(_.childLanes&s)!==s&&(_.childLanes|=s),i===u)break;i=i.return}}function $u(i,s,u,_){var E=i.child;for(E!==null&&(E.return=i);E!==null;){var I=E.dependencies;if(I!==null){var q=E.child;I=I.firstContext;e:for(;I!==null;){var te=I;I=E;for(var ve=0;ve<s.length;ve++)if(te.context===s[ve]){I.lanes|=u,te=I.alternate,te!==null&&(te.lanes|=u),qu(I.return,u,i),_||(q=null);break e}I=te.next}}else if(E.tag===18){if(q=E.return,q===null)throw Error(b(341));q.lanes|=u,I=q.alternate,I!==null&&(I.lanes|=u),qu(q,u,i),q=null}else q=E.child;if(q!==null)q.return=E;else for(q=E;q!==null;){if(q===i){q=null;break}if(E=q.sibling,E!==null){E.return=q.return,q=E;break}q=q.return}E=q}}function Hl(i,s,u,_){i=null;for(var E=s,I=!1;E!==null;){if(!I){if((E.flags&524288)!==0)I=!0;else if((E.flags&262144)!==0)break}if(E.tag===10){var q=E.alternate;if(q===null)throw Error(b(387));if(q=q.memoizedProps,q!==null){var te=E.type;Zr(E.pendingProps.value,q.value)||(i!==null?i.push(te):i=[te])}}else if(E===At.current){if(q=E.alternate,q===null)throw Error(b(387));q.memoizedState.memoizedState!==E.memoizedState.memoizedState&&(i!==null?i.push(Ae):i=[Ae])}E=E.return}i!==null&&$u(s,i,u,_),s.flags|=262144}function Jc(i){for(i=i.firstContext;i!==null;){if(!Zr(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function yo(i){ga=i,Aa=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function on(i){return $r(ga,i)}function js(i,s){return ga===null&&yo(i),$r(i,s)}function $r(i,s){var u=s._currentValue;if(s={context:s,memoizedValue:u,next:null},Aa===null){if(i===null)throw Error(b(308));Aa=s,i.dependencies={lanes:0,firstContext:s},i.flags|=524288}else Aa=Aa.next=s;return u}var Xl=typeof AbortController<"u"?AbortController:function(){var i=[],s=this.signal={aborted:!1,addEventListener:function(u,_){i.push(_)}};this.abort=function(){s.aborted=!0,i.forEach(function(u){return u()})}},ed=p.unstable_scheduleCallback,hf=p.unstable_NormalPriority,Qn={$$typeof:Ee,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function vo(){return{controller:new Xl,data:new Map,refCount:0}}function ol(i){i.refCount--,i.refCount===0&&ed(hf,function(){i.controller.abort()})}var xs=null,Hu=0,rr=0,Or=null;function Yl(i,s){if(xs===null){var u=xs=[];Hu=0,rr=wd(),Or={status:"pending",value:void 0,then:function(_){u.push(_)}}}return Hu++,s.then(Pa,Pa),s}function Pa(){if(--Hu===0&&xs!==null){Or!==null&&(Or.status="fulfilled");var i=xs;xs=null,rr=0,Or=null;for(var s=0;s<i.length;s++)(0,i[s])()}}function Wl(i,s){var u=[],_={status:"pending",value:null,reason:null,then:function(E){u.push(E)}};return i.then(function(){_.status="fulfilled",_.value=s;for(var E=0;E<u.length;E++)(0,u[E])(s)},function(E){for(_.status="rejected",_.reason=E,E=0;E<u.length;E++)(0,u[E])(void 0)}),_}var df=Oe.S;Oe.S=function(i,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&Yl(i,s),df!==null&&df(i,s)};var Ya=Ke(null);function td(){var i=Ya.current;return i!==null?i:Tn.pooledCache}function Xu(i,s){s===null?ft(Ya,Ya.current):ft(Ya,s.pool)}function Kl(){var i=td();return i===null?null:{parent:Qn._currentValue,pool:i}}var Fs=Error(b(460)),Ra=Error(b(474)),Mt=Error(b(542)),eu={then:function(){}};function tu(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Ql(){}function ll(i,s,u){switch(u=i[u],u===void 0?i.push(s):u!==s&&(s.then(Ql,Ql),s=u),s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,Si(i),i;default:if(typeof s.status=="string")s.then(Ql,Ql);else{if(i=Tn,i!==null&&100<i.shellSuspendCounter)throw Error(b(482));i=s,i.status="pending",i.then(function(_){if(s.status==="pending"){var E=s;E.status="fulfilled",E.value=_}},function(_){if(s.status==="pending"){var E=s;E.status="rejected",E.reason=_}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,Si(i),i}throw Wa=s,Fs}}var Wa=null;function iu(){if(Wa===null)throw Error(b(459));var i=Wa;return Wa=null,i}function Si(i){if(i===Fs||i===Mt)throw Error(b(483))}var Ka=!1;function id(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Jl(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function xo(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Us(i,s,u){var _=i.updateQueue;if(_===null)return null;if(_=_.shared,(nn&2)!==0){var E=_.pending;return E===null?s.next=s:(s.next=E.next,E.next=s),_.pending=s,s=Zl(i),Kh(i,null,u),s}return Hc(i,_,s,u),Zl(i)}function cl(i,s,u){if(s=s.updateQueue,s!==null&&(s=s.shared,(u&4194048)!==0)){var _=s.lanes;_&=i.pendingLanes,u|=_,s.lanes=u,jt(i,u)}}function nu(i,s){var u=i.updateQueue,_=i.alternate;if(_!==null&&(_=_.updateQueue,u===_)){var E=null,I=null;if(u=u.firstBaseUpdate,u!==null){do{var q={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};I===null?E=I=q:I=I.next=q,u=u.next}while(u!==null);I===null?E=I=s:I=I.next=s}else E=I=s;u={baseState:_.baseState,firstBaseUpdate:E,lastBaseUpdate:I,shared:_.shared,callbacks:_.callbacks},i.updateQueue=u;return}i=u.lastBaseUpdate,i===null?u.firstBaseUpdate=s:i.next=s,u.lastBaseUpdate=s}var Yu=!1;function ec(){if(Yu){var i=Or;if(i!==null)throw i}}function ul(i,s,u,_){Yu=!1;var E=i.updateQueue;Ka=!1;var I=E.firstBaseUpdate,q=E.lastBaseUpdate,te=E.shared.pending;if(te!==null){E.shared.pending=null;var ve=te,qe=ve.next;ve.next=null,q===null?I=qe:q.next=qe,q=ve;var rt=i.alternate;rt!==null&&(rt=rt.updateQueue,te=rt.lastBaseUpdate,te!==q&&(te===null?rt.firstBaseUpdate=qe:te.next=qe,rt.lastBaseUpdate=ve))}if(I!==null){var ut=E.baseState;q=0,rt=qe=ve=null,te=I;do{var He=te.lane&-536870913,We=He!==te.lane;if(We?(Mi&He)===He:(_&He)===He){He!==0&&He===rr&&(Yu=!0),rt!==null&&(rt=rt.next={lane:0,tag:te.tag,payload:te.payload,callback:null,next:null});e:{var li=i,ai=te;He=s;var hn=u;switch(ai.tag){case 1:if(li=ai.payload,typeof li=="function"){ut=li.call(hn,ut,He);break e}ut=li;break e;case 3:li.flags=li.flags&-65537|128;case 0:if(li=ai.payload,He=typeof li=="function"?li.call(hn,ut,He):li,He==null)break e;ut=Z({},ut,He);break e;case 2:Ka=!0}}He=te.callback,He!==null&&(i.flags|=64,We&&(i.flags|=8192),We=E.callbacks,We===null?E.callbacks=[He]:We.push(He))}else We={lane:He,tag:te.tag,payload:te.payload,callback:te.callback,next:null},rt===null?(qe=rt=We,ve=ut):rt=rt.next=We,q|=He;if(te=te.next,te===null){if(te=E.shared.pending,te===null)break;We=te,te=We.next,We.next=null,E.lastBaseUpdate=We,E.shared.pending=null}}while(!0);rt===null&&(ve=ut),E.baseState=ve,E.firstBaseUpdate=qe,E.lastBaseUpdate=rt,I===null&&(E.shared.lanes=0),zo|=q,i.lanes=q,i.memoizedState=ut}}function nd(i,s){if(typeof i!="function")throw Error(b(191,i));i.call(s)}function rd(i,s){var u=i.callbacks;if(u!==null)for(i.callbacks=null,i=0;i<u.length;i++)nd(u[i],s)}var Br=Ke(null),ji=Ke(0);function hl(i,s){i=vl,ft(ji,i),ft(Br,s),vl=i|s.baseLanes}function ru(){ft(ji,vl),ft(Br,Br.current)}function Wu(){vl=ji.current,wt(Br),wt(ji)}var bs=0,xi=null,Wi=null,Ki=null,dl=!1,Pt=!1,Ft=!1,fl=0,za=0,Vs=null,Hr=0;function Dn(){throw Error(b(321))}function ra(i,s){if(s===null)return!1;for(var u=0;u<s.length&&u<i.length;u++)if(!Zr(i[u],s[u]))return!1;return!0}function ad(i,s,u,_,E,I){return bs=I,xi=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,Oe.H=i===null||i.memoizedState===null?Da:jr,Ft=!1,I=u(_,E),Ft=!1,Pt&&(I=Zi(s,u,_,E)),tc(i),I}function tc(i){Oe.H=xr;var s=Wi!==null&&Wi.next!==null;if(bs=0,Ki=Wi=xi=null,dl=!1,za=0,Vs=null,s)throw Error(b(300));i===null||sr||(i=i.dependencies,i!==null&&Jc(i)&&(sr=!0))}function Zi(i,s,u,_){xi=i;var E=0;do{if(Pt&&(Vs=null),za=0,Pt=!1,25<=E)throw Error(b(301));if(E+=1,Ki=Wi=null,i.updateQueue!=null){var I=i.updateQueue;I.lastEffect=null,I.events=null,I.stores=null,I.memoCache!=null&&(I.memoCache.index=0)}Oe.H=Eo,I=s(u,_)}while(Pt);return I}function kn(){var i=Oe.H,s=i.useState()[0];return s=typeof s.then=="function"?Zs(s):s,i=i.useState()[0],(Wi!==null?Wi.memoizedState:null)!==i&&(xi.flags|=1024),s}function ic(){var i=fl!==0;return fl=0,i}function bo(i,s,u){s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~u}function wo(i){if(dl){for(i=i.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}dl=!1}bs=0,Ki=Wi=xi=null,Pt=!1,za=fl=0,Vs=null}function Nr(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ki===null?xi.memoizedState=Ki=i:Ki=Ki.next=i,Ki}function mn(){if(Wi===null){var i=xi.alternate;i=i!==null?i.memoizedState:null}else i=Wi.next;var s=Ki===null?xi.memoizedState:Ki.next;if(s!==null)Ki=s,Wi=i;else{if(i===null)throw xi.alternate===null?Error(b(467)):Error(b(310));Wi=i,i={memoizedState:Wi.memoizedState,baseState:Wi.baseState,baseQueue:Wi.baseQueue,queue:Wi.queue,next:null},Ki===null?xi.memoizedState=Ki=i:Ki=Ki.next=i}return Ki}function Gs(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Zs(i){var s=za;return za+=1,Vs===null&&(Vs=[]),i=ll(Vs,i,s),s=xi,(Ki===null?s.memoizedState:Ki.next)===null&&(s=s.alternate,Oe.H=s===null||s.memoizedState===null?Da:jr),i}function pl(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Zs(i);if(i.$$typeof===Ee)return on(i)}throw Error(b(438,String(i)))}function qs(i){var s=null,u=xi.updateQueue;if(u!==null&&(s=u.memoCache),s==null){var _=xi.alternate;_!==null&&(_=_.updateQueue,_!==null&&(_=_.memoCache,_!=null&&(s={data:_.data.map(function(E){return E.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),u===null&&(u=Gs(),xi.updateQueue=u),u.memoCache=s,u=s.data[s.index],u===void 0)for(u=s.data[s.index]=Array(i),_=0;_<i;_++)u[_]=ht;return s.index++,u}function Qa(i,s){return typeof s=="function"?s(i):s}function nc(i){var s=mn();return rc(s,Wi,i)}function rc(i,s,u){var _=i.queue;if(_===null)throw Error(b(311));_.lastRenderedReducer=u;var E=i.baseQueue,I=_.pending;if(I!==null){if(E!==null){var q=E.next;E.next=I.next,I.next=q}s.baseQueue=E=I,_.pending=null}if(I=i.baseState,E===null)i.memoizedState=I;else{s=E.next;var te=q=null,ve=null,qe=s,rt=!1;do{var ut=qe.lane&-536870913;if(ut!==qe.lane?(Mi&ut)===ut:(bs&ut)===ut){var He=qe.revertLane;if(He===0)ve!==null&&(ve=ve.next={lane:0,revertLane:0,action:qe.action,hasEagerState:qe.hasEagerState,eagerState:qe.eagerState,next:null}),ut===rr&&(rt=!0);else if((bs&He)===He){qe=qe.next,He===rr&&(rt=!0);continue}else ut={lane:0,revertLane:qe.revertLane,action:qe.action,hasEagerState:qe.hasEagerState,eagerState:qe.eagerState,next:null},ve===null?(te=ve=ut,q=I):ve=ve.next=ut,xi.lanes|=He,zo|=He;ut=qe.action,Ft&&u(I,ut),I=qe.hasEagerState?qe.eagerState:u(I,ut)}else He={lane:ut,revertLane:qe.revertLane,action:qe.action,hasEagerState:qe.hasEagerState,eagerState:qe.eagerState,next:null},ve===null?(te=ve=He,q=I):ve=ve.next=He,xi.lanes|=ut,zo|=ut;qe=qe.next}while(qe!==null&&qe!==s);if(ve===null?q=I:ve.next=te,!Zr(I,i.memoizedState)&&(sr=!0,rt&&(u=Or,u!==null)))throw u;i.memoizedState=I,i.baseState=q,i.baseQueue=ve,_.lastRenderedState=I}return E===null&&(_.lanes=0),[i.memoizedState,_.dispatch]}function au(i){var s=mn(),u=s.queue;if(u===null)throw Error(b(311));u.lastRenderedReducer=i;var _=u.dispatch,E=u.pending,I=s.memoizedState;if(E!==null){u.pending=null;var q=E=E.next;do I=i(I,q.action),q=q.next;while(q!==E);Zr(I,s.memoizedState)||(sr=!0),s.memoizedState=I,s.baseQueue===null&&(s.baseState=I),u.lastRenderedState=I}return[I,_]}function m(i,s,u){var _=xi,E=mn(),I=Oi;if(I){if(u===void 0)throw Error(b(407));u=u()}else u=s();var q=!Zr((Wi||E).memoizedState,u);q&&(E.memoizedState=u,sr=!0),E=E.queue;var te=c.bind(null,_,E,i);if(Re(2048,8,te,[i]),E.getSnapshot!==s||q||Ki!==null&&Ki.memoizedState.tag&1){if(_.flags|=2048,he(9,ye(),a.bind(null,_,E,u,s),null),Tn===null)throw Error(b(349));I||(bs&124)!==0||e(_,s,u)}return u}function e(i,s,u){i.flags|=16384,i={getSnapshot:s,value:u},s=xi.updateQueue,s===null?(s=Gs(),xi.updateQueue=s,s.stores=[i]):(u=s.stores,u===null?s.stores=[i]:u.push(i))}function a(i,s,u,_){s.value=u,s.getSnapshot=_,f(s)&&y(i)}function c(i,s,u){return u(function(){f(s)&&y(i)})}function f(i){var s=i.getSnapshot;i=i.value;try{var u=s();return!Zr(i,u)}catch{return!0}}function y(i){var s=ha(i,2);s!==null&&rs(s,i,2)}function w(i){var s=Nr();if(typeof i=="function"){var u=i;if(i=u(),Ft){oa(!0);try{u()}finally{oa(!1)}}}return s.memoizedState=s.baseState=i,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qa,lastRenderedState:i},s}function A(i,s,u,_){return i.baseState=u,rc(i,Wi,typeof _=="function"?_:Qa)}function P(i,s,u,_,E){if(Hs(i))throw Error(b(485));if(i=s.action,i!==null){var I={payload:E,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(q){I.listeners.push(q)}};Oe.T!==null?u(!0):I.isTransition=!1,_(I),u=s.pending,u===null?(I.next=s.pending=I,k(s,I)):(I.next=u.next,s.pending=u.next=I)}}function k(i,s){var u=s.action,_=s.payload,E=i.state;if(s.isTransition){var I=Oe.T,q={};Oe.T=q;try{var te=u(E,_),ve=Oe.S;ve!==null&&ve(q,te),O(i,s,te)}catch(qe){j(i,s,qe)}finally{Oe.T=I}}else try{I=u(E,_),O(i,s,I)}catch(qe){j(i,s,qe)}}function O(i,s,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(_){F(i,s,_)},function(_){return j(i,s,_)}):F(i,s,u)}function F(i,s,u){s.status="fulfilled",s.value=u,G(s),i.state=u,s=i.pending,s!==null&&(u=s.next,u===s?i.pending=null:(u=u.next,s.next=u,k(i,u)))}function j(i,s,u){var _=i.pending;if(i.pending=null,_!==null){_=_.next;do s.status="rejected",s.reason=u,G(s),s=s.next;while(s!==_)}i.action=null}function G(i){i=i.listeners;for(var s=0;s<i.length;s++)(0,i[s])()}function X(i,s){return s}function se(i,s){if(Oi){var u=Tn.formState;if(u!==null){e:{var _=xi;if(Oi){if(vn){t:{for(var E=vn,I=ma;E.nodeType!==8;){if(!I){E=null;break t}if(E=Qs(E.nextSibling),E===null){E=null;break t}}I=E.data,E=I==="F!"||I==="F"?E:null}if(E){vn=Qs(E.nextSibling),_=E.data==="F!";break e}}sl(_)}_=!1}_&&(s=u[0])}}return u=Nr(),u.memoizedState=u.baseState=s,_={pending:null,lanes:0,dispatch:null,lastRenderedReducer:X,lastRenderedState:s},u.queue=_,u=$s.bind(null,xi,_),_.dispatch=u,_=w(!1),I=So.bind(null,xi,!1,_.queue),_=Nr(),E={state:s,dispatch:null,action:i,pending:null},_.queue=E,u=P.bind(null,xi,E,I,u),E.dispatch=u,_.memoizedState=i,[s,u,!1]}function ae(i){var s=mn();return oe(s,Wi,i)}function oe(i,s,u){if(s=rc(i,s,X)[0],i=nc(Qa)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var _=Zs(s)}catch(q){throw q===Fs?Mt:q}else _=s;s=mn();var E=s.queue,I=E.dispatch;return u!==s.memoizedState&&(xi.flags|=2048,he(9,ye(),ue.bind(null,E,u),null)),[_,I,i]}function ue(i,s){i.action=s}function ge(i){var s=mn(),u=Wi;if(u!==null)return oe(s,u,i);mn(),s=s.memoizedState,u=mn();var _=u.queue.dispatch;return u.memoizedState=i,[s,_,!1]}function he(i,s,u,_){return i={tag:i,create:u,deps:_,inst:s,next:null},s=xi.updateQueue,s===null&&(s=Gs(),xi.updateQueue=s),u=s.lastEffect,u===null?s.lastEffect=i.next=i:(_=u.next,u.next=i,i.next=_,s.lastEffect=i),i}function ye(){return{destroy:void 0,resource:void 0}}function Te(){return mn().memoizedState}function fe(i,s,u,_){var E=Nr();_=_===void 0?null:_,xi.flags|=i,E.memoizedState=he(1|s,ye(),u,_)}function Re(i,s,u,_){var E=mn();_=_===void 0?null:_;var I=E.memoizedState.inst;Wi!==null&&_!==null&&ra(_,Wi.memoizedState.deps)?E.memoizedState=he(s,I,u,_):(xi.flags|=i,E.memoizedState=he(1|s,I,u,_))}function $e(i,s){fe(8390656,8,i,s)}function Ne(i,s){Re(2048,8,i,s)}function Fe(i,s){return Re(4,2,i,s)}function Ze(i,s){return Re(4,4,i,s)}function mt(i,s){if(typeof s=="function"){i=i();var u=s(i);return function(){typeof u=="function"?u():s(null)}}if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function _t(i,s,u){u=u!=null?u.concat([i]):null,Re(4,4,mt.bind(null,s,i),u)}function st(){}function Dt(i,s){var u=mn();s=s===void 0?null:s;var _=u.memoizedState;return s!==null&&ra(s,_[1])?_[0]:(u.memoizedState=[i,s],i)}function hi(i,s){var u=mn();s=s===void 0?null:s;var _=u.memoizedState;if(s!==null&&ra(s,_[1]))return _[0];if(_=i(),Ft){oa(!0);try{i()}finally{oa(!1)}}return u.memoizedState=[_,s],_}function Ri(i,s,u){return u===void 0||(bs&1073741824)!==0?i.memoizedState=s:(i.memoizedState=u,i=lg(),xi.lanes|=i,zo|=i,u)}function qi(i,s,u,_){return Zr(u,s)?u:Br.current!==null?(i=Ri(i,u,_),Zr(i,s)||(sr=!0),i):(bs&42)===0?(sr=!0,i.memoizedState=u):(i=lg(),xi.lanes|=i,zo|=i,s)}function Fi(i,s,u,_,E){var I=it.p;it.p=I!==0&&8>I?I:8;var q=Oe.T,te={};Oe.T=te,So(i,!1,s,u);try{var ve=E(),qe=Oe.S;if(qe!==null&&qe(te,ve),ve!==null&&typeof ve=="object"&&typeof ve.then=="function"){var rt=Wl(ve,_);Ia(i,s,rt,Na(i))}else Ia(i,s,_,Na(i))}catch(ut){Ia(i,s,{then:function(){},status:"rejected",reason:ut},Na())}finally{it.p=I,Oe.T=q}}function bn(){}function gn(i,s,u,_){if(i.tag!==5)throw Error(b(476));var E=oi(i).queue;Fi(i,E,s,Xe,u===null?bn:function(){return $i(i),u(_)})}function oi(i){var s=i.memoizedState;if(s!==null)return s;s={memoizedState:Xe,baseState:Xe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qa,lastRenderedState:Xe},next:null};var u={};return s.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qa,lastRenderedState:u},next:null},i.memoizedState=s,i=i.alternate,i!==null&&(i.memoizedState=s),s}function $i(i){var s=oi(i).next.queue;Ia(i,s,{},Na())}function Ln(){return on(Ae)}function Jn(){return mn().memoizedState}function ar(){return mn().memoizedState}function Xr(i){for(var s=i.return;s!==null;){switch(s.tag){case 24:case 3:var u=Na();i=xo(u);var _=Us(s,i,u);_!==null&&(rs(_,s,u),cl(_,s,u)),s={cache:vo()},i.payload=s;return}s=s.return}}function Ja(i,s,u){var _=Na();u={lane:_,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null},Hs(i)?To(s,u):(u=fo(i,s,u,_),u!==null&&(rs(u,i,_),Co(u,s,_)))}function $s(i,s,u){var _=Na();Ia(i,s,u,_)}function Ia(i,s,u,_){var E={lane:_,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null};if(Hs(i))To(s,E);else{var I=i.alternate;if(i.lanes===0&&(I===null||I.lanes===0)&&(I=s.lastRenderedReducer,I!==null))try{var q=s.lastRenderedState,te=I(q,u);if(E.hasEagerState=!0,E.eagerState=te,Zr(te,q))return Hc(i,s,E,0),Tn===null&&al(),!1}catch{}finally{}if(u=fo(i,s,E,_),u!==null)return rs(u,i,_),Co(u,s,_),!0}return!1}function So(i,s,u,_){if(_={lane:2,revertLane:wd(),action:_,hasEagerState:!1,eagerState:null,next:null},Hs(i)){if(s)throw Error(b(479))}else s=fo(i,u,_,2),s!==null&&rs(s,i,2)}function Hs(i){var s=i.alternate;return i===xi||s!==null&&s===xi}function To(i,s){Pt=dl=!0;var u=i.pending;u===null?s.next=s:(s.next=u.next,u.next=s),i.pending=s}function Co(i,s,u){if((u&4194048)!==0){var _=s.lanes;_&=i.pendingLanes,u|=_,s.lanes=u,jt(i,u)}}var xr={readContext:on,use:pl,useCallback:Dn,useContext:Dn,useEffect:Dn,useImperativeHandle:Dn,useLayoutEffect:Dn,useInsertionEffect:Dn,useMemo:Dn,useReducer:Dn,useRef:Dn,useState:Dn,useDebugValue:Dn,useDeferredValue:Dn,useTransition:Dn,useSyncExternalStore:Dn,useId:Dn,useHostTransitionStatus:Dn,useFormState:Dn,useActionState:Dn,useOptimistic:Dn,useMemoCache:Dn,useCacheRefresh:Dn},Da={readContext:on,use:pl,useCallback:function(i,s){return Nr().memoizedState=[i,s===void 0?null:s],i},useContext:on,useEffect:$e,useImperativeHandle:function(i,s,u){u=u!=null?u.concat([i]):null,fe(4194308,4,mt.bind(null,s,i),u)},useLayoutEffect:function(i,s){return fe(4194308,4,i,s)},useInsertionEffect:function(i,s){fe(4,2,i,s)},useMemo:function(i,s){var u=Nr();s=s===void 0?null:s;var _=i();if(Ft){oa(!0);try{i()}finally{oa(!1)}}return u.memoizedState=[_,s],_},useReducer:function(i,s,u){var _=Nr();if(u!==void 0){var E=u(s);if(Ft){oa(!0);try{u(s)}finally{oa(!1)}}}else E=s;return _.memoizedState=_.baseState=E,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:E},_.queue=i,i=i.dispatch=Ja.bind(null,xi,i),[_.memoizedState,i]},useRef:function(i){var s=Nr();return i={current:i},s.memoizedState=i},useState:function(i){i=w(i);var s=i.queue,u=$s.bind(null,xi,s);return s.dispatch=u,[i.memoizedState,u]},useDebugValue:st,useDeferredValue:function(i,s){var u=Nr();return Ri(u,i,s)},useTransition:function(){var i=w(!1);return i=Fi.bind(null,xi,i.queue,!0,!1),Nr().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,s,u){var _=xi,E=Nr();if(Oi){if(u===void 0)throw Error(b(407));u=u()}else{if(u=s(),Tn===null)throw Error(b(349));(Mi&124)!==0||e(_,s,u)}E.memoizedState=u;var I={value:u,getSnapshot:s};return E.queue=I,$e(c.bind(null,_,I,i),[i]),_.flags|=2048,he(9,ye(),a.bind(null,_,I,u,s),null),u},useId:function(){var i=Nr(),s=Tn.identifierPrefix;if(Oi){var u=Ma,_=pa;u=(_&~(1<<32-Me(_)-1)).toString(32)+u,s=""+s+"R"+u,u=fl++,0<u&&(s+="H"+u.toString(32)),s+=""}else u=Hr++,s=""+s+"r"+u.toString(32)+"";return i.memoizedState=s},useHostTransitionStatus:Ln,useFormState:se,useActionState:se,useOptimistic:function(i){var s=Nr();s.memoizedState=s.baseState=i;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=u,s=So.bind(null,xi,!0,u),u.dispatch=s,[i,s]},useMemoCache:qs,useCacheRefresh:function(){return Nr().memoizedState=Xr.bind(null,xi)}},jr={readContext:on,use:pl,useCallback:Dt,useContext:on,useEffect:Ne,useImperativeHandle:_t,useInsertionEffect:Fe,useLayoutEffect:Ze,useMemo:hi,useReducer:nc,useRef:Te,useState:function(){return nc(Qa)},useDebugValue:st,useDeferredValue:function(i,s){var u=mn();return qi(u,Wi.memoizedState,i,s)},useTransition:function(){var i=nc(Qa)[0],s=mn().memoizedState;return[typeof i=="boolean"?i:Zs(i),s]},useSyncExternalStore:m,useId:Jn,useHostTransitionStatus:Ln,useFormState:ae,useActionState:ae,useOptimistic:function(i,s){var u=mn();return A(u,Wi,i,s)},useMemoCache:qs,useCacheRefresh:ar},Eo={readContext:on,use:pl,useCallback:Dt,useContext:on,useEffect:Ne,useImperativeHandle:_t,useInsertionEffect:Fe,useLayoutEffect:Ze,useMemo:hi,useReducer:au,useRef:Te,useState:function(){return au(Qa)},useDebugValue:st,useDeferredValue:function(i,s){var u=mn();return Wi===null?Ri(u,i,s):qi(u,Wi.memoizedState,i,s)},useTransition:function(){var i=au(Qa)[0],s=mn().memoizedState;return[typeof i=="boolean"?i:Zs(i),s]},useSyncExternalStore:m,useId:Jn,useHostTransitionStatus:Ln,useFormState:ge,useActionState:ge,useOptimistic:function(i,s){var u=mn();return Wi!==null?A(u,Wi,i,s):(u.baseState=i,[i,u.queue.dispatch])},useMemoCache:qs,useCacheRefresh:ar},_n=null,An=0;function Yr(i){var s=An;return An+=1,_n===null&&(_n=[]),ll(_n,i,s)}function wn(i,s){s=s.props.ref,i.ref=s!==void 0?s:null}function Mo(i,s){throw s.$$typeof===Y?Error(b(525)):(i=Object.prototype.toString.call(s),Error(b(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i)))}function ml(i){var s=i._init;return s(i._payload)}function ws(i){function s(Be,De){if(i){var Ge=Be.deletions;Ge===null?(Be.deletions=[De],Be.flags|=16):Ge.push(De)}}function u(Be,De){if(!i)return null;for(;De!==null;)s(Be,De),De=De.sibling;return null}function _(Be){for(var De=new Map;Be!==null;)Be.key!==null?De.set(Be.key,Be):De.set(Be.index,Be),Be=Be.sibling;return De}function E(Be,De){return Be=Ir(Be,De),Be.index=0,Be.sibling=null,Be}function I(Be,De,Ge){return Be.index=Ge,i?(Ge=Be.alternate,Ge!==null?(Ge=Ge.index,Ge<De?(Be.flags|=67108866,De):Ge):(Be.flags|=67108866,De)):(Be.flags|=1048576,De)}function q(Be){return i&&Be.alternate===null&&(Be.flags|=67108866),Be}function te(Be,De,Ge,lt){return De===null||De.tag!==6?(De=Jh(Ge,Be.mode,lt),De.return=Be,De):(De=E(De,Ge),De.return=Be,De)}function ve(Be,De,Ge,lt){var Vt=Ge.type;return Vt===le?rt(Be,De,Ge.props.children,lt,Ge.key):De!==null&&(De.elementType===Vt||typeof Vt=="object"&&Vt!==null&&Vt.$$typeof===Qe&&ml(Vt)===De.type)?(De=E(De,Ge.props),wn(De,Ge),De.return=Be,De):(De=Vu(Ge.type,Ge.key,Ge.props,null,Be.mode,lt),wn(De,Ge),De.return=Be,De)}function qe(Be,De,Ge,lt){return De===null||De.tag!==4||De.stateNode.containerInfo!==Ge.containerInfo||De.stateNode.implementation!==Ge.implementation?(De=Yc(Ge,Be.mode,lt),De.return=Be,De):(De=E(De,Ge.children||[]),De.return=Be,De)}function rt(Be,De,Ge,lt,Vt){return De===null||De.tag!==7?(De=po(Ge,Be.mode,lt,Vt),De.return=Be,De):(De=E(De,Ge),De.return=Be,De)}function ut(Be,De,Ge){if(typeof De=="string"&&De!==""||typeof De=="number"||typeof De=="bigint")return De=Jh(""+De,Be.mode,Ge),De.return=Be,De;if(typeof De=="object"&&De!==null){switch(De.$$typeof){case ee:return Ge=Vu(De.type,De.key,De.props,null,Be.mode,Ge),wn(Ge,De),Ge.return=Be,Ge;case U:return De=Yc(De,Be.mode,Ge),De.return=Be,De;case Qe:var lt=De._init;return De=lt(De._payload),ut(Be,De,Ge)}if(Ht(De)||Rt(De))return De=po(De,Be.mode,Ge,null),De.return=Be,De;if(typeof De.then=="function")return ut(Be,Yr(De),Ge);if(De.$$typeof===Ee)return ut(Be,js(Be,De),Ge);Mo(Be,De)}return null}function He(Be,De,Ge,lt){var Vt=De!==null?De.key:null;if(typeof Ge=="string"&&Ge!==""||typeof Ge=="number"||typeof Ge=="bigint")return Vt!==null?null:te(Be,De,""+Ge,lt);if(typeof Ge=="object"&&Ge!==null){switch(Ge.$$typeof){case ee:return Ge.key===Vt?ve(Be,De,Ge,lt):null;case U:return Ge.key===Vt?qe(Be,De,Ge,lt):null;case Qe:return Vt=Ge._init,Ge=Vt(Ge._payload),He(Be,De,Ge,lt)}if(Ht(Ge)||Rt(Ge))return Vt!==null?null:rt(Be,De,Ge,lt,null);if(typeof Ge.then=="function")return He(Be,De,Yr(Ge),lt);if(Ge.$$typeof===Ee)return He(Be,De,js(Be,Ge),lt);Mo(Be,Ge)}return null}function We(Be,De,Ge,lt,Vt){if(typeof lt=="string"&&lt!==""||typeof lt=="number"||typeof lt=="bigint")return Be=Be.get(Ge)||null,te(De,Be,""+lt,Vt);if(typeof lt=="object"&&lt!==null){switch(lt.$$typeof){case ee:return Be=Be.get(lt.key===null?Ge:lt.key)||null,ve(De,Be,lt,Vt);case U:return Be=Be.get(lt.key===null?Ge:lt.key)||null,qe(De,Be,lt,Vt);case Qe:var Ai=lt._init;return lt=Ai(lt._payload),We(Be,De,Ge,lt,Vt)}if(Ht(lt)||Rt(lt))return Be=Be.get(Ge)||null,rt(De,Be,lt,Vt,null);if(typeof lt.then=="function")return We(Be,De,Ge,Yr(lt),Vt);if(lt.$$typeof===Ee)return We(Be,De,Ge,js(De,lt),Vt);Mo(De,lt)}return null}function li(Be,De,Ge,lt){for(var Vt=null,Ai=null,Bt=De,Jt=De=0,Er=null;Bt!==null&&Jt<Ge.length;Jt++){Bt.index>Jt?(Er=Bt,Bt=null):Er=Bt.sibling;var Xi=He(Be,Bt,Ge[Jt],lt);if(Xi===null){Bt===null&&(Bt=Er);break}i&&Bt&&Xi.alternate===null&&s(Be,Bt),De=I(Xi,De,Jt),Ai===null?Vt=Xi:Ai.sibling=Xi,Ai=Xi,Bt=Er}if(Jt===Ge.length)return u(Be,Bt),Oi&&Bs(Be,Jt),Vt;if(Bt===null){for(;Jt<Ge.length;Jt++)Bt=ut(Be,Ge[Jt],lt),Bt!==null&&(De=I(Bt,De,Jt),Ai===null?Vt=Bt:Ai.sibling=Bt,Ai=Bt);return Oi&&Bs(Be,Jt),Vt}for(Bt=_(Bt);Jt<Ge.length;Jt++)Er=We(Bt,Be,Jt,Ge[Jt],lt),Er!==null&&(i&&Er.alternate!==null&&Bt.delete(Er.key===null?Jt:Er.key),De=I(Er,De,Jt),Ai===null?Vt=Er:Ai.sibling=Er,Ai=Er);return i&&Bt.forEach(function(mc){return s(Be,mc)}),Oi&&Bs(Be,Jt),Vt}function ai(Be,De,Ge,lt){if(Ge==null)throw Error(b(151));for(var Vt=null,Ai=null,Bt=De,Jt=De=0,Er=null,Xi=Ge.next();Bt!==null&&!Xi.done;Jt++,Xi=Ge.next()){Bt.index>Jt?(Er=Bt,Bt=null):Er=Bt.sibling;var mc=He(Be,Bt,Xi.value,lt);if(mc===null){Bt===null&&(Bt=Er);break}i&&Bt&&mc.alternate===null&&s(Be,Bt),De=I(mc,De,Jt),Ai===null?Vt=mc:Ai.sibling=mc,Ai=mc,Bt=Er}if(Xi.done)return u(Be,Bt),Oi&&Bs(Be,Jt),Vt;if(Bt===null){for(;!Xi.done;Jt++,Xi=Ge.next())Xi=ut(Be,Xi.value,lt),Xi!==null&&(De=I(Xi,De,Jt),Ai===null?Vt=Xi:Ai.sibling=Xi,Ai=Xi);return Oi&&Bs(Be,Jt),Vt}for(Bt=_(Bt);!Xi.done;Jt++,Xi=Ge.next())Xi=We(Bt,Be,Jt,Xi.value,lt),Xi!==null&&(i&&Xi.alternate!==null&&Bt.delete(Xi.key===null?Jt:Xi.key),De=I(Xi,De,Jt),Ai===null?Vt=Xi:Ai.sibling=Xi,Ai=Xi);return i&&Bt.forEach(function(L_){return s(Be,L_)}),Oi&&Bs(Be,Jt),Vt}function hn(Be,De,Ge,lt){if(typeof Ge=="object"&&Ge!==null&&Ge.type===le&&Ge.key===null&&(Ge=Ge.props.children),typeof Ge=="object"&&Ge!==null){switch(Ge.$$typeof){case ee:e:{for(var Vt=Ge.key;De!==null;){if(De.key===Vt){if(Vt=Ge.type,Vt===le){if(De.tag===7){u(Be,De.sibling),lt=E(De,Ge.props.children),lt.return=Be,Be=lt;break e}}else if(De.elementType===Vt||typeof Vt=="object"&&Vt!==null&&Vt.$$typeof===Qe&&ml(Vt)===De.type){u(Be,De.sibling),lt=E(De,Ge.props),wn(lt,Ge),lt.return=Be,Be=lt;break e}u(Be,De);break}else s(Be,De);De=De.sibling}Ge.type===le?(lt=po(Ge.props.children,Be.mode,lt,Ge.key),lt.return=Be,Be=lt):(lt=Vu(Ge.type,Ge.key,Ge.props,null,Be.mode,lt),wn(lt,Ge),lt.return=Be,Be=lt)}return q(Be);case U:e:{for(Vt=Ge.key;De!==null;){if(De.key===Vt)if(De.tag===4&&De.stateNode.containerInfo===Ge.containerInfo&&De.stateNode.implementation===Ge.implementation){u(Be,De.sibling),lt=E(De,Ge.children||[]),lt.return=Be,Be=lt;break e}else{u(Be,De);break}else s(Be,De);De=De.sibling}lt=Yc(Ge,Be.mode,lt),lt.return=Be,Be=lt}return q(Be);case Qe:return Vt=Ge._init,Ge=Vt(Ge._payload),hn(Be,De,Ge,lt)}if(Ht(Ge))return li(Be,De,Ge,lt);if(Rt(Ge)){if(Vt=Rt(Ge),typeof Vt!="function")throw Error(b(150));return Ge=Vt.call(Ge),ai(Be,De,Ge,lt)}if(typeof Ge.then=="function")return hn(Be,De,Yr(Ge),lt);if(Ge.$$typeof===Ee)return hn(Be,De,js(Be,Ge),lt);Mo(Be,Ge)}return typeof Ge=="string"&&Ge!==""||typeof Ge=="number"||typeof Ge=="bigint"?(Ge=""+Ge,De!==null&&De.tag===6?(u(Be,De.sibling),lt=E(De,Ge),lt.return=Be,Be=lt):(u(Be,De),lt=Jh(Ge,Be.mode,lt),lt.return=Be,Be=lt),q(Be)):u(Be,De)}return function(Be,De,Ge,lt){try{An=0;var Vt=hn(Be,De,Ge,lt);return _n=null,Vt}catch(Bt){if(Bt===Fs||Bt===Mt)throw Bt;var Ai=da(29,Bt,null,Be.mode);return Ai.lanes=lt,Ai.return=Be,Ai}finally{}}}var Fr=ws(!0),Xs=ws(!1),_a=Ke(null),On=null;function Ys(i){var s=i.alternate;ft(ln,ln.current&1),ft(_a,i),On===null&&(s===null||Br.current!==null||s.memoizedState!==null)&&(On=i)}function Ku(i){if(i.tag===22){if(ft(ln,ln.current),ft(_a,i),On===null){var s=i.alternate;s!==null&&s.memoizedState!==null&&(On=i)}}else es()}function es(){ft(ln,ln.current),ft(_a,_a.current)}function ka(i){wt(_a),On===i&&(On=null),wt(ln)}var ln=Ke(0);function La(i){for(var s=i;s!==null;){if(s.tag===13){var u=s.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||mh(u)))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}function ff(i,s,u,_){s=i.memoizedState,u=u(_,s),u=u==null?s:Z({},s,u),i.memoizedState=u,i.lanes===0&&(i.updateQueue.baseState=u)}var Pp={enqueueSetState:function(i,s,u){i=i._reactInternals;var _=Na(),E=xo(_);E.payload=s,u!=null&&(E.callback=u),s=Us(i,E,_),s!==null&&(rs(s,i,_),cl(s,i,_))},enqueueReplaceState:function(i,s,u){i=i._reactInternals;var _=Na(),E=xo(_);E.tag=1,E.payload=s,u!=null&&(E.callback=u),s=Us(i,E,_),s!==null&&(rs(s,i,_),cl(s,i,_))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var u=Na(),_=xo(u);_.tag=2,s!=null&&(_.callback=s),s=Us(i,_,u),s!==null&&(rs(s,i,u),cl(s,i,u))}};function pf(i,s,u,_,E,I,q){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(_,I,q):s.prototype&&s.prototype.isPureReactComponent?!Vl(u,_)||!Vl(E,I):!0}function Rp(i,s,u,_){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(u,_),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(u,_),s.state!==i&&Pp.enqueueReplaceState(s,s.state,null)}function su(i,s){var u=s;if("ref"in s){u={};for(var _ in s)_!=="ref"&&(u[_]=s[_])}if(i=i.defaultProps){u===s&&(u=Z({},u));for(var E in i)u[E]===void 0&&(u[E]=i[E])}return u}var sd=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function Gm(i){sd(i)}function mf(i){console.error(i)}function Zm(i){sd(i)}function Qu(i,s){try{var u=i.onUncaughtError;u(s.value,{componentStack:s.stack})}catch(_){setTimeout(function(){throw _})}}function zp(i,s,u){try{var _=i.onCaughtError;_(u.value,{componentStack:u.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(E){setTimeout(function(){throw E})}}function gf(i,s,u){return u=xo(u),u.tag=3,u.payload={element:null},u.callback=function(){Qu(i,s)},u}function ou(i){return i=xo(i),i.tag=3,i}function qm(i,s,u,_){var E=u.type.getDerivedStateFromError;if(typeof E=="function"){var I=_.value;i.payload=function(){return E(I)},i.callback=function(){zp(s,u,_)}}var q=u.stateNode;q!==null&&typeof q.componentDidCatch=="function"&&(i.callback=function(){zp(s,u,_),typeof E!="function"&&(xl===null?xl=new Set([this]):xl.add(this));var te=_.stack;this.componentDidCatch(_.value,{componentStack:te!==null?te:""})})}function od(i,s,u,_,E){if(u.flags|=32768,_!==null&&typeof _=="object"&&typeof _.then=="function"){if(s=u.alternate,s!==null&&Hl(s,u,E,!0),u=_a.current,u!==null){switch(u.tag){case 13:return On===null?zf():u.alternate===null&&Hn===0&&(Hn=3),u.flags&=-257,u.flags|=65536,u.lanes=E,_===eu?u.flags|=16384:(s=u.updateQueue,s===null?u.updateQueue=new Set([_]):s.add(_),em(i,_,E)),!1;case 22:return u.flags|=65536,_===eu?u.flags|=16384:(s=u.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([_])},u.updateQueue=s):(u=s.retryQueue,u===null?s.retryQueue=new Set([_]):u.add(_)),em(i,_,E)),!1}throw Error(b(435,u.tag))}return em(i,_,E),zf(),!1}if(Oi)return s=_a.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=E,_!==Kc&&(i=Error(b(422),{cause:_}),Ns(cr(i,u)))):(_!==Kc&&(s=Error(b(423),{cause:_}),Ns(cr(s,u))),i=i.current.alternate,i.flags|=65536,E&=-E,i.lanes|=E,_=cr(_,u),E=gf(i.stateNode,_,E),nu(i,E),Hn!==4&&(Hn=2)),!1;var I=Error(b(520),{cause:_});if(I=cr(I,u),cc===null?cc=[I]:cc.push(I),Hn!==4&&(Hn=2),s===null)return!0;_=cr(_,u),u=s;do{switch(u.tag){case 3:return u.flags|=65536,i=E&-E,u.lanes|=i,i=gf(u.stateNode,_,i),nu(u,i),!1;case 1:if(s=u.type,I=u.stateNode,(u.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(xl===null||!xl.has(I))))return u.flags|=65536,E&=-E,u.lanes|=E,E=ou(E),qm(E,i,u,_),nu(u,E),!1}u=u.return}while(u!==null);return!1}var ld=Error(b(461)),sr=!1;function Ur(i,s,u,_){s.child=i===null?Xs(s,null,u,_):Fr(s,i.child,u,_)}function Ip(i,s,u,_,E){u=u.render;var I=s.ref;if("ref"in _){var q={};for(var te in _)te!=="ref"&&(q[te]=_[te])}else q=_;return yo(s),_=ad(i,s,u,q,I,E),te=ic(),i!==null&&!sr?(bo(i,s,E),Ws(i,s,E)):(Oi&&te&&Wc(s),s.flags|=1,Ur(i,s,_,E),s.child)}function $m(i,s,u,_,E){if(i===null){var I=u.type;return typeof I=="function"&&!Uu(I)&&I.defaultProps===void 0&&u.compare===null?(s.tag=15,s.type=I,Hm(i,s,I,_,E)):(i=Vu(u.type,null,_,s,s.mode,E),i.ref=s.ref,i.return=s,s.child=i)}if(I=i.child,!wf(i,E)){var q=I.memoizedProps;if(u=u.compare,u=u!==null?u:Vl,u(q,_)&&i.ref===s.ref)return Ws(i,s,E)}return s.flags|=1,i=Ir(I,_),i.ref=s.ref,i.return=s,s.child=i}function Hm(i,s,u,_,E){if(i!==null){var I=i.memoizedProps;if(Vl(I,_)&&i.ref===s.ref)if(sr=!1,s.pendingProps=_=I,wf(i,E))(i.flags&131072)!==0&&(sr=!0);else return s.lanes=i.lanes,Ws(i,s,E)}return Lp(i,s,u,_,E)}function Dp(i,s,u){var _=s.pendingProps,E=_.children,I=i!==null?i.memoizedState:null;if(_.mode==="hidden"){if((s.flags&128)!==0){if(_=I!==null?I.baseLanes|u:u,i!==null){for(E=s.child=i.child,I=0;E!==null;)I=I|E.lanes|E.childLanes,E=E.sibling;s.childLanes=I&~_}else s.childLanes=0,s.child=null;return kp(i,s,_,u)}if((u&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},i!==null&&Xu(s,I!==null?I.cachePool:null),I!==null?hl(s,I):ru(),Ku(s);else return s.lanes=s.childLanes=536870912,kp(i,s,I!==null?I.baseLanes|u:u,u)}else I!==null?(Xu(s,I.cachePool),hl(s,I),es(),s.memoizedState=null):(i!==null&&Xu(s,null),ru(),es());return Ur(i,s,E,u),s.child}function kp(i,s,u,_){var E=td();return E=E===null?null:{parent:Qn._currentValue,pool:E},s.memoizedState={baseLanes:u,cachePool:E},i!==null&&Xu(s,null),ru(),Ku(s),i!==null&&Hl(i,s,_,!0),null}function cd(i,s){var u=s.ref;if(u===null)i!==null&&i.ref!==null&&(s.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(b(284));(i===null||i.ref!==u)&&(s.flags|=4194816)}}function Lp(i,s,u,_,E){return yo(s),u=ad(i,s,u,_,void 0,E),_=ic(),i!==null&&!sr?(bo(i,s,E),Ws(i,s,E)):(Oi&&_&&Wc(s),s.flags|=1,Ur(i,s,u,E),s.child)}function _f(i,s,u,_,E,I){return yo(s),s.updateQueue=null,u=Zi(s,_,u,E),tc(i),_=ic(),i!==null&&!sr?(bo(i,s,I),Ws(i,s,I)):(Oi&&_&&Wc(s),s.flags|=1,Ur(i,s,u,I),s.child)}function Op(i,s,u,_,E){if(yo(s),s.stateNode===null){var I=fi,q=u.contextType;typeof q=="object"&&q!==null&&(I=on(q)),I=new u(_,I),s.memoizedState=I.state!==null&&I.state!==void 0?I.state:null,I.updater=Pp,s.stateNode=I,I._reactInternals=s,I=s.stateNode,I.props=_,I.state=s.memoizedState,I.refs={},id(s),q=u.contextType,I.context=typeof q=="object"&&q!==null?on(q):fi,I.state=s.memoizedState,q=u.getDerivedStateFromProps,typeof q=="function"&&(ff(s,u,q,_),I.state=s.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof I.getSnapshotBeforeUpdate=="function"||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(q=I.state,typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount(),q!==I.state&&Pp.enqueueReplaceState(I,I.state,null),ul(s,_,I,E),ec(),I.state=s.memoizedState),typeof I.componentDidMount=="function"&&(s.flags|=4194308),_=!0}else if(i===null){I=s.stateNode;var te=s.memoizedProps,ve=su(u,te);I.props=ve;var qe=I.context,rt=u.contextType;q=fi,typeof rt=="object"&&rt!==null&&(q=on(rt));var ut=u.getDerivedStateFromProps;rt=typeof ut=="function"||typeof I.getSnapshotBeforeUpdate=="function",te=s.pendingProps!==te,rt||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(te||qe!==q)&&Rp(s,I,_,q),Ka=!1;var He=s.memoizedState;I.state=He,ul(s,_,I,E),ec(),qe=s.memoizedState,te||He!==qe||Ka?(typeof ut=="function"&&(ff(s,u,ut,_),qe=s.memoizedState),(ve=Ka||pf(s,u,ve,_,He,qe,q))?(rt||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount()),typeof I.componentDidMount=="function"&&(s.flags|=4194308)):(typeof I.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=_,s.memoizedState=qe),I.props=_,I.state=qe,I.context=q,_=ve):(typeof I.componentDidMount=="function"&&(s.flags|=4194308),_=!1)}else{I=s.stateNode,Jl(i,s),q=s.memoizedProps,rt=su(u,q),I.props=rt,ut=s.pendingProps,He=I.context,qe=u.contextType,ve=fi,typeof qe=="object"&&qe!==null&&(ve=on(qe)),te=u.getDerivedStateFromProps,(qe=typeof te=="function"||typeof I.getSnapshotBeforeUpdate=="function")||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(q!==ut||He!==ve)&&Rp(s,I,_,ve),Ka=!1,He=s.memoizedState,I.state=He,ul(s,_,I,E),ec();var We=s.memoizedState;q!==ut||He!==We||Ka||i!==null&&i.dependencies!==null&&Jc(i.dependencies)?(typeof te=="function"&&(ff(s,u,te,_),We=s.memoizedState),(rt=Ka||pf(s,u,rt,_,He,We,ve)||i!==null&&i.dependencies!==null&&Jc(i.dependencies))?(qe||typeof I.UNSAFE_componentWillUpdate!="function"&&typeof I.componentWillUpdate!="function"||(typeof I.componentWillUpdate=="function"&&I.componentWillUpdate(_,We,ve),typeof I.UNSAFE_componentWillUpdate=="function"&&I.UNSAFE_componentWillUpdate(_,We,ve)),typeof I.componentDidUpdate=="function"&&(s.flags|=4),typeof I.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof I.componentDidUpdate!="function"||q===i.memoizedProps&&He===i.memoizedState||(s.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||q===i.memoizedProps&&He===i.memoizedState||(s.flags|=1024),s.memoizedProps=_,s.memoizedState=We),I.props=_,I.state=We,I.context=ve,_=rt):(typeof I.componentDidUpdate!="function"||q===i.memoizedProps&&He===i.memoizedState||(s.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||q===i.memoizedProps&&He===i.memoizedState||(s.flags|=1024),_=!1)}return I=_,cd(i,s),_=(s.flags&128)!==0,I||_?(I=s.stateNode,u=_&&typeof u.getDerivedStateFromError!="function"?null:I.render(),s.flags|=1,i!==null&&_?(s.child=Fr(s,i.child,null,E),s.child=Fr(s,null,u,E)):Ur(i,s,u,E),s.memoizedState=I.state,i=s.child):i=Ws(i,s,E),i}function yf(i,s,u,_){return kr(),s.flags|=256,Ur(i,s,u,_),s.child}var lu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Wr(i){return{baseLanes:i,cachePool:Kl()}}function vf(i,s,u){return i=i!==null?i.childLanes&~u:0,s&&(i|=ns),i}function xf(i,s,u){var _=s.pendingProps,E=!1,I=(s.flags&128)!==0,q;if((q=I)||(q=i!==null&&i.memoizedState===null?!1:(ln.current&2)!==0),q&&(E=!0,s.flags&=-129),q=(s.flags&32)!==0,s.flags&=-33,i===null){if(Oi){if(E?Ys(s):es(),Oi){var te=vn,ve;if(ve=te){e:{for(ve=te,te=ma;ve.nodeType!==8;){if(!te){te=null;break e}if(ve=Qs(ve.nextSibling),ve===null){te=null;break e}}te=ve}te!==null?(s.memoizedState={dehydrated:te,treeContext:Ha!==null?{id:pa,overflow:Ma}:null,retryLane:536870912,hydrationErrors:null},ve=da(18,null,null,0),ve.stateNode=te,ve.return=s,s.child=ve,$n=s,vn=null,ve=!0):ve=!1}ve||sl(s)}if(te=s.memoizedState,te!==null&&(te=te.dehydrated,te!==null))return mh(te)?s.lanes=32:s.lanes=536870912,null;ka(s)}return te=_.children,_=_.fallback,E?(es(),E=s.mode,te=ud({mode:"hidden",children:te},E),_=po(_,E,u,null),te.return=s,_.return=s,te.sibling=_,s.child=te,E=s.child,E.memoizedState=Wr(u),E.childLanes=vf(i,q,u),s.memoizedState=lu,_):(Ys(s),Bp(s,te))}if(ve=i.memoizedState,ve!==null&&(te=ve.dehydrated,te!==null)){if(I)s.flags&256?(Ys(s),s.flags&=-257,s=Np(i,s,u)):s.memoizedState!==null?(es(),s.child=i.child,s.flags|=128,s=null):(es(),E=_.fallback,te=s.mode,_=ud({mode:"visible",children:_.children},te),E=po(E,te,u,null),E.flags|=2,_.return=s,E.return=s,_.sibling=E,s.child=_,Fr(s,i.child,null,u),_=s.child,_.memoizedState=Wr(u),_.childLanes=vf(i,q,u),s.memoizedState=lu,s=E);else if(Ys(s),mh(te)){if(q=te.nextSibling&&te.nextSibling.dataset,q)var qe=q.dgst;q=qe,_=Error(b(419)),_.stack="",_.digest=q,Ns({value:_,source:null,stack:null}),s=Np(i,s,u)}else if(sr||Hl(i,s,u,!1),q=(u&i.childLanes)!==0,sr||q){if(q=Tn,q!==null&&(_=u&-u,_=(_&42)!==0?1:si(_),_=(_&(q.suspendedLanes|u))!==0?0:_,_!==0&&_!==ve.retryLane))throw ve.retryLane=_,ha(i,_),rs(q,i,_),ld;te.data==="$?"||zf(),s=Np(i,s,u)}else te.data==="$?"?(s.flags|=192,s.child=i.child,s=null):(i=ve.treeContext,vn=Qs(te.nextSibling),$n=s,Oi=!0,_o=null,ma=!1,i!==null&&(fa[Dr++]=pa,fa[Dr++]=Ma,fa[Dr++]=Ha,pa=i.id,Ma=i.overflow,Ha=s),s=Bp(s,_.children),s.flags|=4096);return s}return E?(es(),E=_.fallback,te=s.mode,ve=i.child,qe=ve.sibling,_=Ir(ve,{mode:"hidden",children:_.children}),_.subtreeFlags=ve.subtreeFlags&65011712,qe!==null?E=Ir(qe,E):(E=po(E,te,u,null),E.flags|=2),E.return=s,_.return=s,_.sibling=E,s.child=_,_=E,E=s.child,te=i.child.memoizedState,te===null?te=Wr(u):(ve=te.cachePool,ve!==null?(qe=Qn._currentValue,ve=ve.parent!==qe?{parent:qe,pool:qe}:ve):ve=Kl(),te={baseLanes:te.baseLanes|u,cachePool:ve}),E.memoizedState=te,E.childLanes=vf(i,q,u),s.memoizedState=lu,_):(Ys(s),u=i.child,i=u.sibling,u=Ir(u,{mode:"visible",children:_.children}),u.return=s,u.sibling=null,i!==null&&(q=s.deletions,q===null?(s.deletions=[i],s.flags|=16):q.push(i)),s.child=u,s.memoizedState=null,u)}function Bp(i,s){return s=ud({mode:"visible",children:s},i.mode),s.return=i,i.child=s}function ud(i,s){return i=da(22,i,null,s),i.lanes=0,i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},i}function Np(i,s,u){return Fr(s,i.child,null,u),i=Bp(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function Xm(i,s,u){i.lanes|=s;var _=i.alternate;_!==null&&(_.lanes|=s),qu(i.return,s,u)}function bf(i,s,u,_,E){var I=i.memoizedState;I===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:_,tail:u,tailMode:E}:(I.isBackwards=s,I.rendering=null,I.renderingStartTime=0,I.last=_,I.tail=u,I.tailMode=E)}function Ym(i,s,u){var _=s.pendingProps,E=_.revealOrder,I=_.tail;if(Ur(i,s,_.children,u),_=ln.current,(_&2)!==0)_=_&1|2,s.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Xm(i,u,s);else if(i.tag===19)Xm(i,u,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}_&=1}switch(ft(ln,_),E){case"forwards":for(u=s.child,E=null;u!==null;)i=u.alternate,i!==null&&La(i)===null&&(E=u),u=u.sibling;u=E,u===null?(E=s.child,s.child=null):(E=u.sibling,u.sibling=null),bf(s,!1,E,u,I);break;case"backwards":for(u=null,E=s.child,s.child=null;E!==null;){if(i=E.alternate,i!==null&&La(i)===null){s.child=E;break}i=E.sibling,E.sibling=u,u=E,E=i}bf(s,!0,u,null,I);break;case"together":bf(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function Ws(i,s,u){if(i!==null&&(s.dependencies=i.dependencies),zo|=s.lanes,(u&s.childLanes)===0)if(i!==null){if(Hl(i,s,u,!1),(u&s.childLanes)===0)return null}else return null;if(i!==null&&s.child!==i.child)throw Error(b(153));if(s.child!==null){for(i=s.child,u=Ir(i,i.pendingProps),s.child=u,u.return=s;i.sibling!==null;)i=i.sibling,u=u.sibling=Ir(i,i.pendingProps),u.return=s;u.sibling=null}return s.child}function wf(i,s){return(i.lanes&s)!==0?!0:(i=i.dependencies,!!(i!==null&&Jc(i)))}function Wm(i,s,u){switch(s.tag){case 3:Nt(s,s.stateNode.containerInfo),Lr(s,Qn,i.memoizedState.cache),kr();break;case 27:case 5:wi(s);break;case 4:Nt(s,s.stateNode.containerInfo);break;case 10:Lr(s,s.type,s.memoizedProps.value);break;case 13:var _=s.memoizedState;if(_!==null)return _.dehydrated!==null?(Ys(s),s.flags|=128,null):(u&s.child.childLanes)!==0?xf(i,s,u):(Ys(s),i=Ws(i,s,u),i!==null?i.sibling:null);Ys(s);break;case 19:var E=(i.flags&128)!==0;if(_=(u&s.childLanes)!==0,_||(Hl(i,s,u,!1),_=(u&s.childLanes)!==0),E){if(_)return Ym(i,s,u);s.flags|=128}if(E=s.memoizedState,E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),ft(ln,ln.current),_)break;return null;case 22:case 23:return s.lanes=0,Dp(i,s,u);case 24:Lr(s,Qn,i.memoizedState.cache)}return Ws(i,s,u)}function Km(i,s,u){if(i!==null)if(i.memoizedProps!==s.pendingProps)sr=!0;else{if(!wf(i,u)&&(s.flags&128)===0)return sr=!1,Wm(i,s,u);sr=(i.flags&131072)!==0}else sr=!1,Oi&&(s.flags&1048576)!==0&&go(s,ql,s.index);switch(s.lanes=0,s.tag){case 16:e:{i=s.pendingProps;var _=s.elementType,E=_._init;if(_=E(_._payload),s.type=_,typeof _=="function")Uu(_)?(i=su(_,i),s.tag=1,s=Op(null,s,_,i,u)):(s.tag=0,s=Lp(null,s,_,i,u));else{if(_!=null){if(E=_.$$typeof,E===ke){s.tag=11,s=Ip(null,s,_,i,u);break e}else if(E===tt){s.tag=14,s=$m(null,s,_,i,u);break e}}throw s=Gt(_)||_,Error(b(306,s,""))}}return s;case 0:return Lp(i,s,s.type,s.pendingProps,u);case 1:return _=s.type,E=su(_,s.pendingProps),Op(i,s,_,E,u);case 3:e:{if(Nt(s,s.stateNode.containerInfo),i===null)throw Error(b(387));_=s.pendingProps;var I=s.memoizedState;E=I.element,Jl(i,s),ul(s,_,null,u);var q=s.memoizedState;if(_=q.cache,Lr(s,Qn,_),_!==I.cache&&$u(s,[Qn],u,!0),ec(),_=q.element,I.isDehydrated)if(I={element:_,isDehydrated:!1,cache:q.cache},s.updateQueue.baseState=I,s.memoizedState=I,s.flags&256){s=yf(i,s,_,u);break e}else if(_!==E){E=cr(Error(b(424)),s),Ns(E),s=yf(i,s,_,u);break e}else{switch(i=s.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(vn=Qs(i.firstChild),$n=s,Oi=!0,_o=null,ma=!0,u=Xs(s,null,_,u),s.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(kr(),_===E){s=Ws(i,s,u);break e}Ur(i,s,_,u)}s=s.child}return s;case 26:return cd(i,s),i===null?(u=zd(s.type,null,s.pendingProps,null))?s.memoizedState=u:Oi||(u=s.type,i=s.pendingProps,_=Ad(kt.current).createElement(u),_[Wt]=s,_[ti]=i,Xn(_,u,i),pn(_),s.stateNode=_):s.memoizedState=zd(s.type,i.memoizedProps,s.pendingProps,i.memoizedState),null;case 27:return wi(s),i===null&&Oi&&(_=s.stateNode=wr(s.type,s.pendingProps,kt.current),$n=s,ma=!0,E=vn,wl(s.type)?(um=E,vn=Qs(_.firstChild)):vn=E),Ur(i,s,s.pendingProps.children,u),cd(i,s),i===null&&(s.flags|=4194304),s.child;case 5:return i===null&&Oi&&((E=_=vn)&&(_=Gf(_,s.type,s.pendingProps,ma),_!==null?(s.stateNode=_,$n=s,vn=Qs(_.firstChild),ma=!1,E=!0):E=!1),E||sl(s)),wi(s),E=s.type,I=s.pendingProps,q=i!==null?i.memoizedProps:null,_=I.children,ko(E,I)?_=null:q!==null&&ko(E,q)&&(s.flags|=32),s.memoizedState!==null&&(E=ad(i,s,kn,null,null,u),Ae._currentValue=E),cd(i,s),Ur(i,s,_,u),s.child;case 6:return i===null&&Oi&&((i=u=vn)&&(u=Zf(u,s.pendingProps,ma),u!==null?(s.stateNode=u,$n=s,vn=null,i=!0):i=!1),i||sl(s)),null;case 13:return xf(i,s,u);case 4:return Nt(s,s.stateNode.containerInfo),_=s.pendingProps,i===null?s.child=Fr(s,null,_,u):Ur(i,s,_,u),s.child;case 11:return Ip(i,s,s.type,s.pendingProps,u);case 7:return Ur(i,s,s.pendingProps,u),s.child;case 8:return Ur(i,s,s.pendingProps.children,u),s.child;case 12:return Ur(i,s,s.pendingProps.children,u),s.child;case 10:return _=s.pendingProps,Lr(s,s.type,_.value),Ur(i,s,_.children,u),s.child;case 9:return E=s.type._context,_=s.pendingProps.children,yo(s),E=on(E),_=_(E),s.flags|=1,Ur(i,s,_,u),s.child;case 14:return $m(i,s,s.type,s.pendingProps,u);case 15:return Hm(i,s,s.type,s.pendingProps,u);case 19:return Ym(i,s,u);case 31:return _=s.pendingProps,u=s.mode,_={mode:_.mode,children:_.children},i===null?(u=ud(_,u),u.ref=s.ref,s.child=u,u.return=s,s=u):(u=Ir(i.child,_),u.ref=s.ref,s.child=u,u.return=s,s=u),s;case 22:return Dp(i,s,u);case 24:return yo(s),_=on(Qn),i===null?(E=td(),E===null&&(E=Tn,I=vo(),E.pooledCache=I,I.refCount++,I!==null&&(E.pooledCacheLanes|=u),E=I),s.memoizedState={parent:_,cache:E},id(s),Lr(s,Qn,E)):((i.lanes&u)!==0&&(Jl(i,s),ul(s,null,null,u),ec()),E=i.memoizedState,I=s.memoizedState,E.parent!==_?(E={parent:_,cache:_},s.memoizedState=E,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=E),Lr(s,Qn,_)):(_=I.cache,Lr(s,Qn,_),_!==E.cache&&$u(s,[Qn],u,!0))),Ur(i,s,s.pendingProps.children,u),s.child;case 29:throw s.pendingProps}throw Error(b(156,s.tag))}function gl(i){i.flags|=4}function Qm(i,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!z(s)){if(s=_a.current,s!==null&&((Mi&4194048)===Mi?On!==null:(Mi&62914560)!==Mi&&(Mi&536870912)===0||s!==On))throw Wa=eu,Ra;i.flags|=8192}}function Ju(i,s){s!==null&&(i.flags|=4),i.flags&16384&&(s=i.tag!==22?nt():536870912,i.lanes|=s,hh|=s)}function cu(i,s){if(!Oi)switch(i.tailMode){case"hidden":s=i.tail;for(var u=null;s!==null;)s.alternate!==null&&(u=s),s=s.sibling;u===null?i.tail=null:u.sibling=null;break;case"collapsed":u=i.tail;for(var _=null;u!==null;)u.alternate!==null&&(_=u),u=u.sibling;_===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:_.sibling=null}}function Bn(i){var s=i.alternate!==null&&i.alternate.child===i.child,u=0,_=0;if(s)for(var E=i.child;E!==null;)u|=E.lanes|E.childLanes,_|=E.subtreeFlags&65011712,_|=E.flags&65011712,E.return=i,E=E.sibling;else for(E=i.child;E!==null;)u|=E.lanes|E.childLanes,_|=E.subtreeFlags,_|=E.flags,E.return=i,E=E.sibling;return i.subtreeFlags|=_,i.childLanes=u,s}function uu(i,s,u){var _=s.pendingProps;switch($l(s),s.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bn(s),null;case 1:return Bn(s),null;case 3:return u=s.stateNode,_=null,i!==null&&(_=i.memoizedState.cache),s.memoizedState.cache!==_&&(s.flags|=2048),Xa(Qn),bi(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(i===null||i.child===null)&&(na(s)?gl(s):i===null||i.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Qc())),Bn(s),null;case 26:return u=s.memoizedState,i===null?(gl(s),u!==null?(Bn(s),Qm(s,u)):(Bn(s),s.flags&=-16777217)):u?u!==i.memoizedState?(gl(s),Bn(s),Qm(s,u)):(Bn(s),s.flags&=-16777217):(i.memoizedProps!==_&&gl(s),Bn(s),s.flags&=-16777217),null;case 27:gi(s),u=kt.current;var E=s.type;if(i!==null&&s.stateNode!=null)i.memoizedProps!==_&&gl(s);else{if(!_){if(s.stateNode===null)throw Error(b(166));return Bn(s),null}i=Et.current,na(s)?Gu(s):(i=wr(E,_,u),s.stateNode=i,gl(s))}return Bn(s),null;case 5:if(gi(s),u=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==_&&gl(s);else{if(!_){if(s.stateNode===null)throw Error(b(166));return Bn(s),null}if(i=Et.current,na(s))Gu(s);else{switch(E=Ad(kt.current),i){case 1:i=E.createElementNS("http://www.w3.org/2000/svg",u);break;case 2:i=E.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;default:switch(u){case"svg":i=E.createElementNS("http://www.w3.org/2000/svg",u);break;case"math":i=E.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;case"script":i=E.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof _.is=="string"?E.createElement("select",{is:_.is}):E.createElement("select"),_.multiple?i.multiple=!0:_.size&&(i.size=_.size);break;default:i=typeof _.is=="string"?E.createElement(u,{is:_.is}):E.createElement(u)}}i[Wt]=s,i[ti]=_;e:for(E=s.child;E!==null;){if(E.tag===5||E.tag===6)i.appendChild(E.stateNode);else if(E.tag!==4&&E.tag!==27&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===s)break e;for(;E.sibling===null;){if(E.return===null||E.return===s)break e;E=E.return}E.sibling.return=E.return,E=E.sibling}s.stateNode=i;e:switch(Xn(i,u,_),u){case"button":case"input":case"select":case"textarea":i=!!_.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&gl(s)}}return Bn(s),s.flags&=-16777217,null;case 6:if(i&&s.stateNode!=null)i.memoizedProps!==_&&gl(s);else{if(typeof _!="string"&&s.stateNode===null)throw Error(b(166));if(i=kt.current,na(s)){if(i=s.stateNode,u=s.memoizedProps,_=null,E=$n,E!==null)switch(E.tag){case 27:case 5:_=E.memoizedProps}i[Wt]=s,i=!!(i.nodeValue===u||_!==null&&_.suppressHydrationWarning===!0||om(i.nodeValue,u)),i||sl(s)}else i=Ad(i).createTextNode(_),i[Wt]=s,s.stateNode=i}return Bn(s),null;case 13:if(_=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(E=na(s),_!==null&&_.dehydrated!==null){if(i===null){if(!E)throw Error(b(318));if(E=s.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(b(317));E[Wt]=s}else kr(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Bn(s),E=!1}else E=Qc(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=E),E=!0;if(!E)return s.flags&256?(ka(s),s):(ka(s),null)}if(ka(s),(s.flags&128)!==0)return s.lanes=u,s;if(u=_!==null,i=i!==null&&i.memoizedState!==null,u){_=s.child,E=null,_.alternate!==null&&_.alternate.memoizedState!==null&&_.alternate.memoizedState.cachePool!==null&&(E=_.alternate.memoizedState.cachePool.pool);var I=null;_.memoizedState!==null&&_.memoizedState.cachePool!==null&&(I=_.memoizedState.cachePool.pool),I!==E&&(_.flags|=2048)}return u!==i&&u&&(s.child.flags|=8192),Ju(s,s.updateQueue),Bn(s),null;case 4:return bi(),i===null&&Of(s.stateNode.containerInfo),Bn(s),null;case 10:return Xa(s.type),Bn(s),null;case 19:if(wt(ln),E=s.memoizedState,E===null)return Bn(s),null;if(_=(s.flags&128)!==0,I=E.rendering,I===null)if(_)cu(E,!1);else{if(Hn!==0||i!==null&&(i.flags&128)!==0)for(i=s.child;i!==null;){if(I=La(i),I!==null){for(s.flags|=128,cu(E,!1),i=I.updateQueue,s.updateQueue=i,Ju(s,i),s.subtreeFlags=0,i=u,u=s.child;u!==null;)Qh(u,i),u=u.sibling;return ft(ln,ln.current&1|2),s.child}i=i.sibling}E.tail!==null&&zn()>Mf&&(s.flags|=128,_=!0,cu(E,!1),s.lanes=4194304)}else{if(!_)if(i=La(I),i!==null){if(s.flags|=128,_=!0,i=i.updateQueue,s.updateQueue=i,Ju(s,i),cu(E,!0),E.tail===null&&E.tailMode==="hidden"&&!I.alternate&&!Oi)return Bn(s),null}else 2*zn()-E.renderingStartTime>Mf&&u!==536870912&&(s.flags|=128,_=!0,cu(E,!1),s.lanes=4194304);E.isBackwards?(I.sibling=s.child,s.child=I):(i=E.last,i!==null?i.sibling=I:s.child=I,E.last=I)}return E.tail!==null?(s=E.tail,E.rendering=s,E.tail=s.sibling,E.renderingStartTime=zn(),s.sibling=null,i=ln.current,ft(ln,_?i&1|2:i&1),s):(Bn(s),null);case 22:case 23:return ka(s),Wu(),_=s.memoizedState!==null,i!==null?i.memoizedState!==null!==_&&(s.flags|=8192):_&&(s.flags|=8192),_?(u&536870912)!==0&&(s.flags&128)===0&&(Bn(s),s.subtreeFlags&6&&(s.flags|=8192)):Bn(s),u=s.updateQueue,u!==null&&Ju(s,u.retryQueue),u=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),_=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(_=s.memoizedState.cachePool.pool),_!==u&&(s.flags|=2048),i!==null&&wt(Ya),null;case 24:return u=null,i!==null&&(u=i.memoizedState.cache),s.memoizedState.cache!==u&&(s.flags|=2048),Xa(Qn),Bn(s),null;case 25:return null;case 30:return null}throw Error(b(156,s.tag))}function hd(i,s){switch($l(s),s.tag){case 1:return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return Xa(Qn),bi(),i=s.flags,(i&65536)!==0&&(i&128)===0?(s.flags=i&-65537|128,s):null;case 26:case 27:case 5:return gi(s),null;case 13:if(ka(s),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(b(340));kr()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return wt(ln),null;case 4:return bi(),null;case 10:return Xa(s.type),null;case 22:case 23:return ka(s),Wu(),i!==null&&wt(Ya),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 24:return Xa(Qn),null;case 25:return null;default:return null}}function Jm(i,s){switch($l(s),s.tag){case 3:Xa(Qn),bi();break;case 26:case 27:case 5:gi(s);break;case 4:bi();break;case 13:ka(s);break;case 19:wt(ln);break;case 10:Xa(s.type);break;case 22:case 23:ka(s),Wu(),i!==null&&wt(Ya);break;case 24:Xa(Qn)}}function dd(i,s){try{var u=s.updateQueue,_=u!==null?u.lastEffect:null;if(_!==null){var E=_.next;u=E;do{if((u.tag&i)===i){_=void 0;var I=u.create,q=u.inst;_=I(),q.destroy=_}u=u.next}while(u!==E)}}catch(te){cn(s,s.return,te)}}function ac(i,s,u){try{var _=s.updateQueue,E=_!==null?_.lastEffect:null;if(E!==null){var I=E.next;_=I;do{if((_.tag&i)===i){var q=_.inst,te=q.destroy;if(te!==void 0){q.destroy=void 0,E=s;var ve=u,qe=te;try{qe()}catch(rt){cn(E,ve,rt)}}}_=_.next}while(_!==I)}}catch(rt){cn(s,s.return,rt)}}function eg(i){var s=i.updateQueue;if(s!==null){var u=i.stateNode;try{rd(s,u)}catch(_){cn(i,i.return,_)}}}function tg(i,s,u){u.props=su(i.type,i.memoizedProps),u.state=i.memoizedState;try{u.componentWillUnmount()}catch(_){cn(i,s,_)}}function fd(i,s){try{var u=i.ref;if(u!==null){switch(i.tag){case 26:case 27:case 5:var _=i.stateNode;break;case 30:_=i.stateNode;break;default:_=i.stateNode}typeof u=="function"?i.refCleanup=u(_):u.current=_}}catch(E){cn(i,s,E)}}function Ao(i,s){var u=i.ref,_=i.refCleanup;if(u!==null)if(typeof _=="function")try{_()}catch(E){cn(i,s,E)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(E){cn(i,s,E)}else u.current=null}function Sf(i){var s=i.type,u=i.memoizedProps,_=i.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":u.autoFocus&&_.focus();break e;case"img":u.src?_.src=u.src:u.srcSet&&(_.srcset=u.srcSet)}}catch(E){cn(i,i.return,E)}}function jp(i,s,u){try{var _=i.stateNode;Cg(_,i.type,u,s),_[ti]=s}catch(E){cn(i,i.return,E)}}function Fp(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&wl(i.type)||i.tag===4}function hu(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Fp(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&wl(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Up(i,s,u){var _=i.tag;if(_===5||_===6)i=i.stateNode,s?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(i,s):(s=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,s.appendChild(i),u=u._reactRootContainer,u!=null||s.onclick!==null||(s.onclick=aa));else if(_!==4&&(_===27&&wl(i.type)&&(u=i.stateNode,s=null),i=i.child,i!==null))for(Up(i,s,u),i=i.sibling;i!==null;)Up(i,s,u),i=i.sibling}function Sn(i,s,u){var _=i.tag;if(_===5||_===6)i=i.stateNode,s?u.insertBefore(i,s):u.appendChild(i);else if(_!==4&&(_===27&&wl(i.type)&&(u=i.stateNode),i=i.child,i!==null))for(Sn(i,s,u),i=i.sibling;i!==null;)Sn(i,s,u),i=i.sibling}function du(i){var s=i.stateNode,u=i.memoizedProps;try{for(var _=i.type,E=s.attributes;E.length;)s.removeAttributeNode(E[0]);Xn(s,_,u),s[Wt]=i,s[ti]=u}catch(I){cn(i,i.return,I)}}var Po=!1,Nn=!1,eh=!1,th=typeof WeakSet=="function"?WeakSet:Set,br=null;function ig(i,s){if(i=i.containerInfo,jf=yt,i=Bu(i),Vc(i)){if("selectionStart"in i)var u={start:i.selectionStart,end:i.selectionEnd};else e:{u=(u=i.ownerDocument)&&u.defaultView||window;var _=u.getSelection&&u.getSelection();if(_&&_.rangeCount!==0){u=_.anchorNode;var E=_.anchorOffset,I=_.focusNode;_=_.focusOffset;try{u.nodeType,I.nodeType}catch{u=null;break e}var q=0,te=-1,ve=-1,qe=0,rt=0,ut=i,He=null;t:for(;;){for(var We;ut!==u||E!==0&&ut.nodeType!==3||(te=q+E),ut!==I||_!==0&&ut.nodeType!==3||(ve=q+_),ut.nodeType===3&&(q+=ut.nodeValue.length),(We=ut.firstChild)!==null;)He=ut,ut=We;for(;;){if(ut===i)break t;if(He===u&&++qe===E&&(te=q),He===I&&++rt===_&&(ve=q),(We=ut.nextSibling)!==null)break;ut=He,He=ut.parentNode}ut=We}u=te===-1||ve===-1?null:{start:te,end:ve}}else u=null}u=u||{start:0,end:0}}else u=null;for(Ff={focusedElem:i,selectionRange:u},yt=!1,br=s;br!==null;)if(s=br,i=s.child,(s.subtreeFlags&1024)!==0&&i!==null)i.return=s,br=i;else for(;br!==null;){switch(s=br,I=s.alternate,i=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((i&1024)!==0&&I!==null){i=void 0,u=s,E=I.memoizedProps,I=I.memoizedState,_=u.stateNode;try{var li=su(u.type,E,u.elementType===u.type);i=_.getSnapshotBeforeUpdate(li,I),_.__reactInternalSnapshotBeforeUpdate=i}catch(ai){cn(u,u.return,ai)}}break;case 3:if((i&1024)!==0){if(i=s.stateNode.containerInfo,u=i.nodeType,u===9)Vf(i);else if(u===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Vf(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(b(163))}if(i=s.sibling,i!==null){i.return=s.return,br=i;break}br=s.return}}function ih(i,s,u){var _=u.flags;switch(u.tag){case 0:case 11:case 15:yl(i,u),_&4&&dd(5,u);break;case 1:if(yl(i,u),_&4)if(i=u.stateNode,s===null)try{i.componentDidMount()}catch(q){cn(u,u.return,q)}else{var E=su(u.type,s.memoizedProps);s=s.memoizedState;try{i.componentDidUpdate(E,s,i.__reactInternalSnapshotBeforeUpdate)}catch(q){cn(u,u.return,q)}}_&64&&eg(u),_&512&&fd(u,u.return);break;case 3:if(yl(i,u),_&64&&(i=u.updateQueue,i!==null)){if(s=null,u.child!==null)switch(u.child.tag){case 27:case 5:s=u.child.stateNode;break;case 1:s=u.child.stateNode}try{rd(i,s)}catch(q){cn(u,u.return,q)}}break;case 27:s===null&&_&4&&du(u);case 26:case 5:yl(i,u),s===null&&_&4&&Sf(u),_&512&&fd(u,u.return);break;case 12:yl(i,u);break;case 13:yl(i,u),_&4&&ng(i,u),_&64&&(i=u.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(u=A_.bind(null,u),k_(i,u))));break;case 22:if(_=u.memoizedState!==null||Po,!_){s=s!==null&&s.memoizedState!==null||Nn,E=Po;var I=Nn;Po=_,(Nn=s)&&!I?sc(i,u,(u.subtreeFlags&8772)!==0):yl(i,u),Po=E,Nn=I}break;case 30:break;default:yl(i,u)}}function Tf(i){var s=i.alternate;s!==null&&(i.alternate=null,Tf(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&Tt(s)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var an=null,Kr=!1;function Oa(i,s,u){for(u=u.child;u!==null;)nh(i,s,u),u=u.sibling}function nh(i,s,u){if(Yn&&typeof Yn.onCommitFiberUnmount=="function")try{Yn.onCommitFiberUnmount(Sa,u)}catch{}switch(u.tag){case 26:Nn||Ao(u,s),Oa(i,s,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:Nn||Ao(u,s);var _=an,E=Kr;wl(u.type)&&(an=u.stateNode,Kr=!1),Oa(i,s,u),Su(u.stateNode),an=_,Kr=E;break;case 5:Nn||Ao(u,s);case 6:if(_=an,E=Kr,an=null,Oa(i,s,u),an=_,Kr=E,an!==null)if(Kr)try{(an.nodeType===9?an.body:an.nodeName==="HTML"?an.ownerDocument.body:an).removeChild(u.stateNode)}catch(I){cn(u,s,I)}else try{an.removeChild(u.stateNode)}catch(I){cn(u,s,I)}break;case 18:an!==null&&(Kr?(i=an,Pd(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,u.stateNode),Un(i)):Pd(an,u.stateNode));break;case 4:_=an,E=Kr,an=u.stateNode.containerInfo,Kr=!0,Oa(i,s,u),an=_,Kr=E;break;case 0:case 11:case 14:case 15:Nn||ac(2,u,s),Nn||ac(4,u,s),Oa(i,s,u);break;case 1:Nn||(Ao(u,s),_=u.stateNode,typeof _.componentWillUnmount=="function"&&tg(u,s,_)),Oa(i,s,u);break;case 21:Oa(i,s,u);break;case 22:Nn=(_=Nn)||u.memoizedState!==null,Oa(i,s,u),Nn=_;break;default:Oa(i,s,u)}}function ng(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Un(i)}catch(u){cn(s,s.return,u)}}function rg(i){switch(i.tag){case 13:case 19:var s=i.stateNode;return s===null&&(s=i.stateNode=new th),s;case 22:return i=i.stateNode,s=i._retryCache,s===null&&(s=i._retryCache=new th),s;default:throw Error(b(435,i.tag))}}function _l(i,s){var u=rg(i);s.forEach(function(_){var E=P_.bind(null,i,_);u.has(_)||(u.add(_),_.then(E,E))})}function ts(i,s){var u=s.deletions;if(u!==null)for(var _=0;_<u.length;_++){var E=u[_],I=i,q=s,te=q;e:for(;te!==null;){switch(te.tag){case 27:if(wl(te.type)){an=te.stateNode,Kr=!1;break e}break;case 5:an=te.stateNode,Kr=!1;break e;case 3:case 4:an=te.stateNode.containerInfo,Kr=!0;break e}te=te.return}if(an===null)throw Error(b(160));nh(I,q,E),an=null,Kr=!1,I=E.alternate,I!==null&&(I.return=null),E.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)rh(s,i),s=s.sibling}var Ss=null;function rh(i,s){var u=i.alternate,_=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:ts(s,i),ya(i),_&4&&(ac(3,i,i.return),dd(3,i),ac(5,i,i.return));break;case 1:ts(s,i),ya(i),_&512&&(Nn||u===null||Ao(u,u.return)),_&64&&Po&&(i=i.updateQueue,i!==null&&(_=i.callbacks,_!==null&&(u=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=u===null?_:u.concat(_))));break;case 26:var E=Ss;if(ts(s,i),ya(i),_&512&&(Nn||u===null||Ao(u,u.return)),_&4){var I=u!==null?u.memoizedState:null;if(_=i.memoizedState,u===null)if(_===null)if(i.stateNode===null){e:{_=i.type,u=i.memoizedProps,E=E.ownerDocument||E;t:switch(_){case"title":I=E.getElementsByTagName("title")[0],(!I||I[cs]||I[Wt]||I.namespaceURI==="http://www.w3.org/2000/svg"||I.hasAttribute("itemprop"))&&(I=E.createElement(_),E.head.insertBefore(I,E.querySelector("head > title"))),Xn(I,_,u),I[Wt]=i,pn(I),_=I;break e;case"link":var q=x("link","href",E).get(_+(u.href||""));if(q){for(var te=0;te<q.length;te++)if(I=q[te],I.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&I.getAttribute("rel")===(u.rel==null?null:u.rel)&&I.getAttribute("title")===(u.title==null?null:u.title)&&I.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){q.splice(te,1);break t}}I=E.createElement(_),Xn(I,_,u),E.head.appendChild(I);break;case"meta":if(q=x("meta","content",E).get(_+(u.content||""))){for(te=0;te<q.length;te++)if(I=q[te],I.getAttribute("content")===(u.content==null?null:""+u.content)&&I.getAttribute("name")===(u.name==null?null:u.name)&&I.getAttribute("property")===(u.property==null?null:u.property)&&I.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&I.getAttribute("charset")===(u.charSet==null?null:u.charSet)){q.splice(te,1);break t}}I=E.createElement(_),Xn(I,_,u),E.head.appendChild(I);break;default:throw Error(b(468,_))}I[Wt]=i,pn(I),_=I}i.stateNode=_}else S(E,i.type,i.stateNode);else i.stateNode=t(E,_,i.memoizedProps);else I!==_?(I===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):I.count--,_===null?S(E,i.type,i.stateNode):t(E,_,i.memoizedProps)):_===null&&i.stateNode!==null&&jp(i,i.memoizedProps,u.memoizedProps)}break;case 27:ts(s,i),ya(i),_&512&&(Nn||u===null||Ao(u,u.return)),u!==null&&_&4&&jp(i,i.memoizedProps,u.memoizedProps);break;case 5:if(ts(s,i),ya(i),_&512&&(Nn||u===null||Ao(u,u.return)),i.flags&32){E=i.stateNode;try{fs(E,"")}catch(We){cn(i,i.return,We)}}_&4&&i.stateNode!=null&&(E=i.memoizedProps,jp(i,E,u!==null?u.memoizedProps:E)),_&1024&&(eh=!0);break;case 6:if(ts(s,i),ya(i),_&4){if(i.stateNode===null)throw Error(b(162));_=i.memoizedProps,u=i.stateNode;try{u.nodeValue=_}catch(We){cn(i,i.return,We)}}break;case 3:if(v=null,E=Ss,Ss=gh(s.containerInfo),ts(s,i),Ss=E,ya(i),_&4&&u!==null&&u.memoizedState.isDehydrated)try{Un(s.containerInfo)}catch(We){cn(i,i.return,We)}eh&&(eh=!1,Vp(i));break;case 4:_=Ss,Ss=gh(i.stateNode.containerInfo),ts(s,i),ya(i),Ss=_;break;case 12:ts(s,i),ya(i);break;case 13:ts(s,i),ya(i),i.child.flags&8192&&i.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(Hp=zn()),_&4&&(_=i.updateQueue,_!==null&&(i.updateQueue=null,_l(i,_)));break;case 22:E=i.memoizedState!==null;var ve=u!==null&&u.memoizedState!==null,qe=Po,rt=Nn;if(Po=qe||E,Nn=rt||ve,ts(s,i),Nn=rt,Po=qe,ya(i),_&8192)e:for(s=i.stateNode,s._visibility=E?s._visibility&-2:s._visibility|1,E&&(u===null||ve||Po||Nn||fu(i)),u=null,s=i;;){if(s.tag===5||s.tag===26){if(u===null){ve=u=s;try{if(I=ve.stateNode,E)q=I.style,typeof q.setProperty=="function"?q.setProperty("display","none","important"):q.display="none";else{te=ve.stateNode;var ut=ve.memoizedProps.style,He=ut!=null&&ut.hasOwnProperty("display")?ut.display:null;te.style.display=He==null||typeof He=="boolean"?"":(""+He).trim()}}catch(We){cn(ve,ve.return,We)}}}else if(s.tag===6){if(u===null){ve=s;try{ve.stateNode.nodeValue=E?"":ve.memoizedProps}catch(We){cn(ve,ve.return,We)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===i)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;u===s&&(u=null),s=s.return}u===s&&(u=null),s.sibling.return=s.return,s=s.sibling}_&4&&(_=i.updateQueue,_!==null&&(u=_.retryQueue,u!==null&&(_.retryQueue=null,_l(i,u))));break;case 19:ts(s,i),ya(i),_&4&&(_=i.updateQueue,_!==null&&(i.updateQueue=null,_l(i,_)));break;case 30:break;case 21:break;default:ts(s,i),ya(i)}}function ya(i){var s=i.flags;if(s&2){try{for(var u,_=i.return;_!==null;){if(Fp(_)){u=_;break}_=_.return}if(u==null)throw Error(b(160));switch(u.tag){case 27:var E=u.stateNode,I=hu(i);Sn(i,I,E);break;case 5:var q=u.stateNode;u.flags&32&&(fs(q,""),u.flags&=-33);var te=hu(i);Sn(i,te,q);break;case 3:case 4:var ve=u.stateNode.containerInfo,qe=hu(i);Up(i,qe,ve);break;default:throw Error(b(161))}}catch(rt){cn(i,i.return,rt)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function Vp(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var s=i;Vp(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),i=i.sibling}}function yl(i,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)ih(i,s.alternate,s),s=s.sibling}function fu(i){for(i=i.child;i!==null;){var s=i;switch(s.tag){case 0:case 11:case 14:case 15:ac(4,s,s.return),fu(s);break;case 1:Ao(s,s.return);var u=s.stateNode;typeof u.componentWillUnmount=="function"&&tg(s,s.return,u),fu(s);break;case 27:Su(s.stateNode);case 26:case 5:Ao(s,s.return),fu(s);break;case 22:s.memoizedState===null&&fu(s);break;case 30:fu(s);break;default:fu(s)}i=i.sibling}}function sc(i,s,u){for(u=u&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var _=s.alternate,E=i,I=s,q=I.flags;switch(I.tag){case 0:case 11:case 15:sc(E,I,u),dd(4,I);break;case 1:if(sc(E,I,u),_=I,E=_.stateNode,typeof E.componentDidMount=="function")try{E.componentDidMount()}catch(qe){cn(_,_.return,qe)}if(_=I,E=_.updateQueue,E!==null){var te=_.stateNode;try{var ve=E.shared.hiddenCallbacks;if(ve!==null)for(E.shared.hiddenCallbacks=null,E=0;E<ve.length;E++)nd(ve[E],te)}catch(qe){cn(_,_.return,qe)}}u&&q&64&&eg(I),fd(I,I.return);break;case 27:du(I);case 26:case 5:sc(E,I,u),u&&_===null&&q&4&&Sf(I),fd(I,I.return);break;case 12:sc(E,I,u);break;case 13:sc(E,I,u),u&&q&4&&ng(E,I);break;case 22:I.memoizedState===null&&sc(E,I,u),fd(I,I.return);break;case 30:break;default:sc(E,I,u)}s=s.sibling}}function Gp(i,s){var u=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),i=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(i=s.memoizedState.cachePool.pool),i!==u&&(i!=null&&i.refCount++,u!=null&&ol(u))}function Zp(i,s){i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&ol(i))}function Ro(i,s,u,_){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)pu(i,s,u,_),s=s.sibling}function pu(i,s,u,_){var E=s.flags;switch(s.tag){case 0:case 11:case 15:Ro(i,s,u,_),E&2048&&dd(9,s);break;case 1:Ro(i,s,u,_);break;case 3:Ro(i,s,u,_),E&2048&&(i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&ol(i)));break;case 12:if(E&2048){Ro(i,s,u,_),i=s.stateNode;try{var I=s.memoizedProps,q=I.id,te=I.onPostCommit;typeof te=="function"&&te(q,s.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(ve){cn(s,s.return,ve)}}else Ro(i,s,u,_);break;case 13:Ro(i,s,u,_);break;case 23:break;case 22:I=s.stateNode,q=s.alternate,s.memoizedState!==null?I._visibility&2?Ro(i,s,u,_):pd(i,s):I._visibility&2?Ro(i,s,u,_):(I._visibility|=2,ah(i,s,u,_,(s.subtreeFlags&10256)!==0)),E&2048&&Gp(q,s);break;case 24:Ro(i,s,u,_),E&2048&&Zp(s.alternate,s);break;default:Ro(i,s,u,_)}}function ah(i,s,u,_,E){for(E=E&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var I=i,q=s,te=u,ve=_,qe=q.flags;switch(q.tag){case 0:case 11:case 15:ah(I,q,te,ve,E),dd(8,q);break;case 23:break;case 22:var rt=q.stateNode;q.memoizedState!==null?rt._visibility&2?ah(I,q,te,ve,E):pd(I,q):(rt._visibility|=2,ah(I,q,te,ve,E)),E&&qe&2048&&Gp(q.alternate,q);break;case 24:ah(I,q,te,ve,E),E&&qe&2048&&Zp(q.alternate,q);break;default:ah(I,q,te,ve,E)}s=s.sibling}}function pd(i,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var u=i,_=s,E=_.flags;switch(_.tag){case 22:pd(u,_),E&2048&&Gp(_.alternate,_);break;case 24:pd(u,_),E&2048&&Zp(_.alternate,_);break;default:pd(u,_)}s=s.sibling}}var sh=8192;function oh(i){if(i.subtreeFlags&sh)for(i=i.child;i!==null;)qp(i),i=i.sibling}function qp(i){switch(i.tag){case 26:oh(i),i.flags&sh&&i.memoizedState!==null&&V(Ss,i.memoizedState,i.memoizedProps);break;case 5:oh(i);break;case 3:case 4:var s=Ss;Ss=gh(i.stateNode.containerInfo),oh(i),Ss=s;break;case 22:i.memoizedState===null&&(s=i.alternate,s!==null&&s.memoizedState!==null?(s=sh,sh=16777216,oh(i),sh=s):oh(i));break;default:oh(i)}}function ag(i){var s=i.alternate;if(s!==null&&(i=s.child,i!==null)){s.child=null;do s=i.sibling,i.sibling=null,i=s;while(i!==null)}}function mu(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var u=0;u<s.length;u++){var _=s[u];br=_,sg(_,i)}ag(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)lh(i),i=i.sibling}function lh(i){switch(i.tag){case 0:case 11:case 15:mu(i),i.flags&2048&&ac(9,i,i.return);break;case 3:mu(i);break;case 12:mu(i);break;case 22:var s=i.stateNode;i.memoizedState!==null&&s._visibility&2&&(i.return===null||i.return.tag!==13)?(s._visibility&=-3,ch(i)):mu(i);break;default:mu(i)}}function ch(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var u=0;u<s.length;u++){var _=s[u];br=_,sg(_,i)}ag(i)}for(i=i.child;i!==null;){switch(s=i,s.tag){case 0:case 11:case 15:ac(8,s,s.return),ch(s);break;case 22:u=s.stateNode,u._visibility&2&&(u._visibility&=-3,ch(s));break;default:ch(s)}i=i.sibling}}function sg(i,s){for(;br!==null;){var u=br;switch(u.tag){case 0:case 11:case 15:ac(8,u,s);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var _=u.memoizedState.cachePool.pool;_!=null&&_.refCount++}break;case 24:ol(u.memoizedState.cache)}if(_=u.child,_!==null)_.return=u,br=_;else e:for(u=i;br!==null;){_=br;var E=_.sibling,I=_.return;if(Tf(_),_===u){br=null;break e}if(E!==null){E.return=I,br=E;break e}br=I}}}var C_={getCacheForType:function(i){var s=on(Qn),u=s.data.get(i);return u===void 0&&(u=i(),s.data.set(i,u)),u}},og=typeof WeakMap=="function"?WeakMap:Map,nn=0,Tn=null,zi=null,Mi=0,rn=0,is=null,oc=!1,uh=!1,$p=!1,vl=0,Hn=0,zo=0,lc=0,Cf=0,ns=0,hh=0,cc=null,Ba=null,Ef=!1,Hp=0,Mf=1/0,Af=null,xl=null,Qr=0,uc=null,Io=null,Pn=0,md=0,Pf=null,Xp=null,gu=0,hc=null;function Na(){if((nn&2)!==0&&Mi!==0)return Mi&-Mi;if(Oe.T!==null){var i=rr;return i!==0?i:wd()}return Wn()}function lg(){ns===0&&(ns=(Mi&536870912)===0||Oi?dt():536870912);var i=_a.current;return i!==null&&(i.flags|=32),ns}function rs(i,s,u){(i===Tn&&(rn===2||rn===9)||i.cancelPendingCommit!==null)&&(dh(i,0),dc(i,Mi,ns,!1)),Ie(i,u),((nn&2)===0||i!==Tn)&&(i===Tn&&((nn&2)===0&&(lc|=u),Hn===4&&dc(i,Mi,ns,!1)),as(i))}function cg(i,s,u){if((nn&6)!==0)throw Error(b(327));var _=!u&&(s&124)===0&&(s&i.expiredLanes)===0||ze(i,s),E=_?fc(i,s):gd(i,s,!0),I=_;do{if(E===0){uh&&!_&&dc(i,s,0,!1);break}else{if(u=i.current.alternate,I&&!E_(u)){E=gd(i,s,!1),I=!1;continue}if(E===2){if(I=s,i.errorRecoveryDisabledLanes&I)var q=0;else q=i.pendingLanes&-536870913,q=q!==0?q:q&536870912?536870912:0;if(q!==0){s=q;e:{var te=i;E=cc;var ve=te.current.memoizedState.isDehydrated;if(ve&&(dh(te,q).flags|=256),q=gd(te,q,!1),q!==2){if($p&&!ve){te.errorRecoveryDisabledLanes|=I,lc|=I,E=4;break e}I=Ba,Ba=E,I!==null&&(Ba===null?Ba=I:Ba.push.apply(Ba,I))}E=q}if(I=!1,E!==2)continue}}if(E===1){dh(i,0),dc(i,s,0,!0);break}e:{switch(_=i,I=E,I){case 0:case 1:throw Error(b(345));case 4:if((s&4194048)!==s)break;case 6:dc(_,s,ns,!oc);break e;case 2:Ba=null;break;case 3:case 5:break;default:throw Error(b(329))}if((s&62914560)===s&&(E=Hp+300-zn(),10<E)){if(dc(_,s,ns,!oc),je(_,0,!0)!==0)break e;_.timeoutHandle=cm(ug.bind(null,_,u,Ba,Af,Ef,s,ns,lc,hh,oc,I,2,-0,0),E);break e}ug(_,u,Ba,Af,Ef,s,ns,lc,hh,oc,I,0,-0,0)}}break}while(!0);as(i)}function ug(i,s,u,_,E,I,q,te,ve,qe,rt,ut,He,We){if(i.timeoutHandle=-1,ut=s.subtreeFlags,(ut&8192||(ut&16785408)===16785408)&&(D={stylesheets:null,count:0,unsuspend:B},qp(s),ut=$(),ut!==null)){i.cancelPendingCommit=ut(Wp.bind(null,i,s,I,u,_,E,q,te,ve,rt,1,He,We)),dc(i,I,q,!qe);return}Wp(i,s,I,u,_,E,q,te,ve)}function E_(i){for(var s=i;;){var u=s.tag;if((u===0||u===11||u===15)&&s.flags&16384&&(u=s.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var _=0;_<u.length;_++){var E=u[_],I=E.getSnapshot;E=E.value;try{if(!Zr(I(),E))return!1}catch{return!1}}if(u=s.child,s.subtreeFlags&16384&&u!==null)u.return=s,s=u;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function dc(i,s,u,_){s&=~Cf,s&=~lc,i.suspendedLanes|=s,i.pingedLanes&=~s,_&&(i.warmLanes|=s),_=i.expirationTimes;for(var E=s;0<E;){var I=31-Me(E),q=1<<I;_[I]=-1,E&=~q}u!==0&&_i(i,u,s)}function Rf(){return(nn&6)===0?(vu(0),!1):!0}function Yp(){if(zi!==null){if(rn===0)var i=zi.return;else i=zi,Aa=ga=null,wo(i),_n=null,An=0,i=zi;for(;i!==null;)Jm(i.alternate,i),i=i.return;zi=null}}function dh(i,s){var u=i.timeoutHandle;u!==-1&&(i.timeoutHandle=-1,Ag(u)),u=i.cancelPendingCommit,u!==null&&(i.cancelPendingCommit=null,u()),Yp(),Tn=i,zi=u=Ir(i.current,null),Mi=s,rn=0,is=null,oc=!1,uh=ze(i,s),$p=!1,hh=ns=Cf=lc=zo=Hn=0,Ba=cc=null,Ef=!1,(s&8)!==0&&(s|=s&32);var _=i.entangledLanes;if(_!==0)for(i=i.entanglements,_&=s;0<_;){var E=31-Me(_),I=1<<E;s|=i[E],_&=~I}return vl=s,al(),u}function hg(i,s){xi=null,Oe.H=xr,s===Fs||s===Mt?(s=iu(),rn=3):s===Ra?(s=iu(),rn=4):rn=s===ld?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,is=s,zi===null&&(Hn=1,Qu(i,cr(s,i.current)))}function dg(){var i=Oe.H;return Oe.H=xr,i===null?xr:i}function fg(){var i=Oe.A;return Oe.A=C_,i}function zf(){Hn=4,oc||(Mi&4194048)!==Mi&&_a.current!==null||(uh=!0),(zo&134217727)===0&&(lc&134217727)===0||Tn===null||dc(Tn,Mi,ns,!1)}function gd(i,s,u){var _=nn;nn|=2;var E=dg(),I=fg();(Tn!==i||Mi!==s)&&(Af=null,dh(i,s)),s=!1;var q=Hn;e:do try{if(rn!==0&&zi!==null){var te=zi,ve=is;switch(rn){case 8:Yp(),q=6;break e;case 3:case 2:case 9:case 6:_a.current===null&&(s=!0);var qe=rn;if(rn=0,is=null,bl(i,te,ve,qe),u&&uh){q=0;break e}break;default:qe=rn,rn=0,is=null,bl(i,te,ve,qe)}}pg(),q=Hn;break}catch(rt){hg(i,rt)}while(!0);return s&&i.shellSuspendCounter++,Aa=ga=null,nn=_,Oe.H=E,Oe.A=I,zi===null&&(Tn=null,Mi=0,al()),q}function pg(){for(;zi!==null;)_u(zi)}function fc(i,s){var u=nn;nn|=2;var _=dg(),E=fg();Tn!==i||Mi!==s?(Af=null,Mf=zn()+500,dh(i,s)):uh=ze(i,s);e:do try{if(rn!==0&&zi!==null){s=zi;var I=is;t:switch(rn){case 1:rn=0,is=null,bl(i,s,I,1);break;case 2:case 9:if(tu(I)){rn=0,is=null,yd(s);break}s=function(){rn!==2&&rn!==9||Tn!==i||(rn=7),as(i)},I.then(s,s);break e;case 3:rn=7;break e;case 4:rn=5;break e;case 7:tu(I)?(rn=0,is=null,yd(s)):(rn=0,is=null,bl(i,s,I,7));break;case 5:var q=null;switch(zi.tag){case 26:q=zi.memoizedState;case 5:case 27:var te=zi;if(!q||z(q)){rn=0,is=null;var ve=te.sibling;if(ve!==null)zi=ve;else{var qe=te.return;qe!==null?(zi=qe,If(qe)):zi=null}break t}}rn=0,is=null,bl(i,s,I,5);break;case 6:rn=0,is=null,bl(i,s,I,6);break;case 8:Yp(),Hn=6;break e;default:throw Error(b(462))}}_d();break}catch(rt){hg(i,rt)}while(!0);return Aa=ga=null,Oe.H=_,Oe.A=E,nn=u,zi!==null?0:(Tn=null,Mi=0,al(),Hn)}function _d(){for(;zi!==null&&!fr();)_u(zi)}function _u(i){var s=Km(i.alternate,i,vl);i.memoizedProps=i.pendingProps,s===null?If(i):zi=s}function yd(i){var s=i,u=s.alternate;switch(s.tag){case 15:case 0:s=_f(u,s,s.pendingProps,s.type,void 0,Mi);break;case 11:s=_f(u,s,s.pendingProps,s.type.render,s.ref,Mi);break;case 5:wo(s);default:Jm(u,s),s=zi=Qh(s,vl),s=Km(u,s,vl)}i.memoizedProps=i.pendingProps,s===null?If(i):zi=s}function bl(i,s,u,_){Aa=ga=null,wo(s),_n=null,An=0;var E=s.return;try{if(od(i,E,s,u,Mi)){Hn=1,Qu(i,cr(u,i.current)),zi=null;return}}catch(I){if(E!==null)throw zi=E,I;Hn=1,Qu(i,cr(u,i.current)),zi=null;return}s.flags&32768?(Oi||_===1?i=!0:uh||(Mi&536870912)!==0?i=!1:(oc=i=!0,(_===2||_===9||_===3||_===6)&&(_=_a.current,_!==null&&_.tag===13&&(_.flags|=16384))),mg(s,i)):If(s)}function If(i){var s=i;do{if((s.flags&32768)!==0){mg(s,oc);return}i=s.return;var u=uu(s.alternate,s,vl);if(u!==null){zi=u;return}if(s=s.sibling,s!==null){zi=s;return}zi=s=i}while(s!==null);Hn===0&&(Hn=5)}function mg(i,s){do{var u=hd(i.alternate,i);if(u!==null){u.flags&=32767,zi=u;return}if(u=i.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!s&&(i=i.sibling,i!==null)){zi=i;return}zi=i=u}while(i!==null);Hn=6,zi=null}function Wp(i,s,u,_,E,I,q,te,ve){i.cancelPendingCommit=null;do fh();while(Qr!==0);if((nn&6)!==0)throw Error(b(327));if(s!==null){if(s===i.current)throw Error(b(177));if(I=s.lanes|s.childLanes,I|=rl,ei(i,u,I,q,te,ve),i===Tn&&(zi=Tn=null,Mi=0),Io=s,uc=i,Pn=u,md=I,Pf=E,Xp=_,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,vg(Za,function(){return Df(),null})):(i.callbackNode=null,i.callbackPriority=0),_=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||_){_=Oe.T,Oe.T=null,E=it.p,it.p=2,q=nn,nn|=4;try{ig(i,s,u)}finally{nn=q,it.p=E,Oe.T=_}}Qr=1,Kp(),gg(),Qp()}}function Kp(){if(Qr===1){Qr=0;var i=uc,s=Io,u=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||u){u=Oe.T,Oe.T=null;var _=it.p;it.p=2;var E=nn;nn|=4;try{rh(s,i);var I=Ff,q=Bu(i.containerInfo),te=I.focusedElem,ve=I.selectionRange;if(q!==te&&te&&te.ownerDocument&&Pi(te.ownerDocument.documentElement,te)){if(ve!==null&&Vc(te)){var qe=ve.start,rt=ve.end;if(rt===void 0&&(rt=qe),"selectionStart"in te)te.selectionStart=qe,te.selectionEnd=Math.min(rt,te.value.length);else{var ut=te.ownerDocument||document,He=ut&&ut.defaultView||window;if(He.getSelection){var We=He.getSelection(),li=te.textContent.length,ai=Math.min(ve.start,li),hn=ve.end===void 0?ai:Math.min(ve.end,li);!We.extend&&ai>hn&&(q=hn,hn=ai,ai=q);var Be=ys(te,ai),De=ys(te,hn);if(Be&&De&&(We.rangeCount!==1||We.anchorNode!==Be.node||We.anchorOffset!==Be.offset||We.focusNode!==De.node||We.focusOffset!==De.offset)){var Ge=ut.createRange();Ge.setStart(Be.node,Be.offset),We.removeAllRanges(),ai>hn?(We.addRange(Ge),We.extend(De.node,De.offset)):(Ge.setEnd(De.node,De.offset),We.addRange(Ge))}}}}for(ut=[],We=te;We=We.parentNode;)We.nodeType===1&&ut.push({element:We,left:We.scrollLeft,top:We.scrollTop});for(typeof te.focus=="function"&&te.focus(),te=0;te<ut.length;te++){var lt=ut[te];lt.element.scrollLeft=lt.left,lt.element.scrollTop=lt.top}}yt=!!jf,Ff=jf=null}finally{nn=E,it.p=_,Oe.T=u}}i.current=s,Qr=2}}function gg(){if(Qr===2){Qr=0;var i=uc,s=Io,u=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||u){u=Oe.T,Oe.T=null;var _=it.p;it.p=2;var E=nn;nn|=4;try{ih(i,s.alternate,s)}finally{nn=E,it.p=_,Oe.T=u}}Qr=3}}function Qp(){if(Qr===4||Qr===3){Qr=0,Mr();var i=uc,s=Io,u=Pn,_=Xp;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?Qr=5:(Qr=0,Io=uc=null,Jp(i,i.pendingLanes));var E=i.pendingLanes;if(E===0&&(xl=null),Yi(u),s=s.stateNode,Yn&&typeof Yn.onCommitFiberRoot=="function")try{Yn.onCommitFiberRoot(Sa,s,void 0,(s.current.flags&128)===128)}catch{}if(_!==null){s=Oe.T,E=it.p,it.p=2,Oe.T=null;try{for(var I=i.onRecoverableError,q=0;q<_.length;q++){var te=_[q];I(te.value,{componentStack:te.stack})}}finally{Oe.T=s,it.p=E}}(Pn&3)!==0&&fh(),as(i),E=i.pendingLanes,(u&4194090)!==0&&(E&42)!==0?i===hc?gu++:(gu=0,hc=i):gu=0,vu(0)}}function Jp(i,s){(i.pooledCacheLanes&=s)===0&&(s=i.pooledCache,s!=null&&(i.pooledCache=null,ol(s)))}function fh(i){return Kp(),gg(),Qp(),Df()}function Df(){if(Qr!==5)return!1;var i=uc,s=md;md=0;var u=Yi(Pn),_=Oe.T,E=it.p;try{it.p=32>u?32:u,Oe.T=null,u=Pf,Pf=null;var I=uc,q=Pn;if(Qr=0,Io=uc=null,Pn=0,(nn&6)!==0)throw Error(b(331));var te=nn;if(nn|=4,lh(I.current),pu(I,I.current,q,u),nn=te,vu(0,!1),Yn&&typeof Yn.onPostCommitFiberRoot=="function")try{Yn.onPostCommitFiberRoot(Sa,I)}catch{}return!0}finally{it.p=E,Oe.T=_,Jp(i,s)}}function _g(i,s,u){s=cr(u,s),s=gf(i.stateNode,s,2),i=Us(i,s,2),i!==null&&(Ie(i,2),as(i))}function cn(i,s,u){if(i.tag===3)_g(i,i,u);else for(;s!==null;){if(s.tag===3){_g(s,i,u);break}else if(s.tag===1){var _=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof _.componentDidCatch=="function"&&(xl===null||!xl.has(_))){i=cr(u,i),u=ou(2),_=Us(s,u,2),_!==null&&(qm(u,_,s,i),Ie(_,2),as(_));break}}s=s.return}}function em(i,s,u){var _=i.pingCache;if(_===null){_=i.pingCache=new og;var E=new Set;_.set(s,E)}else E=_.get(s),E===void 0&&(E=new Set,_.set(s,E));E.has(u)||($p=!0,E.add(u),i=M_.bind(null,i,s,u),s.then(i,i))}function M_(i,s,u){var _=i.pingCache;_!==null&&_.delete(s),i.pingedLanes|=i.suspendedLanes&u,i.warmLanes&=~u,Tn===i&&(Mi&u)===u&&(Hn===4||Hn===3&&(Mi&62914560)===Mi&&300>zn()-Hp?(nn&2)===0&&dh(i,0):Cf|=u,hh===Mi&&(hh=0)),as(i)}function yg(i,s){s===0&&(s=nt()),i=ha(i,s),i!==null&&(Ie(i,s),as(i))}function A_(i){var s=i.memoizedState,u=0;s!==null&&(u=s.retryLane),yg(i,u)}function P_(i,s){var u=0;switch(i.tag){case 13:var _=i.stateNode,E=i.memoizedState;E!==null&&(u=E.retryLane);break;case 19:_=i.stateNode;break;case 22:_=i.stateNode._retryCache;break;default:throw Error(b(314))}_!==null&&_.delete(s),yg(i,u)}function vg(i,s){return Ti(i,s)}var vd=null,ja=null,Do=!1,xd=!1,bd=!1,yu=0;function as(i){i!==ja&&i.next===null&&(ja===null?vd=ja=i:ja=ja.next=i),xd=!0,Do||(Do=!0,xg())}function vu(i,s){if(!bd&&xd){bd=!0;do for(var u=!1,_=vd;_!==null;){if(i!==0){var E=_.pendingLanes;if(E===0)var I=0;else{var q=_.suspendedLanes,te=_.pingedLanes;I=(1<<31-Me(42|i)+1)-1,I&=E&~(q&~te),I=I&201326741?I&201326741|1:I?I|2:0}I!==0&&(u=!0,tm(_,I))}else I=Mi,I=je(_,_===Tn?I:0,_.cancelPendingCommit!==null||_.timeoutHandle!==-1),(I&3)===0||ze(_,I)||(u=!0,tm(_,I));_=_.next}while(u);bd=!1}}function R_(){kf()}function kf(){xd=Do=!1;var i=0;yu!==0&&(Mg()&&(i=yu),yu=0);for(var s=zn(),u=null,_=vd;_!==null;){var E=_.next,I=Lf(_,s);I===0?(_.next=null,u===null?vd=E:u.next=E,E===null&&(ja=u)):(u=_,(i!==0||(I&3)!==0)&&(xd=!0)),_=E}vu(i)}function Lf(i,s){for(var u=i.suspendedLanes,_=i.pingedLanes,E=i.expirationTimes,I=i.pendingLanes&-62914561;0<I;){var q=31-Me(I),te=1<<q,ve=E[q];ve===-1?((te&u)===0||(te&_)!==0)&&(E[q]=Je(te,s)):ve<=s&&(i.expiredLanes|=te),I&=~te}if(s=Tn,u=Mi,u=je(i,i===s?u:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),_=i.callbackNode,u===0||i===s&&(rn===2||rn===9)||i.cancelPendingCommit!==null)return _!==null&&_!==null&&ki(_),i.callbackNode=null,i.callbackPriority=0;if((u&3)===0||ze(i,u)){if(s=u&-u,s===i.callbackPriority)return s;switch(_!==null&&ki(_),Yi(u)){case 2:case 8:u=jo;break;case 32:u=Za;break;case 268435456:u=As;break;default:u=Za}return _=xu.bind(null,i),u=Ti(u,_),i.callbackPriority=s,i.callbackNode=u,s}return _!==null&&_!==null&&ki(_),i.callbackPriority=2,i.callbackNode=null,2}function xu(i,s){if(Qr!==0&&Qr!==5)return i.callbackNode=null,i.callbackPriority=0,null;var u=i.callbackNode;if(fh()&&i.callbackNode!==u)return null;var _=Mi;return _=je(i,i===Tn?_:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),_===0?null:(cg(i,_,s),Lf(i,zn()),i.callbackNode!=null&&i.callbackNode===u?xu.bind(null,i):null)}function tm(i,s){if(fh())return null;cg(i,s,!0)}function xg(){D_(function(){(nn&6)!==0?Ti(Ar,R_):kf()})}function wd(){return yu===0&&(yu=dt()),yu}function im(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:pi(""+i)}function Sd(i,s){var u=s.ownerDocument.createElement("input");return u.name=s.name,u.value=s.value,i.id&&u.setAttribute("form",i.id),s.parentNode.insertBefore(u,s),i=new FormData(i),u.parentNode.removeChild(u),i}function bg(i,s,u,_,E){if(s==="submit"&&u&&u.stateNode===E){var I=im((E[ti]||null).action),q=_.submitter;q&&(s=(s=q[ti]||null)?im(s.formAction):q.getAttribute("formAction"),s!==null&&(I=s,q=null));var te=new ca("action","action",null,_,E);i.push({event:te,listeners:[{instance:null,listener:function(){if(_.defaultPrevented){if(yu!==0){var ve=q?Sd(E,q):new FormData(E);gn(u,{pending:!0,data:ve,method:E.method,action:I},null,ve)}}else typeof I=="function"&&(te.preventDefault(),ve=q?Sd(E,q):new FormData(E),gn(u,{pending:!0,data:ve,method:E.method,action:I},I,ve))},currentTarget:E}]})}}for(var nm=0;nm<ju.length;nm++){var rm=ju[nm],wg=rm.toLowerCase(),z_=rm[0].toUpperCase()+rm.slice(1);Ea(wg,"on"+z_)}Ea(Gc,"onAnimationEnd"),Ea(Zc,"onAnimationIteration"),Ea(qc,"onAnimationStart"),Ea("dblclick","onDoubleClick"),Ea("focusin","onFocus"),Ea("focusout","onBlur"),Ea(Wh,"onTransitionRun"),Ea(il,"onTransitionStart"),Ea($c,"onTransitionCancel"),Ea(nl,"onTransitionEnd"),Rs("onMouseEnter",["mouseout","mouseover"]),Rs("onMouseLeave",["mouseout","mouseover"]),Rs("onPointerEnter",["pointerout","pointerover"]),Rs("onPointerLeave",["pointerout","pointerover"]),ta("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ta("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ta("onBeforeInput",["compositionend","keypress","textInput","paste"]),ta("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ta("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ta("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Td="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),I_=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Td));function Sg(i,s){s=(s&4)!==0;for(var u=0;u<i.length;u++){var _=i[u],E=_.event;_=_.listeners;e:{var I=void 0;if(s)for(var q=_.length-1;0<=q;q--){var te=_[q],ve=te.instance,qe=te.currentTarget;if(te=te.listener,ve!==I&&E.isPropagationStopped())break e;I=te,E.currentTarget=qe;try{I(E)}catch(rt){sd(rt)}E.currentTarget=null,I=ve}else for(q=0;q<_.length;q++){if(te=_[q],ve=te.instance,qe=te.currentTarget,te=te.listener,ve!==I&&E.isPropagationStopped())break e;I=te,E.currentTarget=qe;try{I(E)}catch(rt){sd(rt)}E.currentTarget=null,I=ve}}}}function Ii(i,s){var u=s[pt];u===void 0&&(u=s[pt]=new Set);var _=i+"__bubble";u.has(_)||(am(s,i,2,!1),u.add(_))}function Cd(i,s,u){var _=0;s&&(_|=4),am(u,i,_,s)}var Ks="_reactListening"+Math.random().toString(36).slice(2);function Of(i){if(!i[Ks]){i[Ks]=!0,ui.forEach(function(u){u!=="selectionchange"&&(I_.has(u)||Cd(u,!1,i),Cd(u,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[Ks]||(s[Ks]=!0,Cd("selectionchange",!1,s))}}function am(i,s,u,_){switch(Ut(s)){case 2:var E=Ot;break;case 8:E=bt;break;default:E=vt}u=E.bind(null,s,u,i),E=void 0,!_r||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(E=!0),_?E!==void 0?i.addEventListener(s,u,{capture:!0,passive:E}):i.addEventListener(s,u,!0):E!==void 0?i.addEventListener(s,u,{passive:E}):i.addEventListener(s,u,!1)}function Bf(i,s,u,_,E){var I=_;if((s&1)===0&&(s&2)===0&&_!==null)e:for(;;){if(_===null)return;var q=_.tag;if(q===3||q===4){var te=_.stateNode.containerInfo;if(te===E)break;if(q===4)for(q=_.return;q!==null;){var ve=q.tag;if((ve===3||ve===4)&&q.stateNode.containerInfo===E)return;q=q.return}for(;te!==null;){if(q=ci(te),q===null)return;if(ve=q.tag,ve===5||ve===6||ve===26||ve===27){_=I=q;continue e}te=te.parentNode}}_=_.return}qn(function(){var qe=I,rt=Il(u),ut=[];e:{var He=ua.get(i);if(He!==void 0){var We=ca,li=i;switch(i){case"keypress":if(ii(u)===0)break e;case"keydown":case"keyup":We=Lc;break;case"focusin":li="focus",We=Xo;break;case"focusout":li="blur",We=Xo;break;case"beforeblur":case"afterblur":We=Xo;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":We=zc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":We=lr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":We=Tp;break;case Gc:case Zc:case qc:We=In;break;case nl:We=Cp;break;case"scroll":case"scrollend":We=jh;break;case"wheel":We=Lu;break;case"copy":case"cut":case"paste":We=Ic;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":We=Uh;break;case"toggle":case"beforetoggle":We=Ko}var ai=(s&4)!==0,hn=!ai&&(i==="scroll"||i==="scrollend"),Be=ai?He!==null?He+"Capture":null:He;ai=[];for(var De=qe,Ge;De!==null;){var lt=De;if(Ge=lt.stateNode,lt=lt.tag,lt!==5&&lt!==26&&lt!==27||Ge===null||Be===null||(lt=Li(De,Be),lt!=null&&ai.push(ph(De,lt,Ge))),hn)break;De=De.return}0<ai.length&&(He=new We(He,li,null,u,rt),ut.push({event:He,listeners:ai}))}}if((s&7)===0){e:{if(He=i==="mouseover"||i==="pointerover",We=i==="mouseout"||i==="pointerout",He&&u!==Is&&(li=u.relatedTarget||u.fromElement)&&(ci(li)||li[fn]))break e;if((We||He)&&(He=rt.window===rt?rt:(He=rt.ownerDocument)?He.defaultView||He.parentWindow:window,We?(li=u.relatedTarget||u.toElement,We=qe,li=li?ci(li):null,li!==null&&(hn=R(li),ai=li.tag,li!==hn||ai!==5&&ai!==27&&ai!==6)&&(li=null)):(We=null,li=qe),We!==li)){if(ai=zc,lt="onMouseLeave",Be="onMouseEnter",De="mouse",(i==="pointerout"||i==="pointerover")&&(ai=Uh,lt="onPointerLeave",Be="onPointerEnter",De="pointer"),hn=We==null?He:Zn(We),Ge=li==null?He:Zn(li),He=new ai(lt,De+"leave",We,u,rt),He.target=hn,He.relatedTarget=Ge,lt=null,ci(rt)===qe&&(ai=new ai(Be,De+"enter",li,u,rt),ai.target=Ge,ai.relatedTarget=hn,lt=ai),hn=lt,We&&li)t:{for(ai=We,Be=li,De=0,Ge=ai;Ge;Ge=pc(Ge))De++;for(Ge=0,lt=Be;lt;lt=pc(lt))Ge++;for(;0<De-Ge;)ai=pc(ai),De--;for(;0<Ge-De;)Be=pc(Be),Ge--;for(;De--;){if(ai===Be||Be!==null&&ai===Be.alternate)break t;ai=pc(ai),Be=pc(Be)}ai=null}else ai=null;We!==null&&sm(ut,He,We,ai,!1),li!==null&&hn!==null&&sm(ut,hn,li,ai,!0)}}e:{if(He=qe?Zn(qe):window,We=He.nodeName&&He.nodeName.toLowerCase(),We==="select"||We==="input"&&He.type==="file")var Vt=Hh;else if(nf(He))if(co)Vt=of;else{Vt=Ap;var Ai=af}else We=He.nodeName,!We||We.toLowerCase()!=="input"||He.type!=="checkbox"&&He.type!=="radio"?qe&&ps(qe.elementType)&&(Vt=Hh):Vt=sf;if(Vt&&(Vt=Vt(i,qe))){$h(ut,Vt,u,rt);break e}Ai&&Ai(i,He,qe),i==="focusout"&&qe&&He.type==="number"&&qe.memoizedProps.value!=null&&Rc(He,"number",He.value)}switch(Ai=qe?Zn(qe):window,i){case"focusin":(nf(Ai)||Ai.contentEditable==="true")&&(uo=Ai,ks=qe,el=null);break;case"focusout":el=ks=uo=null;break;case"mousedown":Yh=!0;break;case"contextmenu":case"mouseup":case"dragend":Yh=!1,cf(ut,u,rt);break;case"selectionchange":if(lf)break;case"keydown":case"keyup":cf(ut,u,rt)}var Bt;if(Ll)e:{switch(i){case"compositionstart":var Jt="onCompositionStart";break e;case"compositionend":Jt="onCompositionEnd";break e;case"compositionupdate":Jt="onCompositionUpdate";break e}Jt=void 0}else Nl?ef(i,u)&&(Jt="onCompositionEnd"):i==="keydown"&&u.keyCode===229&&(Jt="onCompositionStart");Jt&&(Oc&&u.locale!=="ko"&&(Nl||Jt!=="onCompositionStart"?Jt==="onCompositionEnd"&&Nl&&(Bt=Yt()):(Mn=rt,tn="value"in Mn?Mn.value:Mn.textContent,Nl=!0)),Ai=Ed(qe,Jt),0<Ai.length&&(Jt=new Jd(Jt,i,null,u,rt),ut.push({event:Jt,listeners:Ai}),Bt?Jt.data=Bt:(Bt=Bc(u),Bt!==null&&(Jt.data=Bt)))),(Bt=Mp?Qo(i,u):tf(i,u))&&(Jt=Ed(qe,"onBeforeInput"),0<Jt.length&&(Ai=new Jd("onBeforeInput","beforeinput",null,u,rt),ut.push({event:Ai,listeners:Jt}),Ai.data=Bt)),bg(ut,i,qe,u,rt)}Sg(ut,s)})}function ph(i,s,u){return{instance:i,listener:s,currentTarget:u}}function Ed(i,s){for(var u=s+"Capture",_=[];i!==null;){var E=i,I=E.stateNode;if(E=E.tag,E!==5&&E!==26&&E!==27||I===null||(E=Li(i,u),E!=null&&_.unshift(ph(i,E,I)),E=Li(i,s),E!=null&&_.push(ph(i,E,I))),i.tag===3)return _;i=i.return}return[]}function pc(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function sm(i,s,u,_,E){for(var I=s._reactName,q=[];u!==null&&u!==_;){var te=u,ve=te.alternate,qe=te.stateNode;if(te=te.tag,ve!==null&&ve===_)break;te!==5&&te!==26&&te!==27||qe===null||(ve=qe,E?(qe=Li(u,I),qe!=null&&q.unshift(ph(u,qe,ve))):E||(qe=Li(u,I),qe!=null&&q.push(ph(u,qe,ve)))),u=u.return}q.length!==0&&i.push({event:s,listeners:q})}var Md=/\r\n?/g,Tg=/\u0000|\uFFFD/g;function Nf(i){return(typeof i=="string"?i:""+i).replace(Md,`
`).replace(Tg,"")}function om(i,s){return s=Nf(s),Nf(i)===s}function aa(){}function Ui(i,s,u,_,E,I){switch(u){case"children":typeof _=="string"?s==="body"||s==="textarea"&&_===""||fs(i,_):(typeof _=="number"||typeof _=="bigint")&&s!=="body"&&fs(i,""+_);break;case"className":Ni(i,"class",_);break;case"tabIndex":Ni(i,"tabindex",_);break;case"dir":case"role":case"viewBox":case"width":case"height":Ni(i,u,_);break;case"style":ao(i,_,I);break;case"data":if(s!=="object"){Ni(i,"data",_);break}case"src":case"href":if(_===""&&(s!=="a"||u!=="href")){i.removeAttribute(u);break}if(_==null||typeof _=="function"||typeof _=="symbol"||typeof _=="boolean"){i.removeAttribute(u);break}_=pi(""+_),i.setAttribute(u,_);break;case"action":case"formAction":if(typeof _=="function"){i.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof I=="function"&&(u==="formAction"?(s!=="input"&&Ui(i,s,"name",E.name,E,null),Ui(i,s,"formEncType",E.formEncType,E,null),Ui(i,s,"formMethod",E.formMethod,E,null),Ui(i,s,"formTarget",E.formTarget,E,null)):(Ui(i,s,"encType",E.encType,E,null),Ui(i,s,"method",E.method,E,null),Ui(i,s,"target",E.target,E,null)));if(_==null||typeof _=="symbol"||typeof _=="boolean"){i.removeAttribute(u);break}_=pi(""+_),i.setAttribute(u,_);break;case"onClick":_!=null&&(i.onclick=aa);break;case"onScroll":_!=null&&Ii("scroll",i);break;case"onScrollEnd":_!=null&&Ii("scrollend",i);break;case"dangerouslySetInnerHTML":if(_!=null){if(typeof _!="object"||!("__html"in _))throw Error(b(61));if(u=_.__html,u!=null){if(E.children!=null)throw Error(b(60));i.innerHTML=u}}break;case"multiple":i.multiple=_&&typeof _!="function"&&typeof _!="symbol";break;case"muted":i.muted=_&&typeof _!="function"&&typeof _!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(_==null||typeof _=="function"||typeof _=="boolean"||typeof _=="symbol"){i.removeAttribute("xlink:href");break}u=pi(""+_),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":_!=null&&typeof _!="function"&&typeof _!="symbol"?i.setAttribute(u,""+_):i.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":_&&typeof _!="function"&&typeof _!="symbol"?i.setAttribute(u,""):i.removeAttribute(u);break;case"capture":case"download":_===!0?i.setAttribute(u,""):_!==!1&&_!=null&&typeof _!="function"&&typeof _!="symbol"?i.setAttribute(u,_):i.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":_!=null&&typeof _!="function"&&typeof _!="symbol"&&!isNaN(_)&&1<=_?i.setAttribute(u,_):i.removeAttribute(u);break;case"rowSpan":case"start":_==null||typeof _=="function"||typeof _=="symbol"||isNaN(_)?i.removeAttribute(u):i.setAttribute(u,_);break;case"popover":Ii("beforetoggle",i),Ii("toggle",i),pr(i,"popover",_);break;case"xlinkActuate":hs(i,"http://www.w3.org/1999/xlink","xlink:actuate",_);break;case"xlinkArcrole":hs(i,"http://www.w3.org/1999/xlink","xlink:arcrole",_);break;case"xlinkRole":hs(i,"http://www.w3.org/1999/xlink","xlink:role",_);break;case"xlinkShow":hs(i,"http://www.w3.org/1999/xlink","xlink:show",_);break;case"xlinkTitle":hs(i,"http://www.w3.org/1999/xlink","xlink:title",_);break;case"xlinkType":hs(i,"http://www.w3.org/1999/xlink","xlink:type",_);break;case"xmlBase":hs(i,"http://www.w3.org/XML/1998/namespace","xml:base",_);break;case"xmlLang":hs(i,"http://www.w3.org/XML/1998/namespace","xml:lang",_);break;case"xmlSpace":hs(i,"http://www.w3.org/XML/1998/namespace","xml:space",_);break;case"is":pr(i,"is",_);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=zs.get(u)||u,pr(i,u,_))}}function bu(i,s,u,_,E,I){switch(u){case"style":ao(i,_,I);break;case"dangerouslySetInnerHTML":if(_!=null){if(typeof _!="object"||!("__html"in _))throw Error(b(61));if(u=_.__html,u!=null){if(E.children!=null)throw Error(b(60));i.innerHTML=u}}break;case"children":typeof _=="string"?fs(i,_):(typeof _=="number"||typeof _=="bigint")&&fs(i,""+_);break;case"onScroll":_!=null&&Ii("scroll",i);break;case"onScrollEnd":_!=null&&Ii("scrollend",i);break;case"onClick":_!=null&&(i.onclick=aa);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Mc.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(E=u.endsWith("Capture"),s=u.slice(2,E?u.length-7:void 0),I=i[ti]||null,I=I!=null?I[u]:null,typeof I=="function"&&i.removeEventListener(s,I,E),typeof _=="function")){typeof I!="function"&&I!==null&&(u in i?i[u]=null:i.hasAttribute(u)&&i.removeAttribute(u)),i.addEventListener(s,_,E);break e}u in i?i[u]=_:_===!0?i.setAttribute(u,""):pr(i,u,_)}}}function Xn(i,s,u){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ii("error",i),Ii("load",i);var _=!1,E=!1,I;for(I in u)if(u.hasOwnProperty(I)){var q=u[I];if(q!=null)switch(I){case"src":_=!0;break;case"srcSet":E=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(b(137,s));default:Ui(i,s,I,q,u,null)}}E&&Ui(i,s,"srcSet",u.srcSet,u,null),_&&Ui(i,s,"src",u.src,u,null);return;case"input":Ii("invalid",i);var te=I=q=E=null,ve=null,qe=null;for(_ in u)if(u.hasOwnProperty(_)){var rt=u[_];if(rt!=null)switch(_){case"name":E=rt;break;case"type":q=rt;break;case"checked":ve=rt;break;case"defaultChecked":qe=rt;break;case"value":I=rt;break;case"defaultValue":te=rt;break;case"children":case"dangerouslySetInnerHTML":if(rt!=null)throw Error(b(137,s));break;default:Ui(i,s,_,rt,u,null)}}Go(i,I,te,ve,qe,q,E,!1),Du(i);return;case"select":Ii("invalid",i),_=q=I=null;for(E in u)if(u.hasOwnProperty(E)&&(te=u[E],te!=null))switch(E){case"value":I=te;break;case"defaultValue":q=te;break;case"multiple":_=te;default:Ui(i,s,E,te,u,null)}s=I,u=q,i.multiple=!!_,s!=null?ro(i,!!_,s,!1):u!=null&&ro(i,!!_,u,!0);return;case"textarea":Ii("invalid",i),I=E=_=null;for(q in u)if(u.hasOwnProperty(q)&&(te=u[q],te!=null))switch(q){case"value":_=te;break;case"defaultValue":E=te;break;case"children":I=te;break;case"dangerouslySetInnerHTML":if(te!=null)throw Error(b(91));break;default:Ui(i,s,q,te,u,null)}Zo(i,_,E,I),Du(i);return;case"option":for(ve in u)if(u.hasOwnProperty(ve)&&(_=u[ve],_!=null))switch(ve){case"selected":i.selected=_&&typeof _!="function"&&typeof _!="symbol";break;default:Ui(i,s,ve,_,u,null)}return;case"dialog":Ii("beforetoggle",i),Ii("toggle",i),Ii("cancel",i),Ii("close",i);break;case"iframe":case"object":Ii("load",i);break;case"video":case"audio":for(_=0;_<Td.length;_++)Ii(Td[_],i);break;case"image":Ii("error",i),Ii("load",i);break;case"details":Ii("toggle",i);break;case"embed":case"source":case"link":Ii("error",i),Ii("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(qe in u)if(u.hasOwnProperty(qe)&&(_=u[qe],_!=null))switch(qe){case"children":case"dangerouslySetInnerHTML":throw Error(b(137,s));default:Ui(i,s,qe,_,u,null)}return;default:if(ps(s)){for(rt in u)u.hasOwnProperty(rt)&&(_=u[rt],_!==void 0&&bu(i,s,rt,_,u,void 0));return}}for(te in u)u.hasOwnProperty(te)&&(_=u[te],_!=null&&Ui(i,s,te,_,u,null))}function Cg(i,s,u,_){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var E=null,I=null,q=null,te=null,ve=null,qe=null,rt=null;for(We in u){var ut=u[We];if(u.hasOwnProperty(We)&&ut!=null)switch(We){case"checked":break;case"value":break;case"defaultValue":ve=ut;default:_.hasOwnProperty(We)||Ui(i,s,We,null,_,ut)}}for(var He in _){var We=_[He];if(ut=u[He],_.hasOwnProperty(He)&&(We!=null||ut!=null))switch(He){case"type":I=We;break;case"name":E=We;break;case"checked":qe=We;break;case"defaultChecked":rt=We;break;case"value":q=We;break;case"defaultValue":te=We;break;case"children":case"dangerouslySetInnerHTML":if(We!=null)throw Error(b(137,s));break;default:We!==ut&&Ui(i,s,He,We,_,ut)}}Pc(i,q,te,ve,qe,rt,I,E);return;case"select":We=q=te=He=null;for(I in u)if(ve=u[I],u.hasOwnProperty(I)&&ve!=null)switch(I){case"value":break;case"multiple":We=ve;default:_.hasOwnProperty(I)||Ui(i,s,I,null,_,ve)}for(E in _)if(I=_[E],ve=u[E],_.hasOwnProperty(E)&&(I!=null||ve!=null))switch(E){case"value":He=I;break;case"defaultValue":te=I;break;case"multiple":q=I;default:I!==ve&&Ui(i,s,E,I,_,ve)}s=te,u=q,_=We,He!=null?ro(i,!!u,He,!1):!!_!=!!u&&(s!=null?ro(i,!!u,s,!0):ro(i,!!u,u?[]:"",!1));return;case"textarea":We=He=null;for(te in u)if(E=u[te],u.hasOwnProperty(te)&&E!=null&&!_.hasOwnProperty(te))switch(te){case"value":break;case"children":break;default:Ui(i,s,te,null,_,E)}for(q in _)if(E=_[q],I=u[q],_.hasOwnProperty(q)&&(E!=null||I!=null))switch(q){case"value":He=E;break;case"defaultValue":We=E;break;case"children":break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(b(91));break;default:E!==I&&Ui(i,s,q,E,_,I)}Kd(i,He,We);return;case"option":for(var li in u)if(He=u[li],u.hasOwnProperty(li)&&He!=null&&!_.hasOwnProperty(li))switch(li){case"selected":i.selected=!1;break;default:Ui(i,s,li,null,_,He)}for(ve in _)if(He=_[ve],We=u[ve],_.hasOwnProperty(ve)&&He!==We&&(He!=null||We!=null))switch(ve){case"selected":i.selected=He&&typeof He!="function"&&typeof He!="symbol";break;default:Ui(i,s,ve,He,_,We)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ai in u)He=u[ai],u.hasOwnProperty(ai)&&He!=null&&!_.hasOwnProperty(ai)&&Ui(i,s,ai,null,_,He);for(qe in _)if(He=_[qe],We=u[qe],_.hasOwnProperty(qe)&&He!==We&&(He!=null||We!=null))switch(qe){case"children":case"dangerouslySetInnerHTML":if(He!=null)throw Error(b(137,s));break;default:Ui(i,s,qe,He,_,We)}return;default:if(ps(s)){for(var hn in u)He=u[hn],u.hasOwnProperty(hn)&&He!==void 0&&!_.hasOwnProperty(hn)&&bu(i,s,hn,void 0,_,He);for(rt in _)He=_[rt],We=u[rt],!_.hasOwnProperty(rt)||He===We||He===void 0&&We===void 0||bu(i,s,rt,He,_,We);return}}for(var Be in u)He=u[Be],u.hasOwnProperty(Be)&&He!=null&&!_.hasOwnProperty(Be)&&Ui(i,s,Be,null,_,He);for(ut in _)He=_[ut],We=u[ut],!_.hasOwnProperty(ut)||He===We||He==null&&We==null||Ui(i,s,ut,He,_,We)}var jf=null,Ff=null;function Ad(i){return i.nodeType===9?i:i.ownerDocument}function Eg(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function lm(i,s){if(i===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&s==="foreignObject"?0:i}function ko(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Uf=null;function Mg(){var i=window.event;return i&&i.type==="popstate"?i===Uf?!1:(Uf=i,!0):(Uf=null,!1)}var cm=typeof setTimeout=="function"?setTimeout:void 0,Ag=typeof clearTimeout=="function"?clearTimeout:void 0,Pg=typeof Promise=="function"?Promise:void 0,D_=typeof queueMicrotask=="function"?queueMicrotask:typeof Pg<"u"?function(i){return Pg.resolve(null).then(i).catch(Rg)}:cm;function Rg(i){setTimeout(function(){throw i})}function wl(i){return i==="head"}function Pd(i,s){var u=s,_=0,E=0;do{var I=u.nextSibling;if(i.removeChild(u),I&&I.nodeType===8)if(u=I.data,u==="/$"){if(0<_&&8>_){u=_;var q=i.ownerDocument;if(u&1&&Su(q.documentElement),u&2&&Su(q.body),u&4)for(u=q.head,Su(u),q=u.firstChild;q;){var te=q.nextSibling,ve=q.nodeName;q[cs]||ve==="SCRIPT"||ve==="STYLE"||ve==="LINK"&&q.rel.toLowerCase()==="stylesheet"||u.removeChild(q),q=te}}if(E===0){i.removeChild(I),Un(s);return}E--}else u==="$"||u==="$?"||u==="$!"?E++:_=u.charCodeAt(0)-48;else _=0;u=I}while(u);Un(s)}function Vf(i){var s=i.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var u=s;switch(s=s.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":Vf(u),Tt(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}i.removeChild(u)}}function Gf(i,s,u,_){for(;i.nodeType===1;){var E=u;if(i.nodeName.toLowerCase()!==s.toLowerCase()){if(!_&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(_){if(!i[cs])switch(s){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(I=i.getAttribute("rel"),I==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(I!==E.rel||i.getAttribute("href")!==(E.href==null||E.href===""?null:E.href)||i.getAttribute("crossorigin")!==(E.crossOrigin==null?null:E.crossOrigin)||i.getAttribute("title")!==(E.title==null?null:E.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(I=i.getAttribute("src"),(I!==(E.src==null?null:E.src)||i.getAttribute("type")!==(E.type==null?null:E.type)||i.getAttribute("crossorigin")!==(E.crossOrigin==null?null:E.crossOrigin))&&I&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(s==="input"&&i.type==="hidden"){var I=E.name==null?null:""+E.name;if(E.type==="hidden"&&i.getAttribute("name")===I)return i}else return i;if(i=Qs(i.nextSibling),i===null)break}return null}function Zf(i,s,u){if(s==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!u||(i=Qs(i.nextSibling),i===null))return null;return i}function mh(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState==="complete"}function k_(i,s){var u=i.ownerDocument;if(i.data!=="$?"||u.readyState==="complete")s();else{var _=function(){s(),u.removeEventListener("DOMContentLoaded",_)};u.addEventListener("DOMContentLoaded",_),i._reactRetry=_}}function Qs(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return i}var um=null;function wu(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var u=i.data;if(u==="$"||u==="$!"||u==="$?"){if(s===0)return i;s--}else u==="/$"&&s++}i=i.previousSibling}return null}function wr(i,s,u){switch(s=Ad(u),i){case"html":if(i=s.documentElement,!i)throw Error(b(452));return i;case"head":if(i=s.head,!i)throw Error(b(453));return i;case"body":if(i=s.body,!i)throw Error(b(454));return i;default:throw Error(b(451))}}function Su(i){for(var s=i.attributes;s.length;)i.removeAttributeNode(s[0]);Tt(i)}var ss=new Map,hm=new Set;function gh(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Sl=it.d;it.d={f:zg,r:Ig,D:fm,C:pm,L:Dg,m:Rd,X:kg,S:mm,M:gm};function zg(){var i=Sl.f(),s=Rf();return i||s}function Ig(i){var s=ri(i);s!==null&&s.tag===5&&s.type==="form"?$i(s):Sl.r(i)}var _h=typeof document>"u"?null:document;function dm(i,s,u){var _=_h;if(_&&typeof s=="string"&&s){var E=ia(s);E='link[rel="'+i+'"][href="'+E+'"]',typeof u=="string"&&(E+='[crossorigin="'+u+'"]'),hm.has(E)||(hm.add(E),i={rel:i,crossOrigin:u,href:s},_.querySelector(E)===null&&(s=_.createElement("link"),Xn(s,"link",i),pn(s),_.head.appendChild(s)))}}function fm(i){Sl.D(i),dm("dns-prefetch",i,null)}function pm(i,s){Sl.C(i,s),dm("preconnect",i,s)}function Dg(i,s,u){Sl.L(i,s,u);var _=_h;if(_&&i&&s){var E='link[rel="preload"][as="'+ia(s)+'"]';s==="image"&&u&&u.imageSrcSet?(E+='[imagesrcset="'+ia(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(E+='[imagesizes="'+ia(u.imageSizes)+'"]')):E+='[href="'+ia(i)+'"]';var I=E;switch(s){case"style":I=Lo(i);break;case"script":I=yh(i)}ss.has(I)||(i=Z({rel:"preload",href:s==="image"&&u&&u.imageSrcSet?void 0:i,as:s},u),ss.set(I,i),_.querySelector(E)!==null||s==="style"&&_.querySelector(Tu(I))||s==="script"&&_.querySelector(r(I))||(s=_.createElement("link"),Xn(s,"link",i),pn(s),_.head.appendChild(s)))}}function Rd(i,s){Sl.m(i,s);var u=_h;if(u&&i){var _=s&&typeof s.as=="string"?s.as:"script",E='link[rel="modulepreload"][as="'+ia(_)+'"][href="'+ia(i)+'"]',I=E;switch(_){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":I=yh(i)}if(!ss.has(I)&&(i=Z({rel:"modulepreload",href:i},s),ss.set(I,i),u.querySelector(E)===null)){switch(_){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(r(I)))return}_=u.createElement("link"),Xn(_,"link",i),pn(_),u.head.appendChild(_)}}}function mm(i,s,u){Sl.S(i,s,u);var _=_h;if(_&&i){var E=Ta(_).hoistableStyles,I=Lo(i);s=s||"default";var q=E.get(I);if(!q){var te={loading:0,preload:null};if(q=_.querySelector(Tu(I)))te.loading=5;else{i=Z({rel:"stylesheet",href:i,"data-precedence":s},u),(u=ss.get(I))&&l(i,u);var ve=q=_.createElement("link");pn(ve),Xn(ve,"link",i),ve._p=new Promise(function(qe,rt){ve.onload=qe,ve.onerror=rt}),ve.addEventListener("load",function(){te.loading|=1}),ve.addEventListener("error",function(){te.loading|=2}),te.loading|=4,n(q,s,_)}q={type:"stylesheet",instance:q,count:1,state:te},E.set(I,q)}}}function kg(i,s){Sl.X(i,s);var u=_h;if(u&&i){var _=Ta(u).hoistableScripts,E=yh(i),I=_.get(E);I||(I=u.querySelector(r(E)),I||(i=Z({src:i,async:!0},s),(s=ss.get(E))&&d(i,s),I=u.createElement("script"),pn(I),Xn(I,"link",i),u.head.appendChild(I)),I={type:"script",instance:I,count:1,state:null},_.set(E,I))}}function gm(i,s){Sl.M(i,s);var u=_h;if(u&&i){var _=Ta(u).hoistableScripts,E=yh(i),I=_.get(E);I||(I=u.querySelector(r(E)),I||(i=Z({src:i,async:!0,type:"module"},s),(s=ss.get(E))&&d(i,s),I=u.createElement("script"),pn(I),Xn(I,"link",i),u.head.appendChild(I)),I={type:"script",instance:I,count:1,state:null},_.set(E,I))}}function zd(i,s,u,_){var E=(E=kt.current)?gh(E):null;if(!E)throw Error(b(446));switch(i){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(s=Lo(u.href),u=Ta(E).hoistableStyles,_=u.get(s),_||(_={type:"style",instance:null,count:0,state:null},u.set(s,_)),_):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){i=Lo(u.href);var I=Ta(E).hoistableStyles,q=I.get(i);if(q||(E=E.ownerDocument||E,q={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},I.set(i,q),(I=E.querySelector(Tu(i)))&&!I._p&&(q.instance=I,q.state.loading=5),ss.has(i)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},ss.set(i,u),I||_m(E,i,u,q.state))),s&&_===null)throw Error(b(528,""));return q}if(s&&_!==null)throw Error(b(529,""));return null;case"script":return s=u.async,u=u.src,typeof u=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=yh(u),u=Ta(E).hoistableScripts,_=u.get(s),_||(_={type:"script",instance:null,count:0,state:null},u.set(s,_)),_):{type:"void",instance:null,count:0,state:null};default:throw Error(b(444,i))}}function Lo(i){return'href="'+ia(i)+'"'}function Tu(i){return'link[rel="stylesheet"]['+i+"]"}function qf(i){return Z({},i,{"data-precedence":i.precedence,precedence:null})}function _m(i,s,u,_){i.querySelector('link[rel="preload"][as="style"]['+s+"]")?_.loading=1:(s=i.createElement("link"),_.preload=s,s.addEventListener("load",function(){return _.loading|=1}),s.addEventListener("error",function(){return _.loading|=2}),Xn(s,"link",u),pn(s),i.head.appendChild(s))}function yh(i){return'[src="'+ia(i)+'"]'}function r(i){return"script[async]"+i}function t(i,s,u){if(s.count++,s.instance===null)switch(s.type){case"style":var _=i.querySelector('style[data-href~="'+ia(u.href)+'"]');if(_)return s.instance=_,pn(_),_;var E=Z({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return _=(i.ownerDocument||i).createElement("style"),pn(_),Xn(_,"style",E),n(_,u.precedence,i),s.instance=_;case"stylesheet":E=Lo(u.href);var I=i.querySelector(Tu(E));if(I)return s.state.loading|=4,s.instance=I,pn(I),I;_=qf(u),(E=ss.get(E))&&l(_,E),I=(i.ownerDocument||i).createElement("link"),pn(I);var q=I;return q._p=new Promise(function(te,ve){q.onload=te,q.onerror=ve}),Xn(I,"link",_),s.state.loading|=4,n(I,u.precedence,i),s.instance=I;case"script":return I=yh(u.src),(E=i.querySelector(r(I)))?(s.instance=E,pn(E),E):(_=u,(E=ss.get(I))&&(_=Z({},u),d(_,E)),i=i.ownerDocument||i,E=i.createElement("script"),pn(E),Xn(E,"link",_),i.head.appendChild(E),s.instance=E);case"void":return null;default:throw Error(b(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(_=s.instance,s.state.loading|=4,n(_,u.precedence,i));return s.instance}function n(i,s,u){for(var _=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),E=_.length?_[_.length-1]:null,I=E,q=0;q<_.length;q++){var te=_[q];if(te.dataset.precedence===s)I=te;else if(I!==E)break}I?I.parentNode.insertBefore(i,I.nextSibling):(s=u.nodeType===9?u.head:u,s.insertBefore(i,s.firstChild))}function l(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.title==null&&(i.title=s.title)}function d(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.integrity==null&&(i.integrity=s.integrity)}var v=null;function x(i,s,u){if(v===null){var _=new Map,E=v=new Map;E.set(u,_)}else E=v,_=E.get(u),_||(_=new Map,E.set(u,_));if(_.has(i))return _;for(_.set(i,null),u=u.getElementsByTagName(i),E=0;E<u.length;E++){var I=u[E];if(!(I[cs]||I[Wt]||i==="link"&&I.getAttribute("rel")==="stylesheet")&&I.namespaceURI!=="http://www.w3.org/2000/svg"){var q=I.getAttribute(s)||"";q=i+q;var te=_.get(q);te?te.push(I):_.set(q,[I])}}return _}function S(i,s,u){i=i.ownerDocument||i,i.head.insertBefore(u,s==="title"?i.querySelector("head > title"):null)}function M(i,s,u){if(u===1||s.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return i=s.disabled,typeof s.precedence=="string"&&i==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function z(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}var D=null;function B(){}function V(i,s,u){if(D===null)throw Error(b(475));var _=D;if(s.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var E=Lo(u.href),I=i.querySelector(Tu(E));if(I){i=I._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(_.count++,_=H.bind(_),i.then(_,_)),s.state.loading|=4,s.instance=I,pn(I);return}I=i.ownerDocument||i,u=qf(u),(E=ss.get(E))&&l(u,E),I=I.createElement("link"),pn(I);var q=I;q._p=new Promise(function(te,ve){q.onload=te,q.onerror=ve}),Xn(I,"link",u),s.instance=I}_.stylesheets===null&&(_.stylesheets=new Map),_.stylesheets.set(s,i),(i=s.state.preload)&&(s.state.loading&3)===0&&(_.count++,s=H.bind(_),i.addEventListener("load",s),i.addEventListener("error",s))}}function $(){if(D===null)throw Error(b(475));var i=D;return i.stylesheets&&i.count===0&&ne(i,i.stylesheets),0<i.count?function(s){var u=setTimeout(function(){if(i.stylesheets&&ne(i,i.stylesheets),i.unsuspend){var _=i.unsuspend;i.unsuspend=null,_()}},6e4);return i.unsuspend=s,function(){i.unsuspend=null,clearTimeout(u)}}:null}function H(){if(this.count--,this.count===0){if(this.stylesheets)ne(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var K=null;function ne(i,s){i.stylesheets=null,i.unsuspend!==null&&(i.count++,K=new Map,s.forEach(ce,i),K=null,H.call(i))}function ce(i,s){if(!(s.state.loading&4)){var u=K.get(i);if(u)var _=u.get(null);else{u=new Map,K.set(i,u);for(var E=i.querySelectorAll("link[data-precedence],style[data-precedence]"),I=0;I<E.length;I++){var q=E[I];(q.nodeName==="LINK"||q.getAttribute("media")!=="not all")&&(u.set(q.dataset.precedence,q),_=q)}_&&u.set(null,_)}E=s.instance,q=E.getAttribute("data-precedence"),I=u.get(q)||_,I===_&&u.set(null,E),u.set(q,E),this.count++,_=H.bind(this),E.addEventListener("load",_),E.addEventListener("error",_),I?I.parentNode.insertBefore(E,I.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(E,i.firstChild)),s.state.loading|=4}}var Ae={$$typeof:Ee,Provider:null,Consumer:null,_currentValue:Xe,_currentValue2:Xe,_threadCount:0};function _e(i,s,u,_,E,I,q,te){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=It(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=It(0),this.hiddenUpdates=It(null),this.identifierPrefix=_,this.onUncaughtError=E,this.onCaughtError=I,this.onRecoverableError=q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=te,this.incompleteTransitions=new Map}function xe(i,s,u,_,E,I,q,te,ve,qe,rt,ut){return i=new _e(i,s,u,q,te,ve,qe,ut),s=1,I===!0&&(s|=24),I=da(3,null,null,s),i.current=I,I.stateNode=i,s=vo(),s.refCount++,i.pooledCache=s,s.refCount++,I.memoizedState={element:_,isDehydrated:u,cache:s},id(I),i}function Ue(i){return i?(i=fi,i):fi}function Ye(i,s,u,_,E,I){E=Ue(E),_.context===null?_.context=E:_.pendingContext=E,_=xo(s),_.payload={element:u},I=I===void 0?null:I,I!==null&&(_.callback=I),u=Us(i,_,s),u!==null&&(rs(u,i,s),cl(u,i,s))}function ot(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var u=i.retryLane;i.retryLane=u!==0&&u<s?u:s}}function xt(i,s){ot(i,s),(i=i.alternate)&&ot(i,s)}function gt(i){if(i.tag===13){var s=ha(i,67108864);s!==null&&rs(s,i,67108864),xt(i,67108864)}}var yt=!0;function Ot(i,s,u,_){var E=Oe.T;Oe.T=null;var I=it.p;try{it.p=2,vt(i,s,u,_)}finally{it.p=I,Oe.T=E}}function bt(i,s,u,_){var E=Oe.T;Oe.T=null;var I=it.p;try{it.p=8,vt(i,s,u,_)}finally{it.p=I,Oe.T=E}}function vt(i,s,u,_){if(yt){var E=et(_);if(E===null)Bf(i,s,_,Xt,u),yn(i,_);else if(Tr(E,i,s,u,_))_.stopPropagation();else if(yn(i,_),s&4&&-1<Sr.indexOf(i)){for(;E!==null;){var I=ri(E);if(I!==null)switch(I.tag){case 3:if(I=I.stateNode,I.current.memoizedState.isDehydrated){var q=Pe(I.pendingLanes);if(q!==0){var te=I;for(te.pendingLanes|=2,te.entangledLanes|=2;q;){var ve=1<<31-Me(q);te.entanglements[1]|=ve,q&=~ve}as(I),(nn&6)===0&&(Mf=zn()+500,vu(0))}}break;case 13:te=ha(I,2),te!==null&&rs(te,I,2),Rf(),xt(I,2)}if(I=et(_),I===null&&Bf(i,s,_,Xt,u),I===E)break;E=I}E!==null&&_.stopPropagation()}else Bf(i,s,_,null,u)}}function et(i){return i=Il(i),Qt(i)}var Xt=null;function Qt(i){if(Xt=null,i=ci(i),i!==null){var s=R(i);if(s===null)i=null;else{var u=s.tag;if(u===13){if(i=T(s),i!==null)return i;i=null}else if(u===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null)}}return Xt=i,null}function Ut(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(wa()){case Ar:return 2;case jo:return 8;case Za:case io:return 32;case As:return 268435456;default:return 32}default:return 32}}var zt=!1,di=null,Hi=null,un=null,er=new Map,Jr=new Map,tr=[],Sr="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function yn(i,s){switch(i){case"focusin":case"focusout":di=null;break;case"dragenter":case"dragleave":Hi=null;break;case"mouseover":case"mouseout":un=null;break;case"pointerover":case"pointerout":er.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Jr.delete(s.pointerId)}}function jn(i,s,u,_,E,I){return i===null||i.nativeEvent!==I?(i={blockedOn:s,domEventName:u,eventSystemFlags:_,nativeEvent:I,targetContainers:[E]},s!==null&&(s=ri(s),s!==null&&gt(s)),i):(i.eventSystemFlags|=_,s=i.targetContainers,E!==null&&s.indexOf(E)===-1&&s.push(E),i)}function Tr(i,s,u,_,E){switch(s){case"focusin":return di=jn(di,i,s,u,_,E),!0;case"dragenter":return Hi=jn(Hi,i,s,u,_,E),!0;case"mouseover":return un=jn(un,i,s,u,_,E),!0;case"pointerover":var I=E.pointerId;return er.set(I,jn(er.get(I)||null,i,s,u,_,E)),!0;case"gotpointercapture":return I=E.pointerId,Jr.set(I,jn(Jr.get(I)||null,i,s,u,_,E)),!0}return!1}function ur(i){var s=ci(i.target);if(s!==null){var u=R(s);if(u!==null){if(s=u.tag,s===13){if(s=T(u),s!==null){i.blockedOn=s,ir(i.priority,function(){if(u.tag===13){var _=Na();_=si(_);var E=ha(u,_);E!==null&&rs(E,u,_),xt(u,_)}});return}}else if(s===3&&u.stateNode.current.memoizedState.isDehydrated){i.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Cr(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var u=et(i.nativeEvent);if(u===null){u=i.nativeEvent;var _=new u.constructor(u.type,u);Is=_,u.target.dispatchEvent(_),Is=null}else return s=ri(u),s!==null&&gt(s),i.blockedOn=u,!1;s.shift()}return!0}function Fa(i,s,u){Cr(i)&&u.delete(s)}function hr(){zt=!1,di!==null&&Cr(di)&&(di=null),Hi!==null&&Cr(Hi)&&(Hi=null),un!==null&&Cr(un)&&(un=null),er.forEach(Fa),Jr.forEach(Fa)}function Vr(i,s){i.blockedOn===s&&(i.blockedOn=null,zt||(zt=!0,p.unstable_scheduleCallback(p.unstable_NormalPriority,hr)))}var Fn=null;function or(i){Fn!==i&&(Fn=i,p.unstable_scheduleCallback(p.unstable_NormalPriority,function(){Fn===i&&(Fn=null);for(var s=0;s<i.length;s+=3){var u=i[s],_=i[s+1],E=i[s+2];if(typeof _!="function"){if(Qt(_||u)===null)continue;break}var I=ri(u);I!==null&&(i.splice(s,3),s-=3,gn(I,{pending:!0,data:E,method:u.method,action:_},_,E))}}))}function Un(i){function s(ve){return Vr(ve,i)}di!==null&&Vr(di,i),Hi!==null&&Vr(Hi,i),un!==null&&Vr(un,i),er.forEach(s),Jr.forEach(s);for(var u=0;u<tr.length;u++){var _=tr[u];_.blockedOn===i&&(_.blockedOn=null)}for(;0<tr.length&&(u=tr[0],u.blockedOn===null);)ur(u),u.blockedOn===null&&tr.shift();if(u=(i.ownerDocument||i).$$reactFormReplay,u!=null)for(_=0;_<u.length;_+=3){var E=u[_],I=u[_+1],q=E[ti]||null;if(typeof I=="function")q||or(u);else if(q){var te=null;if(I&&I.hasAttribute("formAction")){if(E=I,q=I[ti]||null)te=q.formAction;else if(Qt(E)!==null)continue}else te=q.action;typeof te=="function"?u[_+1]=te:(u.splice(_,3),_-=3),or(u)}}}function Vn(i){this._internalRoot=i}Qi.prototype.render=Vn.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(b(409));var u=s.current,_=Na();Ye(u,_,i,s,null,null)},Qi.prototype.unmount=Vn.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;Ye(i.current,2,null,i,null,null),Rf(),s[fn]=null}};function Qi(i){this._internalRoot=i}Qi.prototype.unstable_scheduleHydration=function(i){if(i){var s=Wn();i={blockedOn:null,target:i,priority:s};for(var u=0;u<tr.length&&s!==0&&s<tr[u].priority;u++);tr.splice(u,0,i),u===0&&ur(i)}};var Ts=h.version;if(Ts!=="19.1.1")throw Error(b(527,Ts,"19.1.1"));it.findDOMNode=function(i){var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(b(188)):(i=Object.keys(i).join(","),Error(b(268,i)));return i=L(s),i=i!==null?N(i):null,i=i===null?null:i.stateNode,i};var vh={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:Oe,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ua=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ua.isDisabled&&Ua.supportsFiber)try{Sa=Ua.inject(vh),Yn=Ua}catch{}}return vm.createRoot=function(i,s){if(!C(i))throw Error(b(299));var u=!1,_="",E=Gm,I=mf,q=Zm,te=null;return s!=null&&(s.unstable_strictMode===!0&&(u=!0),s.identifierPrefix!==void 0&&(_=s.identifierPrefix),s.onUncaughtError!==void 0&&(E=s.onUncaughtError),s.onCaughtError!==void 0&&(I=s.onCaughtError),s.onRecoverableError!==void 0&&(q=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(te=s.unstable_transitionCallbacks)),s=xe(i,1,!1,null,null,u,_,E,I,q,te,null),i[fn]=s.current,Of(i),new Vn(s)},vm.hydrateRoot=function(i,s,u){if(!C(i))throw Error(b(299));var _=!1,E="",I=Gm,q=mf,te=Zm,ve=null,qe=null;return u!=null&&(u.unstable_strictMode===!0&&(_=!0),u.identifierPrefix!==void 0&&(E=u.identifierPrefix),u.onUncaughtError!==void 0&&(I=u.onUncaughtError),u.onCaughtError!==void 0&&(q=u.onCaughtError),u.onRecoverableError!==void 0&&(te=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(ve=u.unstable_transitionCallbacks),u.formState!==void 0&&(qe=u.formState)),s=xe(i,1,!0,s,u??null,_,E,I,q,te,ve,qe),s.context=Ue(null),u=s.current,_=Na(),_=si(_),E=xo(_),E.callback=null,Us(u,E,_),u=_,s.current.lanes=u,Ie(s,u),as(s),i[fn]=s.current,Of(i),new Qi(s)},vm.version="19.1.1",vm}var _v;function _1(){if(_v)return j_.exports;_v=1;function p(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(p)}catch(h){console.error(h)}}return p(),j_.exports=g1(),j_.exports}var y1=_1(),Nm=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(p){return this.listeners.add(p),this.onSubscribe(),()=>{this.listeners.delete(p),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Zd=typeof window>"u"||"Deno"in globalThis;function Es(){}function v1(p,h){return typeof p=="function"?p(h):p}function ty(p){return typeof p=="number"&&p>=0&&p!==1/0}function Vx(p,h){return Math.max(p+(h||0)-Date.now(),0)}function zh(p,h){return typeof p=="function"?p(h):p}function Bo(p,h){return typeof p=="function"?p(h):p}function yv(p,h){const{type:g="all",exact:b,fetchStatus:C,predicate:R,queryKey:T,stale:o}=p;if(T){if(b){if(h.queryHash!==jy(T,h.options))return!1}else if(!Am(h.queryKey,T))return!1}if(g!=="all"){const L=h.isActive();if(g==="active"&&!L||g==="inactive"&&L)return!1}return!(typeof o=="boolean"&&h.isStale()!==o||C&&C!==h.state.fetchStatus||R&&!R(h))}function vv(p,h){const{exact:g,status:b,predicate:C,mutationKey:R}=p;if(R){if(!h.options.mutationKey)return!1;if(g){if(Mm(h.options.mutationKey)!==Mm(R))return!1}else if(!Am(h.options.mutationKey,R))return!1}return!(b&&h.state.status!==b||C&&!C(h))}function jy(p,h){return((h==null?void 0:h.queryKeyHashFn)||Mm)(p)}function Mm(p){return JSON.stringify(p,(h,g)=>ny(g)?Object.keys(g).sort().reduce((b,C)=>(b[C]=g[C],b),{}):g)}function Am(p,h){return p===h?!0:typeof p!=typeof h?!1:p&&h&&typeof p=="object"&&typeof h=="object"?Object.keys(h).every(g=>Am(p[g],h[g])):!1}var x1=Object.prototype.hasOwnProperty;function Gx(p,h){if(p===h)return p;const g=xv(p)&&xv(h);if(!g&&!(ny(p)&&ny(h)))return h;const C=(g?p:Object.keys(p)).length,R=g?h:Object.keys(h),T=R.length,o=g?new Array(T):{};let L=0;for(let N=0;N<T;N++){const Z=g?N:R[N],Y=p[Z],ee=h[Z];if(Y===ee){o[Z]=Y,(g?N<C:x1.call(p,Z))&&L++;continue}if(Y===null||ee===null||typeof Y!="object"||typeof ee!="object"){o[Z]=ee;continue}const U=Gx(Y,ee);o[Z]=U,U===Y&&L++}return C===T&&L===C?p:o}function iy(p,h){if(!h||Object.keys(p).length!==Object.keys(h).length)return!1;for(const g in p)if(p[g]!==h[g])return!1;return!0}function xv(p){return Array.isArray(p)&&p.length===Object.keys(p).length}function ny(p){if(!bv(p))return!1;const h=p.constructor;if(h===void 0)return!0;const g=h.prototype;return!(!bv(g)||!g.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(p)!==Object.prototype)}function bv(p){return Object.prototype.toString.call(p)==="[object Object]"}function b1(p){return new Promise(h=>{setTimeout(h,p)})}function ry(p,h,g){return typeof g.structuralSharing=="function"?g.structuralSharing(p,h):g.structuralSharing!==!1?Gx(p,h):h}function w1(p,h,g=0){const b=[...p,h];return g&&b.length>g?b.slice(1):b}function S1(p,h,g=0){const b=[h,...p];return g&&b.length>g?b.slice(0,-1):b}var Fy=Symbol();function Zx(p,h){return!p.queryFn&&(h!=null&&h.initialPromise)?()=>h.initialPromise:!p.queryFn||p.queryFn===Fy?()=>Promise.reject(new Error(`Missing queryFn: '${p.queryHash}'`)):p.queryFn}function T1(p,h){return typeof p=="function"?p(...h):!!p}var Ld,Th,tp,Rx,C1=(Rx=class extends Nm{constructor(){super();mi(this,Ld);mi(this,Th);mi(this,tp);Zt(this,tp,h=>{if(!Zd&&window.addEventListener){const g=()=>h();return window.addEventListener("visibilitychange",g,!1),()=>{window.removeEventListener("visibilitychange",g)}}})}onSubscribe(){Le(this,Th)||this.setEventListener(Le(this,tp))}onUnsubscribe(){var h;this.hasListeners()||((h=Le(this,Th))==null||h.call(this),Zt(this,Th,void 0))}setEventListener(h){var g;Zt(this,tp,h),(g=Le(this,Th))==null||g.call(this),Zt(this,Th,h(b=>{typeof b=="boolean"?this.setFocused(b):this.onFocus()}))}setFocused(h){Le(this,Ld)!==h&&(Zt(this,Ld,h),this.onFocus())}onFocus(){const h=this.isFocused();this.listeners.forEach(g=>{g(h)})}isFocused(){var h;return typeof Le(this,Ld)=="boolean"?Le(this,Ld):((h=globalThis.document)==null?void 0:h.visibilityState)!=="hidden"}},Ld=new WeakMap,Th=new WeakMap,tp=new WeakMap,Rx),Uy=new C1,ip,Ch,np,zx,E1=(zx=class extends Nm{constructor(){super();mi(this,ip,!0);mi(this,Ch);mi(this,np);Zt(this,np,h=>{if(!Zd&&window.addEventListener){const g=()=>h(!0),b=()=>h(!1);return window.addEventListener("online",g,!1),window.addEventListener("offline",b,!1),()=>{window.removeEventListener("online",g),window.removeEventListener("offline",b)}}})}onSubscribe(){Le(this,Ch)||this.setEventListener(Le(this,np))}onUnsubscribe(){var h;this.hasListeners()||((h=Le(this,Ch))==null||h.call(this),Zt(this,Ch,void 0))}setEventListener(h){var g;Zt(this,np,h),(g=Le(this,Ch))==null||g.call(this),Zt(this,Ch,h(this.setOnline.bind(this)))}setOnline(h){Le(this,ip)!==h&&(Zt(this,ip,h),this.listeners.forEach(b=>{b(h)}))}isOnline(){return Le(this,ip)}},ip=new WeakMap,Ch=new WeakMap,np=new WeakMap,zx),Kg=new E1;function ay(){let p,h;const g=new Promise((C,R)=>{p=C,h=R});g.status="pending",g.catch(()=>{});function b(C){Object.assign(g,C),delete g.resolve,delete g.reject}return g.resolve=C=>{b({status:"fulfilled",value:C}),p(C)},g.reject=C=>{b({status:"rejected",reason:C}),h(C)},g}function M1(p){return Math.min(1e3*2**p,3e4)}function qx(p){return(p??"online")==="online"?Kg.isOnline():!0}var sy=class extends Error{constructor(p){super("CancelledError"),this.revert=p==null?void 0:p.revert,this.silent=p==null?void 0:p.silent}};function $x(p){let h=!1,g=0,b;const C=ay(),R=()=>C.status!=="pending",T=ie=>{var me;if(!R()){const Ce=new sy(ie);ee(Ce),(me=p.onCancel)==null||me.call(p,Ce)}},o=()=>{h=!0},L=()=>{h=!1},N=()=>Uy.isFocused()&&(p.networkMode==="always"||Kg.isOnline())&&p.canRun(),Z=()=>qx(p.networkMode)&&p.canRun(),Y=ie=>{R()||(b==null||b(),C.resolve(ie))},ee=ie=>{R()||(b==null||b(),C.reject(ie))},U=()=>new Promise(ie=>{var me;b=Ce=>{(R()||N())&&ie(Ce)},(me=p.onPause)==null||me.call(p)}).then(()=>{var ie;b=void 0,R()||(ie=p.onContinue)==null||ie.call(p)}),le=()=>{if(R())return;let ie;const me=g===0?p.initialPromise:void 0;try{ie=me??p.fn()}catch(Ce){ie=Promise.reject(Ce)}Promise.resolve(ie).then(Y).catch(Ce=>{var ct;if(R())return;const Se=p.retry??(Zd?0:3),Ee=p.retryDelay??M1,ke=typeof Ee=="function"?Ee(g,Ce):Ee,Ve=Se===!0||typeof Se=="number"&&g<Se||typeof Se=="function"&&Se(g,Ce);if(h||!Ve){ee(Ce);return}g++,(ct=p.onFail)==null||ct.call(p,g,Ce),b1(ke).then(()=>N()?void 0:U()).then(()=>{h?ee(Ce):le()})})};return{promise:C,status:()=>C.status,cancel:T,continue:()=>(b==null||b(),C),cancelRetry:o,continueRetry:L,canStart:Z,start:()=>(Z()?le():U().then(le),C)}}var A1=p=>setTimeout(p,0);function P1(){let p=[],h=0,g=o=>{o()},b=o=>{o()},C=A1;const R=o=>{h?p.push(o):C(()=>{g(o)})},T=()=>{const o=p;p=[],o.length&&C(()=>{b(()=>{o.forEach(L=>{g(L)})})})};return{batch:o=>{let L;h++;try{L=o()}finally{h--,h||T()}return L},batchCalls:o=>(...L)=>{R(()=>{o(...L)})},schedule:R,setNotifyFunction:o=>{g=o},setBatchNotifyFunction:o=>{b=o},setScheduler:o=>{C=o}}}var xa=P1(),Od,Ix,Hx=(Ix=class{constructor(){mi(this,Od)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),ty(this.gcTime)&&Zt(this,Od,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(p){this.gcTime=Math.max(this.gcTime||0,p??(Zd?1/0:300*1e3))}clearGcTimeout(){Le(this,Od)&&(clearTimeout(Le(this,Od)),Zt(this,Od,void 0))}},Od=new WeakMap,Ix),rp,ap,Oo,Bd,sa,km,Nd,El,Eu,Dx,R1=(Dx=class extends Hx{constructor(h){super();mi(this,El);mi(this,rp);mi(this,ap);mi(this,Oo);mi(this,Bd);mi(this,sa);mi(this,km);mi(this,Nd);Zt(this,Nd,!1),Zt(this,km,h.defaultOptions),this.setOptions(h.options),this.observers=[],Zt(this,Bd,h.client),Zt(this,Oo,Le(this,Bd).getQueryCache()),this.queryKey=h.queryKey,this.queryHash=h.queryHash,Zt(this,rp,z1(this.options)),this.state=h.state??Le(this,rp),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var h;return(h=Le(this,sa))==null?void 0:h.promise}setOptions(h){this.options={...Le(this,km),...h},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&Le(this,Oo).remove(this)}setData(h,g){const b=ry(this.state.data,h,this.options);return Vi(this,El,Eu).call(this,{data:b,type:"success",dataUpdatedAt:g==null?void 0:g.updatedAt,manual:g==null?void 0:g.manual}),b}setState(h,g){Vi(this,El,Eu).call(this,{type:"setState",state:h,setStateOptions:g})}cancel(h){var b,C;const g=(b=Le(this,sa))==null?void 0:b.promise;return(C=Le(this,sa))==null||C.cancel(h),g?g.then(Es).catch(Es):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Le(this,rp))}isActive(){return this.observers.some(h=>Bo(h.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Fy||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(h=>zh(h.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(h=>h.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(h=0){return this.state.data===void 0?!0:h==="static"?!1:this.state.isInvalidated?!0:!Vx(this.state.dataUpdatedAt,h)}onFocus(){var g;const h=this.observers.find(b=>b.shouldFetchOnWindowFocus());h==null||h.refetch({cancelRefetch:!1}),(g=Le(this,sa))==null||g.continue()}onOnline(){var g;const h=this.observers.find(b=>b.shouldFetchOnReconnect());h==null||h.refetch({cancelRefetch:!1}),(g=Le(this,sa))==null||g.continue()}addObserver(h){this.observers.includes(h)||(this.observers.push(h),this.clearGcTimeout(),Le(this,Oo).notify({type:"observerAdded",query:this,observer:h}))}removeObserver(h){this.observers.includes(h)&&(this.observers=this.observers.filter(g=>g!==h),this.observers.length||(Le(this,sa)&&(Le(this,Nd)?Le(this,sa).cancel({revert:!0}):Le(this,sa).cancelRetry()),this.scheduleGc()),Le(this,Oo).notify({type:"observerRemoved",query:this,observer:h}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Vi(this,El,Eu).call(this,{type:"invalidate"})}async fetch(h,g){var L,N,Z,Y,ee,U,le,ie,me,Ce,Se,Ee;if(this.state.fetchStatus!=="idle"&&((L=Le(this,sa))==null?void 0:L.status())!=="rejected"){if(this.state.data!==void 0&&(g!=null&&g.cancelRefetch))this.cancel({silent:!0});else if(Le(this,sa))return Le(this,sa).continueRetry(),Le(this,sa).promise}if(h&&this.setOptions(h),!this.options.queryFn){const ke=this.observers.find(Ve=>Ve.options.queryFn);ke&&this.setOptions(ke.options)}const b=new AbortController,C=ke=>{Object.defineProperty(ke,"signal",{enumerable:!0,get:()=>(Zt(this,Nd,!0),b.signal)})},R=()=>{const ke=Zx(this.options,g),ct=(()=>{const tt={client:Le(this,Bd),queryKey:this.queryKey,meta:this.meta};return C(tt),tt})();return Zt(this,Nd,!1),this.options.persister?this.options.persister(ke,ct,this):ke(ct)},o=(()=>{const ke={fetchOptions:g,options:this.options,queryKey:this.queryKey,client:Le(this,Bd),state:this.state,fetchFn:R};return C(ke),ke})();(N=this.options.behavior)==null||N.onFetch(o,this),Zt(this,ap,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((Z=o.fetchOptions)==null?void 0:Z.meta))&&Vi(this,El,Eu).call(this,{type:"fetch",meta:(Y=o.fetchOptions)==null?void 0:Y.meta}),Zt(this,sa,$x({initialPromise:g==null?void 0:g.initialPromise,fn:o.fetchFn,onCancel:ke=>{ke instanceof sy&&ke.revert&&this.setState({...Le(this,ap),fetchStatus:"idle"}),b.abort()},onFail:(ke,Ve)=>{Vi(this,El,Eu).call(this,{type:"failed",failureCount:ke,error:Ve})},onPause:()=>{Vi(this,El,Eu).call(this,{type:"pause"})},onContinue:()=>{Vi(this,El,Eu).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}));try{const ke=await Le(this,sa).start();if(ke===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(ke),(U=(ee=Le(this,Oo).config).onSuccess)==null||U.call(ee,ke,this),(ie=(le=Le(this,Oo).config).onSettled)==null||ie.call(le,ke,this.state.error,this),ke}catch(ke){if(ke instanceof sy){if(ke.silent)return Le(this,sa).promise;if(ke.revert){if(this.state.data===void 0)throw ke;return this.state.data}}throw Vi(this,El,Eu).call(this,{type:"error",error:ke}),(Ce=(me=Le(this,Oo).config).onError)==null||Ce.call(me,ke,this),(Ee=(Se=Le(this,Oo).config).onSettled)==null||Ee.call(Se,this.state.data,ke,this),ke}finally{this.scheduleGc()}}},rp=new WeakMap,ap=new WeakMap,Oo=new WeakMap,Bd=new WeakMap,sa=new WeakMap,km=new WeakMap,Nd=new WeakMap,El=new WeakSet,Eu=function(h){const g=b=>{switch(h.type){case"failed":return{...b,fetchFailureCount:h.failureCount,fetchFailureReason:h.error};case"pause":return{...b,fetchStatus:"paused"};case"continue":return{...b,fetchStatus:"fetching"};case"fetch":return{...b,...Xx(b.data,this.options),fetchMeta:h.meta??null};case"success":const C={...b,data:h.data,dataUpdateCount:b.dataUpdateCount+1,dataUpdatedAt:h.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!h.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Zt(this,ap,h.manual?C:void 0),C;case"error":const R=h.error;return{...b,error:R,errorUpdateCount:b.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:b.fetchFailureCount+1,fetchFailureReason:R,fetchStatus:"idle",status:"error"};case"invalidate":return{...b,isInvalidated:!0};case"setState":return{...b,...h.state}}};this.state=g(this.state),xa.batch(()=>{this.observers.forEach(b=>{b.onQueryUpdate()}),Le(this,Oo).notify({query:this,type:"updated",action:h})})},Dx);function Xx(p,h){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:qx(h.networkMode)?"fetching":"paused",...p===void 0&&{error:null,status:"pending"}}}function z1(p){const h=typeof p.initialData=="function"?p.initialData():p.initialData,g=h!==void 0,b=g?typeof p.initialDataUpdatedAt=="function"?p.initialDataUpdatedAt():p.initialDataUpdatedAt:0;return{data:h,dataUpdateCount:0,dataUpdatedAt:g?b??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:g?"success":"pending",fetchStatus:"idle"}}var _c,kx,I1=(kx=class extends Nm{constructor(h={}){super();mi(this,_c);this.config=h,Zt(this,_c,new Map)}build(h,g,b){const C=g.queryKey,R=g.queryHash??jy(C,g);let T=this.get(R);return T||(T=new R1({client:h,queryKey:C,queryHash:R,options:h.defaultQueryOptions(g),state:b,defaultOptions:h.getQueryDefaults(C)}),this.add(T)),T}add(h){Le(this,_c).has(h.queryHash)||(Le(this,_c).set(h.queryHash,h),this.notify({type:"added",query:h}))}remove(h){const g=Le(this,_c).get(h.queryHash);g&&(h.destroy(),g===h&&Le(this,_c).delete(h.queryHash),this.notify({type:"removed",query:h}))}clear(){xa.batch(()=>{this.getAll().forEach(h=>{this.remove(h)})})}get(h){return Le(this,_c).get(h)}getAll(){return[...Le(this,_c).values()]}find(h){const g={exact:!0,...h};return this.getAll().find(b=>yv(g,b))}findAll(h={}){const g=this.getAll();return Object.keys(h).length>0?g.filter(b=>yv(h,b)):g}notify(h){xa.batch(()=>{this.listeners.forEach(g=>{g(h)})})}onFocus(){xa.batch(()=>{this.getAll().forEach(h=>{h.onFocus()})})}onOnline(){xa.batch(()=>{this.getAll().forEach(h=>{h.onOnline()})})}},_c=new WeakMap,kx),yc,os,jd,vc,wh,Lx,D1=(Lx=class extends Hx{constructor(h){super();mi(this,vc);mi(this,yc);mi(this,os);mi(this,jd);this.mutationId=h.mutationId,Zt(this,os,h.mutationCache),Zt(this,yc,[]),this.state=h.state||k1(),this.setOptions(h.options),this.scheduleGc()}setOptions(h){this.options=h,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(h){Le(this,yc).includes(h)||(Le(this,yc).push(h),this.clearGcTimeout(),Le(this,os).notify({type:"observerAdded",mutation:this,observer:h}))}removeObserver(h){Zt(this,yc,Le(this,yc).filter(g=>g!==h)),this.scheduleGc(),Le(this,os).notify({type:"observerRemoved",mutation:this,observer:h})}optionalRemove(){Le(this,yc).length||(this.state.status==="pending"?this.scheduleGc():Le(this,os).remove(this))}continue(){var h;return((h=Le(this,jd))==null?void 0:h.continue())??this.execute(this.state.variables)}async execute(h){var R,T,o,L,N,Z,Y,ee,U,le,ie,me,Ce,Se,Ee,ke,Ve,ct,tt,Qe;const g=()=>{Vi(this,vc,wh).call(this,{type:"continue"})};Zt(this,jd,$x({fn:()=>this.options.mutationFn?this.options.mutationFn(h):Promise.reject(new Error("No mutationFn found")),onFail:(at,ht)=>{Vi(this,vc,wh).call(this,{type:"failed",failureCount:at,error:ht})},onPause:()=>{Vi(this,vc,wh).call(this,{type:"pause"})},onContinue:g,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>Le(this,os).canRun(this)}));const b=this.state.status==="pending",C=!Le(this,jd).canStart();try{if(b)g();else{Vi(this,vc,wh).call(this,{type:"pending",variables:h,isPaused:C}),await((T=(R=Le(this,os).config).onMutate)==null?void 0:T.call(R,h,this));const ht=await((L=(o=this.options).onMutate)==null?void 0:L.call(o,h));ht!==this.state.context&&Vi(this,vc,wh).call(this,{type:"pending",context:ht,variables:h,isPaused:C})}const at=await Le(this,jd).start();return await((Z=(N=Le(this,os).config).onSuccess)==null?void 0:Z.call(N,at,h,this.state.context,this)),await((ee=(Y=this.options).onSuccess)==null?void 0:ee.call(Y,at,h,this.state.context)),await((le=(U=Le(this,os).config).onSettled)==null?void 0:le.call(U,at,null,this.state.variables,this.state.context,this)),await((me=(ie=this.options).onSettled)==null?void 0:me.call(ie,at,null,h,this.state.context)),Vi(this,vc,wh).call(this,{type:"success",data:at}),at}catch(at){try{throw await((Se=(Ce=Le(this,os).config).onError)==null?void 0:Se.call(Ce,at,h,this.state.context,this)),await((ke=(Ee=this.options).onError)==null?void 0:ke.call(Ee,at,h,this.state.context)),await((ct=(Ve=Le(this,os).config).onSettled)==null?void 0:ct.call(Ve,void 0,at,this.state.variables,this.state.context,this)),await((Qe=(tt=this.options).onSettled)==null?void 0:Qe.call(tt,void 0,at,h,this.state.context)),at}finally{Vi(this,vc,wh).call(this,{type:"error",error:at})}}finally{Le(this,os).runNext(this)}}},yc=new WeakMap,os=new WeakMap,jd=new WeakMap,vc=new WeakSet,wh=function(h){const g=b=>{switch(h.type){case"failed":return{...b,failureCount:h.failureCount,failureReason:h.error};case"pause":return{...b,isPaused:!0};case"continue":return{...b,isPaused:!1};case"pending":return{...b,context:h.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:h.isPaused,status:"pending",variables:h.variables,submittedAt:Date.now()};case"success":return{...b,data:h.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...b,data:void 0,error:h.error,failureCount:b.failureCount+1,failureReason:h.error,isPaused:!1,status:"error"}}};this.state=g(this.state),xa.batch(()=>{Le(this,yc).forEach(b=>{b.onMutationUpdate(h)}),Le(this,os).notify({mutation:this,type:"updated",action:h})})},Lx);function k1(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Mu,Ml,Lm,Ox,L1=(Ox=class extends Nm{constructor(h={}){super();mi(this,Mu);mi(this,Ml);mi(this,Lm);this.config=h,Zt(this,Mu,new Set),Zt(this,Ml,new Map),Zt(this,Lm,0)}build(h,g,b){const C=new D1({mutationCache:this,mutationId:++Lg(this,Lm)._,options:h.defaultMutationOptions(g),state:b});return this.add(C),C}add(h){Le(this,Mu).add(h);const g=Og(h);if(typeof g=="string"){const b=Le(this,Ml).get(g);b?b.push(h):Le(this,Ml).set(g,[h])}this.notify({type:"added",mutation:h})}remove(h){if(Le(this,Mu).delete(h)){const g=Og(h);if(typeof g=="string"){const b=Le(this,Ml).get(g);if(b)if(b.length>1){const C=b.indexOf(h);C!==-1&&b.splice(C,1)}else b[0]===h&&Le(this,Ml).delete(g)}}this.notify({type:"removed",mutation:h})}canRun(h){const g=Og(h);if(typeof g=="string"){const b=Le(this,Ml).get(g),C=b==null?void 0:b.find(R=>R.state.status==="pending");return!C||C===h}else return!0}runNext(h){var b;const g=Og(h);if(typeof g=="string"){const C=(b=Le(this,Ml).get(g))==null?void 0:b.find(R=>R!==h&&R.state.isPaused);return(C==null?void 0:C.continue())??Promise.resolve()}else return Promise.resolve()}clear(){xa.batch(()=>{Le(this,Mu).forEach(h=>{this.notify({type:"removed",mutation:h})}),Le(this,Mu).clear(),Le(this,Ml).clear()})}getAll(){return Array.from(Le(this,Mu))}find(h){const g={exact:!0,...h};return this.getAll().find(b=>vv(g,b))}findAll(h={}){return this.getAll().filter(g=>vv(h,g))}notify(h){xa.batch(()=>{this.listeners.forEach(g=>{g(h)})})}resumePausedMutations(){const h=this.getAll().filter(g=>g.state.isPaused);return xa.batch(()=>Promise.all(h.map(g=>g.continue().catch(Es))))}},Mu=new WeakMap,Ml=new WeakMap,Lm=new WeakMap,Ox);function Og(p){var h;return(h=p.options.scope)==null?void 0:h.id}function wv(p){return{onFetch:(h,g)=>{var Z,Y,ee,U,le;const b=h.options,C=(ee=(Y=(Z=h.fetchOptions)==null?void 0:Z.meta)==null?void 0:Y.fetchMore)==null?void 0:ee.direction,R=((U=h.state.data)==null?void 0:U.pages)||[],T=((le=h.state.data)==null?void 0:le.pageParams)||[];let o={pages:[],pageParams:[]},L=0;const N=async()=>{let ie=!1;const me=Ee=>{Object.defineProperty(Ee,"signal",{enumerable:!0,get:()=>(h.signal.aborted?ie=!0:h.signal.addEventListener("abort",()=>{ie=!0}),h.signal)})},Ce=Zx(h.options,h.fetchOptions),Se=async(Ee,ke,Ve)=>{if(ie)return Promise.reject();if(ke==null&&Ee.pages.length)return Promise.resolve(Ee);const tt=(()=>{const Ct={client:h.client,queryKey:h.queryKey,pageParam:ke,direction:Ve?"backward":"forward",meta:h.options.meta};return me(Ct),Ct})(),Qe=await Ce(tt),{maxPages:at}=h.options,ht=Ve?S1:w1;return{pages:ht(Ee.pages,Qe,at),pageParams:ht(Ee.pageParams,ke,at)}};if(C&&R.length){const Ee=C==="backward",ke=Ee?O1:Sv,Ve={pages:R,pageParams:T},ct=ke(b,Ve);o=await Se(Ve,ct,Ee)}else{const Ee=p??R.length;do{const ke=L===0?T[0]??b.initialPageParam:Sv(b,o);if(L>0&&ke==null)break;o=await Se(o,ke),L++}while(L<Ee)}return o};h.options.persister?h.fetchFn=()=>{var ie,me;return(me=(ie=h.options).persister)==null?void 0:me.call(ie,N,{client:h.client,queryKey:h.queryKey,meta:h.options.meta,signal:h.signal},g)}:h.fetchFn=N}}}function Sv(p,{pages:h,pageParams:g}){const b=h.length-1;return h.length>0?p.getNextPageParam(h[b],h,g[b],g):void 0}function O1(p,{pages:h,pageParams:g}){var b;return h.length>0?(b=p.getPreviousPageParam)==null?void 0:b.call(p,h[0],h,g[0],g):void 0}var dr,Eh,Mh,sp,op,Ah,lp,cp,Bx,B1=(Bx=class{constructor(p={}){mi(this,dr);mi(this,Eh);mi(this,Mh);mi(this,sp);mi(this,op);mi(this,Ah);mi(this,lp);mi(this,cp);Zt(this,dr,p.queryCache||new I1),Zt(this,Eh,p.mutationCache||new L1),Zt(this,Mh,p.defaultOptions||{}),Zt(this,sp,new Map),Zt(this,op,new Map),Zt(this,Ah,0)}mount(){Lg(this,Ah)._++,Le(this,Ah)===1&&(Zt(this,lp,Uy.subscribe(async p=>{p&&(await this.resumePausedMutations(),Le(this,dr).onFocus())})),Zt(this,cp,Kg.subscribe(async p=>{p&&(await this.resumePausedMutations(),Le(this,dr).onOnline())})))}unmount(){var p,h;Lg(this,Ah)._--,Le(this,Ah)===0&&((p=Le(this,lp))==null||p.call(this),Zt(this,lp,void 0),(h=Le(this,cp))==null||h.call(this),Zt(this,cp,void 0))}isFetching(p){return Le(this,dr).findAll({...p,fetchStatus:"fetching"}).length}isMutating(p){return Le(this,Eh).findAll({...p,status:"pending"}).length}getQueryData(p){var g;const h=this.defaultQueryOptions({queryKey:p});return(g=Le(this,dr).get(h.queryHash))==null?void 0:g.state.data}ensureQueryData(p){const h=this.defaultQueryOptions(p),g=Le(this,dr).build(this,h),b=g.state.data;return b===void 0?this.fetchQuery(p):(p.revalidateIfStale&&g.isStaleByTime(zh(h.staleTime,g))&&this.prefetchQuery(h),Promise.resolve(b))}getQueriesData(p){return Le(this,dr).findAll(p).map(({queryKey:h,state:g})=>{const b=g.data;return[h,b]})}setQueryData(p,h,g){const b=this.defaultQueryOptions({queryKey:p}),C=Le(this,dr).get(b.queryHash),R=C==null?void 0:C.state.data,T=v1(h,R);if(T!==void 0)return Le(this,dr).build(this,b).setData(T,{...g,manual:!0})}setQueriesData(p,h,g){return xa.batch(()=>Le(this,dr).findAll(p).map(({queryKey:b})=>[b,this.setQueryData(b,h,g)]))}getQueryState(p){var g;const h=this.defaultQueryOptions({queryKey:p});return(g=Le(this,dr).get(h.queryHash))==null?void 0:g.state}removeQueries(p){const h=Le(this,dr);xa.batch(()=>{h.findAll(p).forEach(g=>{h.remove(g)})})}resetQueries(p,h){const g=Le(this,dr);return xa.batch(()=>(g.findAll(p).forEach(b=>{b.reset()}),this.refetchQueries({type:"active",...p},h)))}cancelQueries(p,h={}){const g={revert:!0,...h},b=xa.batch(()=>Le(this,dr).findAll(p).map(C=>C.cancel(g)));return Promise.all(b).then(Es).catch(Es)}invalidateQueries(p,h={}){return xa.batch(()=>(Le(this,dr).findAll(p).forEach(g=>{g.invalidate()}),(p==null?void 0:p.refetchType)==="none"?Promise.resolve():this.refetchQueries({...p,type:(p==null?void 0:p.refetchType)??(p==null?void 0:p.type)??"active"},h)))}refetchQueries(p,h={}){const g={...h,cancelRefetch:h.cancelRefetch??!0},b=xa.batch(()=>Le(this,dr).findAll(p).filter(C=>!C.isDisabled()&&!C.isStatic()).map(C=>{let R=C.fetch(void 0,g);return g.throwOnError||(R=R.catch(Es)),C.state.fetchStatus==="paused"?Promise.resolve():R}));return Promise.all(b).then(Es)}fetchQuery(p){const h=this.defaultQueryOptions(p);h.retry===void 0&&(h.retry=!1);const g=Le(this,dr).build(this,h);return g.isStaleByTime(zh(h.staleTime,g))?g.fetch(h):Promise.resolve(g.state.data)}prefetchQuery(p){return this.fetchQuery(p).then(Es).catch(Es)}fetchInfiniteQuery(p){return p.behavior=wv(p.pages),this.fetchQuery(p)}prefetchInfiniteQuery(p){return this.fetchInfiniteQuery(p).then(Es).catch(Es)}ensureInfiniteQueryData(p){return p.behavior=wv(p.pages),this.ensureQueryData(p)}resumePausedMutations(){return Kg.isOnline()?Le(this,Eh).resumePausedMutations():Promise.resolve()}getQueryCache(){return Le(this,dr)}getMutationCache(){return Le(this,Eh)}getDefaultOptions(){return Le(this,Mh)}setDefaultOptions(p){Zt(this,Mh,p)}setQueryDefaults(p,h){Le(this,sp).set(Mm(p),{queryKey:p,defaultOptions:h})}getQueryDefaults(p){const h=[...Le(this,sp).values()],g={};return h.forEach(b=>{Am(p,b.queryKey)&&Object.assign(g,b.defaultOptions)}),g}setMutationDefaults(p,h){Le(this,op).set(Mm(p),{mutationKey:p,defaultOptions:h})}getMutationDefaults(p){const h=[...Le(this,op).values()],g={};return h.forEach(b=>{Am(p,b.mutationKey)&&Object.assign(g,b.defaultOptions)}),g}defaultQueryOptions(p){if(p._defaulted)return p;const h={...Le(this,Mh).queries,...this.getQueryDefaults(p.queryKey),...p,_defaulted:!0};return h.queryHash||(h.queryHash=jy(h.queryKey,h)),h.refetchOnReconnect===void 0&&(h.refetchOnReconnect=h.networkMode!=="always"),h.throwOnError===void 0&&(h.throwOnError=!!h.suspense),!h.networkMode&&h.persister&&(h.networkMode="offlineFirst"),h.queryFn===Fy&&(h.enabled=!1),h}defaultMutationOptions(p){return p!=null&&p._defaulted?p:{...Le(this,Mh).mutations,...(p==null?void 0:p.mutationKey)&&this.getMutationDefaults(p.mutationKey),...p,_defaulted:!0}}clear(){Le(this,dr).clear(),Le(this,Eh).clear()}},dr=new WeakMap,Eh=new WeakMap,Mh=new WeakMap,sp=new WeakMap,op=new WeakMap,Ah=new WeakMap,lp=new WeakMap,cp=new WeakMap,Bx),Cs,Gi,Om,ls,Fd,up,Au,Ph,Bm,hp,dp,Ud,Vd,Rh,fp,dn,Sm,oy,ly,cy,uy,hy,dy,fy,Yx,Nx,N1=(Nx=class extends Nm{constructor(h,g){super();mi(this,dn);mi(this,Cs);mi(this,Gi);mi(this,Om);mi(this,ls);mi(this,Fd);mi(this,up);mi(this,Au);mi(this,Ph);mi(this,Bm);mi(this,hp);mi(this,dp);mi(this,Ud);mi(this,Vd);mi(this,Rh);mi(this,fp,new Set);this.options=g,Zt(this,Cs,h),Zt(this,Ph,null),Zt(this,Au,ay()),this.bindMethods(),this.setOptions(g)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(Le(this,Gi).addObserver(this),Tv(Le(this,Gi),this.options)?Vi(this,dn,Sm).call(this):this.updateResult(),Vi(this,dn,uy).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return py(Le(this,Gi),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return py(Le(this,Gi),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Vi(this,dn,hy).call(this),Vi(this,dn,dy).call(this),Le(this,Gi).removeObserver(this)}setOptions(h){const g=this.options,b=Le(this,Gi);if(this.options=Le(this,Cs).defaultQueryOptions(h),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Bo(this.options.enabled,Le(this,Gi))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Vi(this,dn,fy).call(this),Le(this,Gi).setOptions(this.options),g._defaulted&&!iy(this.options,g)&&Le(this,Cs).getQueryCache().notify({type:"observerOptionsUpdated",query:Le(this,Gi),observer:this});const C=this.hasListeners();C&&Cv(Le(this,Gi),b,this.options,g)&&Vi(this,dn,Sm).call(this),this.updateResult(),C&&(Le(this,Gi)!==b||Bo(this.options.enabled,Le(this,Gi))!==Bo(g.enabled,Le(this,Gi))||zh(this.options.staleTime,Le(this,Gi))!==zh(g.staleTime,Le(this,Gi)))&&Vi(this,dn,oy).call(this);const R=Vi(this,dn,ly).call(this);C&&(Le(this,Gi)!==b||Bo(this.options.enabled,Le(this,Gi))!==Bo(g.enabled,Le(this,Gi))||R!==Le(this,Rh))&&Vi(this,dn,cy).call(this,R)}getOptimisticResult(h){const g=Le(this,Cs).getQueryCache().build(Le(this,Cs),h),b=this.createResult(g,h);return F1(this,b)&&(Zt(this,ls,b),Zt(this,up,this.options),Zt(this,Fd,Le(this,Gi).state)),b}getCurrentResult(){return Le(this,ls)}trackResult(h,g){return new Proxy(h,{get:(b,C)=>(this.trackProp(C),g==null||g(C),C==="promise"&&!this.options.experimental_prefetchInRender&&Le(this,Au).status==="pending"&&Le(this,Au).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),Reflect.get(b,C))})}trackProp(h){Le(this,fp).add(h)}getCurrentQuery(){return Le(this,Gi)}refetch({...h}={}){return this.fetch({...h})}fetchOptimistic(h){const g=Le(this,Cs).defaultQueryOptions(h),b=Le(this,Cs).getQueryCache().build(Le(this,Cs),g);return b.fetch().then(()=>this.createResult(b,g))}fetch(h){return Vi(this,dn,Sm).call(this,{...h,cancelRefetch:h.cancelRefetch??!0}).then(()=>(this.updateResult(),Le(this,ls)))}createResult(h,g){var at;const b=Le(this,Gi),C=this.options,R=Le(this,ls),T=Le(this,Fd),o=Le(this,up),N=h!==b?h.state:Le(this,Om),{state:Z}=h;let Y={...Z},ee=!1,U;if(g._optimisticResults){const ht=this.hasListeners(),Ct=!ht&&Tv(h,g),Rt=ht&&Cv(h,b,g,C);(Ct||Rt)&&(Y={...Y,...Xx(Z.data,h.options)}),g._optimisticResults==="isRestoring"&&(Y.fetchStatus="idle")}let{error:le,errorUpdatedAt:ie,status:me}=Y;U=Y.data;let Ce=!1;if(g.placeholderData!==void 0&&U===void 0&&me==="pending"){let ht;R!=null&&R.isPlaceholderData&&g.placeholderData===(o==null?void 0:o.placeholderData)?(ht=R.data,Ce=!0):ht=typeof g.placeholderData=="function"?g.placeholderData((at=Le(this,dp))==null?void 0:at.state.data,Le(this,dp)):g.placeholderData,ht!==void 0&&(me="success",U=ry(R==null?void 0:R.data,ht,g),ee=!0)}if(g.select&&U!==void 0&&!Ce)if(R&&U===(T==null?void 0:T.data)&&g.select===Le(this,Bm))U=Le(this,hp);else try{Zt(this,Bm,g.select),U=g.select(U),U=ry(R==null?void 0:R.data,U,g),Zt(this,hp,U),Zt(this,Ph,null)}catch(ht){Zt(this,Ph,ht)}Le(this,Ph)&&(le=Le(this,Ph),U=Le(this,hp),ie=Date.now(),me="error");const Se=Y.fetchStatus==="fetching",Ee=me==="pending",ke=me==="error",Ve=Ee&&Se,ct=U!==void 0,Qe={status:me,fetchStatus:Y.fetchStatus,isPending:Ee,isSuccess:me==="success",isError:ke,isInitialLoading:Ve,isLoading:Ve,data:U,dataUpdatedAt:Y.dataUpdatedAt,error:le,errorUpdatedAt:ie,failureCount:Y.fetchFailureCount,failureReason:Y.fetchFailureReason,errorUpdateCount:Y.errorUpdateCount,isFetched:Y.dataUpdateCount>0||Y.errorUpdateCount>0,isFetchedAfterMount:Y.dataUpdateCount>N.dataUpdateCount||Y.errorUpdateCount>N.errorUpdateCount,isFetching:Se,isRefetching:Se&&!Ee,isLoadingError:ke&&!ct,isPaused:Y.fetchStatus==="paused",isPlaceholderData:ee,isRefetchError:ke&&ct,isStale:Vy(h,g),refetch:this.refetch,promise:Le(this,Au),isEnabled:Bo(g.enabled,h)!==!1};if(this.options.experimental_prefetchInRender){const ht=Lt=>{Qe.status==="error"?Lt.reject(Qe.error):Qe.data!==void 0&&Lt.resolve(Qe.data)},Ct=()=>{const Lt=Zt(this,Au,Qe.promise=ay());ht(Lt)},Rt=Le(this,Au);switch(Rt.status){case"pending":h.queryHash===b.queryHash&&ht(Rt);break;case"fulfilled":(Qe.status==="error"||Qe.data!==Rt.value)&&Ct();break;case"rejected":(Qe.status!=="error"||Qe.error!==Rt.reason)&&Ct();break}}return Qe}updateResult(){const h=Le(this,ls),g=this.createResult(Le(this,Gi),this.options);if(Zt(this,Fd,Le(this,Gi).state),Zt(this,up,this.options),Le(this,Fd).data!==void 0&&Zt(this,dp,Le(this,Gi)),iy(g,h))return;Zt(this,ls,g);const b=()=>{if(!h)return!0;const{notifyOnChangeProps:C}=this.options,R=typeof C=="function"?C():C;if(R==="all"||!R&&!Le(this,fp).size)return!0;const T=new Set(R??Le(this,fp));return this.options.throwOnError&&T.add("error"),Object.keys(Le(this,ls)).some(o=>{const L=o;return Le(this,ls)[L]!==h[L]&&T.has(L)})};Vi(this,dn,Yx).call(this,{listeners:b()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Vi(this,dn,uy).call(this)}},Cs=new WeakMap,Gi=new WeakMap,Om=new WeakMap,ls=new WeakMap,Fd=new WeakMap,up=new WeakMap,Au=new WeakMap,Ph=new WeakMap,Bm=new WeakMap,hp=new WeakMap,dp=new WeakMap,Ud=new WeakMap,Vd=new WeakMap,Rh=new WeakMap,fp=new WeakMap,dn=new WeakSet,Sm=function(h){Vi(this,dn,fy).call(this);let g=Le(this,Gi).fetch(this.options,h);return h!=null&&h.throwOnError||(g=g.catch(Es)),g},oy=function(){Vi(this,dn,hy).call(this);const h=zh(this.options.staleTime,Le(this,Gi));if(Zd||Le(this,ls).isStale||!ty(h))return;const b=Vx(Le(this,ls).dataUpdatedAt,h)+1;Zt(this,Ud,setTimeout(()=>{Le(this,ls).isStale||this.updateResult()},b))},ly=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(Le(this,Gi)):this.options.refetchInterval)??!1},cy=function(h){Vi(this,dn,dy).call(this),Zt(this,Rh,h),!(Zd||Bo(this.options.enabled,Le(this,Gi))===!1||!ty(Le(this,Rh))||Le(this,Rh)===0)&&Zt(this,Vd,setInterval(()=>{(this.options.refetchIntervalInBackground||Uy.isFocused())&&Vi(this,dn,Sm).call(this)},Le(this,Rh)))},uy=function(){Vi(this,dn,oy).call(this),Vi(this,dn,cy).call(this,Vi(this,dn,ly).call(this))},hy=function(){Le(this,Ud)&&(clearTimeout(Le(this,Ud)),Zt(this,Ud,void 0))},dy=function(){Le(this,Vd)&&(clearInterval(Le(this,Vd)),Zt(this,Vd,void 0))},fy=function(){const h=Le(this,Cs).getQueryCache().build(Le(this,Cs),this.options);if(h===Le(this,Gi))return;const g=Le(this,Gi);Zt(this,Gi,h),Zt(this,Om,h.state),this.hasListeners()&&(g==null||g.removeObserver(this),h.addObserver(this))},Yx=function(h){xa.batch(()=>{h.listeners&&this.listeners.forEach(g=>{g(Le(this,ls))}),Le(this,Cs).getQueryCache().notify({query:Le(this,Gi),type:"observerResultsUpdated"})})},Nx);function j1(p,h){return Bo(h.enabled,p)!==!1&&p.state.data===void 0&&!(p.state.status==="error"&&h.retryOnMount===!1)}function Tv(p,h){return j1(p,h)||p.state.data!==void 0&&py(p,h,h.refetchOnMount)}function py(p,h,g){if(Bo(h.enabled,p)!==!1&&zh(h.staleTime,p)!=="static"){const b=typeof g=="function"?g(p):g;return b==="always"||b!==!1&&Vy(p,h)}return!1}function Cv(p,h,g,b){return(p!==h||Bo(b.enabled,p)===!1)&&(!g.suspense||p.state.status!=="error")&&Vy(p,g)}function Vy(p,h){return Bo(h.enabled,p)!==!1&&p.isStaleByTime(zh(h.staleTime,p))}function F1(p,h){return!iy(p.getCurrentResult(),h)}var Wx=J.createContext(void 0),U1=p=>{const h=J.useContext(Wx);if(!h)throw new Error("No QueryClient set, use QueryClientProvider to set one");return h},V1=({client:p,children:h})=>(J.useEffect(()=>(p.mount(),()=>{p.unmount()}),[p]),pe.jsx(Wx.Provider,{value:p,children:h})),Kx=J.createContext(!1),G1=()=>J.useContext(Kx);Kx.Provider;function Z1(){let p=!1;return{clearReset:()=>{p=!1},reset:()=>{p=!0},isReset:()=>p}}var q1=J.createContext(Z1()),$1=()=>J.useContext(q1),H1=(p,h)=>{(p.suspense||p.throwOnError||p.experimental_prefetchInRender)&&(h.isReset()||(p.retryOnMount=!1))},X1=p=>{J.useEffect(()=>{p.clearReset()},[p])},Y1=({result:p,errorResetBoundary:h,throwOnError:g,query:b,suspense:C})=>p.isError&&!h.isReset()&&!p.isFetching&&b&&(C&&p.data===void 0||T1(g,[p.error,b])),W1=p=>{if(p.suspense){const g=C=>C==="static"?C:Math.max(C??1e3,1e3),b=p.staleTime;p.staleTime=typeof b=="function"?(...C)=>g(b(...C)):g(b),typeof p.gcTime=="number"&&(p.gcTime=Math.max(p.gcTime,1e3))}},K1=(p,h)=>p.isLoading&&p.isFetching&&!h,Q1=(p,h)=>(p==null?void 0:p.suspense)&&h.isPending,Ev=(p,h,g)=>h.fetchOptimistic(p).catch(()=>{g.clearReset()});function J1(p,h,g){var Y,ee,U,le,ie;const b=G1(),C=$1(),R=U1(),T=R.defaultQueryOptions(p);(ee=(Y=R.getDefaultOptions().queries)==null?void 0:Y._experimental_beforeQuery)==null||ee.call(Y,T),T._optimisticResults=b?"isRestoring":"optimistic",W1(T),H1(T,C),X1(C);const o=!R.getQueryCache().get(T.queryHash),[L]=J.useState(()=>new h(R,T)),N=L.getOptimisticResult(T),Z=!b&&p.subscribed!==!1;if(J.useSyncExternalStore(J.useCallback(me=>{const Ce=Z?L.subscribe(xa.batchCalls(me)):Es;return L.updateResult(),Ce},[L,Z]),()=>L.getCurrentResult(),()=>L.getCurrentResult()),J.useEffect(()=>{L.setOptions(T)},[T,L]),Q1(T,N))throw Ev(T,L,C);if(Y1({result:N,errorResetBoundary:C,throwOnError:T.throwOnError,query:R.getQueryCache().get(T.queryHash),suspense:T.suspense}))throw N.error;if((le=(U=R.getDefaultOptions().queries)==null?void 0:U._experimental_afterQuery)==null||le.call(U,T,N),T.experimental_prefetchInRender&&!Zd&&K1(N,b)){const me=o?Ev(T,L,C):(ie=R.getQueryCache().get(T.queryHash))==null?void 0:ie.promise;me==null||me.catch(Es).finally(()=>{L.updateResult()})}return T.notifyOnChangeProps?N:L.trackResult(N)}function my(p,h){return J1(p,N1)}const ew="modulepreload",tw=function(p){return"/"+p},Mv={},Bi=function(h,g,b){let C=Promise.resolve();if(g&&g.length>0){let T=function(N){return Promise.all(N.map(Z=>Promise.resolve(Z).then(Y=>({status:"fulfilled",value:Y}),Y=>({status:"rejected",reason:Y}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),L=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));C=T(g.map(N=>{if(N=tw(N),N in Mv)return;Mv[N]=!0;const Z=N.endsWith(".css"),Y=Z?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${N}"]${Y}`))return;const ee=document.createElement("link");if(ee.rel=Z?"stylesheet":ew,Z||(ee.as="script"),ee.crossOrigin="",ee.href=N,L&&ee.setAttribute("nonce",L),document.head.appendChild(ee),Z)return new Promise((U,le)=>{ee.addEventListener("load",U),ee.addEventListener("error",()=>le(new Error(`Unable to preload CSS for ${N}`)))})}))}function R(T){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=T,window.dispatchEvent(o),!o.defaultPrevented)throw T}return C.then(T=>{for(const o of T||[])o.status==="rejected"&&R(o.reason);return h().catch(R)})},iw=(p,h,g,b)=>{var R,T,o,L;const C=[g,{code:h,...b||{}}];if((T=(R=p==null?void 0:p.services)==null?void 0:R.logger)!=null&&T.forward)return p.services.logger.forward(C,"warn","react-i18next::",!0);Gd(C[0])&&(C[0]=`react-i18next:: ${C[0]}`),(L=(o=p==null?void 0:p.services)==null?void 0:o.logger)!=null&&L.warn?p.services.logger.warn(...C):console!=null&&console.warn&&console.warn(...C)},Av={},gy=(p,h,g,b)=>{Gd(g)&&Av[g]||(Gd(g)&&(Av[g]=new Date),iw(p,h,g,b))},Qx=(p,h)=>()=>{if(p.isInitialized)h();else{const g=()=>{setTimeout(()=>{p.off("initialized",g)},0),h()};p.on("initialized",g)}},_y=(p,h,g)=>{p.loadNamespaces(h,Qx(p,g))},Pv=(p,h,g,b)=>{if(Gd(g)&&(g=[g]),p.options.preload&&p.options.preload.indexOf(h)>-1)return _y(p,g,b);g.forEach(C=>{p.options.ns.indexOf(C)<0&&p.options.ns.push(C)}),p.loadLanguages(h,Qx(p,b))},nw=(p,h,g={})=>!h.languages||!h.languages.length?(gy(h,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:h.languages}),!0):h.hasLoadedNamespace(p,{lng:g.lng,precheck:(b,C)=>{if(g.bindI18n&&g.bindI18n.indexOf("languageChanging")>-1&&b.services.backendConnector.backend&&b.isLanguageChangingTo&&!C(b.isLanguageChangingTo,p))return!1}}),Gd=p=>typeof p=="string",rw=p=>typeof p=="object"&&p!==null,aw=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,sw={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},ow=p=>sw[p],lw=p=>p.replace(aw,ow);let yy={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:lw};const cw=(p={})=>{yy={...yy,...p}},uw=()=>yy;let Jx;const hw=p=>{Jx=p},dw=()=>Jx,fw={type:"3rdParty",init(p){cw(p.options.react),hw(p)}},pw=J.createContext();class mw{constructor(){this.usedNamespaces={}}addUsedNamespaces(h){h.forEach(g=>{this.usedNamespaces[g]||(this.usedNamespaces[g]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const gw=(p,h)=>{const g=J.useRef();return J.useEffect(()=>{g.current=p},[p,h]),g.current},e0=(p,h,g,b)=>p.getFixedT(h,g,b),_w=(p,h,g,b)=>J.useCallback(e0(p,h,g,b),[p,h,g,b]),c_=(p,h={})=>{var ke,Ve,ct,tt;const{i18n:g}=h,{i18n:b,defaultNS:C}=J.useContext(pw)||{},R=g||b||dw();if(R&&!R.reportNamespaces&&(R.reportNamespaces=new mw),!R){gy(R,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const Qe=(ht,Ct)=>Gd(Ct)?Ct:rw(Ct)&&Gd(Ct.defaultValue)?Ct.defaultValue:Array.isArray(ht)?ht[ht.length-1]:ht,at=[Qe,{},!1];return at.t=Qe,at.i18n={},at.ready=!1,at}(ke=R.options.react)!=null&&ke.wait&&gy(R,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const T={...uw(),...R.options.react,...h},{useSuspense:o,keyPrefix:L}=T;let N=C||((Ve=R.options)==null?void 0:Ve.defaultNS);N=Gd(N)?[N]:N||["translation"],(tt=(ct=R.reportNamespaces).addUsedNamespaces)==null||tt.call(ct,N);const Z=(R.isInitialized||R.initializedStoreOnce)&&N.every(Qe=>nw(Qe,R,T)),Y=_w(R,h.lng||null,T.nsMode==="fallback"?N:N[0],L),ee=()=>Y,U=()=>e0(R,h.lng||null,T.nsMode==="fallback"?N:N[0],L),[le,ie]=J.useState(ee);let me=N.join();h.lng&&(me=`${h.lng}${me}`);const Ce=gw(me),Se=J.useRef(!0);J.useEffect(()=>{const{bindI18n:Qe,bindI18nStore:at}=T;Se.current=!0,!Z&&!o&&(h.lng?Pv(R,h.lng,N,()=>{Se.current&&ie(U)}):_y(R,N,()=>{Se.current&&ie(U)})),Z&&Ce&&Ce!==me&&Se.current&&ie(U);const ht=()=>{Se.current&&ie(U)};return Qe&&(R==null||R.on(Qe,ht)),at&&(R==null||R.store.on(at,ht)),()=>{Se.current=!1,R&&Qe&&(Qe==null||Qe.split(" ").forEach(Ct=>R.off(Ct,ht))),at&&R&&at.split(" ").forEach(Ct=>R.store.off(Ct,ht))}},[R,me]),J.useEffect(()=>{Se.current&&Z&&ie(ee)},[R,L,Z]);const Ee=[le,R,Z];if(Ee.t=le,Ee.i18n=R,Ee.ready=Z,Z||!Z&&!o)return Ee;throw new Promise(Qe=>{h.lng?Pv(R,h.lng,N,()=>Qe()):_y(R,N,()=>Qe())})};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yw=p=>p.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),vw=p=>p.replace(/^([A-Z])|[\s-_]+(\w)/g,(h,g,b)=>b?b.toUpperCase():g.toLowerCase()),Rv=p=>{const h=vw(p);return h.charAt(0).toUpperCase()+h.slice(1)},t0=(...p)=>p.filter((h,g,b)=>!!h&&h.trim()!==""&&b.indexOf(h)===g).join(" ").trim(),xw=p=>{for(const h in p)if(h.startsWith("aria-")||h==="role"||h==="title")return!0};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var bw={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ww=J.forwardRef(({color:p="currentColor",size:h=24,strokeWidth:g=2,absoluteStrokeWidth:b,className:C="",children:R,iconNode:T,...o},L)=>J.createElement("svg",{ref:L,...bw,width:h,height:h,stroke:p,strokeWidth:b?Number(g)*24/Number(h):g,className:t0("lucide",C),...!R&&!xw(o)&&{"aria-hidden":"true"},...o},[...T.map(([N,Z])=>J.createElement(N,Z)),...Array.isArray(R)?R:[R]]));/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _p=(p,h)=>{const g=J.forwardRef(({className:b,...C},R)=>J.createElement(ww,{ref:R,iconNode:h,className:t0(`lucide-${yw(Rv(p))}`,`lucide-${p}`,b),...C}));return g.displayName=Rv(p),g};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sw=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Tw=_p("check",Sw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cw=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],i0=_p("chevron-down",Cw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ew=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Mw=_p("chevron-up",Ew);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aw=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Pw=_p("clock",Aw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rw=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],zw=_p("eye",Rw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iw=[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]],Dw=_p("languages",Iw);var jm=Ux();const kw=jx(jm);function vy(p,[h,g]){return Math.min(g,Math.max(h,p))}function Ji(p,h,{checkForDefaultPrevented:g=!0}={}){return function(C){if(p==null||p(C),g===!1||!C.defaultPrevented)return h==null?void 0:h(C)}}function Fm(p,h=[]){let g=[];function b(R,T){const o=J.createContext(T),L=g.length;g=[...g,T];const N=Y=>{var Ce;const{scope:ee,children:U,...le}=Y,ie=((Ce=ee==null?void 0:ee[p])==null?void 0:Ce[L])||o,me=J.useMemo(()=>le,Object.values(le));return pe.jsx(ie.Provider,{value:me,children:U})};N.displayName=R+"Provider";function Z(Y,ee){var ie;const U=((ie=ee==null?void 0:ee[p])==null?void 0:ie[L])||o,le=J.useContext(U);if(le)return le;if(T!==void 0)return T;throw new Error(`\`${Y}\` must be used within \`${R}\``)}return[N,Z]}const C=()=>{const R=g.map(T=>J.createContext(T));return function(o){const L=(o==null?void 0:o[p])||R;return J.useMemo(()=>({[`__scope${p}`]:{...o,[p]:L}}),[o,L])}};return C.scopeName=p,[b,Lw(C,...h)]}function Lw(...p){const h=p[0];if(p.length===1)return h;const g=()=>{const b=p.map(C=>({useScope:C(),scopeName:C.scopeName}));return function(R){const T=b.reduce((o,{useScope:L,scopeName:N})=>{const Y=L(R)[`__scope${N}`];return{...o,...Y}},{});return J.useMemo(()=>({[`__scope${h.scopeName}`]:T}),[T])}};return g.scopeName=h.scopeName,g}function zv(p,h){if(typeof p=="function")return p(h);p!=null&&(p.current=h)}function n0(...p){return h=>{let g=!1;const b=p.map(C=>{const R=zv(C,h);return!g&&typeof R=="function"&&(g=!0),R});if(g)return()=>{for(let C=0;C<b.length;C++){const R=b[C];typeof R=="function"?R():zv(p[C],null)}}}}function Gn(...p){return J.useCallback(n0(...p),p)}function Qg(p){const h=Ow(p),g=J.forwardRef((b,C)=>{const{children:R,...T}=b,o=J.Children.toArray(R),L=o.find(Nw);if(L){const N=L.props.children,Z=o.map(Y=>Y===L?J.Children.count(N)>1?J.Children.only(null):J.isValidElement(N)?N.props.children:null:Y);return pe.jsx(h,{...T,ref:C,children:J.isValidElement(N)?J.cloneElement(N,void 0,Z):null})}return pe.jsx(h,{...T,ref:C,children:R})});return g.displayName=`${p}.Slot`,g}function Ow(p){const h=J.forwardRef((g,b)=>{const{children:C,...R}=g;if(J.isValidElement(C)){const T=Fw(C),o=jw(R,C.props);return C.type!==J.Fragment&&(o.ref=b?n0(b,T):T),J.cloneElement(C,o)}return J.Children.count(C)>1?J.Children.only(null):null});return h.displayName=`${p}.SlotClone`,h}var r0=Symbol("radix.slottable");function Bw(p){const h=({children:g})=>pe.jsx(pe.Fragment,{children:g});return h.displayName=`${p}.Slottable`,h.__radixId=r0,h}function Nw(p){return J.isValidElement(p)&&typeof p.type=="function"&&"__radixId"in p.type&&p.type.__radixId===r0}function jw(p,h){const g={...h};for(const b in h){const C=p[b],R=h[b];/^on[A-Z]/.test(b)?C&&R?g[b]=(...o)=>{const L=R(...o);return C(...o),L}:C&&(g[b]=C):b==="style"?g[b]={...C,...R}:b==="className"&&(g[b]=[C,R].filter(Boolean).join(" "))}return{...p,...g}}function Fw(p){var b,C;let h=(b=Object.getOwnPropertyDescriptor(p.props,"ref"))==null?void 0:b.get,g=h&&"isReactWarning"in h&&h.isReactWarning;return g?p.ref:(h=(C=Object.getOwnPropertyDescriptor(p,"ref"))==null?void 0:C.get,g=h&&"isReactWarning"in h&&h.isReactWarning,g?p.props.ref:p.props.ref||p.ref)}function Uw(p){const h=p+"CollectionProvider",[g,b]=Fm(h),[C,R]=g(h,{collectionRef:{current:null},itemMap:new Map}),T=ie=>{const{scope:me,children:Ce}=ie,Se=bh.useRef(null),Ee=bh.useRef(new Map).current;return pe.jsx(C,{scope:me,itemMap:Ee,collectionRef:Se,children:Ce})};T.displayName=h;const o=p+"CollectionSlot",L=Qg(o),N=bh.forwardRef((ie,me)=>{const{scope:Ce,children:Se}=ie,Ee=R(o,Ce),ke=Gn(me,Ee.collectionRef);return pe.jsx(L,{ref:ke,children:Se})});N.displayName=o;const Z=p+"CollectionItemSlot",Y="data-radix-collection-item",ee=Qg(Z),U=bh.forwardRef((ie,me)=>{const{scope:Ce,children:Se,...Ee}=ie,ke=bh.useRef(null),Ve=Gn(me,ke),ct=R(Z,Ce);return bh.useEffect(()=>(ct.itemMap.set(ke,{ref:ke,...Ee}),()=>void ct.itemMap.delete(ke))),pe.jsx(ee,{[Y]:"",ref:Ve,children:Se})});U.displayName=Z;function le(ie){const me=R(p+"CollectionConsumer",ie);return bh.useCallback(()=>{const Se=me.collectionRef.current;if(!Se)return[];const Ee=Array.from(Se.querySelectorAll(`[${Y}]`));return Array.from(me.itemMap.values()).sort((ct,tt)=>Ee.indexOf(ct.ref.current)-Ee.indexOf(tt.ref.current))},[me.collectionRef,me.itemMap])}return[{Provider:T,Slot:N,ItemSlot:U},le,b]}var Vw=J.createContext(void 0);function a0(p){const h=J.useContext(Vw);return p||h||"ltr"}var Gw=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Rn=Gw.reduce((p,h)=>{const g=Qg(`Primitive.${h}`),b=J.forwardRef((C,R)=>{const{asChild:T,...o}=C,L=T?g:h;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),pe.jsx(L,{...o,ref:R})});return b.displayName=`Primitive.${h}`,{...p,[h]:b}},{});function Zw(p,h){p&&jm.flushSync(()=>p.dispatchEvent(h))}function Ms(p){const h=J.useRef(p);return J.useEffect(()=>{h.current=p}),J.useMemo(()=>(...g)=>{var b;return(b=h.current)==null?void 0:b.call(h,...g)},[])}function qw(p,h=globalThis==null?void 0:globalThis.document){const g=Ms(p);J.useEffect(()=>{const b=C=>{C.key==="Escape"&&g(C)};return h.addEventListener("keydown",b,{capture:!0}),()=>h.removeEventListener("keydown",b,{capture:!0})},[g,h])}var $w="DismissableLayer",xy="dismissableLayer.update",Hw="dismissableLayer.pointerDownOutside",Xw="dismissableLayer.focusOutside",Iv,s0=J.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Gy=J.forwardRef((p,h)=>{const{disableOutsidePointerEvents:g=!1,onEscapeKeyDown:b,onPointerDownOutside:C,onFocusOutside:R,onInteractOutside:T,onDismiss:o,...L}=p,N=J.useContext(s0),[Z,Y]=J.useState(null),ee=(Z==null?void 0:Z.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,U]=J.useState({}),le=Gn(h,tt=>Y(tt)),ie=Array.from(N.layers),[me]=[...N.layersWithOutsidePointerEventsDisabled].slice(-1),Ce=ie.indexOf(me),Se=Z?ie.indexOf(Z):-1,Ee=N.layersWithOutsidePointerEventsDisabled.size>0,ke=Se>=Ce,Ve=Kw(tt=>{const Qe=tt.target,at=[...N.branches].some(ht=>ht.contains(Qe));!ke||at||(C==null||C(tt),T==null||T(tt),tt.defaultPrevented||o==null||o())},ee),ct=Qw(tt=>{const Qe=tt.target;[...N.branches].some(ht=>ht.contains(Qe))||(R==null||R(tt),T==null||T(tt),tt.defaultPrevented||o==null||o())},ee);return qw(tt=>{Se===N.layers.size-1&&(b==null||b(tt),!tt.defaultPrevented&&o&&(tt.preventDefault(),o()))},ee),J.useEffect(()=>{if(Z)return g&&(N.layersWithOutsidePointerEventsDisabled.size===0&&(Iv=ee.body.style.pointerEvents,ee.body.style.pointerEvents="none"),N.layersWithOutsidePointerEventsDisabled.add(Z)),N.layers.add(Z),Dv(),()=>{g&&N.layersWithOutsidePointerEventsDisabled.size===1&&(ee.body.style.pointerEvents=Iv)}},[Z,ee,g,N]),J.useEffect(()=>()=>{Z&&(N.layers.delete(Z),N.layersWithOutsidePointerEventsDisabled.delete(Z),Dv())},[Z,N]),J.useEffect(()=>{const tt=()=>U({});return document.addEventListener(xy,tt),()=>document.removeEventListener(xy,tt)},[]),pe.jsx(Rn.div,{...L,ref:le,style:{pointerEvents:Ee?ke?"auto":"none":void 0,...p.style},onFocusCapture:Ji(p.onFocusCapture,ct.onFocusCapture),onBlurCapture:Ji(p.onBlurCapture,ct.onBlurCapture),onPointerDownCapture:Ji(p.onPointerDownCapture,Ve.onPointerDownCapture)})});Gy.displayName=$w;var Yw="DismissableLayerBranch",Ww=J.forwardRef((p,h)=>{const g=J.useContext(s0),b=J.useRef(null),C=Gn(h,b);return J.useEffect(()=>{const R=b.current;if(R)return g.branches.add(R),()=>{g.branches.delete(R)}},[g.branches]),pe.jsx(Rn.div,{...p,ref:C})});Ww.displayName=Yw;function Kw(p,h=globalThis==null?void 0:globalThis.document){const g=Ms(p),b=J.useRef(!1),C=J.useRef(()=>{});return J.useEffect(()=>{const R=o=>{if(o.target&&!b.current){let L=function(){o0(Hw,g,N,{discrete:!0})};const N={originalEvent:o};o.pointerType==="touch"?(h.removeEventListener("click",C.current),C.current=L,h.addEventListener("click",C.current,{once:!0})):L()}else h.removeEventListener("click",C.current);b.current=!1},T=window.setTimeout(()=>{h.addEventListener("pointerdown",R)},0);return()=>{window.clearTimeout(T),h.removeEventListener("pointerdown",R),h.removeEventListener("click",C.current)}},[h,g]),{onPointerDownCapture:()=>b.current=!0}}function Qw(p,h=globalThis==null?void 0:globalThis.document){const g=Ms(p),b=J.useRef(!1);return J.useEffect(()=>{const C=R=>{R.target&&!b.current&&o0(Xw,g,{originalEvent:R},{discrete:!1})};return h.addEventListener("focusin",C),()=>h.removeEventListener("focusin",C)},[h,g]),{onFocusCapture:()=>b.current=!0,onBlurCapture:()=>b.current=!1}}function Dv(){const p=new CustomEvent(xy);document.dispatchEvent(p)}function o0(p,h,g,{discrete:b}){const C=g.originalEvent.target,R=new CustomEvent(p,{bubbles:!1,cancelable:!0,detail:g});h&&C.addEventListener(p,h,{once:!0}),b?Zw(C,R):C.dispatchEvent(R)}var G_=0;function Jw(){J.useEffect(()=>{const p=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",p[0]??kv()),document.body.insertAdjacentElement("beforeend",p[1]??kv()),G_++,()=>{G_===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(h=>h.remove()),G_--}},[])}function kv(){const p=document.createElement("span");return p.setAttribute("data-radix-focus-guard",""),p.tabIndex=0,p.style.outline="none",p.style.opacity="0",p.style.position="fixed",p.style.pointerEvents="none",p}var Z_="focusScope.autoFocusOnMount",q_="focusScope.autoFocusOnUnmount",Lv={bubbles:!1,cancelable:!0},eS="FocusScope",l0=J.forwardRef((p,h)=>{const{loop:g=!1,trapped:b=!1,onMountAutoFocus:C,onUnmountAutoFocus:R,...T}=p,[o,L]=J.useState(null),N=Ms(C),Z=Ms(R),Y=J.useRef(null),ee=Gn(h,ie=>L(ie)),U=J.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;J.useEffect(()=>{if(b){let ie=function(Ee){if(U.paused||!o)return;const ke=Ee.target;o.contains(ke)?Y.current=ke:Sh(Y.current,{select:!0})},me=function(Ee){if(U.paused||!o)return;const ke=Ee.relatedTarget;ke!==null&&(o.contains(ke)||Sh(Y.current,{select:!0}))},Ce=function(Ee){if(document.activeElement===document.body)for(const Ve of Ee)Ve.removedNodes.length>0&&Sh(o)};document.addEventListener("focusin",ie),document.addEventListener("focusout",me);const Se=new MutationObserver(Ce);return o&&Se.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",ie),document.removeEventListener("focusout",me),Se.disconnect()}}},[b,o,U.paused]),J.useEffect(()=>{if(o){Bv.add(U);const ie=document.activeElement;if(!o.contains(ie)){const Ce=new CustomEvent(Z_,Lv);o.addEventListener(Z_,N),o.dispatchEvent(Ce),Ce.defaultPrevented||(tS(sS(c0(o)),{select:!0}),document.activeElement===ie&&Sh(o))}return()=>{o.removeEventListener(Z_,N),setTimeout(()=>{const Ce=new CustomEvent(q_,Lv);o.addEventListener(q_,Z),o.dispatchEvent(Ce),Ce.defaultPrevented||Sh(ie??document.body,{select:!0}),o.removeEventListener(q_,Z),Bv.remove(U)},0)}}},[o,N,Z,U]);const le=J.useCallback(ie=>{if(!g&&!b||U.paused)return;const me=ie.key==="Tab"&&!ie.altKey&&!ie.ctrlKey&&!ie.metaKey,Ce=document.activeElement;if(me&&Ce){const Se=ie.currentTarget,[Ee,ke]=iS(Se);Ee&&ke?!ie.shiftKey&&Ce===ke?(ie.preventDefault(),g&&Sh(Ee,{select:!0})):ie.shiftKey&&Ce===Ee&&(ie.preventDefault(),g&&Sh(ke,{select:!0})):Ce===Se&&ie.preventDefault()}},[g,b,U.paused]);return pe.jsx(Rn.div,{tabIndex:-1,...T,ref:ee,onKeyDown:le})});l0.displayName=eS;function tS(p,{select:h=!1}={}){const g=document.activeElement;for(const b of p)if(Sh(b,{select:h}),document.activeElement!==g)return}function iS(p){const h=c0(p),g=Ov(h,p),b=Ov(h.reverse(),p);return[g,b]}function c0(p){const h=[],g=document.createTreeWalker(p,NodeFilter.SHOW_ELEMENT,{acceptNode:b=>{const C=b.tagName==="INPUT"&&b.type==="hidden";return b.disabled||b.hidden||C?NodeFilter.FILTER_SKIP:b.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;g.nextNode();)h.push(g.currentNode);return h}function Ov(p,h){for(const g of p)if(!nS(g,{upTo:h}))return g}function nS(p,{upTo:h}){if(getComputedStyle(p).visibility==="hidden")return!0;for(;p;){if(h!==void 0&&p===h)return!1;if(getComputedStyle(p).display==="none")return!0;p=p.parentElement}return!1}function rS(p){return p instanceof HTMLInputElement&&"select"in p}function Sh(p,{select:h=!1}={}){if(p&&p.focus){const g=document.activeElement;p.focus({preventScroll:!0}),p!==g&&rS(p)&&h&&p.select()}}var Bv=aS();function aS(){let p=[];return{add(h){const g=p[0];h!==g&&(g==null||g.pause()),p=Nv(p,h),p.unshift(h)},remove(h){var g;p=Nv(p,h),(g=p[0])==null||g.resume()}}}function Nv(p,h){const g=[...p],b=g.indexOf(h);return b!==-1&&g.splice(b,1),g}function sS(p){return p.filter(h=>h.tagName!=="A")}var ba=globalThis!=null&&globalThis.document?J.useLayoutEffect:()=>{},oS=Fx[" useId ".trim().toString()]||(()=>{}),lS=0;function u_(p){const[h,g]=J.useState(oS());return ba(()=>{g(b=>b??String(lS++))},[p]),h?`radix-${h}`:""}const cS=["top","right","bottom","left"],Ih=Math.min,eo=Math.max,Jg=Math.round,Bg=Math.floor,Sc=p=>({x:p,y:p}),uS={left:"right",right:"left",bottom:"top",top:"bottom"},hS={start:"end",end:"start"};function by(p,h,g){return eo(p,Ih(h,g))}function Pu(p,h){return typeof p=="function"?p(h):p}function Ru(p){return p.split("-")[0]}function yp(p){return p.split("-")[1]}function Zy(p){return p==="x"?"y":"x"}function qy(p){return p==="y"?"height":"width"}const dS=new Set(["top","bottom"]);function bc(p){return dS.has(Ru(p))?"y":"x"}function $y(p){return Zy(bc(p))}function fS(p,h,g){g===void 0&&(g=!1);const b=yp(p),C=$y(p),R=qy(C);let T=C==="x"?b===(g?"end":"start")?"right":"left":b==="start"?"bottom":"top";return h.reference[R]>h.floating[R]&&(T=e_(T)),[T,e_(T)]}function pS(p){const h=e_(p);return[wy(p),h,wy(h)]}function wy(p){return p.replace(/start|end/g,h=>hS[h])}const jv=["left","right"],Fv=["right","left"],mS=["top","bottom"],gS=["bottom","top"];function _S(p,h,g){switch(p){case"top":case"bottom":return g?h?Fv:jv:h?jv:Fv;case"left":case"right":return h?mS:gS;default:return[]}}function yS(p,h,g,b){const C=yp(p);let R=_S(Ru(p),g==="start",b);return C&&(R=R.map(T=>T+"-"+C),h&&(R=R.concat(R.map(wy)))),R}function e_(p){return p.replace(/left|right|bottom|top/g,h=>uS[h])}function vS(p){return{top:0,right:0,bottom:0,left:0,...p}}function u0(p){return typeof p!="number"?vS(p):{top:p,right:p,bottom:p,left:p}}function t_(p){const{x:h,y:g,width:b,height:C}=p;return{width:b,height:C,top:g,left:h,right:h+b,bottom:g+C,x:h,y:g}}function Uv(p,h,g){let{reference:b,floating:C}=p;const R=bc(h),T=$y(h),o=qy(T),L=Ru(h),N=R==="y",Z=b.x+b.width/2-C.width/2,Y=b.y+b.height/2-C.height/2,ee=b[o]/2-C[o]/2;let U;switch(L){case"top":U={x:Z,y:b.y-C.height};break;case"bottom":U={x:Z,y:b.y+b.height};break;case"right":U={x:b.x+b.width,y:Y};break;case"left":U={x:b.x-C.width,y:Y};break;default:U={x:b.x,y:b.y}}switch(yp(h)){case"start":U[T]-=ee*(g&&N?-1:1);break;case"end":U[T]+=ee*(g&&N?-1:1);break}return U}const xS=async(p,h,g)=>{const{placement:b="bottom",strategy:C="absolute",middleware:R=[],platform:T}=g,o=R.filter(Boolean),L=await(T.isRTL==null?void 0:T.isRTL(h));let N=await T.getElementRects({reference:p,floating:h,strategy:C}),{x:Z,y:Y}=Uv(N,b,L),ee=b,U={},le=0;for(let ie=0;ie<o.length;ie++){const{name:me,fn:Ce}=o[ie],{x:Se,y:Ee,data:ke,reset:Ve}=await Ce({x:Z,y:Y,initialPlacement:b,placement:ee,strategy:C,middlewareData:U,rects:N,platform:T,elements:{reference:p,floating:h}});Z=Se??Z,Y=Ee??Y,U={...U,[me]:{...U[me],...ke}},Ve&&le<=50&&(le++,typeof Ve=="object"&&(Ve.placement&&(ee=Ve.placement),Ve.rects&&(N=Ve.rects===!0?await T.getElementRects({reference:p,floating:h,strategy:C}):Ve.rects),{x:Z,y:Y}=Uv(N,ee,L)),ie=-1)}return{x:Z,y:Y,placement:ee,strategy:C,middlewareData:U}};async function Pm(p,h){var g;h===void 0&&(h={});const{x:b,y:C,platform:R,rects:T,elements:o,strategy:L}=p,{boundary:N="clippingAncestors",rootBoundary:Z="viewport",elementContext:Y="floating",altBoundary:ee=!1,padding:U=0}=Pu(h,p),le=u0(U),me=o[ee?Y==="floating"?"reference":"floating":Y],Ce=t_(await R.getClippingRect({element:(g=await(R.isElement==null?void 0:R.isElement(me)))==null||g?me:me.contextElement||await(R.getDocumentElement==null?void 0:R.getDocumentElement(o.floating)),boundary:N,rootBoundary:Z,strategy:L})),Se=Y==="floating"?{x:b,y:C,width:T.floating.width,height:T.floating.height}:T.reference,Ee=await(R.getOffsetParent==null?void 0:R.getOffsetParent(o.floating)),ke=await(R.isElement==null?void 0:R.isElement(Ee))?await(R.getScale==null?void 0:R.getScale(Ee))||{x:1,y:1}:{x:1,y:1},Ve=t_(R.convertOffsetParentRelativeRectToViewportRelativeRect?await R.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:Se,offsetParent:Ee,strategy:L}):Se);return{top:(Ce.top-Ve.top+le.top)/ke.y,bottom:(Ve.bottom-Ce.bottom+le.bottom)/ke.y,left:(Ce.left-Ve.left+le.left)/ke.x,right:(Ve.right-Ce.right+le.right)/ke.x}}const bS=p=>({name:"arrow",options:p,async fn(h){const{x:g,y:b,placement:C,rects:R,platform:T,elements:o,middlewareData:L}=h,{element:N,padding:Z=0}=Pu(p,h)||{};if(N==null)return{};const Y=u0(Z),ee={x:g,y:b},U=$y(C),le=qy(U),ie=await T.getDimensions(N),me=U==="y",Ce=me?"top":"left",Se=me?"bottom":"right",Ee=me?"clientHeight":"clientWidth",ke=R.reference[le]+R.reference[U]-ee[U]-R.floating[le],Ve=ee[U]-R.reference[U],ct=await(T.getOffsetParent==null?void 0:T.getOffsetParent(N));let tt=ct?ct[Ee]:0;(!tt||!await(T.isElement==null?void 0:T.isElement(ct)))&&(tt=o.floating[Ee]||R.floating[le]);const Qe=ke/2-Ve/2,at=tt/2-ie[le]/2-1,ht=Ih(Y[Ce],at),Ct=Ih(Y[Se],at),Rt=ht,Lt=tt-ie[le]-Ct,Gt=tt/2-ie[le]/2+Qe,Ht=by(Rt,Gt,Lt),Oe=!L.arrow&&yp(C)!=null&&Gt!==Ht&&R.reference[le]/2-(Gt<Rt?ht:Ct)-ie[le]/2<0,it=Oe?Gt<Rt?Gt-Rt:Gt-Lt:0;return{[U]:ee[U]+it,data:{[U]:Ht,centerOffset:Gt-Ht-it,...Oe&&{alignmentOffset:it}},reset:Oe}}}),wS=function(p){return p===void 0&&(p={}),{name:"flip",options:p,async fn(h){var g,b;const{placement:C,middlewareData:R,rects:T,initialPlacement:o,platform:L,elements:N}=h,{mainAxis:Z=!0,crossAxis:Y=!0,fallbackPlacements:ee,fallbackStrategy:U="bestFit",fallbackAxisSideDirection:le="none",flipAlignment:ie=!0,...me}=Pu(p,h);if((g=R.arrow)!=null&&g.alignmentOffset)return{};const Ce=Ru(C),Se=bc(o),Ee=Ru(o)===o,ke=await(L.isRTL==null?void 0:L.isRTL(N.floating)),Ve=ee||(Ee||!ie?[e_(o)]:pS(o)),ct=le!=="none";!ee&&ct&&Ve.push(...yS(o,ie,le,ke));const tt=[o,...Ve],Qe=await Pm(h,me),at=[];let ht=((b=R.flip)==null?void 0:b.overflows)||[];if(Z&&at.push(Qe[Ce]),Y){const Gt=fS(C,T,ke);at.push(Qe[Gt[0]],Qe[Gt[1]])}if(ht=[...ht,{placement:C,overflows:at}],!at.every(Gt=>Gt<=0)){var Ct,Rt;const Gt=(((Ct=R.flip)==null?void 0:Ct.index)||0)+1,Ht=tt[Gt];if(Ht&&(!(Y==="alignment"?Se!==bc(Ht):!1)||ht.every(Xe=>bc(Xe.placement)===Se?Xe.overflows[0]>0:!0)))return{data:{index:Gt,overflows:ht},reset:{placement:Ht}};let Oe=(Rt=ht.filter(it=>it.overflows[0]<=0).sort((it,Xe)=>it.overflows[1]-Xe.overflows[1])[0])==null?void 0:Rt.placement;if(!Oe)switch(U){case"bestFit":{var Lt;const it=(Lt=ht.filter(Xe=>{if(ct){const St=bc(Xe.placement);return St===Se||St==="y"}return!0}).map(Xe=>[Xe.placement,Xe.overflows.filter(St=>St>0).reduce((St,be)=>St+be,0)]).sort((Xe,St)=>Xe[1]-St[1])[0])==null?void 0:Lt[0];it&&(Oe=it);break}case"initialPlacement":Oe=o;break}if(C!==Oe)return{reset:{placement:Oe}}}return{}}}};function Vv(p,h){return{top:p.top-h.height,right:p.right-h.width,bottom:p.bottom-h.height,left:p.left-h.width}}function Gv(p){return cS.some(h=>p[h]>=0)}const SS=function(p){return p===void 0&&(p={}),{name:"hide",options:p,async fn(h){const{rects:g}=h,{strategy:b="referenceHidden",...C}=Pu(p,h);switch(b){case"referenceHidden":{const R=await Pm(h,{...C,elementContext:"reference"}),T=Vv(R,g.reference);return{data:{referenceHiddenOffsets:T,referenceHidden:Gv(T)}}}case"escaped":{const R=await Pm(h,{...C,altBoundary:!0}),T=Vv(R,g.floating);return{data:{escapedOffsets:T,escaped:Gv(T)}}}default:return{}}}}},h0=new Set(["left","top"]);async function TS(p,h){const{placement:g,platform:b,elements:C}=p,R=await(b.isRTL==null?void 0:b.isRTL(C.floating)),T=Ru(g),o=yp(g),L=bc(g)==="y",N=h0.has(T)?-1:1,Z=R&&L?-1:1,Y=Pu(h,p);let{mainAxis:ee,crossAxis:U,alignmentAxis:le}=typeof Y=="number"?{mainAxis:Y,crossAxis:0,alignmentAxis:null}:{mainAxis:Y.mainAxis||0,crossAxis:Y.crossAxis||0,alignmentAxis:Y.alignmentAxis};return o&&typeof le=="number"&&(U=o==="end"?le*-1:le),L?{x:U*Z,y:ee*N}:{x:ee*N,y:U*Z}}const CS=function(p){return p===void 0&&(p=0),{name:"offset",options:p,async fn(h){var g,b;const{x:C,y:R,placement:T,middlewareData:o}=h,L=await TS(h,p);return T===((g=o.offset)==null?void 0:g.placement)&&(b=o.arrow)!=null&&b.alignmentOffset?{}:{x:C+L.x,y:R+L.y,data:{...L,placement:T}}}}},ES=function(p){return p===void 0&&(p={}),{name:"shift",options:p,async fn(h){const{x:g,y:b,placement:C}=h,{mainAxis:R=!0,crossAxis:T=!1,limiter:o={fn:me=>{let{x:Ce,y:Se}=me;return{x:Ce,y:Se}}},...L}=Pu(p,h),N={x:g,y:b},Z=await Pm(h,L),Y=bc(Ru(C)),ee=Zy(Y);let U=N[ee],le=N[Y];if(R){const me=ee==="y"?"top":"left",Ce=ee==="y"?"bottom":"right",Se=U+Z[me],Ee=U-Z[Ce];U=by(Se,U,Ee)}if(T){const me=Y==="y"?"top":"left",Ce=Y==="y"?"bottom":"right",Se=le+Z[me],Ee=le-Z[Ce];le=by(Se,le,Ee)}const ie=o.fn({...h,[ee]:U,[Y]:le});return{...ie,data:{x:ie.x-g,y:ie.y-b,enabled:{[ee]:R,[Y]:T}}}}}},MS=function(p){return p===void 0&&(p={}),{options:p,fn(h){const{x:g,y:b,placement:C,rects:R,middlewareData:T}=h,{offset:o=0,mainAxis:L=!0,crossAxis:N=!0}=Pu(p,h),Z={x:g,y:b},Y=bc(C),ee=Zy(Y);let U=Z[ee],le=Z[Y];const ie=Pu(o,h),me=typeof ie=="number"?{mainAxis:ie,crossAxis:0}:{mainAxis:0,crossAxis:0,...ie};if(L){const Ee=ee==="y"?"height":"width",ke=R.reference[ee]-R.floating[Ee]+me.mainAxis,Ve=R.reference[ee]+R.reference[Ee]-me.mainAxis;U<ke?U=ke:U>Ve&&(U=Ve)}if(N){var Ce,Se;const Ee=ee==="y"?"width":"height",ke=h0.has(Ru(C)),Ve=R.reference[Y]-R.floating[Ee]+(ke&&((Ce=T.offset)==null?void 0:Ce[Y])||0)+(ke?0:me.crossAxis),ct=R.reference[Y]+R.reference[Ee]+(ke?0:((Se=T.offset)==null?void 0:Se[Y])||0)-(ke?me.crossAxis:0);le<Ve?le=Ve:le>ct&&(le=ct)}return{[ee]:U,[Y]:le}}}},AS=function(p){return p===void 0&&(p={}),{name:"size",options:p,async fn(h){var g,b;const{placement:C,rects:R,platform:T,elements:o}=h,{apply:L=()=>{},...N}=Pu(p,h),Z=await Pm(h,N),Y=Ru(C),ee=yp(C),U=bc(C)==="y",{width:le,height:ie}=R.floating;let me,Ce;Y==="top"||Y==="bottom"?(me=Y,Ce=ee===(await(T.isRTL==null?void 0:T.isRTL(o.floating))?"start":"end")?"left":"right"):(Ce=Y,me=ee==="end"?"top":"bottom");const Se=ie-Z.top-Z.bottom,Ee=le-Z.left-Z.right,ke=Ih(ie-Z[me],Se),Ve=Ih(le-Z[Ce],Ee),ct=!h.middlewareData.shift;let tt=ke,Qe=Ve;if((g=h.middlewareData.shift)!=null&&g.enabled.x&&(Qe=Ee),(b=h.middlewareData.shift)!=null&&b.enabled.y&&(tt=Se),ct&&!ee){const ht=eo(Z.left,0),Ct=eo(Z.right,0),Rt=eo(Z.top,0),Lt=eo(Z.bottom,0);U?Qe=le-2*(ht!==0||Ct!==0?ht+Ct:eo(Z.left,Z.right)):tt=ie-2*(Rt!==0||Lt!==0?Rt+Lt:eo(Z.top,Z.bottom))}await L({...h,availableWidth:Qe,availableHeight:tt});const at=await T.getDimensions(o.floating);return le!==at.width||ie!==at.height?{reset:{rects:!0}}:{}}}};function h_(){return typeof window<"u"}function vp(p){return d0(p)?(p.nodeName||"").toLowerCase():"#document"}function to(p){var h;return(p==null||(h=p.ownerDocument)==null?void 0:h.defaultView)||window}function Cc(p){var h;return(h=(d0(p)?p.ownerDocument:p.document)||window.document)==null?void 0:h.documentElement}function d0(p){return h_()?p instanceof Node||p instanceof to(p).Node:!1}function Al(p){return h_()?p instanceof Element||p instanceof to(p).Element:!1}function Tc(p){return h_()?p instanceof HTMLElement||p instanceof to(p).HTMLElement:!1}function Zv(p){return!h_()||typeof ShadowRoot>"u"?!1:p instanceof ShadowRoot||p instanceof to(p).ShadowRoot}const PS=new Set(["inline","contents"]);function Um(p){const{overflow:h,overflowX:g,overflowY:b,display:C}=Pl(p);return/auto|scroll|overlay|hidden|clip/.test(h+b+g)&&!PS.has(C)}const RS=new Set(["table","td","th"]);function zS(p){return RS.has(vp(p))}const IS=[":popover-open",":modal"];function d_(p){return IS.some(h=>{try{return p.matches(h)}catch{return!1}})}const DS=["transform","translate","scale","rotate","perspective"],kS=["transform","translate","scale","rotate","perspective","filter"],LS=["paint","layout","strict","content"];function Hy(p){const h=Xy(),g=Al(p)?Pl(p):p;return DS.some(b=>g[b]?g[b]!=="none":!1)||(g.containerType?g.containerType!=="normal":!1)||!h&&(g.backdropFilter?g.backdropFilter!=="none":!1)||!h&&(g.filter?g.filter!=="none":!1)||kS.some(b=>(g.willChange||"").includes(b))||LS.some(b=>(g.contain||"").includes(b))}function OS(p){let h=Dh(p);for(;Tc(h)&&!pp(h);){if(Hy(h))return h;if(d_(h))return null;h=Dh(h)}return null}function Xy(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const BS=new Set(["html","body","#document"]);function pp(p){return BS.has(vp(p))}function Pl(p){return to(p).getComputedStyle(p)}function f_(p){return Al(p)?{scrollLeft:p.scrollLeft,scrollTop:p.scrollTop}:{scrollLeft:p.scrollX,scrollTop:p.scrollY}}function Dh(p){if(vp(p)==="html")return p;const h=p.assignedSlot||p.parentNode||Zv(p)&&p.host||Cc(p);return Zv(h)?h.host:h}function f0(p){const h=Dh(p);return pp(h)?p.ownerDocument?p.ownerDocument.body:p.body:Tc(h)&&Um(h)?h:f0(h)}function Rm(p,h,g){var b;h===void 0&&(h=[]),g===void 0&&(g=!0);const C=f0(p),R=C===((b=p.ownerDocument)==null?void 0:b.body),T=to(C);if(R){const o=Sy(T);return h.concat(T,T.visualViewport||[],Um(C)?C:[],o&&g?Rm(o):[])}return h.concat(C,Rm(C,[],g))}function Sy(p){return p.parent&&Object.getPrototypeOf(p.parent)?p.frameElement:null}function p0(p){const h=Pl(p);let g=parseFloat(h.width)||0,b=parseFloat(h.height)||0;const C=Tc(p),R=C?p.offsetWidth:g,T=C?p.offsetHeight:b,o=Jg(g)!==R||Jg(b)!==T;return o&&(g=R,b=T),{width:g,height:b,$:o}}function Yy(p){return Al(p)?p:p.contextElement}function Jf(p){const h=Yy(p);if(!Tc(h))return Sc(1);const g=h.getBoundingClientRect(),{width:b,height:C,$:R}=p0(h);let T=(R?Jg(g.width):g.width)/b,o=(R?Jg(g.height):g.height)/C;return(!T||!Number.isFinite(T))&&(T=1),(!o||!Number.isFinite(o))&&(o=1),{x:T,y:o}}const NS=Sc(0);function m0(p){const h=to(p);return!Xy()||!h.visualViewport?NS:{x:h.visualViewport.offsetLeft,y:h.visualViewport.offsetTop}}function jS(p,h,g){return h===void 0&&(h=!1),!g||h&&g!==to(p)?!1:h}function qd(p,h,g,b){h===void 0&&(h=!1),g===void 0&&(g=!1);const C=p.getBoundingClientRect(),R=Yy(p);let T=Sc(1);h&&(b?Al(b)&&(T=Jf(b)):T=Jf(p));const o=jS(R,g,b)?m0(R):Sc(0);let L=(C.left+o.x)/T.x,N=(C.top+o.y)/T.y,Z=C.width/T.x,Y=C.height/T.y;if(R){const ee=to(R),U=b&&Al(b)?to(b):b;let le=ee,ie=Sy(le);for(;ie&&b&&U!==le;){const me=Jf(ie),Ce=ie.getBoundingClientRect(),Se=Pl(ie),Ee=Ce.left+(ie.clientLeft+parseFloat(Se.paddingLeft))*me.x,ke=Ce.top+(ie.clientTop+parseFloat(Se.paddingTop))*me.y;L*=me.x,N*=me.y,Z*=me.x,Y*=me.y,L+=Ee,N+=ke,le=to(ie),ie=Sy(le)}}return t_({width:Z,height:Y,x:L,y:N})}function p_(p,h){const g=f_(p).scrollLeft;return h?h.left+g:qd(Cc(p)).left+g}function g0(p,h){const g=p.getBoundingClientRect(),b=g.left+h.scrollLeft-p_(p,g),C=g.top+h.scrollTop;return{x:b,y:C}}function FS(p){let{elements:h,rect:g,offsetParent:b,strategy:C}=p;const R=C==="fixed",T=Cc(b),o=h?d_(h.floating):!1;if(b===T||o&&R)return g;let L={scrollLeft:0,scrollTop:0},N=Sc(1);const Z=Sc(0),Y=Tc(b);if((Y||!Y&&!R)&&((vp(b)!=="body"||Um(T))&&(L=f_(b)),Tc(b))){const U=qd(b);N=Jf(b),Z.x=U.x+b.clientLeft,Z.y=U.y+b.clientTop}const ee=T&&!Y&&!R?g0(T,L):Sc(0);return{width:g.width*N.x,height:g.height*N.y,x:g.x*N.x-L.scrollLeft*N.x+Z.x+ee.x,y:g.y*N.y-L.scrollTop*N.y+Z.y+ee.y}}function US(p){return Array.from(p.getClientRects())}function VS(p){const h=Cc(p),g=f_(p),b=p.ownerDocument.body,C=eo(h.scrollWidth,h.clientWidth,b.scrollWidth,b.clientWidth),R=eo(h.scrollHeight,h.clientHeight,b.scrollHeight,b.clientHeight);let T=-g.scrollLeft+p_(p);const o=-g.scrollTop;return Pl(b).direction==="rtl"&&(T+=eo(h.clientWidth,b.clientWidth)-C),{width:C,height:R,x:T,y:o}}const qv=25;function GS(p,h){const g=to(p),b=Cc(p),C=g.visualViewport;let R=b.clientWidth,T=b.clientHeight,o=0,L=0;if(C){R=C.width,T=C.height;const Z=Xy();(!Z||Z&&h==="fixed")&&(o=C.offsetLeft,L=C.offsetTop)}const N=p_(b);if(N<=0){const Z=b.ownerDocument,Y=Z.body,ee=getComputedStyle(Y),U=Z.compatMode==="CSS1Compat"&&parseFloat(ee.marginLeft)+parseFloat(ee.marginRight)||0,le=Math.abs(b.clientWidth-Y.clientWidth-U);le<=qv&&(R-=le)}else N<=qv&&(R+=N);return{width:R,height:T,x:o,y:L}}const ZS=new Set(["absolute","fixed"]);function qS(p,h){const g=qd(p,!0,h==="fixed"),b=g.top+p.clientTop,C=g.left+p.clientLeft,R=Tc(p)?Jf(p):Sc(1),T=p.clientWidth*R.x,o=p.clientHeight*R.y,L=C*R.x,N=b*R.y;return{width:T,height:o,x:L,y:N}}function $v(p,h,g){let b;if(h==="viewport")b=GS(p,g);else if(h==="document")b=VS(Cc(p));else if(Al(h))b=qS(h,g);else{const C=m0(p);b={x:h.x-C.x,y:h.y-C.y,width:h.width,height:h.height}}return t_(b)}function _0(p,h){const g=Dh(p);return g===h||!Al(g)||pp(g)?!1:Pl(g).position==="fixed"||_0(g,h)}function $S(p,h){const g=h.get(p);if(g)return g;let b=Rm(p,[],!1).filter(o=>Al(o)&&vp(o)!=="body"),C=null;const R=Pl(p).position==="fixed";let T=R?Dh(p):p;for(;Al(T)&&!pp(T);){const o=Pl(T),L=Hy(T);!L&&o.position==="fixed"&&(C=null),(R?!L&&!C:!L&&o.position==="static"&&!!C&&ZS.has(C.position)||Um(T)&&!L&&_0(p,T))?b=b.filter(Z=>Z!==T):C=o,T=Dh(T)}return h.set(p,b),b}function HS(p){let{element:h,boundary:g,rootBoundary:b,strategy:C}=p;const T=[...g==="clippingAncestors"?d_(h)?[]:$S(h,this._c):[].concat(g),b],o=T[0],L=T.reduce((N,Z)=>{const Y=$v(h,Z,C);return N.top=eo(Y.top,N.top),N.right=Ih(Y.right,N.right),N.bottom=Ih(Y.bottom,N.bottom),N.left=eo(Y.left,N.left),N},$v(h,o,C));return{width:L.right-L.left,height:L.bottom-L.top,x:L.left,y:L.top}}function XS(p){const{width:h,height:g}=p0(p);return{width:h,height:g}}function YS(p,h,g){const b=Tc(h),C=Cc(h),R=g==="fixed",T=qd(p,!0,R,h);let o={scrollLeft:0,scrollTop:0};const L=Sc(0);function N(){L.x=p_(C)}if(b||!b&&!R)if((vp(h)!=="body"||Um(C))&&(o=f_(h)),b){const U=qd(h,!0,R,h);L.x=U.x+h.clientLeft,L.y=U.y+h.clientTop}else C&&N();R&&!b&&C&&N();const Z=C&&!b&&!R?g0(C,o):Sc(0),Y=T.left+o.scrollLeft-L.x-Z.x,ee=T.top+o.scrollTop-L.y-Z.y;return{x:Y,y:ee,width:T.width,height:T.height}}function $_(p){return Pl(p).position==="static"}function Hv(p,h){if(!Tc(p)||Pl(p).position==="fixed")return null;if(h)return h(p);let g=p.offsetParent;return Cc(p)===g&&(g=g.ownerDocument.body),g}function y0(p,h){const g=to(p);if(d_(p))return g;if(!Tc(p)){let C=Dh(p);for(;C&&!pp(C);){if(Al(C)&&!$_(C))return C;C=Dh(C)}return g}let b=Hv(p,h);for(;b&&zS(b)&&$_(b);)b=Hv(b,h);return b&&pp(b)&&$_(b)&&!Hy(b)?g:b||OS(p)||g}const WS=async function(p){const h=this.getOffsetParent||y0,g=this.getDimensions,b=await g(p.floating);return{reference:YS(p.reference,await h(p.floating),p.strategy),floating:{x:0,y:0,width:b.width,height:b.height}}};function KS(p){return Pl(p).direction==="rtl"}const QS={convertOffsetParentRelativeRectToViewportRelativeRect:FS,getDocumentElement:Cc,getClippingRect:HS,getOffsetParent:y0,getElementRects:WS,getClientRects:US,getDimensions:XS,getScale:Jf,isElement:Al,isRTL:KS};function v0(p,h){return p.x===h.x&&p.y===h.y&&p.width===h.width&&p.height===h.height}function JS(p,h){let g=null,b;const C=Cc(p);function R(){var o;clearTimeout(b),(o=g)==null||o.disconnect(),g=null}function T(o,L){o===void 0&&(o=!1),L===void 0&&(L=1),R();const N=p.getBoundingClientRect(),{left:Z,top:Y,width:ee,height:U}=N;if(o||h(),!ee||!U)return;const le=Bg(Y),ie=Bg(C.clientWidth-(Z+ee)),me=Bg(C.clientHeight-(Y+U)),Ce=Bg(Z),Ee={rootMargin:-le+"px "+-ie+"px "+-me+"px "+-Ce+"px",threshold:eo(0,Ih(1,L))||1};let ke=!0;function Ve(ct){const tt=ct[0].intersectionRatio;if(tt!==L){if(!ke)return T();tt?T(!1,tt):b=setTimeout(()=>{T(!1,1e-7)},1e3)}tt===1&&!v0(N,p.getBoundingClientRect())&&T(),ke=!1}try{g=new IntersectionObserver(Ve,{...Ee,root:C.ownerDocument})}catch{g=new IntersectionObserver(Ve,Ee)}g.observe(p)}return T(!0),R}function e2(p,h,g,b){b===void 0&&(b={});const{ancestorScroll:C=!0,ancestorResize:R=!0,elementResize:T=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:L=!1}=b,N=Yy(p),Z=C||R?[...N?Rm(N):[],...Rm(h)]:[];Z.forEach(Ce=>{C&&Ce.addEventListener("scroll",g,{passive:!0}),R&&Ce.addEventListener("resize",g)});const Y=N&&o?JS(N,g):null;let ee=-1,U=null;T&&(U=new ResizeObserver(Ce=>{let[Se]=Ce;Se&&Se.target===N&&U&&(U.unobserve(h),cancelAnimationFrame(ee),ee=requestAnimationFrame(()=>{var Ee;(Ee=U)==null||Ee.observe(h)})),g()}),N&&!L&&U.observe(N),U.observe(h));let le,ie=L?qd(p):null;L&&me();function me(){const Ce=qd(p);ie&&!v0(ie,Ce)&&g(),ie=Ce,le=requestAnimationFrame(me)}return g(),()=>{var Ce;Z.forEach(Se=>{C&&Se.removeEventListener("scroll",g),R&&Se.removeEventListener("resize",g)}),Y==null||Y(),(Ce=U)==null||Ce.disconnect(),U=null,L&&cancelAnimationFrame(le)}}const t2=CS,i2=ES,n2=wS,r2=AS,a2=SS,Xv=bS,s2=MS,o2=(p,h,g)=>{const b=new Map,C={platform:QS,...g},R={...C.platform,_c:b};return xS(p,h,{...C,platform:R})};var l2=typeof document<"u",c2=function(){},Hg=l2?J.useLayoutEffect:c2;function i_(p,h){if(p===h)return!0;if(typeof p!=typeof h)return!1;if(typeof p=="function"&&p.toString()===h.toString())return!0;let g,b,C;if(p&&h&&typeof p=="object"){if(Array.isArray(p)){if(g=p.length,g!==h.length)return!1;for(b=g;b--!==0;)if(!i_(p[b],h[b]))return!1;return!0}if(C=Object.keys(p),g=C.length,g!==Object.keys(h).length)return!1;for(b=g;b--!==0;)if(!{}.hasOwnProperty.call(h,C[b]))return!1;for(b=g;b--!==0;){const R=C[b];if(!(R==="_owner"&&p.$$typeof)&&!i_(p[R],h[R]))return!1}return!0}return p!==p&&h!==h}function x0(p){return typeof window>"u"?1:(p.ownerDocument.defaultView||window).devicePixelRatio||1}function Yv(p,h){const g=x0(p);return Math.round(h*g)/g}function H_(p){const h=J.useRef(p);return Hg(()=>{h.current=p}),h}function u2(p){p===void 0&&(p={});const{placement:h="bottom",strategy:g="absolute",middleware:b=[],platform:C,elements:{reference:R,floating:T}={},transform:o=!0,whileElementsMounted:L,open:N}=p,[Z,Y]=J.useState({x:0,y:0,strategy:g,placement:h,middlewareData:{},isPositioned:!1}),[ee,U]=J.useState(b);i_(ee,b)||U(b);const[le,ie]=J.useState(null),[me,Ce]=J.useState(null),Se=J.useCallback(Xe=>{Xe!==ct.current&&(ct.current=Xe,ie(Xe))},[]),Ee=J.useCallback(Xe=>{Xe!==tt.current&&(tt.current=Xe,Ce(Xe))},[]),ke=R||le,Ve=T||me,ct=J.useRef(null),tt=J.useRef(null),Qe=J.useRef(Z),at=L!=null,ht=H_(L),Ct=H_(C),Rt=H_(N),Lt=J.useCallback(()=>{if(!ct.current||!tt.current)return;const Xe={placement:h,strategy:g,middleware:ee};Ct.current&&(Xe.platform=Ct.current),o2(ct.current,tt.current,Xe).then(St=>{const be={...St,isPositioned:Rt.current!==!1};Gt.current&&!i_(Qe.current,be)&&(Qe.current=be,jm.flushSync(()=>{Y(be)}))})},[ee,h,g,Ct,Rt]);Hg(()=>{N===!1&&Qe.current.isPositioned&&(Qe.current.isPositioned=!1,Y(Xe=>({...Xe,isPositioned:!1})))},[N]);const Gt=J.useRef(!1);Hg(()=>(Gt.current=!0,()=>{Gt.current=!1}),[]),Hg(()=>{if(ke&&(ct.current=ke),Ve&&(tt.current=Ve),ke&&Ve){if(ht.current)return ht.current(ke,Ve,Lt);Lt()}},[ke,Ve,Lt,ht,at]);const Ht=J.useMemo(()=>({reference:ct,floating:tt,setReference:Se,setFloating:Ee}),[Se,Ee]),Oe=J.useMemo(()=>({reference:ke,floating:Ve}),[ke,Ve]),it=J.useMemo(()=>{const Xe={position:g,left:0,top:0};if(!Oe.floating)return Xe;const St=Yv(Oe.floating,Z.x),be=Yv(Oe.floating,Z.y);return o?{...Xe,transform:"translate("+St+"px, "+be+"px)",...x0(Oe.floating)>=1.5&&{willChange:"transform"}}:{position:g,left:St,top:be}},[g,o,Oe.floating,Z.x,Z.y]);return J.useMemo(()=>({...Z,update:Lt,refs:Ht,elements:Oe,floatingStyles:it}),[Z,Lt,Ht,Oe,it])}const h2=p=>{function h(g){return{}.hasOwnProperty.call(g,"current")}return{name:"arrow",options:p,fn(g){const{element:b,padding:C}=typeof p=="function"?p(g):p;return b&&h(b)?b.current!=null?Xv({element:b.current,padding:C}).fn(g):{}:b?Xv({element:b,padding:C}).fn(g):{}}}},d2=(p,h)=>({...t2(p),options:[p,h]}),f2=(p,h)=>({...i2(p),options:[p,h]}),p2=(p,h)=>({...s2(p),options:[p,h]}),m2=(p,h)=>({...n2(p),options:[p,h]}),g2=(p,h)=>({...r2(p),options:[p,h]}),_2=(p,h)=>({...a2(p),options:[p,h]}),y2=(p,h)=>({...h2(p),options:[p,h]});var v2="Arrow",b0=J.forwardRef((p,h)=>{const{children:g,width:b=10,height:C=5,...R}=p;return pe.jsx(Rn.svg,{...R,ref:h,width:b,height:C,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:p.asChild?g:pe.jsx("polygon",{points:"0,0 30,0 15,10"})})});b0.displayName=v2;var x2=b0;function b2(p){const[h,g]=J.useState(void 0);return ba(()=>{if(p){g({width:p.offsetWidth,height:p.offsetHeight});const b=new ResizeObserver(C=>{if(!Array.isArray(C)||!C.length)return;const R=C[0];let T,o;if("borderBoxSize"in R){const L=R.borderBoxSize,N=Array.isArray(L)?L[0]:L;T=N.inlineSize,o=N.blockSize}else T=p.offsetWidth,o=p.offsetHeight;g({width:T,height:o})});return b.observe(p,{box:"border-box"}),()=>b.unobserve(p)}else g(void 0)},[p]),h}var Wy="Popper",[w0,m_]=Fm(Wy),[w2,S0]=w0(Wy),T0=p=>{const{__scopePopper:h,children:g}=p,[b,C]=J.useState(null);return pe.jsx(w2,{scope:h,anchor:b,onAnchorChange:C,children:g})};T0.displayName=Wy;var C0="PopperAnchor",E0=J.forwardRef((p,h)=>{const{__scopePopper:g,virtualRef:b,...C}=p,R=S0(C0,g),T=J.useRef(null),o=Gn(h,T),L=J.useRef(null);return J.useEffect(()=>{const N=L.current;L.current=(b==null?void 0:b.current)||T.current,N!==L.current&&R.onAnchorChange(L.current)}),b?null:pe.jsx(Rn.div,{...C,ref:o})});E0.displayName=C0;var Ky="PopperContent",[S2,T2]=w0(Ky),M0=J.forwardRef((p,h)=>{var At,Nt,bi,wi,gi,ni;const{__scopePopper:g,side:b="bottom",sideOffset:C=0,align:R="center",alignOffset:T=0,arrowPadding:o=0,avoidCollisions:L=!0,collisionBoundary:N=[],collisionPadding:Z=0,sticky:Y="partial",hideWhenDetached:ee=!1,updatePositionStrategy:U="optimized",onPlaced:le,...ie}=p,me=S0(Ky,g),[Ce,Se]=J.useState(null),Ee=Gn(h,Ti=>Se(Ti)),[ke,Ve]=J.useState(null),ct=b2(ke),tt=(ct==null?void 0:ct.width)??0,Qe=(ct==null?void 0:ct.height)??0,at=b+(R!=="center"?"-"+R:""),ht=typeof Z=="number"?Z:{top:0,right:0,bottom:0,left:0,...Z},Ct=Array.isArray(N)?N:[N],Rt=Ct.length>0,Lt={padding:ht,boundary:Ct.filter(E2),altBoundary:Rt},{refs:Gt,floatingStyles:Ht,placement:Oe,isPositioned:it,middlewareData:Xe}=u2({strategy:"fixed",placement:at,whileElementsMounted:(...Ti)=>e2(...Ti,{animationFrame:U==="always"}),elements:{reference:me.anchor},middleware:[d2({mainAxis:C+Qe,alignmentAxis:T}),L&&f2({mainAxis:!0,crossAxis:!1,limiter:Y==="partial"?p2():void 0,...Lt}),L&&m2({...Lt}),g2({...Lt,apply:({elements:Ti,rects:ki,availableWidth:fr,availableHeight:Mr})=>{const{width:zn,height:wa}=ki.reference,Ar=Ti.floating.style;Ar.setProperty("--radix-popper-available-width",`${fr}px`),Ar.setProperty("--radix-popper-available-height",`${Mr}px`),Ar.setProperty("--radix-popper-anchor-width",`${zn}px`),Ar.setProperty("--radix-popper-anchor-height",`${wa}px`)}}),ke&&y2({element:ke,padding:o}),M2({arrowWidth:tt,arrowHeight:Qe}),ee&&_2({strategy:"referenceHidden",...Lt})]}),[St,be]=R0(Oe),Ke=Ms(le);ba(()=>{it&&(Ke==null||Ke())},[it,Ke]);const wt=(At=Xe.arrow)==null?void 0:At.x,ft=(Nt=Xe.arrow)==null?void 0:Nt.y,Et=((bi=Xe.arrow)==null?void 0:bi.centerOffset)!==0,[Kt,kt]=J.useState();return ba(()=>{Ce&&kt(window.getComputedStyle(Ce).zIndex)},[Ce]),pe.jsx("div",{ref:Gt.setFloating,"data-radix-popper-content-wrapper":"",style:{...Ht,transform:it?Ht.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Kt,"--radix-popper-transform-origin":[(wi=Xe.transformOrigin)==null?void 0:wi.x,(gi=Xe.transformOrigin)==null?void 0:gi.y].join(" "),...((ni=Xe.hide)==null?void 0:ni.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:p.dir,children:pe.jsx(S2,{scope:g,placedSide:St,onArrowChange:Ve,arrowX:wt,arrowY:ft,shouldHideArrow:Et,children:pe.jsx(Rn.div,{"data-side":St,"data-align":be,...ie,ref:Ee,style:{...ie.style,animation:it?void 0:"none"}})})})});M0.displayName=Ky;var A0="PopperArrow",C2={top:"bottom",right:"left",bottom:"top",left:"right"},P0=J.forwardRef(function(h,g){const{__scopePopper:b,...C}=h,R=T2(A0,b),T=C2[R.placedSide];return pe.jsx("span",{ref:R.onArrowChange,style:{position:"absolute",left:R.arrowX,top:R.arrowY,[T]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[R.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[R.placedSide],visibility:R.shouldHideArrow?"hidden":void 0},children:pe.jsx(x2,{...C,ref:g,style:{...C.style,display:"block"}})})});P0.displayName=A0;function E2(p){return p!==null}var M2=p=>({name:"transformOrigin",options:p,fn(h){var me,Ce,Se;const{placement:g,rects:b,middlewareData:C}=h,T=((me=C.arrow)==null?void 0:me.centerOffset)!==0,o=T?0:p.arrowWidth,L=T?0:p.arrowHeight,[N,Z]=R0(g),Y={start:"0%",center:"50%",end:"100%"}[Z],ee=(((Ce=C.arrow)==null?void 0:Ce.x)??0)+o/2,U=(((Se=C.arrow)==null?void 0:Se.y)??0)+L/2;let le="",ie="";return N==="bottom"?(le=T?Y:`${ee}px`,ie=`${-L}px`):N==="top"?(le=T?Y:`${ee}px`,ie=`${b.floating.height+L}px`):N==="right"?(le=`${-L}px`,ie=T?Y:`${U}px`):N==="left"&&(le=`${b.floating.width+L}px`,ie=T?Y:`${U}px`),{data:{x:le,y:ie}}}});function R0(p){const[h,g="center"]=p.split("-");return[h,g]}var z0=T0,I0=E0,D0=M0,k0=P0,A2="Portal",Qy=J.forwardRef((p,h)=>{var o;const{container:g,...b}=p,[C,R]=J.useState(!1);ba(()=>R(!0),[]);const T=g||C&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return T?kw.createPortal(pe.jsx(Rn.div,{...b,ref:h}),T):null});Qy.displayName=A2;var P2=Fx[" useInsertionEffect ".trim().toString()]||ba;function Ty({prop:p,defaultProp:h,onChange:g=()=>{},caller:b}){const[C,R,T]=R2({defaultProp:h,onChange:g}),o=p!==void 0,L=o?p:C;{const Z=J.useRef(p!==void 0);J.useEffect(()=>{const Y=Z.current;Y!==o&&console.warn(`${b} is changing from ${Y?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),Z.current=o},[o,b])}const N=J.useCallback(Z=>{var Y;if(o){const ee=z2(Z)?Z(p):Z;ee!==p&&((Y=T.current)==null||Y.call(T,ee))}else R(Z)},[o,p,R,T]);return[L,N]}function R2({defaultProp:p,onChange:h}){const[g,b]=J.useState(p),C=J.useRef(g),R=J.useRef(h);return P2(()=>{R.current=h},[h]),J.useEffect(()=>{var T;C.current!==g&&((T=R.current)==null||T.call(R,g),C.current=g)},[g,C]),[g,b,R]}function z2(p){return typeof p=="function"}function I2(p){const h=J.useRef({value:p,previous:p});return J.useMemo(()=>(h.current.value!==p&&(h.current.previous=h.current.value,h.current.value=p),h.current.previous),[p])}var L0=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),D2="VisuallyHidden",O0=J.forwardRef((p,h)=>pe.jsx(Rn.span,{...p,ref:h,style:{...L0,...p.style}}));O0.displayName=D2;var k2=O0,L2=function(p){if(typeof document>"u")return null;var h=Array.isArray(p)?p[0]:p;return h.ownerDocument.body},$f=new WeakMap,Ng=new WeakMap,jg={},X_=0,B0=function(p){return p&&(p.host||B0(p.parentNode))},O2=function(p,h){return h.map(function(g){if(p.contains(g))return g;var b=B0(g);return b&&p.contains(b)?b:(console.error("aria-hidden",g,"in not contained inside",p,". Doing nothing"),null)}).filter(function(g){return!!g})},B2=function(p,h,g,b){var C=O2(h,Array.isArray(p)?p:[p]);jg[g]||(jg[g]=new WeakMap);var R=jg[g],T=[],o=new Set,L=new Set(C),N=function(Y){!Y||o.has(Y)||(o.add(Y),N(Y.parentNode))};C.forEach(N);var Z=function(Y){!Y||L.has(Y)||Array.prototype.forEach.call(Y.children,function(ee){if(o.has(ee))Z(ee);else try{var U=ee.getAttribute(b),le=U!==null&&U!=="false",ie=($f.get(ee)||0)+1,me=(R.get(ee)||0)+1;$f.set(ee,ie),R.set(ee,me),T.push(ee),ie===1&&le&&Ng.set(ee,!0),me===1&&ee.setAttribute(g,"true"),le||ee.setAttribute(b,"true")}catch(Ce){console.error("aria-hidden: cannot operate on ",ee,Ce)}})};return Z(h),o.clear(),X_++,function(){T.forEach(function(Y){var ee=$f.get(Y)-1,U=R.get(Y)-1;$f.set(Y,ee),R.set(Y,U),ee||(Ng.has(Y)||Y.removeAttribute(b),Ng.delete(Y)),U||Y.removeAttribute(g)}),X_--,X_||($f=new WeakMap,$f=new WeakMap,Ng=new WeakMap,jg={})}},N2=function(p,h,g){g===void 0&&(g="data-aria-hidden");var b=Array.from(Array.isArray(p)?p:[p]),C=L2(p);return C?(b.push.apply(b,Array.from(C.querySelectorAll("[aria-live], script"))),B2(b,C,g,"aria-hidden")):function(){return null}},xc=function(){return xc=Object.assign||function(h){for(var g,b=1,C=arguments.length;b<C;b++){g=arguments[b];for(var R in g)Object.prototype.hasOwnProperty.call(g,R)&&(h[R]=g[R])}return h},xc.apply(this,arguments)};function N0(p,h){var g={};for(var b in p)Object.prototype.hasOwnProperty.call(p,b)&&h.indexOf(b)<0&&(g[b]=p[b]);if(p!=null&&typeof Object.getOwnPropertySymbols=="function")for(var C=0,b=Object.getOwnPropertySymbols(p);C<b.length;C++)h.indexOf(b[C])<0&&Object.prototype.propertyIsEnumerable.call(p,b[C])&&(g[b[C]]=p[b[C]]);return g}function j2(p,h,g){if(g||arguments.length===2)for(var b=0,C=h.length,R;b<C;b++)(R||!(b in h))&&(R||(R=Array.prototype.slice.call(h,0,b)),R[b]=h[b]);return p.concat(R||Array.prototype.slice.call(h))}var Xg="right-scroll-bar-position",Yg="width-before-scroll-bar",F2="with-scroll-bars-hidden",U2="--removed-body-scroll-bar-size";function Y_(p,h){return typeof p=="function"?p(h):p&&(p.current=h),p}function V2(p,h){var g=J.useState(function(){return{value:p,callback:h,facade:{get current(){return g.value},set current(b){var C=g.value;C!==b&&(g.value=b,g.callback(b,C))}}}})[0];return g.callback=h,g.facade}var G2=typeof window<"u"?J.useLayoutEffect:J.useEffect,Wv=new WeakMap;function Z2(p,h){var g=V2(null,function(b){return p.forEach(function(C){return Y_(C,b)})});return G2(function(){var b=Wv.get(g);if(b){var C=new Set(b),R=new Set(p),T=g.current;C.forEach(function(o){R.has(o)||Y_(o,null)}),R.forEach(function(o){C.has(o)||Y_(o,T)})}Wv.set(g,p)},[p]),g}function q2(p){return p}function $2(p,h){h===void 0&&(h=q2);var g=[],b=!1,C={read:function(){if(b)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return g.length?g[g.length-1]:p},useMedium:function(R){var T=h(R,b);return g.push(T),function(){g=g.filter(function(o){return o!==T})}},assignSyncMedium:function(R){for(b=!0;g.length;){var T=g;g=[],T.forEach(R)}g={push:function(o){return R(o)},filter:function(){return g}}},assignMedium:function(R){b=!0;var T=[];if(g.length){var o=g;g=[],o.forEach(R),T=g}var L=function(){var Z=T;T=[],Z.forEach(R)},N=function(){return Promise.resolve().then(L)};N(),g={push:function(Z){T.push(Z),N()},filter:function(Z){return T=T.filter(Z),g}}}};return C}function H2(p){p===void 0&&(p={});var h=$2(null);return h.options=xc({async:!0,ssr:!1},p),h}var j0=function(p){var h=p.sideCar,g=N0(p,["sideCar"]);if(!h)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var b=h.read();if(!b)throw new Error("Sidecar medium not found");return J.createElement(b,xc({},g))};j0.isSideCarExport=!0;function X2(p,h){return p.useMedium(h),j0}var F0=H2(),W_=function(){},g_=J.forwardRef(function(p,h){var g=J.useRef(null),b=J.useState({onScrollCapture:W_,onWheelCapture:W_,onTouchMoveCapture:W_}),C=b[0],R=b[1],T=p.forwardProps,o=p.children,L=p.className,N=p.removeScrollBar,Z=p.enabled,Y=p.shards,ee=p.sideCar,U=p.noRelative,le=p.noIsolation,ie=p.inert,me=p.allowPinchZoom,Ce=p.as,Se=Ce===void 0?"div":Ce,Ee=p.gapMode,ke=N0(p,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),Ve=ee,ct=Z2([g,h]),tt=xc(xc({},ke),C);return J.createElement(J.Fragment,null,Z&&J.createElement(Ve,{sideCar:F0,removeScrollBar:N,shards:Y,noRelative:U,noIsolation:le,inert:ie,setCallbacks:R,allowPinchZoom:!!me,lockRef:g,gapMode:Ee}),T?J.cloneElement(J.Children.only(o),xc(xc({},tt),{ref:ct})):J.createElement(Se,xc({},tt,{className:L,ref:ct}),o))});g_.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};g_.classNames={fullWidth:Yg,zeroRight:Xg};var Y2=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function W2(){if(!document)return null;var p=document.createElement("style");p.type="text/css";var h=Y2();return h&&p.setAttribute("nonce",h),p}function K2(p,h){p.styleSheet?p.styleSheet.cssText=h:p.appendChild(document.createTextNode(h))}function Q2(p){var h=document.head||document.getElementsByTagName("head")[0];h.appendChild(p)}var J2=function(){var p=0,h=null;return{add:function(g){p==0&&(h=W2())&&(K2(h,g),Q2(h)),p++},remove:function(){p--,!p&&h&&(h.parentNode&&h.parentNode.removeChild(h),h=null)}}},eT=function(){var p=J2();return function(h,g){J.useEffect(function(){return p.add(h),function(){p.remove()}},[h&&g])}},U0=function(){var p=eT(),h=function(g){var b=g.styles,C=g.dynamic;return p(b,C),null};return h},tT={left:0,top:0,right:0,gap:0},K_=function(p){return parseInt(p||"",10)||0},iT=function(p){var h=window.getComputedStyle(document.body),g=h[p==="padding"?"paddingLeft":"marginLeft"],b=h[p==="padding"?"paddingTop":"marginTop"],C=h[p==="padding"?"paddingRight":"marginRight"];return[K_(g),K_(b),K_(C)]},nT=function(p){if(p===void 0&&(p="margin"),typeof window>"u")return tT;var h=iT(p),g=document.documentElement.clientWidth,b=window.innerWidth;return{left:h[0],top:h[1],right:h[2],gap:Math.max(0,b-g+h[2]-h[0])}},rT=U0(),ep="data-scroll-locked",aT=function(p,h,g,b){var C=p.left,R=p.top,T=p.right,o=p.gap;return g===void 0&&(g="margin"),`
  .`.concat(F2,` {
   overflow: hidden `).concat(b,`;
   padding-right: `).concat(o,"px ").concat(b,`;
  }
  body[`).concat(ep,`] {
    overflow: hidden `).concat(b,`;
    overscroll-behavior: contain;
    `).concat([h&&"position: relative ".concat(b,";"),g==="margin"&&`
    padding-left: `.concat(C,`px;
    padding-top: `).concat(R,`px;
    padding-right: `).concat(T,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(b,`;
    `),g==="padding"&&"padding-right: ".concat(o,"px ").concat(b,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Xg,` {
    right: `).concat(o,"px ").concat(b,`;
  }
  
  .`).concat(Yg,` {
    margin-right: `).concat(o,"px ").concat(b,`;
  }
  
  .`).concat(Xg," .").concat(Xg,` {
    right: 0 `).concat(b,`;
  }
  
  .`).concat(Yg," .").concat(Yg,` {
    margin-right: 0 `).concat(b,`;
  }
  
  body[`).concat(ep,`] {
    `).concat(U2,": ").concat(o,`px;
  }
`)},Kv=function(){var p=parseInt(document.body.getAttribute(ep)||"0",10);return isFinite(p)?p:0},sT=function(){J.useEffect(function(){return document.body.setAttribute(ep,(Kv()+1).toString()),function(){var p=Kv()-1;p<=0?document.body.removeAttribute(ep):document.body.setAttribute(ep,p.toString())}},[])},oT=function(p){var h=p.noRelative,g=p.noImportant,b=p.gapMode,C=b===void 0?"margin":b;sT();var R=J.useMemo(function(){return nT(C)},[C]);return J.createElement(rT,{styles:aT(R,!h,C,g?"":"!important")})},Cy=!1;if(typeof window<"u")try{var Fg=Object.defineProperty({},"passive",{get:function(){return Cy=!0,!0}});window.addEventListener("test",Fg,Fg),window.removeEventListener("test",Fg,Fg)}catch{Cy=!1}var Hf=Cy?{passive:!1}:!1,lT=function(p){return p.tagName==="TEXTAREA"},V0=function(p,h){if(!(p instanceof Element))return!1;var g=window.getComputedStyle(p);return g[h]!=="hidden"&&!(g.overflowY===g.overflowX&&!lT(p)&&g[h]==="visible")},cT=function(p){return V0(p,"overflowY")},uT=function(p){return V0(p,"overflowX")},Qv=function(p,h){var g=h.ownerDocument,b=h;do{typeof ShadowRoot<"u"&&b instanceof ShadowRoot&&(b=b.host);var C=G0(p,b);if(C){var R=Z0(p,b),T=R[1],o=R[2];if(T>o)return!0}b=b.parentNode}while(b&&b!==g.body);return!1},hT=function(p){var h=p.scrollTop,g=p.scrollHeight,b=p.clientHeight;return[h,g,b]},dT=function(p){var h=p.scrollLeft,g=p.scrollWidth,b=p.clientWidth;return[h,g,b]},G0=function(p,h){return p==="v"?cT(h):uT(h)},Z0=function(p,h){return p==="v"?hT(h):dT(h)},fT=function(p,h){return p==="h"&&h==="rtl"?-1:1},pT=function(p,h,g,b,C){var R=fT(p,window.getComputedStyle(h).direction),T=R*b,o=g.target,L=h.contains(o),N=!1,Z=T>0,Y=0,ee=0;do{if(!o)break;var U=Z0(p,o),le=U[0],ie=U[1],me=U[2],Ce=ie-me-R*le;(le||Ce)&&G0(p,o)&&(Y+=Ce,ee+=le);var Se=o.parentNode;o=Se&&Se.nodeType===Node.DOCUMENT_FRAGMENT_NODE?Se.host:Se}while(!L&&o!==document.body||L&&(h.contains(o)||h===o));return(Z&&Math.abs(Y)<1||!Z&&Math.abs(ee)<1)&&(N=!0),N},Ug=function(p){return"changedTouches"in p?[p.changedTouches[0].clientX,p.changedTouches[0].clientY]:[0,0]},Jv=function(p){return[p.deltaX,p.deltaY]},ex=function(p){return p&&"current"in p?p.current:p},mT=function(p,h){return p[0]===h[0]&&p[1]===h[1]},gT=function(p){return`
  .block-interactivity-`.concat(p,` {pointer-events: none;}
  .allow-interactivity-`).concat(p,` {pointer-events: all;}
`)},_T=0,Xf=[];function yT(p){var h=J.useRef([]),g=J.useRef([0,0]),b=J.useRef(),C=J.useState(_T++)[0],R=J.useState(U0)[0],T=J.useRef(p);J.useEffect(function(){T.current=p},[p]),J.useEffect(function(){if(p.inert){document.body.classList.add("block-interactivity-".concat(C));var ie=j2([p.lockRef.current],(p.shards||[]).map(ex),!0).filter(Boolean);return ie.forEach(function(me){return me.classList.add("allow-interactivity-".concat(C))}),function(){document.body.classList.remove("block-interactivity-".concat(C)),ie.forEach(function(me){return me.classList.remove("allow-interactivity-".concat(C))})}}},[p.inert,p.lockRef.current,p.shards]);var o=J.useCallback(function(ie,me){if("touches"in ie&&ie.touches.length===2||ie.type==="wheel"&&ie.ctrlKey)return!T.current.allowPinchZoom;var Ce=Ug(ie),Se=g.current,Ee="deltaX"in ie?ie.deltaX:Se[0]-Ce[0],ke="deltaY"in ie?ie.deltaY:Se[1]-Ce[1],Ve,ct=ie.target,tt=Math.abs(Ee)>Math.abs(ke)?"h":"v";if("touches"in ie&&tt==="h"&&ct.type==="range")return!1;var Qe=Qv(tt,ct);if(!Qe)return!0;if(Qe?Ve=tt:(Ve=tt==="v"?"h":"v",Qe=Qv(tt,ct)),!Qe)return!1;if(!b.current&&"changedTouches"in ie&&(Ee||ke)&&(b.current=Ve),!Ve)return!0;var at=b.current||Ve;return pT(at,me,ie,at==="h"?Ee:ke)},[]),L=J.useCallback(function(ie){var me=ie;if(!(!Xf.length||Xf[Xf.length-1]!==R)){var Ce="deltaY"in me?Jv(me):Ug(me),Se=h.current.filter(function(Ve){return Ve.name===me.type&&(Ve.target===me.target||me.target===Ve.shadowParent)&&mT(Ve.delta,Ce)})[0];if(Se&&Se.should){me.cancelable&&me.preventDefault();return}if(!Se){var Ee=(T.current.shards||[]).map(ex).filter(Boolean).filter(function(Ve){return Ve.contains(me.target)}),ke=Ee.length>0?o(me,Ee[0]):!T.current.noIsolation;ke&&me.cancelable&&me.preventDefault()}}},[]),N=J.useCallback(function(ie,me,Ce,Se){var Ee={name:ie,delta:me,target:Ce,should:Se,shadowParent:vT(Ce)};h.current.push(Ee),setTimeout(function(){h.current=h.current.filter(function(ke){return ke!==Ee})},1)},[]),Z=J.useCallback(function(ie){g.current=Ug(ie),b.current=void 0},[]),Y=J.useCallback(function(ie){N(ie.type,Jv(ie),ie.target,o(ie,p.lockRef.current))},[]),ee=J.useCallback(function(ie){N(ie.type,Ug(ie),ie.target,o(ie,p.lockRef.current))},[]);J.useEffect(function(){return Xf.push(R),p.setCallbacks({onScrollCapture:Y,onWheelCapture:Y,onTouchMoveCapture:ee}),document.addEventListener("wheel",L,Hf),document.addEventListener("touchmove",L,Hf),document.addEventListener("touchstart",Z,Hf),function(){Xf=Xf.filter(function(ie){return ie!==R}),document.removeEventListener("wheel",L,Hf),document.removeEventListener("touchmove",L,Hf),document.removeEventListener("touchstart",Z,Hf)}},[]);var U=p.removeScrollBar,le=p.inert;return J.createElement(J.Fragment,null,le?J.createElement(R,{styles:gT(C)}):null,U?J.createElement(oT,{noRelative:p.noRelative,gapMode:p.gapMode}):null)}function vT(p){for(var h=null;p!==null;)p instanceof ShadowRoot&&(h=p.host,p=p.host),p=p.parentNode;return h}const xT=X2(F0,yT);var q0=J.forwardRef(function(p,h){return J.createElement(g_,xc({},p,{ref:h,sideCar:xT}))});q0.classNames=g_.classNames;var bT=[" ","Enter","ArrowUp","ArrowDown"],wT=[" ","Enter"],$d="Select",[__,y_,ST]=Uw($d),[xp,DM]=Fm($d,[ST,m_]),v_=m_(),[TT,Lh]=xp($d),[CT,ET]=xp($d),$0=p=>{const{__scopeSelect:h,children:g,open:b,defaultOpen:C,onOpenChange:R,value:T,defaultValue:o,onValueChange:L,dir:N,name:Z,autoComplete:Y,disabled:ee,required:U,form:le}=p,ie=v_(h),[me,Ce]=J.useState(null),[Se,Ee]=J.useState(null),[ke,Ve]=J.useState(!1),ct=a0(N),[tt,Qe]=Ty({prop:b,defaultProp:C??!1,onChange:R,caller:$d}),[at,ht]=Ty({prop:T,defaultProp:o,onChange:L,caller:$d}),Ct=J.useRef(null),Rt=me?le||!!me.closest("form"):!0,[Lt,Gt]=J.useState(new Set),Ht=Array.from(Lt).map(Oe=>Oe.props.value).join(";");return pe.jsx(z0,{...ie,children:pe.jsxs(TT,{required:U,scope:h,trigger:me,onTriggerChange:Ce,valueNode:Se,onValueNodeChange:Ee,valueNodeHasChildren:ke,onValueNodeHasChildrenChange:Ve,contentId:u_(),value:at,onValueChange:ht,open:tt,onOpenChange:Qe,dir:ct,triggerPointerDownPosRef:Ct,disabled:ee,children:[pe.jsx(__.Provider,{scope:h,children:pe.jsx(CT,{scope:p.__scopeSelect,onNativeOptionAdd:J.useCallback(Oe=>{Gt(it=>new Set(it).add(Oe))},[]),onNativeOptionRemove:J.useCallback(Oe=>{Gt(it=>{const Xe=new Set(it);return Xe.delete(Oe),Xe})},[]),children:g})}),Rt?pe.jsxs(pb,{"aria-hidden":!0,required:U,tabIndex:-1,name:Z,autoComplete:Y,value:at,onChange:Oe=>ht(Oe.target.value),disabled:ee,form:le,children:[at===void 0?pe.jsx("option",{value:""}):null,Array.from(Lt)]},Ht):null]})})};$0.displayName=$d;var H0="SelectTrigger",X0=J.forwardRef((p,h)=>{const{__scopeSelect:g,disabled:b=!1,...C}=p,R=v_(g),T=Lh(H0,g),o=T.disabled||b,L=Gn(h,T.onTriggerChange),N=y_(g),Z=J.useRef("touch"),[Y,ee,U]=gb(ie=>{const me=N().filter(Ee=>!Ee.disabled),Ce=me.find(Ee=>Ee.value===T.value),Se=_b(me,ie,Ce);Se!==void 0&&T.onValueChange(Se.value)}),le=ie=>{o||(T.onOpenChange(!0),U()),ie&&(T.triggerPointerDownPosRef.current={x:Math.round(ie.pageX),y:Math.round(ie.pageY)})};return pe.jsx(I0,{asChild:!0,...R,children:pe.jsx(Rn.button,{type:"button",role:"combobox","aria-controls":T.contentId,"aria-expanded":T.open,"aria-required":T.required,"aria-autocomplete":"none",dir:T.dir,"data-state":T.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":mb(T.value)?"":void 0,...C,ref:L,onClick:Ji(C.onClick,ie=>{ie.currentTarget.focus(),Z.current!=="mouse"&&le(ie)}),onPointerDown:Ji(C.onPointerDown,ie=>{Z.current=ie.pointerType;const me=ie.target;me.hasPointerCapture(ie.pointerId)&&me.releasePointerCapture(ie.pointerId),ie.button===0&&ie.ctrlKey===!1&&ie.pointerType==="mouse"&&(le(ie),ie.preventDefault())}),onKeyDown:Ji(C.onKeyDown,ie=>{const me=Y.current!=="";!(ie.ctrlKey||ie.altKey||ie.metaKey)&&ie.key.length===1&&ee(ie.key),!(me&&ie.key===" ")&&bT.includes(ie.key)&&(le(),ie.preventDefault())})})})});X0.displayName=H0;var Y0="SelectValue",W0=J.forwardRef((p,h)=>{const{__scopeSelect:g,className:b,style:C,children:R,placeholder:T="",...o}=p,L=Lh(Y0,g),{onValueNodeHasChildrenChange:N}=L,Z=R!==void 0,Y=Gn(h,L.onValueNodeChange);return ba(()=>{N(Z)},[N,Z]),pe.jsx(Rn.span,{...o,ref:Y,style:{pointerEvents:"none"},children:mb(L.value)?pe.jsx(pe.Fragment,{children:T}):R})});W0.displayName=Y0;var MT="SelectIcon",K0=J.forwardRef((p,h)=>{const{__scopeSelect:g,children:b,...C}=p;return pe.jsx(Rn.span,{"aria-hidden":!0,...C,ref:h,children:b||""})});K0.displayName=MT;var AT="SelectPortal",Q0=p=>pe.jsx(Qy,{asChild:!0,...p});Q0.displayName=AT;var Hd="SelectContent",J0=J.forwardRef((p,h)=>{const g=Lh(Hd,p.__scopeSelect),[b,C]=J.useState();if(ba(()=>{C(new DocumentFragment)},[]),!g.open){const R=b;return R?jm.createPortal(pe.jsx(eb,{scope:p.__scopeSelect,children:pe.jsx(__.Slot,{scope:p.__scopeSelect,children:pe.jsx("div",{children:p.children})})}),R):null}return pe.jsx(tb,{...p,ref:h})});J0.displayName=Hd;var Cl=10,[eb,Oh]=xp(Hd),PT="SelectContentImpl",RT=Qg("SelectContent.RemoveScroll"),tb=J.forwardRef((p,h)=>{const{__scopeSelect:g,position:b="item-aligned",onCloseAutoFocus:C,onEscapeKeyDown:R,onPointerDownOutside:T,side:o,sideOffset:L,align:N,alignOffset:Z,arrowPadding:Y,collisionBoundary:ee,collisionPadding:U,sticky:le,hideWhenDetached:ie,avoidCollisions:me,...Ce}=p,Se=Lh(Hd,g),[Ee,ke]=J.useState(null),[Ve,ct]=J.useState(null),tt=Gn(h,At=>ke(At)),[Qe,at]=J.useState(null),[ht,Ct]=J.useState(null),Rt=y_(g),[Lt,Gt]=J.useState(!1),Ht=J.useRef(!1);J.useEffect(()=>{if(Ee)return N2(Ee)},[Ee]),Jw();const Oe=J.useCallback(At=>{const[Nt,...bi]=Rt().map(ni=>ni.ref.current),[wi]=bi.slice(-1),gi=document.activeElement;for(const ni of At)if(ni===gi||(ni==null||ni.scrollIntoView({block:"nearest"}),ni===Nt&&Ve&&(Ve.scrollTop=0),ni===wi&&Ve&&(Ve.scrollTop=Ve.scrollHeight),ni==null||ni.focus(),document.activeElement!==gi))return},[Rt,Ve]),it=J.useCallback(()=>Oe([Qe,Ee]),[Oe,Qe,Ee]);J.useEffect(()=>{Lt&&it()},[Lt,it]);const{onOpenChange:Xe,triggerPointerDownPosRef:St}=Se;J.useEffect(()=>{if(Ee){let At={x:0,y:0};const Nt=wi=>{var gi,ni;At={x:Math.abs(Math.round(wi.pageX)-(((gi=St.current)==null?void 0:gi.x)??0)),y:Math.abs(Math.round(wi.pageY)-(((ni=St.current)==null?void 0:ni.y)??0))}},bi=wi=>{At.x<=10&&At.y<=10?wi.preventDefault():Ee.contains(wi.target)||Xe(!1),document.removeEventListener("pointermove",Nt),St.current=null};return St.current!==null&&(document.addEventListener("pointermove",Nt),document.addEventListener("pointerup",bi,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Nt),document.removeEventListener("pointerup",bi,{capture:!0})}}},[Ee,Xe,St]),J.useEffect(()=>{const At=()=>Xe(!1);return window.addEventListener("blur",At),window.addEventListener("resize",At),()=>{window.removeEventListener("blur",At),window.removeEventListener("resize",At)}},[Xe]);const[be,Ke]=gb(At=>{const Nt=Rt().filter(gi=>!gi.disabled),bi=Nt.find(gi=>gi.ref.current===document.activeElement),wi=_b(Nt,At,bi);wi&&setTimeout(()=>wi.ref.current.focus())}),wt=J.useCallback((At,Nt,bi)=>{const wi=!Ht.current&&!bi;(Se.value!==void 0&&Se.value===Nt||wi)&&(at(At),wi&&(Ht.current=!0))},[Se.value]),ft=J.useCallback(()=>Ee==null?void 0:Ee.focus(),[Ee]),Et=J.useCallback((At,Nt,bi)=>{const wi=!Ht.current&&!bi;(Se.value!==void 0&&Se.value===Nt||wi)&&Ct(At)},[Se.value]),Kt=b==="popper"?Ey:ib,kt=Kt===Ey?{side:o,sideOffset:L,align:N,alignOffset:Z,arrowPadding:Y,collisionBoundary:ee,collisionPadding:U,sticky:le,hideWhenDetached:ie,avoidCollisions:me}:{};return pe.jsx(eb,{scope:g,content:Ee,viewport:Ve,onViewportChange:ct,itemRefCallback:wt,selectedItem:Qe,onItemLeave:ft,itemTextRefCallback:Et,focusSelectedItem:it,selectedItemText:ht,position:b,isPositioned:Lt,searchRef:be,children:pe.jsx(q0,{as:RT,allowPinchZoom:!0,children:pe.jsx(l0,{asChild:!0,trapped:Se.open,onMountAutoFocus:At=>{At.preventDefault()},onUnmountAutoFocus:Ji(C,At=>{var Nt;(Nt=Se.trigger)==null||Nt.focus({preventScroll:!0}),At.preventDefault()}),children:pe.jsx(Gy,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:R,onPointerDownOutside:T,onFocusOutside:At=>At.preventDefault(),onDismiss:()=>Se.onOpenChange(!1),children:pe.jsx(Kt,{role:"listbox",id:Se.contentId,"data-state":Se.open?"open":"closed",dir:Se.dir,onContextMenu:At=>At.preventDefault(),...Ce,...kt,onPlaced:()=>Gt(!0),ref:tt,style:{display:"flex",flexDirection:"column",outline:"none",...Ce.style},onKeyDown:Ji(Ce.onKeyDown,At=>{const Nt=At.ctrlKey||At.altKey||At.metaKey;if(At.key==="Tab"&&At.preventDefault(),!Nt&&At.key.length===1&&Ke(At.key),["ArrowUp","ArrowDown","Home","End"].includes(At.key)){let wi=Rt().filter(gi=>!gi.disabled).map(gi=>gi.ref.current);if(["ArrowUp","End"].includes(At.key)&&(wi=wi.slice().reverse()),["ArrowUp","ArrowDown"].includes(At.key)){const gi=At.target,ni=wi.indexOf(gi);wi=wi.slice(ni+1)}setTimeout(()=>Oe(wi)),At.preventDefault()}})})})})})})});tb.displayName=PT;var zT="SelectItemAlignedPosition",ib=J.forwardRef((p,h)=>{const{__scopeSelect:g,onPlaced:b,...C}=p,R=Lh(Hd,g),T=Oh(Hd,g),[o,L]=J.useState(null),[N,Z]=J.useState(null),Y=Gn(h,tt=>Z(tt)),ee=y_(g),U=J.useRef(!1),le=J.useRef(!0),{viewport:ie,selectedItem:me,selectedItemText:Ce,focusSelectedItem:Se}=T,Ee=J.useCallback(()=>{if(R.trigger&&R.valueNode&&o&&N&&ie&&me&&Ce){const tt=R.trigger.getBoundingClientRect(),Qe=N.getBoundingClientRect(),at=R.valueNode.getBoundingClientRect(),ht=Ce.getBoundingClientRect();if(R.dir!=="rtl"){const gi=ht.left-Qe.left,ni=at.left-gi,Ti=tt.left-ni,ki=tt.width+Ti,fr=Math.max(ki,Qe.width),Mr=window.innerWidth-Cl,zn=vy(ni,[Cl,Math.max(Cl,Mr-fr)]);o.style.minWidth=ki+"px",o.style.left=zn+"px"}else{const gi=Qe.right-ht.right,ni=window.innerWidth-at.right-gi,Ti=window.innerWidth-tt.right-ni,ki=tt.width+Ti,fr=Math.max(ki,Qe.width),Mr=window.innerWidth-Cl,zn=vy(ni,[Cl,Math.max(Cl,Mr-fr)]);o.style.minWidth=ki+"px",o.style.right=zn+"px"}const Ct=ee(),Rt=window.innerHeight-Cl*2,Lt=ie.scrollHeight,Gt=window.getComputedStyle(N),Ht=parseInt(Gt.borderTopWidth,10),Oe=parseInt(Gt.paddingTop,10),it=parseInt(Gt.borderBottomWidth,10),Xe=parseInt(Gt.paddingBottom,10),St=Ht+Oe+Lt+Xe+it,be=Math.min(me.offsetHeight*5,St),Ke=window.getComputedStyle(ie),wt=parseInt(Ke.paddingTop,10),ft=parseInt(Ke.paddingBottom,10),Et=tt.top+tt.height/2-Cl,Kt=Rt-Et,kt=me.offsetHeight/2,At=me.offsetTop+kt,Nt=Ht+Oe+At,bi=St-Nt;if(Nt<=Et){const gi=Ct.length>0&&me===Ct[Ct.length-1].ref.current;o.style.bottom="0px";const ni=N.clientHeight-ie.offsetTop-ie.offsetHeight,Ti=Math.max(Kt,kt+(gi?ft:0)+ni+it),ki=Nt+Ti;o.style.height=ki+"px"}else{const gi=Ct.length>0&&me===Ct[0].ref.current;o.style.top="0px";const Ti=Math.max(Et,Ht+ie.offsetTop+(gi?wt:0)+kt)+bi;o.style.height=Ti+"px",ie.scrollTop=Nt-Et+ie.offsetTop}o.style.margin=`${Cl}px 0`,o.style.minHeight=be+"px",o.style.maxHeight=Rt+"px",b==null||b(),requestAnimationFrame(()=>U.current=!0)}},[ee,R.trigger,R.valueNode,o,N,ie,me,Ce,R.dir,b]);ba(()=>Ee(),[Ee]);const[ke,Ve]=J.useState();ba(()=>{N&&Ve(window.getComputedStyle(N).zIndex)},[N]);const ct=J.useCallback(tt=>{tt&&le.current===!0&&(Ee(),Se==null||Se(),le.current=!1)},[Ee,Se]);return pe.jsx(DT,{scope:g,contentWrapper:o,shouldExpandOnScrollRef:U,onScrollButtonChange:ct,children:pe.jsx("div",{ref:L,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:ke},children:pe.jsx(Rn.div,{...C,ref:Y,style:{boxSizing:"border-box",maxHeight:"100%",...C.style}})})})});ib.displayName=zT;var IT="SelectPopperPosition",Ey=J.forwardRef((p,h)=>{const{__scopeSelect:g,align:b="start",collisionPadding:C=Cl,...R}=p,T=v_(g);return pe.jsx(D0,{...T,...R,ref:h,align:b,collisionPadding:C,style:{boxSizing:"border-box",...R.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Ey.displayName=IT;var[DT,Jy]=xp(Hd,{}),My="SelectViewport",nb=J.forwardRef((p,h)=>{const{__scopeSelect:g,nonce:b,...C}=p,R=Oh(My,g),T=Jy(My,g),o=Gn(h,R.onViewportChange),L=J.useRef(0);return pe.jsxs(pe.Fragment,{children:[pe.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:b}),pe.jsx(__.Slot,{scope:g,children:pe.jsx(Rn.div,{"data-radix-select-viewport":"",role:"presentation",...C,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...C.style},onScroll:Ji(C.onScroll,N=>{const Z=N.currentTarget,{contentWrapper:Y,shouldExpandOnScrollRef:ee}=T;if(ee!=null&&ee.current&&Y){const U=Math.abs(L.current-Z.scrollTop);if(U>0){const le=window.innerHeight-Cl*2,ie=parseFloat(Y.style.minHeight),me=parseFloat(Y.style.height),Ce=Math.max(ie,me);if(Ce<le){const Se=Ce+U,Ee=Math.min(le,Se),ke=Se-Ee;Y.style.height=Ee+"px",Y.style.bottom==="0px"&&(Z.scrollTop=ke>0?ke:0,Y.style.justifyContent="flex-end")}}}L.current=Z.scrollTop})})})]})});nb.displayName=My;var rb="SelectGroup",[kT,LT]=xp(rb),OT=J.forwardRef((p,h)=>{const{__scopeSelect:g,...b}=p,C=u_();return pe.jsx(kT,{scope:g,id:C,children:pe.jsx(Rn.div,{role:"group","aria-labelledby":C,...b,ref:h})})});OT.displayName=rb;var ab="SelectLabel",BT=J.forwardRef((p,h)=>{const{__scopeSelect:g,...b}=p,C=LT(ab,g);return pe.jsx(Rn.div,{id:C.id,...b,ref:h})});BT.displayName=ab;var n_="SelectItem",[NT,sb]=xp(n_),ob=J.forwardRef((p,h)=>{const{__scopeSelect:g,value:b,disabled:C=!1,textValue:R,...T}=p,o=Lh(n_,g),L=Oh(n_,g),N=o.value===b,[Z,Y]=J.useState(R??""),[ee,U]=J.useState(!1),le=Gn(h,Se=>{var Ee;return(Ee=L.itemRefCallback)==null?void 0:Ee.call(L,Se,b,C)}),ie=u_(),me=J.useRef("touch"),Ce=()=>{C||(o.onValueChange(b),o.onOpenChange(!1))};if(b==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return pe.jsx(NT,{scope:g,value:b,disabled:C,textId:ie,isSelected:N,onItemTextChange:J.useCallback(Se=>{Y(Ee=>Ee||((Se==null?void 0:Se.textContent)??"").trim())},[]),children:pe.jsx(__.ItemSlot,{scope:g,value:b,disabled:C,textValue:Z,children:pe.jsx(Rn.div,{role:"option","aria-labelledby":ie,"data-highlighted":ee?"":void 0,"aria-selected":N&&ee,"data-state":N?"checked":"unchecked","aria-disabled":C||void 0,"data-disabled":C?"":void 0,tabIndex:C?void 0:-1,...T,ref:le,onFocus:Ji(T.onFocus,()=>U(!0)),onBlur:Ji(T.onBlur,()=>U(!1)),onClick:Ji(T.onClick,()=>{me.current!=="mouse"&&Ce()}),onPointerUp:Ji(T.onPointerUp,()=>{me.current==="mouse"&&Ce()}),onPointerDown:Ji(T.onPointerDown,Se=>{me.current=Se.pointerType}),onPointerMove:Ji(T.onPointerMove,Se=>{var Ee;me.current=Se.pointerType,C?(Ee=L.onItemLeave)==null||Ee.call(L):me.current==="mouse"&&Se.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Ji(T.onPointerLeave,Se=>{var Ee;Se.currentTarget===document.activeElement&&((Ee=L.onItemLeave)==null||Ee.call(L))}),onKeyDown:Ji(T.onKeyDown,Se=>{var ke;((ke=L.searchRef)==null?void 0:ke.current)!==""&&Se.key===" "||(wT.includes(Se.key)&&Ce(),Se.key===" "&&Se.preventDefault())})})})})});ob.displayName=n_;var Tm="SelectItemText",lb=J.forwardRef((p,h)=>{const{__scopeSelect:g,className:b,style:C,...R}=p,T=Lh(Tm,g),o=Oh(Tm,g),L=sb(Tm,g),N=ET(Tm,g),[Z,Y]=J.useState(null),ee=Gn(h,Ce=>Y(Ce),L.onItemTextChange,Ce=>{var Se;return(Se=o.itemTextRefCallback)==null?void 0:Se.call(o,Ce,L.value,L.disabled)}),U=Z==null?void 0:Z.textContent,le=J.useMemo(()=>pe.jsx("option",{value:L.value,disabled:L.disabled,children:U},L.value),[L.disabled,L.value,U]),{onNativeOptionAdd:ie,onNativeOptionRemove:me}=N;return ba(()=>(ie(le),()=>me(le)),[ie,me,le]),pe.jsxs(pe.Fragment,{children:[pe.jsx(Rn.span,{id:L.textId,...R,ref:ee}),L.isSelected&&T.valueNode&&!T.valueNodeHasChildren?jm.createPortal(R.children,T.valueNode):null]})});lb.displayName=Tm;var cb="SelectItemIndicator",ub=J.forwardRef((p,h)=>{const{__scopeSelect:g,...b}=p;return sb(cb,g).isSelected?pe.jsx(Rn.span,{"aria-hidden":!0,...b,ref:h}):null});ub.displayName=cb;var Ay="SelectScrollUpButton",hb=J.forwardRef((p,h)=>{const g=Oh(Ay,p.__scopeSelect),b=Jy(Ay,p.__scopeSelect),[C,R]=J.useState(!1),T=Gn(h,b.onScrollButtonChange);return ba(()=>{if(g.viewport&&g.isPositioned){let o=function(){const N=L.scrollTop>0;R(N)};const L=g.viewport;return o(),L.addEventListener("scroll",o),()=>L.removeEventListener("scroll",o)}},[g.viewport,g.isPositioned]),C?pe.jsx(fb,{...p,ref:T,onAutoScroll:()=>{const{viewport:o,selectedItem:L}=g;o&&L&&(o.scrollTop=o.scrollTop-L.offsetHeight)}}):null});hb.displayName=Ay;var Py="SelectScrollDownButton",db=J.forwardRef((p,h)=>{const g=Oh(Py,p.__scopeSelect),b=Jy(Py,p.__scopeSelect),[C,R]=J.useState(!1),T=Gn(h,b.onScrollButtonChange);return ba(()=>{if(g.viewport&&g.isPositioned){let o=function(){const N=L.scrollHeight-L.clientHeight,Z=Math.ceil(L.scrollTop)<N;R(Z)};const L=g.viewport;return o(),L.addEventListener("scroll",o),()=>L.removeEventListener("scroll",o)}},[g.viewport,g.isPositioned]),C?pe.jsx(fb,{...p,ref:T,onAutoScroll:()=>{const{viewport:o,selectedItem:L}=g;o&&L&&(o.scrollTop=o.scrollTop+L.offsetHeight)}}):null});db.displayName=Py;var fb=J.forwardRef((p,h)=>{const{__scopeSelect:g,onAutoScroll:b,...C}=p,R=Oh("SelectScrollButton",g),T=J.useRef(null),o=y_(g),L=J.useCallback(()=>{T.current!==null&&(window.clearInterval(T.current),T.current=null)},[]);return J.useEffect(()=>()=>L(),[L]),ba(()=>{var Z;const N=o().find(Y=>Y.ref.current===document.activeElement);(Z=N==null?void 0:N.ref.current)==null||Z.scrollIntoView({block:"nearest"})},[o]),pe.jsx(Rn.div,{"aria-hidden":!0,...C,ref:h,style:{flexShrink:0,...C.style},onPointerDown:Ji(C.onPointerDown,()=>{T.current===null&&(T.current=window.setInterval(b,50))}),onPointerMove:Ji(C.onPointerMove,()=>{var N;(N=R.onItemLeave)==null||N.call(R),T.current===null&&(T.current=window.setInterval(b,50))}),onPointerLeave:Ji(C.onPointerLeave,()=>{L()})})}),jT="SelectSeparator",FT=J.forwardRef((p,h)=>{const{__scopeSelect:g,...b}=p;return pe.jsx(Rn.div,{"aria-hidden":!0,...b,ref:h})});FT.displayName=jT;var Ry="SelectArrow",UT=J.forwardRef((p,h)=>{const{__scopeSelect:g,...b}=p,C=v_(g),R=Lh(Ry,g),T=Oh(Ry,g);return R.open&&T.position==="popper"?pe.jsx(k0,{...C,...b,ref:h}):null});UT.displayName=Ry;var VT="SelectBubbleInput",pb=J.forwardRef(({__scopeSelect:p,value:h,...g},b)=>{const C=J.useRef(null),R=Gn(b,C),T=I2(h);return J.useEffect(()=>{const o=C.current;if(!o)return;const L=window.HTMLSelectElement.prototype,Z=Object.getOwnPropertyDescriptor(L,"value").set;if(T!==h&&Z){const Y=new Event("change",{bubbles:!0});Z.call(o,h),o.dispatchEvent(Y)}},[T,h]),pe.jsx(Rn.select,{...g,style:{...L0,...g.style},ref:R,defaultValue:h})});pb.displayName=VT;function mb(p){return p===""||p===void 0}function gb(p){const h=Ms(p),g=J.useRef(""),b=J.useRef(0),C=J.useCallback(T=>{const o=g.current+T;h(o),(function L(N){g.current=N,window.clearTimeout(b.current),N!==""&&(b.current=window.setTimeout(()=>L(""),1e3))})(o)},[h]),R=J.useCallback(()=>{g.current="",window.clearTimeout(b.current)},[]);return J.useEffect(()=>()=>window.clearTimeout(b.current),[]),[g,C,R]}function _b(p,h,g){const C=h.length>1&&Array.from(h).every(N=>N===h[0])?h[0]:h,R=g?p.indexOf(g):-1;let T=GT(p,Math.max(R,0));C.length===1&&(T=T.filter(N=>N!==g));const L=T.find(N=>N.textValue.toLowerCase().startsWith(C.toLowerCase()));return L!==g?L:void 0}function GT(p,h){return p.map((g,b)=>p[(h+b)%p.length])}var ZT=$0,qT=X0,$T=W0,HT=K0,XT=Q0,YT=J0,WT=nb,KT=ob,QT=lb,JT=ub,eC=hb,tC=db;function yb(p){var h,g,b="";if(typeof p=="string"||typeof p=="number")b+=p;else if(typeof p=="object")if(Array.isArray(p)){var C=p.length;for(h=0;h<C;h++)p[h]&&(g=yb(p[h]))&&(b&&(b+=" "),b+=g)}else for(g in p)p[g]&&(b&&(b+=" "),b+=g);return b}function iC(){for(var p,h,g=0,b="",C=arguments.length;g<C;g++)(p=arguments[g])&&(h=yb(p))&&(b&&(b+=" "),b+=h);return b}const ev="-",nC=p=>{const h=aC(p),{conflictingClassGroups:g,conflictingClassGroupModifiers:b}=p;return{getClassGroupId:T=>{const o=T.split(ev);return o[0]===""&&o.length!==1&&o.shift(),vb(o,h)||rC(T)},getConflictingClassGroupIds:(T,o)=>{const L=g[T]||[];return o&&b[T]?[...L,...b[T]]:L}}},vb=(p,h)=>{var T;if(p.length===0)return h.classGroupId;const g=p[0],b=h.nextPart.get(g),C=b?vb(p.slice(1),b):void 0;if(C)return C;if(h.validators.length===0)return;const R=p.join(ev);return(T=h.validators.find(({validator:o})=>o(R)))==null?void 0:T.classGroupId},tx=/^\[(.+)\]$/,rC=p=>{if(tx.test(p)){const h=tx.exec(p)[1],g=h==null?void 0:h.substring(0,h.indexOf(":"));if(g)return"arbitrary.."+g}},aC=p=>{const{theme:h,classGroups:g}=p,b={nextPart:new Map,validators:[]};for(const C in g)zy(g[C],b,C,h);return b},zy=(p,h,g,b)=>{p.forEach(C=>{if(typeof C=="string"){const R=C===""?h:ix(h,C);R.classGroupId=g;return}if(typeof C=="function"){if(sC(C)){zy(C(b),h,g,b);return}h.validators.push({validator:C,classGroupId:g});return}Object.entries(C).forEach(([R,T])=>{zy(T,ix(h,R),g,b)})})},ix=(p,h)=>{let g=p;return h.split(ev).forEach(b=>{g.nextPart.has(b)||g.nextPart.set(b,{nextPart:new Map,validators:[]}),g=g.nextPart.get(b)}),g},sC=p=>p.isThemeGetter,oC=p=>{if(p<1)return{get:()=>{},set:()=>{}};let h=0,g=new Map,b=new Map;const C=(R,T)=>{g.set(R,T),h++,h>p&&(h=0,b=g,g=new Map)};return{get(R){let T=g.get(R);if(T!==void 0)return T;if((T=b.get(R))!==void 0)return C(R,T),T},set(R,T){g.has(R)?g.set(R,T):C(R,T)}}},Iy="!",Dy=":",lC=Dy.length,cC=p=>{const{prefix:h,experimentalParseClassName:g}=p;let b=C=>{const R=[];let T=0,o=0,L=0,N;for(let le=0;le<C.length;le++){let ie=C[le];if(T===0&&o===0){if(ie===Dy){R.push(C.slice(L,le)),L=le+lC;continue}if(ie==="/"){N=le;continue}}ie==="["?T++:ie==="]"?T--:ie==="("?o++:ie===")"&&o--}const Z=R.length===0?C:C.substring(L),Y=uC(Z),ee=Y!==Z,U=N&&N>L?N-L:void 0;return{modifiers:R,hasImportantModifier:ee,baseClassName:Y,maybePostfixModifierPosition:U}};if(h){const C=h+Dy,R=b;b=T=>T.startsWith(C)?R(T.substring(C.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:T,maybePostfixModifierPosition:void 0}}if(g){const C=b;b=R=>g({className:R,parseClassName:C})}return b},uC=p=>p.endsWith(Iy)?p.substring(0,p.length-1):p.startsWith(Iy)?p.substring(1):p,hC=p=>{const h=Object.fromEntries(p.orderSensitiveModifiers.map(b=>[b,!0]));return b=>{if(b.length<=1)return b;const C=[];let R=[];return b.forEach(T=>{T[0]==="["||h[T]?(C.push(...R.sort(),T),R=[]):R.push(T)}),C.push(...R.sort()),C}},dC=p=>({cache:oC(p.cacheSize),parseClassName:cC(p),sortModifiers:hC(p),...nC(p)}),fC=/\s+/,pC=(p,h)=>{const{parseClassName:g,getClassGroupId:b,getConflictingClassGroupIds:C,sortModifiers:R}=h,T=[],o=p.trim().split(fC);let L="";for(let N=o.length-1;N>=0;N-=1){const Z=o[N],{isExternal:Y,modifiers:ee,hasImportantModifier:U,baseClassName:le,maybePostfixModifierPosition:ie}=g(Z);if(Y){L=Z+(L.length>0?" "+L:L);continue}let me=!!ie,Ce=b(me?le.substring(0,ie):le);if(!Ce){if(!me){L=Z+(L.length>0?" "+L:L);continue}if(Ce=b(le),!Ce){L=Z+(L.length>0?" "+L:L);continue}me=!1}const Se=R(ee).join(":"),Ee=U?Se+Iy:Se,ke=Ee+Ce;if(T.includes(ke))continue;T.push(ke);const Ve=C(Ce,me);for(let ct=0;ct<Ve.length;++ct){const tt=Ve[ct];T.push(Ee+tt)}L=Z+(L.length>0?" "+L:L)}return L};function mC(){let p=0,h,g,b="";for(;p<arguments.length;)(h=arguments[p++])&&(g=xb(h))&&(b&&(b+=" "),b+=g);return b}const xb=p=>{if(typeof p=="string")return p;let h,g="";for(let b=0;b<p.length;b++)p[b]&&(h=xb(p[b]))&&(g&&(g+=" "),g+=h);return g};function gC(p,...h){let g,b,C,R=T;function T(L){const N=h.reduce((Z,Y)=>Y(Z),p());return g=dC(N),b=g.cache.get,C=g.cache.set,R=o,o(L)}function o(L){const N=b(L);if(N)return N;const Z=pC(L,g);return C(L,Z),Z}return function(){return R(mC.apply(null,arguments))}}const ea=p=>{const h=g=>g[p]||[];return h.isThemeGetter=!0,h},bb=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,wb=/^\((?:(\w[\w-]*):)?(.+)\)$/i,_C=/^\d+\/\d+$/,yC=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,vC=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,xC=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,bC=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,wC=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Yf=p=>_C.test(p),Di=p=>!!p&&!Number.isNaN(Number(p)),xh=p=>!!p&&Number.isInteger(Number(p)),Q_=p=>p.endsWith("%")&&Di(p.slice(0,-1)),Cu=p=>yC.test(p),SC=()=>!0,TC=p=>vC.test(p)&&!xC.test(p),Sb=()=>!1,CC=p=>bC.test(p),EC=p=>wC.test(p),MC=p=>!qt(p)&&!$t(p),AC=p=>bp(p,Eb,Sb),qt=p=>bb.test(p),kd=p=>bp(p,Mb,TC),J_=p=>bp(p,DC,Di),nx=p=>bp(p,Tb,Sb),PC=p=>bp(p,Cb,EC),Vg=p=>bp(p,Ab,CC),$t=p=>wb.test(p),xm=p=>wp(p,Mb),RC=p=>wp(p,kC),rx=p=>wp(p,Tb),zC=p=>wp(p,Eb),IC=p=>wp(p,Cb),Gg=p=>wp(p,Ab,!0),bp=(p,h,g)=>{const b=bb.exec(p);return b?b[1]?h(b[1]):g(b[2]):!1},wp=(p,h,g=!1)=>{const b=wb.exec(p);return b?b[1]?h(b[1]):g:!1},Tb=p=>p==="position"||p==="percentage",Cb=p=>p==="image"||p==="url",Eb=p=>p==="length"||p==="size"||p==="bg-size",Mb=p=>p==="length",DC=p=>p==="number",kC=p=>p==="family-name",Ab=p=>p==="shadow",LC=()=>{const p=ea("color"),h=ea("font"),g=ea("text"),b=ea("font-weight"),C=ea("tracking"),R=ea("leading"),T=ea("breakpoint"),o=ea("container"),L=ea("spacing"),N=ea("radius"),Z=ea("shadow"),Y=ea("inset-shadow"),ee=ea("text-shadow"),U=ea("drop-shadow"),le=ea("blur"),ie=ea("perspective"),me=ea("aspect"),Ce=ea("ease"),Se=ea("animate"),Ee=()=>["auto","avoid","all","avoid-page","page","left","right","column"],ke=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],Ve=()=>[...ke(),$t,qt],ct=()=>["auto","hidden","clip","visible","scroll"],tt=()=>["auto","contain","none"],Qe=()=>[$t,qt,L],at=()=>[Yf,"full","auto",...Qe()],ht=()=>[xh,"none","subgrid",$t,qt],Ct=()=>["auto",{span:["full",xh,$t,qt]},xh,$t,qt],Rt=()=>[xh,"auto",$t,qt],Lt=()=>["auto","min","max","fr",$t,qt],Gt=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],Ht=()=>["start","end","center","stretch","center-safe","end-safe"],Oe=()=>["auto",...Qe()],it=()=>[Yf,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...Qe()],Xe=()=>[p,$t,qt],St=()=>[...ke(),rx,nx,{position:[$t,qt]}],be=()=>["no-repeat",{repeat:["","x","y","space","round"]}],Ke=()=>["auto","cover","contain",zC,AC,{size:[$t,qt]}],wt=()=>[Q_,xm,kd],ft=()=>["","none","full",N,$t,qt],Et=()=>["",Di,xm,kd],Kt=()=>["solid","dashed","dotted","double"],kt=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],At=()=>[Di,Q_,rx,nx],Nt=()=>["","none",le,$t,qt],bi=()=>["none",Di,$t,qt],wi=()=>["none",Di,$t,qt],gi=()=>[Di,$t,qt],ni=()=>[Yf,"full",...Qe()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Cu],breakpoint:[Cu],color:[SC],container:[Cu],"drop-shadow":[Cu],ease:["in","out","in-out"],font:[MC],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Cu],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Cu],shadow:[Cu],spacing:["px",Di],text:[Cu],"text-shadow":[Cu],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Yf,qt,$t,me]}],container:["container"],columns:[{columns:[Di,qt,$t,o]}],"break-after":[{"break-after":Ee()}],"break-before":[{"break-before":Ee()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:Ve()}],overflow:[{overflow:ct()}],"overflow-x":[{"overflow-x":ct()}],"overflow-y":[{"overflow-y":ct()}],overscroll:[{overscroll:tt()}],"overscroll-x":[{"overscroll-x":tt()}],"overscroll-y":[{"overscroll-y":tt()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:at()}],"inset-x":[{"inset-x":at()}],"inset-y":[{"inset-y":at()}],start:[{start:at()}],end:[{end:at()}],top:[{top:at()}],right:[{right:at()}],bottom:[{bottom:at()}],left:[{left:at()}],visibility:["visible","invisible","collapse"],z:[{z:[xh,"auto",$t,qt]}],basis:[{basis:[Yf,"full","auto",o,...Qe()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Di,Yf,"auto","initial","none",qt]}],grow:[{grow:["",Di,$t,qt]}],shrink:[{shrink:["",Di,$t,qt]}],order:[{order:[xh,"first","last","none",$t,qt]}],"grid-cols":[{"grid-cols":ht()}],"col-start-end":[{col:Ct()}],"col-start":[{"col-start":Rt()}],"col-end":[{"col-end":Rt()}],"grid-rows":[{"grid-rows":ht()}],"row-start-end":[{row:Ct()}],"row-start":[{"row-start":Rt()}],"row-end":[{"row-end":Rt()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":Lt()}],"auto-rows":[{"auto-rows":Lt()}],gap:[{gap:Qe()}],"gap-x":[{"gap-x":Qe()}],"gap-y":[{"gap-y":Qe()}],"justify-content":[{justify:[...Gt(),"normal"]}],"justify-items":[{"justify-items":[...Ht(),"normal"]}],"justify-self":[{"justify-self":["auto",...Ht()]}],"align-content":[{content:["normal",...Gt()]}],"align-items":[{items:[...Ht(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...Ht(),{baseline:["","last"]}]}],"place-content":[{"place-content":Gt()}],"place-items":[{"place-items":[...Ht(),"baseline"]}],"place-self":[{"place-self":["auto",...Ht()]}],p:[{p:Qe()}],px:[{px:Qe()}],py:[{py:Qe()}],ps:[{ps:Qe()}],pe:[{pe:Qe()}],pt:[{pt:Qe()}],pr:[{pr:Qe()}],pb:[{pb:Qe()}],pl:[{pl:Qe()}],m:[{m:Oe()}],mx:[{mx:Oe()}],my:[{my:Oe()}],ms:[{ms:Oe()}],me:[{me:Oe()}],mt:[{mt:Oe()}],mr:[{mr:Oe()}],mb:[{mb:Oe()}],ml:[{ml:Oe()}],"space-x":[{"space-x":Qe()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":Qe()}],"space-y-reverse":["space-y-reverse"],size:[{size:it()}],w:[{w:[o,"screen",...it()]}],"min-w":[{"min-w":[o,"screen","none",...it()]}],"max-w":[{"max-w":[o,"screen","none","prose",{screen:[T]},...it()]}],h:[{h:["screen","lh",...it()]}],"min-h":[{"min-h":["screen","lh","none",...it()]}],"max-h":[{"max-h":["screen","lh",...it()]}],"font-size":[{text:["base",g,xm,kd]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[b,$t,J_]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Q_,qt]}],"font-family":[{font:[RC,qt,h]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[C,$t,qt]}],"line-clamp":[{"line-clamp":[Di,"none",$t,J_]}],leading:[{leading:[R,...Qe()]}],"list-image":[{"list-image":["none",$t,qt]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",$t,qt]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:Xe()}],"text-color":[{text:Xe()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Kt(),"wavy"]}],"text-decoration-thickness":[{decoration:[Di,"from-font","auto",$t,kd]}],"text-decoration-color":[{decoration:Xe()}],"underline-offset":[{"underline-offset":[Di,"auto",$t,qt]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:Qe()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",$t,qt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",$t,qt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:St()}],"bg-repeat":[{bg:be()}],"bg-size":[{bg:Ke()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},xh,$t,qt],radial:["",$t,qt],conic:[xh,$t,qt]},IC,PC]}],"bg-color":[{bg:Xe()}],"gradient-from-pos":[{from:wt()}],"gradient-via-pos":[{via:wt()}],"gradient-to-pos":[{to:wt()}],"gradient-from":[{from:Xe()}],"gradient-via":[{via:Xe()}],"gradient-to":[{to:Xe()}],rounded:[{rounded:ft()}],"rounded-s":[{"rounded-s":ft()}],"rounded-e":[{"rounded-e":ft()}],"rounded-t":[{"rounded-t":ft()}],"rounded-r":[{"rounded-r":ft()}],"rounded-b":[{"rounded-b":ft()}],"rounded-l":[{"rounded-l":ft()}],"rounded-ss":[{"rounded-ss":ft()}],"rounded-se":[{"rounded-se":ft()}],"rounded-ee":[{"rounded-ee":ft()}],"rounded-es":[{"rounded-es":ft()}],"rounded-tl":[{"rounded-tl":ft()}],"rounded-tr":[{"rounded-tr":ft()}],"rounded-br":[{"rounded-br":ft()}],"rounded-bl":[{"rounded-bl":ft()}],"border-w":[{border:Et()}],"border-w-x":[{"border-x":Et()}],"border-w-y":[{"border-y":Et()}],"border-w-s":[{"border-s":Et()}],"border-w-e":[{"border-e":Et()}],"border-w-t":[{"border-t":Et()}],"border-w-r":[{"border-r":Et()}],"border-w-b":[{"border-b":Et()}],"border-w-l":[{"border-l":Et()}],"divide-x":[{"divide-x":Et()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":Et()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...Kt(),"hidden","none"]}],"divide-style":[{divide:[...Kt(),"hidden","none"]}],"border-color":[{border:Xe()}],"border-color-x":[{"border-x":Xe()}],"border-color-y":[{"border-y":Xe()}],"border-color-s":[{"border-s":Xe()}],"border-color-e":[{"border-e":Xe()}],"border-color-t":[{"border-t":Xe()}],"border-color-r":[{"border-r":Xe()}],"border-color-b":[{"border-b":Xe()}],"border-color-l":[{"border-l":Xe()}],"divide-color":[{divide:Xe()}],"outline-style":[{outline:[...Kt(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Di,$t,qt]}],"outline-w":[{outline:["",Di,xm,kd]}],"outline-color":[{outline:Xe()}],shadow:[{shadow:["","none",Z,Gg,Vg]}],"shadow-color":[{shadow:Xe()}],"inset-shadow":[{"inset-shadow":["none",Y,Gg,Vg]}],"inset-shadow-color":[{"inset-shadow":Xe()}],"ring-w":[{ring:Et()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:Xe()}],"ring-offset-w":[{"ring-offset":[Di,kd]}],"ring-offset-color":[{"ring-offset":Xe()}],"inset-ring-w":[{"inset-ring":Et()}],"inset-ring-color":[{"inset-ring":Xe()}],"text-shadow":[{"text-shadow":["none",ee,Gg,Vg]}],"text-shadow-color":[{"text-shadow":Xe()}],opacity:[{opacity:[Di,$t,qt]}],"mix-blend":[{"mix-blend":[...kt(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":kt()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Di]}],"mask-image-linear-from-pos":[{"mask-linear-from":At()}],"mask-image-linear-to-pos":[{"mask-linear-to":At()}],"mask-image-linear-from-color":[{"mask-linear-from":Xe()}],"mask-image-linear-to-color":[{"mask-linear-to":Xe()}],"mask-image-t-from-pos":[{"mask-t-from":At()}],"mask-image-t-to-pos":[{"mask-t-to":At()}],"mask-image-t-from-color":[{"mask-t-from":Xe()}],"mask-image-t-to-color":[{"mask-t-to":Xe()}],"mask-image-r-from-pos":[{"mask-r-from":At()}],"mask-image-r-to-pos":[{"mask-r-to":At()}],"mask-image-r-from-color":[{"mask-r-from":Xe()}],"mask-image-r-to-color":[{"mask-r-to":Xe()}],"mask-image-b-from-pos":[{"mask-b-from":At()}],"mask-image-b-to-pos":[{"mask-b-to":At()}],"mask-image-b-from-color":[{"mask-b-from":Xe()}],"mask-image-b-to-color":[{"mask-b-to":Xe()}],"mask-image-l-from-pos":[{"mask-l-from":At()}],"mask-image-l-to-pos":[{"mask-l-to":At()}],"mask-image-l-from-color":[{"mask-l-from":Xe()}],"mask-image-l-to-color":[{"mask-l-to":Xe()}],"mask-image-x-from-pos":[{"mask-x-from":At()}],"mask-image-x-to-pos":[{"mask-x-to":At()}],"mask-image-x-from-color":[{"mask-x-from":Xe()}],"mask-image-x-to-color":[{"mask-x-to":Xe()}],"mask-image-y-from-pos":[{"mask-y-from":At()}],"mask-image-y-to-pos":[{"mask-y-to":At()}],"mask-image-y-from-color":[{"mask-y-from":Xe()}],"mask-image-y-to-color":[{"mask-y-to":Xe()}],"mask-image-radial":[{"mask-radial":[$t,qt]}],"mask-image-radial-from-pos":[{"mask-radial-from":At()}],"mask-image-radial-to-pos":[{"mask-radial-to":At()}],"mask-image-radial-from-color":[{"mask-radial-from":Xe()}],"mask-image-radial-to-color":[{"mask-radial-to":Xe()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":ke()}],"mask-image-conic-pos":[{"mask-conic":[Di]}],"mask-image-conic-from-pos":[{"mask-conic-from":At()}],"mask-image-conic-to-pos":[{"mask-conic-to":At()}],"mask-image-conic-from-color":[{"mask-conic-from":Xe()}],"mask-image-conic-to-color":[{"mask-conic-to":Xe()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:St()}],"mask-repeat":[{mask:be()}],"mask-size":[{mask:Ke()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",$t,qt]}],filter:[{filter:["","none",$t,qt]}],blur:[{blur:Nt()}],brightness:[{brightness:[Di,$t,qt]}],contrast:[{contrast:[Di,$t,qt]}],"drop-shadow":[{"drop-shadow":["","none",U,Gg,Vg]}],"drop-shadow-color":[{"drop-shadow":Xe()}],grayscale:[{grayscale:["",Di,$t,qt]}],"hue-rotate":[{"hue-rotate":[Di,$t,qt]}],invert:[{invert:["",Di,$t,qt]}],saturate:[{saturate:[Di,$t,qt]}],sepia:[{sepia:["",Di,$t,qt]}],"backdrop-filter":[{"backdrop-filter":["","none",$t,qt]}],"backdrop-blur":[{"backdrop-blur":Nt()}],"backdrop-brightness":[{"backdrop-brightness":[Di,$t,qt]}],"backdrop-contrast":[{"backdrop-contrast":[Di,$t,qt]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Di,$t,qt]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Di,$t,qt]}],"backdrop-invert":[{"backdrop-invert":["",Di,$t,qt]}],"backdrop-opacity":[{"backdrop-opacity":[Di,$t,qt]}],"backdrop-saturate":[{"backdrop-saturate":[Di,$t,qt]}],"backdrop-sepia":[{"backdrop-sepia":["",Di,$t,qt]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":Qe()}],"border-spacing-x":[{"border-spacing-x":Qe()}],"border-spacing-y":[{"border-spacing-y":Qe()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",$t,qt]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Di,"initial",$t,qt]}],ease:[{ease:["linear","initial",Ce,$t,qt]}],delay:[{delay:[Di,$t,qt]}],animate:[{animate:["none",Se,$t,qt]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[ie,$t,qt]}],"perspective-origin":[{"perspective-origin":Ve()}],rotate:[{rotate:bi()}],"rotate-x":[{"rotate-x":bi()}],"rotate-y":[{"rotate-y":bi()}],"rotate-z":[{"rotate-z":bi()}],scale:[{scale:wi()}],"scale-x":[{"scale-x":wi()}],"scale-y":[{"scale-y":wi()}],"scale-z":[{"scale-z":wi()}],"scale-3d":["scale-3d"],skew:[{skew:gi()}],"skew-x":[{"skew-x":gi()}],"skew-y":[{"skew-y":gi()}],transform:[{transform:[$t,qt,"","none","gpu","cpu"]}],"transform-origin":[{origin:Ve()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:ni()}],"translate-x":[{"translate-x":ni()}],"translate-y":[{"translate-y":ni()}],"translate-z":[{"translate-z":ni()}],"translate-none":["translate-none"],accent:[{accent:Xe()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:Xe()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",$t,qt]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":Qe()}],"scroll-mx":[{"scroll-mx":Qe()}],"scroll-my":[{"scroll-my":Qe()}],"scroll-ms":[{"scroll-ms":Qe()}],"scroll-me":[{"scroll-me":Qe()}],"scroll-mt":[{"scroll-mt":Qe()}],"scroll-mr":[{"scroll-mr":Qe()}],"scroll-mb":[{"scroll-mb":Qe()}],"scroll-ml":[{"scroll-ml":Qe()}],"scroll-p":[{"scroll-p":Qe()}],"scroll-px":[{"scroll-px":Qe()}],"scroll-py":[{"scroll-py":Qe()}],"scroll-ps":[{"scroll-ps":Qe()}],"scroll-pe":[{"scroll-pe":Qe()}],"scroll-pt":[{"scroll-pt":Qe()}],"scroll-pr":[{"scroll-pr":Qe()}],"scroll-pb":[{"scroll-pb":Qe()}],"scroll-pl":[{"scroll-pl":Qe()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",$t,qt]}],fill:[{fill:["none",...Xe()]}],"stroke-w":[{stroke:[Di,xm,kd,J_]}],stroke:[{stroke:["none",...Xe()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},OC=gC(LC);function kh(...p){return OC(iC(p))}function ax({...p}){return pe.jsx(ZT,{"data-slot":"select",...p})}function sx({...p}){return pe.jsx($T,{"data-slot":"select-value",...p})}function ox({className:p,size:h="default",children:g,...b}){return pe.jsxs(qT,{"data-slot":"select-trigger","data-size":h,className:kh("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",p),...b,children:[g,pe.jsx(HT,{asChild:!0,children:pe.jsx(i0,{className:"size-4 opacity-50"})})]})}function lx({className:p,children:h,position:g="popper",...b}){return pe.jsx(XT,{children:pe.jsxs(YT,{"data-slot":"select-content",className:kh("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",g==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",p),position:g,...b,children:[pe.jsx(BC,{}),pe.jsx(WT,{className:kh("p-1",g==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:h}),pe.jsx(NC,{})]})})}function bm({className:p,children:h,...g}){return pe.jsxs(KT,{"data-slot":"select-item",className:kh("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",p),...g,children:[pe.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:pe.jsx(JT,{children:pe.jsx(Tw,{className:"size-4"})})}),pe.jsx(QT,{children:h})]})}function BC({className:p,...h}){return pe.jsx(eC,{"data-slot":"select-scroll-up-button",className:kh("flex cursor-default items-center justify-center py-1",p),...h,children:pe.jsx(Mw,{className:"size-4"})})}function NC({className:p,...h}){return pe.jsx(tC,{"data-slot":"select-scroll-down-button",className:kh("flex cursor-default items-center justify-center py-1",p),...h,children:pe.jsx(i0,{className:"size-4"})})}var Wg={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.7.0/LICENSE.txt
 */var jC=Wg.exports,cx;function FC(){return cx||(cx=1,(function(p,h){(function(g,b){p.exports=b()})(jC,(function(){var g={},b={};function C(T,o,L){if(b[T]=L,T==="index"){var N="var sharedModule = {}; ("+b.shared+")(sharedModule); ("+b.worker+")(sharedModule);",Z={};return b.shared(Z),b.index(g,Z),typeof window<"u"&&g.setWorkerUrl(window.URL.createObjectURL(new Blob([N],{type:"text/javascript"}))),g}}C("shared",["exports"],(function(T){function o(r,t,n,l){return new(n||(n=Promise))((function(d,v){function x(z){try{M(l.next(z))}catch(D){v(D)}}function S(z){try{M(l.throw(z))}catch(D){v(D)}}function M(z){var D;z.done?d(z.value):(D=z.value,D instanceof n?D:new n((function(B){B(D)}))).then(x,S)}M((l=l.apply(r,t||[])).next())}))}function L(r,t){this.x=r,this.y=t}function N(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Z,Y;typeof SuppressedError=="function"&&SuppressedError,L.prototype={clone(){return new L(this.x,this.y)},add(r){return this.clone()._add(r)},sub(r){return this.clone()._sub(r)},multByPoint(r){return this.clone()._multByPoint(r)},divByPoint(r){return this.clone()._divByPoint(r)},mult(r){return this.clone()._mult(r)},div(r){return this.clone()._div(r)},rotate(r){return this.clone()._rotate(r)},rotateAround(r,t){return this.clone()._rotateAround(r,t)},matMult(r){return this.clone()._matMult(r)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(r){return this.x===r.x&&this.y===r.y},dist(r){return Math.sqrt(this.distSqr(r))},distSqr(r){const t=r.x-this.x,n=r.y-this.y;return t*t+n*n},angle(){return Math.atan2(this.y,this.x)},angleTo(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith(r){return this.angleWithSep(r.x,r.y)},angleWithSep(r,t){return Math.atan2(this.x*t-this.y*r,this.x*r+this.y*t)},_matMult(r){const t=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=t,this},_add(r){return this.x+=r.x,this.y+=r.y,this},_sub(r){return this.x-=r.x,this.y-=r.y,this},_mult(r){return this.x*=r,this.y*=r,this},_div(r){return this.x/=r,this.y/=r,this},_multByPoint(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint(r){return this.x/=r.x,this.y/=r.y,this},_unit(){return this._div(this.mag()),this},_perp(){const r=this.y;return this.y=this.x,this.x=-r,this},_rotate(r){const t=Math.cos(r),n=Math.sin(r),l=n*this.x+t*this.y;return this.x=t*this.x-n*this.y,this.y=l,this},_rotateAround(r,t){const n=Math.cos(r),l=Math.sin(r),d=t.y+l*(this.x-t.x)+n*(this.y-t.y);return this.x=t.x+n*(this.x-t.x)-l*(this.y-t.y),this.y=d,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:L},L.convert=function(r){if(r instanceof L)return r;if(Array.isArray(r))return new L(+r[0],+r[1]);if(r.x!==void 0&&r.y!==void 0)return new L(+r.x,+r.y);throw new Error("Expected [x, y] or {x, y} point format")};var ee=(function(){if(Y)return Z;function r(t,n,l,d){this.cx=3*t,this.bx=3*(l-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(d-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=l,this.p2y=d}return Y=1,Z=r,r.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,n){if(n===void 0&&(n=1e-6),t<0)return 0;if(t>1)return 1;for(var l=t,d=0;d<8;d++){var v=this.sampleCurveX(l)-t;if(Math.abs(v)<n)return l;var x=this.sampleCurveDerivativeX(l);if(Math.abs(x)<1e-6)break;l-=v/x}var S=0,M=1;for(l=t,d=0;d<20&&(v=this.sampleCurveX(l),!(Math.abs(v-t)<n));d++)t>v?S=l:M=l,l=.5*(M-S)+S;return l},solve:function(t,n){return this.sampleCurveY(this.solveCurveX(t,n))}},Z})(),U=N(ee);let le,ie;function me(){return le==null&&(le=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),le}function Ce(){if(ie==null&&(ie=!1,me())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let l=0;l<25;l++){const d=4*l;t.fillStyle=`rgb(${d},${d+1},${d+2})`,t.fillRect(l%5,Math.floor(l/5),1,1)}const n=t.getImageData(0,0,5,5).data;for(let l=0;l<100;l++)if(l%4!=3&&n[l]!==l){ie=!0;break}}}return ie||!1}var Se=1e-6,Ee=typeof Float32Array<"u"?Float32Array:Array;function ke(){var r=new Ee(9);return Ee!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function Ve(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function ct(){var r=new Ee(3);return Ee!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function tt(r){var t=r[0],n=r[1],l=r[2];return Math.sqrt(t*t+n*n+l*l)}function Qe(r,t,n){var l=new Ee(3);return l[0]=r,l[1]=t,l[2]=n,l}function at(r,t,n){return r[0]=t[0]+n[0],r[1]=t[1]+n[1],r[2]=t[2]+n[2],r}function ht(r,t,n){return r[0]=t[0]*n,r[1]=t[1]*n,r[2]=t[2]*n,r}function Ct(r,t,n){var l=t[0],d=t[1],v=t[2],x=n[0],S=n[1],M=n[2];return r[0]=d*M-v*S,r[1]=v*x-l*M,r[2]=l*S-d*x,r}var Rt,Lt=tt;function Gt(r,t,n){var l=t[0],d=t[1],v=t[2],x=t[3];return r[0]=n[0]*l+n[4]*d+n[8]*v+n[12]*x,r[1]=n[1]*l+n[5]*d+n[9]*v+n[13]*x,r[2]=n[2]*l+n[6]*d+n[10]*v+n[14]*x,r[3]=n[3]*l+n[7]*d+n[11]*v+n[15]*x,r}function Ht(){var r=new Ee(4);return Ee!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function Oe(r,t,n,l){var d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",v=Math.PI/360;t*=v,l*=v,n*=v;var x=Math.sin(t),S=Math.cos(t),M=Math.sin(n),z=Math.cos(n),D=Math.sin(l),B=Math.cos(l);switch(d){case"xyz":r[0]=x*z*B+S*M*D,r[1]=S*M*B-x*z*D,r[2]=S*z*D+x*M*B,r[3]=S*z*B-x*M*D;break;case"xzy":r[0]=x*z*B-S*M*D,r[1]=S*M*B-x*z*D,r[2]=S*z*D+x*M*B,r[3]=S*z*B+x*M*D;break;case"yxz":r[0]=x*z*B+S*M*D,r[1]=S*M*B-x*z*D,r[2]=S*z*D-x*M*B,r[3]=S*z*B+x*M*D;break;case"yzx":r[0]=x*z*B+S*M*D,r[1]=S*M*B+x*z*D,r[2]=S*z*D-x*M*B,r[3]=S*z*B-x*M*D;break;case"zxy":r[0]=x*z*B-S*M*D,r[1]=S*M*B+x*z*D,r[2]=S*z*D+x*M*B,r[3]=S*z*B-x*M*D;break;case"zyx":r[0]=x*z*B-S*M*D,r[1]=S*M*B+x*z*D,r[2]=S*z*D-x*M*B,r[3]=S*z*B+x*M*D;break;default:throw new Error("Unknown angle order "+d)}return r}function it(){var r=new Ee(2);return Ee!=Float32Array&&(r[0]=0,r[1]=0),r}function Xe(r,t){var n=new Ee(2);return n[0]=r,n[1]=t,n}ct(),Rt=new Ee(4),Ee!=Float32Array&&(Rt[0]=0,Rt[1]=0,Rt[2]=0,Rt[3]=0),ct(),Qe(1,0,0),Qe(0,1,0),Ht(),Ht(),ke(),it();const St=8192;function be(r,t,n){return t*(St/(r.tileSize*Math.pow(2,n-r.tileID.overscaledZ)))}function Ke(r,t){return(r%t+t)%t}function wt(r,t,n){return r*(1-n)+t*n}function ft(r){if(r<=0)return 0;if(r>=1)return 1;const t=r*r,n=t*r;return 4*(r<.5?n:3*(r-t)+n-.75)}function Et(r,t,n,l){const d=new U(r,t,n,l);return v=>d.solve(v)}const Kt=Et(.25,.1,.25,1);function kt(r,t,n){return Math.min(n,Math.max(t,r))}function At(r,t,n){const l=n-t,d=((r-t)%l+l)%l+t;return d===t?n:d}function Nt(r,...t){for(const n of t)for(const l in n)r[l]=n[l];return r}let bi=1;function wi(r,t,n){const l={};for(const d in r)l[d]=t.call(this,r[d],d,r);return l}function gi(r,t,n){const l={};for(const d in r)t.call(this,r[d],d,r)&&(l[d]=r[d]);return l}function ni(r){return Array.isArray(r)?r.map(ni):typeof r=="object"&&r?wi(r,ni):r}const Ti={};function ki(r){Ti[r]||(typeof console<"u"&&console.warn(r),Ti[r]=!0)}function fr(r,t,n){return(n.y-r.y)*(t.x-r.x)>(t.y-r.y)*(n.x-r.x)}function Mr(r){return typeof WorkerGlobalScope<"u"&&r!==void 0&&r instanceof WorkerGlobalScope}let zn=null;function wa(r){return typeof ImageBitmap<"u"&&r instanceof ImageBitmap}const Ar="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function jo(r,t,n,l,d){return o(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const v=new VideoFrame(r,{timestamp:0});try{const x=v==null?void 0:v.format;if(!x||!x.startsWith("BGR")&&!x.startsWith("RGB"))throw new Error(`Unrecognized format ${x}`);const S=x.startsWith("BGR"),M=new Uint8ClampedArray(l*d*4);if(yield v.copyTo(M,(function(z,D,B,V,$){const H=4*Math.max(-D,0),K=(Math.max(0,B)-B)*V*4+H,ne=4*V,ce=Math.max(0,D),Ae=Math.max(0,B);return{rect:{x:ce,y:Ae,width:Math.min(z.width,D+V)-ce,height:Math.min(z.height,B+$)-Ae},layout:[{offset:K,stride:ne}]}})(r,t,n,l,d)),S)for(let z=0;z<M.length;z+=4){const D=M[z];M[z]=M[z+2],M[z+2]=D}return M}finally{v.close()}}))}let Za,io;function As(r,t,n,l){return r.addEventListener(t,n,l),{unsubscribe:()=>{r.removeEventListener(t,n,l)}}}function Fo(r){return r*Math.PI/180}function no(r){return r/Math.PI*180}const Sa={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Yn={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},oa="AbortError";function Me(){return new Error(oa)}const W={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Q(r){return W.REGISTERED_PROTOCOLS[r.substring(0,r.indexOf("://"))]}const re="global-dispatcher";class de extends Error{constructor(t,n,l,d){super(`AJAXError: ${n} (${t}): ${l}`),this.status=t,this.statusText=n,this.url=l,this.body=d}}const we=()=>Mr(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Pe=function(r,t){if(/:\/\//.test(r.url)&&!/^https?:|^file:/.test(r.url)){const l=Q(r.url);if(l)return l(r,t);if(Mr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:r,targetMapId:re},t)}if(!(/^file:/.test(n=r.url)||/^file:/.test(we())&&!/^\w+:/.test(n))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(l,d){return o(this,void 0,void 0,(function*(){const v=new Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,cache:l.cache,referrer:we(),signal:d.signal});let x,S;l.type!=="json"||v.headers.has("Accept")||v.headers.set("Accept","application/json");try{x=yield fetch(v)}catch(z){throw new de(0,z.message,l.url,new Blob)}if(!x.ok){const z=yield x.blob();throw new de(x.status,x.statusText,l.url,z)}S=l.type==="arrayBuffer"||l.type==="image"?x.arrayBuffer():l.type==="json"?x.json():x.text();const M=yield S;if(d.signal.aborted)throw Me();return{data:M,cacheControl:x.headers.get("Cache-Control"),expires:x.headers.get("Expires")}}))})(r,t);if(Mr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:r,mustQueue:!0,targetMapId:re},t)}var n;return(function(l,d){return new Promise(((v,x)=>{var S;const M=new XMLHttpRequest;M.open(l.method||"GET",l.url,!0),l.type!=="arrayBuffer"&&l.type!=="image"||(M.responseType="arraybuffer");for(const z in l.headers)M.setRequestHeader(z,l.headers[z]);l.type==="json"&&(M.responseType="text",!((S=l.headers)===null||S===void 0)&&S.Accept||M.setRequestHeader("Accept","application/json")),M.withCredentials=l.credentials==="include",M.onerror=()=>{x(new Error(M.statusText))},M.onload=()=>{if(!d.signal.aborted)if((M.status>=200&&M.status<300||M.status===0)&&M.response!==null){let z=M.response;if(l.type==="json")try{z=JSON.parse(M.response)}catch(D){return void x(D)}v({data:z,cacheControl:M.getResponseHeader("Cache-Control"),expires:M.getResponseHeader("Expires")})}else{const z=new Blob([M.response],{type:M.getResponseHeader("Content-Type")});x(new de(M.status,M.statusText,l.url,z))}},d.signal.addEventListener("abort",(()=>{M.abort(),x(Me())})),M.send(l.body)}))})(r,t)};function je(r){if(!r||r.indexOf("://")<=0||r.indexOf("data:image/")===0||r.indexOf("blob:")===0)return!0;const t=new URL(r),n=window.location;return t.protocol===n.protocol&&t.host===n.host}function ze(r,t,n){n[r]&&n[r].indexOf(t)!==-1||(n[r]=n[r]||[],n[r].push(t))}function Je(r,t,n){if(n&&n[r]){const l=n[r].indexOf(t);l!==-1&&n[r].splice(l,1)}}class dt{constructor(t,n={}){Nt(this,n),this.type=t}}class nt extends dt{constructor(t,n={}){super("error",Nt({error:t},n))}}class It{on(t,n){return this._listeners=this._listeners||{},ze(t,n,this._listeners),{unsubscribe:()=>{this.off(t,n)}}}off(t,n){return Je(t,n,this._listeners),Je(t,n,this._oneTimeListeners),this}once(t,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},ze(t,n,this._oneTimeListeners),this):new Promise((l=>this.once(t,l)))}fire(t,n){typeof t=="string"&&(t=new dt(t,n||{}));const l=t.type;if(this.listens(l)){t.target=this;const d=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const S of d)S.call(this,t);const v=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const S of v)Je(l,S,this._oneTimeListeners),S.call(this,t);const x=this._eventedParent;x&&(Nt(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(t))}else t instanceof nt&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,n){return this._eventedParent=t,this._eventedParentData=n,this}}var Ie={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const ei=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function _i(r,t){const n={};for(const l in r)l!=="ref"&&(n[l]=r[l]);return ei.forEach((l=>{l in t&&(n[l]=t[l])})),n}function jt(r,t){if(Array.isArray(r)){if(!Array.isArray(t)||r.length!==t.length)return!1;for(let n=0;n<r.length;n++)if(!jt(r[n],t[n]))return!1;return!0}if(typeof r=="object"&&r!==null&&t!==null){if(typeof t!="object"||Object.keys(r).length!==Object.keys(t).length)return!1;for(const n in r)if(!jt(r[n],t[n]))return!1;return!0}return r===t}function si(r,t){r.push(t)}function Yi(r,t,n){si(n,{command:"addSource",args:[r,t[r]]})}function Wn(r,t,n){si(t,{command:"removeSource",args:[r]}),n[r]=!0}function ir(r,t,n,l){Wn(r,n,l),Yi(r,t,n)}function en(r,t,n){let l;for(l in r[n])if(Object.prototype.hasOwnProperty.call(r[n],l)&&l!=="data"&&!jt(r[n][l],t[n][l]))return!1;for(l in t[n])if(Object.prototype.hasOwnProperty.call(t[n],l)&&l!=="data"&&!jt(r[n][l],t[n][l]))return!1;return!0}function Wt(r,t,n,l,d,v){r=r||{},t=t||{};for(const x in r)Object.prototype.hasOwnProperty.call(r,x)&&(jt(r[x],t[x])||n.push({command:v,args:[l,x,t[x],d]}));for(const x in t)Object.prototype.hasOwnProperty.call(t,x)&&!Object.prototype.hasOwnProperty.call(r,x)&&(jt(r[x],t[x])||n.push({command:v,args:[l,x,t[x],d]}))}function ti(r){return r.id}function fn(r,t){return r[t.id]=t,r}class pt{constructor(t,n,l,d){this.message=(t?`${t}: `:"")+l,d&&(this.identifier=d),n!=null&&n.__line__&&(this.line=n.__line__)}}function Pr(r,...t){for(const n of t)for(const l in n)r[l]=n[l];return r}class Cn extends Error{constructor(t,n){super(n),this.message=n,this.key=t}}class Ps{constructor(t,n=[]){this.parent=t,this.bindings={};for(const[l,d]of n)this.bindings[l]=d}concat(t){return new Ps(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const cs={kind:"null"},Tt={kind:"number"},ci={kind:"string"},ri={kind:"boolean"},Zn={kind:"color"},Ta={kind:"projectionDefinition"},pn={kind:"object"},ui={kind:"value"},Mc={kind:"collator"},ta={kind:"formatted"},Rs={kind:"padding"},us={kind:"colorArray"},Uo={kind:"numberArray"},En={kind:"resolvedImage"},zu={kind:"variableAnchorOffsetCollection"};function pr(r,t){return{kind:"array",itemType:r,N:t}}function Ni(r){if(r.kind==="array"){const t=Ni(r.itemType);return typeof r.N=="number"?`array<${t}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${t}>`}return r.kind}const hs=[cs,Tt,ci,ri,Zn,Ta,ta,pn,pr(ui),Rs,Uo,us,En,zu];function Vo(r,t){if(t.kind==="error")return null;if(r.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Vo(r.itemType,t.itemType))&&(typeof r.N!="number"||r.N===t.N))return null}else{if(r.kind===t.kind)return null;if(r.kind==="value"){for(const n of hs)if(!Vo(n,t))return null}}return`Expected ${Ni(r)} but found ${Ni(t)} instead.`}function Iu(r,t){return t.some((n=>n.kind===r.kind))}function la(r,t){return t.some((n=>n==="null"?r===null:n==="array"?Array.isArray(r):n==="object"?r&&!Array.isArray(r)&&typeof r=="object":n===typeof r))}function ds(r,t){return r.kind==="array"&&t.kind==="array"?r.itemType.kind===t.itemType.kind&&typeof r.N=="number":r.kind===t.kind}const Ac=.96422,Yd=.82521,Bh=4/29,mr=6/29,Nh=3*mr*mr,Sp=mr*mr*mr,Du=Math.PI/180,Wd=180/Math.PI;function Rl(r){return(r%=360)<0&&(r+=360),r}function zl([r,t,n,l]){let d,v;const x=Pc((.2225045*(r=ia(r))+.7168786*(t=ia(t))+.0606169*(n=ia(n)))/1);r===t&&t===n?d=v=x:(d=Pc((.4360747*r+.3850649*t+.1430804*n)/Ac),v=Pc((.0139322*r+.0971045*t+.7141733*n)/Yd));const S=116*x-16;return[S<0?0:S,500*(d-x),200*(x-v),l]}function ia(r){return r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function Pc(r){return r>Sp?Math.pow(r,1/3):r/Nh+Bh}function Go([r,t,n,l]){let d=(r+16)/116,v=isNaN(t)?d:d+t/500,x=isNaN(n)?d:d-n/200;return d=1*ro(d),v=Ac*ro(v),x=Yd*ro(x),[Rc(3.1338561*v-1.6168667*d-.4906146*x),Rc(-.9787684*v+1.9161415*d+.033454*x),Rc(.0719453*v-.2289914*d+1.4052427*x),l]}function Rc(r){return(r=r<=.00304?12.92*r:1.055*Math.pow(r,1/2.4)-.055)<0?0:r>1?1:r}function ro(r){return r>mr?r*r*r:Nh*(r-Bh)}const Kd=Object.hasOwn||function(r,t){return Object.prototype.hasOwnProperty.call(r,t)};function Zo(r,t){return Kd(r,t)?r[t]:void 0}function fs(r){return parseInt(r.padEnd(2,r),16)/255}function qa(r,t){return yi(t?r/100:r,0,1)}function yi(r,t,n){return Math.min(Math.max(t,r),n)}function ao(r){return!r.some(Number.isNaN)}const ps={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function zs(r,t,n){return r+n*(t-r)}function qo(r,t,n){return r.map(((l,d)=>zs(l,t[d],n)))}class pi{constructor(t,n,l,d=1,v=!0){this.r=t,this.g=n,this.b=l,this.a=d,v||(this.r*=d,this.g*=d,this.b*=d,d||this.overwriteGetter("rgb",[t,n,l,d]))}static parse(t){if(t instanceof pi)return t;if(typeof t!="string")return;const n=(function(l){if((l=l.toLowerCase().trim())==="transparent")return[0,0,0,0];const d=Zo(ps,l);if(d){const[x,S,M]=d;return[x/255,S/255,M/255,1]}if(l.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(l)){const x=l.length<6?1:2;let S=1;return[fs(l.slice(S,S+=x)),fs(l.slice(S,S+=x)),fs(l.slice(S,S+=x)),fs(l.slice(S,S+x)||"ff")]}if(l.startsWith("rgb")){const x=l.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[S,M,z,D,B,V,$,H,K,ne,ce,Ae]=x,_e=[D||" ",$||" ",ne].join("");if(_e==="  "||_e==="  /"||_e===",,"||_e===",,,"){const xe=[z,V,K].join(""),Ue=xe==="%%%"?100:xe===""?255:0;if(Ue){const Ye=[yi(+M/Ue,0,1),yi(+B/Ue,0,1),yi(+H/Ue,0,1),ce?qa(+ce,Ae):1];if(ao(Ye))return Ye}}return}}const v=l.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(v){const[x,S,M,z,D,B,V,$,H]=v,K=[M||" ",D||" ",V].join("");if(K==="  "||K==="  /"||K===",,"||K===",,,"){const ne=[+S,yi(+z,0,100),yi(+B,0,100),$?qa(+$,H):1];if(ao(ne))return(function([ce,Ae,_e,xe]){function Ue(Ye){const ot=(Ye+ce/30)%12,xt=Ae*Math.min(_e,1-_e);return _e-xt*Math.max(-1,Math.min(ot-3,9-ot,1))}return ce=Rl(ce),Ae/=100,_e/=100,[Ue(0),Ue(8),Ue(4),xe]})(ne)}}})(t);return n?new pi(...n,!1):void 0}get rgb(){const{r:t,g:n,b:l,a:d}=this,v=d||1/0;return this.overwriteGetter("rgb",[t/v,n/v,l/v,d])}get hcl(){return this.overwriteGetter("hcl",(function(t){const[n,l,d,v]=zl(t),x=Math.sqrt(l*l+d*d);return[Math.round(1e4*x)?Rl(Math.atan2(d,l)*Wd):NaN,x,n,v]})(this.rgb))}get lab(){return this.overwriteGetter("lab",zl(this.rgb))}overwriteGetter(t,n){return Object.defineProperty(this,t,{value:n}),n}toString(){const[t,n,l,d]=this.rgb;return`rgba(${[t,n,l].map((v=>Math.round(255*v))).join(",")},${d})`}static interpolate(t,n,l,d="rgb"){switch(d){case"rgb":{const[v,x,S,M]=qo(t.rgb,n.rgb,l);return new pi(v,x,S,M,!1)}case"hcl":{const[v,x,S,M]=t.hcl,[z,D,B,V]=n.hcl;let $,H;if(isNaN(v)||isNaN(z))isNaN(v)?isNaN(z)?$=NaN:($=z,S!==1&&S!==0||(H=D)):($=v,B!==1&&B!==0||(H=x));else{let _e=z-v;z>v&&_e>180?_e-=360:z<v&&v-z>180&&(_e+=360),$=v+l*_e}const[K,ne,ce,Ae]=(function([_e,xe,Ue,Ye]){return _e=isNaN(_e)?0:_e*Du,Go([Ue,Math.cos(_e)*xe,Math.sin(_e)*xe,Ye])})([$,H??zs(x,D,l),zs(S,B,l),zs(M,V,l)]);return new pi(K,ne,ce,Ae,!1)}case"lab":{const[v,x,S,M]=Go(qo(t.lab,n.lab,l));return new pi(v,x,S,M,!1)}}}}pi.black=new pi(0,0,0,1),pi.white=new pi(1,1,1,1),pi.transparent=new pi(0,0,0,0),pi.red=new pi(1,0,0,1);class Is{constructor(t,n,l){this.sensitivity=t?n?"variant":"case":n?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,n){return this.collator.compare(t,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Il=["bottom","center","top"];class Ds{constructor(t,n,l,d,v,x){this.text=t,this.image=n,this.scale=l,this.fontStack=d,this.textColor=v,this.verticalAlign=x}}class Kn{constructor(t){this.sections=t}static fromString(t){return new Kn([new Ds(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((t=>t.text.length!==0||t.image&&t.image.name.length!==0))}static factory(t){return t instanceof Kn?t:Kn.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map((t=>t.text)).join("")}}class nr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof nr)return t;if(typeof t=="number")return new nr([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const n of t)if(typeof n!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new nr(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,n,l){return new nr(qo(t.values,n.values,l))}}class gr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof gr)return t;if(typeof t=="number")return new gr([t]);if(Array.isArray(t)){for(const n of t)if(typeof n!="number")return;return new gr(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,n,l){return new gr(qo(t.values,n.values,l))}}class qn{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof qn)return t;if(typeof t=="string"){const l=pi.parse(t);return l?new qn([l]):void 0}if(!Array.isArray(t))return;const n=[];for(const l of t){if(typeof l!="string")return;const d=pi.parse(l);if(!d)return;n.push(d)}return new qn(n)}toString(){return JSON.stringify(this.values)}static interpolate(t,n,l,d="rgb"){const v=[];if(t.values.length!=n.values.length)throw new Error(`colorArray: Arrays have mismatched length (${t.values.length} vs. ${n.values.length}), cannot interpolate.`);for(let x=0;x<t.values.length;x++)v.push(pi.interpolate(t.values[x],n.values[x],l,d));return new qn(v)}}class Li extends Error{constructor(t){super(t),this.name="RuntimeError"}toJSON(){return this.message}}const ms=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class _r{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof _r)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let n=0;n<t.length;n+=2){const l=t[n],d=t[n+1];if(typeof l!="string"||!ms.has(l)||!Array.isArray(d)||d.length!==2||typeof d[0]!="number"||typeof d[1]!="number")return}return new _r(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,n,l){const d=t.values,v=n.values;if(d.length!==v.length)throw new Li(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${n.toString()}`);const x=[];for(let S=0;S<d.length;S+=2){if(d[S]!==v[S])throw new Li(`Cannot interpolate values containing mismatched anchors. from[${S}]: ${d[S]}, to[${S}]: ${v[S]}`);x.push(d[S]);const[M,z]=d[S+1],[D,B]=v[S+1];x.push([zs(M,D,l),zs(z,B,l)])}return new _r(x)}}class yr{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new yr({name:t,available:!1}):null}}class Mn{constructor(t,n,l){this.from=t,this.to=n,this.transition=l}static interpolate(t,n,l){return new Mn(t,n,l)}static parse(t){return t instanceof Mn?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new Mn(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new Mn(t.from,t.to,t.transition):typeof t=="string"?new Mn(t,t,1):void 0}}function tn(r,t,n,l){return typeof r=="number"&&r>=0&&r<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof n=="number"&&n>=0&&n<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[r,t,n,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[r,t,n,l]:[r,t,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function gs(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof Mn||r instanceof pi||r instanceof Is||r instanceof Kn||r instanceof nr||r instanceof gr||r instanceof qn||r instanceof _r||r instanceof yr)return!0;if(Array.isArray(r)){for(const t of r)if(!gs(t))return!1;return!0}if(typeof r=="object"){for(const t in r)if(!gs(r[t]))return!1;return!0}return!1}function Yt(r){if(r===null)return cs;if(typeof r=="string")return ci;if(typeof r=="boolean")return ri;if(typeof r=="number")return Tt;if(r instanceof pi)return Zn;if(r instanceof Mn)return Ta;if(r instanceof Is)return Mc;if(r instanceof Kn)return ta;if(r instanceof nr)return Rs;if(r instanceof gr)return Uo;if(r instanceof qn)return us;if(r instanceof _r)return zu;if(r instanceof yr)return En;if(Array.isArray(r)){const t=r.length;let n;for(const l of r){const d=Yt(l);if(n){if(n===d)continue;n=ui;break}n=d}return pr(n||ui,t)}return pn}function ii(r){const t=typeof r;return r===null?"":t==="string"||t==="number"||t==="boolean"?String(r):r instanceof pi||r instanceof Mn||r instanceof Kn||r instanceof nr||r instanceof gr||r instanceof qn||r instanceof _r||r instanceof yr?r.toString():JSON.stringify(r)}class Ca{constructor(t,n){this.type=t,this.value=n}static parse(t,n){if(t.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!gs(t[1]))return n.error("invalid value");const l=t[1];let d=Yt(l);const v=n.expectedType;return d.kind!=="array"||d.N!==0||!v||v.kind!=="array"||typeof v.N=="number"&&v.N!==0||(d=v),new Ca(d,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Ci={string:ci,number:Tt,boolean:ri,object:pn};class sn{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");let l,d=1;const v=t[0];if(v==="array"){let S,M;if(t.length>2){const z=t[1];if(typeof z!="string"||!(z in Ci)||z==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);S=Ci[z],d++}else S=ui;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return n.error('The length argument to "array" must be a positive integer literal',2);M=t[2],d++}l=pr(S,M)}else{if(!Ci[v])throw new Error(`Types doesn't contain name = ${v}`);l=Ci[v]}const x=[];for(;d<t.length;d++){const S=n.parse(t[d],d,ui);if(!S)return null;x.push(S)}return new sn(l,x)}evaluate(t){for(let n=0;n<this.args.length;n++){const l=this.args[n].evaluate(t);if(!Vo(this.type,Yt(l)))return l;if(n===this.args.length-1)throw new Li(`Expected value to be of type ${Ni(this.type)}, but found ${Ni(Yt(l))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}const Rr={"to-boolean":ri,"to-color":Zn,"to-number":Tt,"to-string":ci};class ca{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");const l=t[0];if(!Rr[l])throw new Error(`Can't parse ${l} as it is not part of the known types`);if((l==="to-boolean"||l==="to-string")&&t.length!==2)return n.error("Expected one argument.");const d=Rr[l],v=[];for(let x=1;x<t.length;x++){const S=n.parse(t[x],x,ui);if(!S)return null;v.push(S)}return new ca(d,v)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let n,l;for(const d of this.args){if(n=d.evaluate(t),l=null,n instanceof pi)return n;if(typeof n=="string"){const v=t.parseColor(n);if(v)return v}else if(Array.isArray(n)&&(l=n.length<3||n.length>4?`Invalid rgba value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:tn(n[0],n[1],n[2],n[3]),!l))return new pi(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new Li(l||`Could not parse color from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"padding":{let n;for(const l of this.args){n=l.evaluate(t);const d=nr.parse(n);if(d)return d}throw new Li(`Could not parse padding from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"numberArray":{let n;for(const l of this.args){n=l.evaluate(t);const d=gr.parse(n);if(d)return d}throw new Li(`Could not parse numberArray from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"colorArray":{let n;for(const l of this.args){n=l.evaluate(t);const d=qn.parse(n);if(d)return d}throw new Li(`Could not parse colorArray from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"variableAnchorOffsetCollection":{let n;for(const l of this.args){n=l.evaluate(t);const d=_r.parse(n);if(d)return d}throw new Li(`Could not parse variableAnchorOffsetCollection from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"number":{let n=null;for(const l of this.args){if(n=l.evaluate(t),n===null)return 0;const d=Number(n);if(!isNaN(d))return d}throw new Li(`Could not convert ${JSON.stringify(n)} to number.`)}case"formatted":return Kn.fromString(ii(this.args[0].evaluate(t)));case"resolvedImage":return yr.fromString(ii(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return ii(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}const so=["Unknown","Point","LineString","Polygon"];class jh{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?so[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let n=this._parseColorCache.get(t);return n||(n=pi.parse(t),this._parseColorCache.set(t,n)),n}}class oo{constructor(t,n,l=[],d,v=new Ps,x=[]){this.registry=t,this.path=l,this.key=l.map((S=>`[${S}]`)).join(""),this.scope=v,this.errors=x,this.expectedType=d,this._isConstant=n}parse(t,n,l,d,v={}){return n?this.concat(n,l,d)._parse(t,v):this._parse(t,v)}_parse(t,n){function l(d,v,x){return x==="assert"?new sn(v,[d]):x==="coerce"?new ca(v,[d]):d}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const d=t[0];if(typeof d!="string")return this.error(`Expression name must be a string, but found ${typeof d} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const v=this.registry[d];if(v){let x=v.parse(t,this);if(!x)return null;if(this.expectedType){const S=this.expectedType,M=x.type;if(S.kind!=="string"&&S.kind!=="number"&&S.kind!=="boolean"&&S.kind!=="object"&&S.kind!=="array"||M.kind!=="value"){if(S.kind==="projectionDefinition"&&["string","array"].includes(M.kind)||["color","formatted","resolvedImage"].includes(S.kind)&&["value","string"].includes(M.kind)||["padding","numberArray"].includes(S.kind)&&["value","number","array"].includes(M.kind)||S.kind==="colorArray"&&["value","string","array"].includes(M.kind)||S.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(M.kind))x=l(x,S,n.typeAnnotation||"coerce");else if(this.checkSubtype(S,M))return null}else x=l(x,S,n.typeAnnotation||"assert")}if(!(x instanceof Ca)&&x.type.kind!=="resolvedImage"&&this._isConstant(x)){const S=new jh;try{x=new Ca(x.type,x.evaluate(S))}catch(M){return this.error(M.message),null}}return x}return this.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,n,l){const d=typeof t=="number"?this.path.concat(t):this.path,v=l?this.scope.concat(l):this.scope;return new oo(this.registry,this._isConstant,d,n||null,v,this.errors)}error(t,...n){const l=`${this.key}${n.map((d=>`[${d}]`)).join("")}`;this.errors.push(new Cn(l,t))}checkSubtype(t,n){const l=Vo(t,n);return l&&this.error(l),l}}class $o{constructor(t,n){this.type=n.type,this.bindings=[].concat(t),this.result=n}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const n of this.bindings)t(n[1]);t(this.result)}static parse(t,n){if(t.length<4)return n.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const l=[];for(let v=1;v<t.length-1;v+=2){const x=t[v];if(typeof x!="string")return n.error(`Expected string, but found ${typeof x} instead.`,v);if(/[^a-zA-Z0-9_]/.test(x))return n.error("Variable names must contain only alphanumeric characters or '_'.",v);const S=n.parse(t[v+1],v+1);if(!S)return null;l.push([x,S])}const d=n.parse(t[t.length-1],t.length-1,n.expectedType,l);return d?new $o(l,d):null}outputDefined(){return this.result.outputDefined()}}class lo{constructor(t,n){this.type=n.type,this.name=t,this.boundExpression=n}static parse(t,n){if(t.length!==2||typeof t[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const l=t[1];return n.scope.has(l)?new lo(l,n.scope.get(l)):n.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class Ho{constructor(t,n,l){this.type=t,this.index=n,this.input=l}static parse(t,n){if(t.length!==3)return n.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=n.parse(t[1],1,Tt),d=n.parse(t[2],2,pr(n.expectedType||ui));return l&&d?new Ho(d.type.itemType,l,d):null}evaluate(t){const n=this.index.evaluate(t),l=this.input.evaluate(t);if(n<0)throw new Li(`Array index out of bounds: ${n} < 0.`);if(n>=l.length)throw new Li(`Array index out of bounds: ${n} > ${l.length-1}.`);if(n!==Math.floor(n))throw new Li(`Array index must be an integer, but found ${n} instead.`);return l[n]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class zc{constructor(t,n){this.type=ri,this.needle=t,this.haystack=n}static parse(t,n){if(t.length!==3)return n.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=n.parse(t[1],1,ui),d=n.parse(t[2],2,ui);return l&&d?Iu(l.type,[ri,ci,Tt,cs,ui])?new zc(l,d):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ni(l.type)} instead`):null}evaluate(t){const n=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(!l)return!1;if(!la(n,["boolean","string","number","null"]))throw new Li(`Expected first argument to be of type boolean, string, number or null, but found ${Ni(Yt(n))} instead.`);if(!la(l,["string","array"]))throw new Li(`Expected second argument to be of type array or string, but found ${Ni(Yt(l))} instead.`);return l.indexOf(n)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class $a{constructor(t,n,l){this.type=Tt,this.needle=t,this.haystack=n,this.fromIndex=l}static parse(t,n){if(t.length<=2||t.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=n.parse(t[1],1,ui),d=n.parse(t[2],2,ui);if(!l||!d)return null;if(!Iu(l.type,[ri,ci,Tt,cs,ui]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ni(l.type)} instead`);if(t.length===4){const v=n.parse(t[3],3,Tt);return v?new $a(l,d,v):null}return new $a(l,d)}evaluate(t){const n=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(!la(n,["boolean","string","number","null"]))throw new Li(`Expected first argument to be of type boolean, string, number or null, but found ${Ni(Yt(n))} instead.`);let d;if(this.fromIndex&&(d=this.fromIndex.evaluate(t)),la(l,["string"])){const v=l.indexOf(n,d);return v===-1?-1:[...l.slice(0,v)].length}if(la(l,["array"]))return l.indexOf(n,d);throw new Li(`Expected second argument to be of type array or string, but found ${Ni(Yt(l))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class lr{constructor(t,n,l,d,v,x){this.inputType=t,this.type=n,this.input=l,this.cases=d,this.outputs=v,this.otherwise=x}static parse(t,n){if(t.length<5)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return n.error("Expected an even number of arguments.");let l,d;n.expectedType&&n.expectedType.kind!=="value"&&(d=n.expectedType);const v={},x=[];for(let z=2;z<t.length-1;z+=2){let D=t[z];const B=t[z+1];Array.isArray(D)||(D=[D]);const V=n.concat(z);if(D.length===0)return V.error("Expected at least one branch label.");for(const H of D){if(typeof H!="number"&&typeof H!="string")return V.error("Branch labels must be numbers or strings.");if(typeof H=="number"&&Math.abs(H)>Number.MAX_SAFE_INTEGER)return V.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof H=="number"&&Math.floor(H)!==H)return V.error("Numeric branch labels must be integer values.");if(l){if(V.checkSubtype(l,Yt(H)))return null}else l=Yt(H);if(v[String(H)]!==void 0)return V.error("Branch labels must be unique.");v[String(H)]=x.length}const $=n.parse(B,z,d);if(!$)return null;d=d||$.type,x.push($)}const S=n.parse(t[1],1,ui);if(!S)return null;const M=n.parse(t[t.length-1],t.length-1,d);return M?S.type.kind!=="value"&&n.concat(1).checkSubtype(l,S.type)?null:new lr(l,d,S,v,x,M):null}evaluate(t){const n=this.input.evaluate(t);return(Yt(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))&&this.otherwise.outputDefined()}}class Dl{constructor(t,n,l){this.type=t,this.branches=n,this.otherwise=l}static parse(t,n){if(t.length<4)return n.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return n.error("Expected an odd number of arguments.");let l;n.expectedType&&n.expectedType.kind!=="value"&&(l=n.expectedType);const d=[];for(let x=1;x<t.length-1;x+=2){const S=n.parse(t[x],x,ri);if(!S)return null;const M=n.parse(t[x+1],x+1,l);if(!M)return null;d.push([S,M]),l=l||M.type}const v=n.parse(t[t.length-1],t.length-1,l);if(!v)return null;if(!l)throw new Error("Can't infer output type");return new Dl(l,d,v)}evaluate(t){for(const[n,l]of this.branches)if(n.evaluate(t))return l.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[n,l]of this.branches)t(n),t(l);t(this.otherwise)}outputDefined(){return this.branches.every((([t,n])=>n.outputDefined()))&&this.otherwise.outputDefined()}}class Xo{constructor(t,n,l,d){this.type=t,this.input=n,this.beginIndex=l,this.endIndex=d}static parse(t,n){if(t.length<=2||t.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=n.parse(t[1],1,ui),d=n.parse(t[2],2,Tt);if(!l||!d)return null;if(!Iu(l.type,[pr(ui),ci,ui]))return n.error(`Expected first argument to be of type array or string, but found ${Ni(l.type)} instead`);if(t.length===4){const v=n.parse(t[3],3,Tt);return v?new Xo(l.type,l,d,v):null}return new Xo(l.type,l,d)}evaluate(t){const n=this.input.evaluate(t),l=this.beginIndex.evaluate(t);let d;if(this.endIndex&&(d=this.endIndex.evaluate(t)),la(n,["string"]))return[...n].slice(l,d).join("");if(la(n,["array"]))return n.slice(l,d);throw new Li(`Expected first argument to be of type array or string, but found ${Ni(Yt(n))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function Yo(r,t){const n=r.length-1;let l,d,v=0,x=n,S=0;for(;v<=x;)if(S=Math.floor((v+x)/2),l=r[S],d=r[S+1],l<=t){if(S===n||t<d)return S;v=S+1}else{if(!(l>t))throw new Li("Input is not a number.");x=S-1}return 0}class In{constructor(t,n,l){this.type=t,this.input=n,this.labels=[],this.outputs=[];for(const[d,v]of l)this.labels.push(d),this.outputs.push(v)}static parse(t,n){if(t.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");const l=n.parse(t[1],1,Tt);if(!l)return null;const d=[];let v=null;n.expectedType&&n.expectedType.kind!=="value"&&(v=n.expectedType);for(let x=1;x<t.length;x+=2){const S=x===1?-1/0:t[x],M=t[x+1],z=x,D=x+1;if(typeof S!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',z);if(d.length&&d[d.length-1][0]>=S)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',z);const B=n.parse(M,D,v);if(!B)return null;v=v||B.type,d.push([S,B])}return new In(v,l,d)}evaluate(t){const n=this.labels,l=this.outputs;if(n.length===1)return l[0].evaluate(t);const d=this.input.evaluate(t);if(d<=n[0])return l[0].evaluate(t);const v=n.length;return d>=n[v-1]?l[v-1].evaluate(t):l[Yo(n,d)].evaluate(t)}eachChild(t){t(this.input);for(const n of this.outputs)t(n)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}}function Qd(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Ic,Fh,Jd=(function(){if(Fh)return Ic;function r(t,n,l,d){this.cx=3*t,this.bx=3*(l-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(d-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=l,this.p2y=d}return Fh=1,Ic=r,r.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,n){if(n===void 0&&(n=1e-6),t<0)return 0;if(t>1)return 1;for(var l=t,d=0;d<8;d++){var v=this.sampleCurveX(l)-t;if(Math.abs(v)<n)return l;var x=this.sampleCurveDerivativeX(l);if(Math.abs(x)<1e-6)break;l-=v/x}var S=0,M=1;for(l=t,d=0;d<20&&(v=this.sampleCurveX(l),!(Math.abs(v-t)<n));d++)t>v?S=l:M=l,l=.5*(M-S)+S;return l},solve:function(t,n){return this.sampleCurveY(this.solveCurveX(t,n))}},Ic})(),kl=Qd(Jd);class vr{constructor(t,n,l,d,v){this.type=t,this.operator=n,this.interpolation=l,this.input=d,this.labels=[],this.outputs=[];for(const[x,S]of v)this.labels.push(x),this.outputs.push(S)}static interpolationFactor(t,n,l,d){let v=0;if(t.name==="exponential")v=Dc(n,t.base,l,d);else if(t.name==="linear")v=Dc(n,1,l,d);else if(t.name==="cubic-bezier"){const x=t.controlPoints;v=new kl(x[0],x[1],x[2],x[3]).solve(Dc(n,1,l,d))}return v}static parse(t,n){let[l,d,v,...x]=t;if(!Array.isArray(d)||d.length===0)return n.error("Expected an interpolation type expression.",1);if(d[0]==="linear")d={name:"linear"};else if(d[0]==="exponential"){const z=d[1];if(typeof z!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:z}}else{if(d[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(d[0])}`,1,0);{const z=d.slice(1);if(z.length!==4||z.some((D=>typeof D!="number"||D<0||D>1)))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:z}}}if(t.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(v=n.parse(v,2,Tt),!v)return null;const S=[];let M=null;l!=="interpolate-hcl"&&l!=="interpolate-lab"||n.expectedType==us?n.expectedType&&n.expectedType.kind!=="value"&&(M=n.expectedType):M=Zn;for(let z=0;z<x.length;z+=2){const D=x[z],B=x[z+1],V=z+3,$=z+4;if(typeof D!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',V);if(S.length&&S[S.length-1][0]>=D)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',V);const H=n.parse(B,$,M);if(!H)return null;M=M||H.type,S.push([D,H])}return ds(M,Tt)||ds(M,Ta)||ds(M,Zn)||ds(M,Rs)||ds(M,Uo)||ds(M,us)||ds(M,zu)||ds(M,pr(Tt))?new vr(M,l,d,v,S):n.error(`Type ${Ni(M)} is not interpolatable.`)}evaluate(t){const n=this.labels,l=this.outputs;if(n.length===1)return l[0].evaluate(t);const d=this.input.evaluate(t);if(d<=n[0])return l[0].evaluate(t);const v=n.length;if(d>=n[v-1])return l[v-1].evaluate(t);const x=Yo(n,d),S=vr.interpolationFactor(this.interpolation,d,n[x],n[x+1]),M=l[x].evaluate(t),z=l[x+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return zs(M,z,S);case"color":return pi.interpolate(M,z,S);case"padding":return nr.interpolate(M,z,S);case"colorArray":return qn.interpolate(M,z,S);case"numberArray":return gr.interpolate(M,z,S);case"variableAnchorOffsetCollection":return _r.interpolate(M,z,S);case"array":return qo(M,z,S);case"projectionDefinition":return Mn.interpolate(M,z,S)}case"interpolate-hcl":switch(this.type.kind){case"color":return pi.interpolate(M,z,S,"hcl");case"colorArray":return qn.interpolate(M,z,S,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return pi.interpolate(M,z,S,"lab");case"colorArray":return qn.interpolate(M,z,S,"lab")}}}eachChild(t){t(this.input);for(const n of this.outputs)t(n)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}}function Dc(r,t,n,l){const d=l-n,v=r-n;return d===0?0:t===1?v/d:(Math.pow(t,v)-1)/(Math.pow(t,d)-1)}const _s={color:pi.interpolate,number:zs,padding:nr.interpolate,numberArray:gr.interpolate,colorArray:qn.interpolate,variableAnchorOffsetCollection:_r.interpolate,array:qo};class Wo{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");let l=null;const d=n.expectedType;d&&d.kind!=="value"&&(l=d);const v=[];for(const S of t.slice(1)){const M=n.parse(S,1+v.length,l,void 0,{typeAnnotation:"omit"});if(!M)return null;l=l||M.type,v.push(M)}if(!l)throw new Error("No output type");const x=d&&v.some((S=>Vo(d,S.type)));return new Wo(x?ui:l,v)}evaluate(t){let n,l=null,d=0;for(const v of this.args)if(d++,l=v.evaluate(t),l&&l instanceof yr&&!l.available&&(n||(n=l.name),l=null,d===this.args.length&&(l=n)),l!==null)break;return l}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}function kc(r,t){return r==="=="||r==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Lc(r,t,n,l){return l.compare(t,n)===0}function zr(r,t,n){const l=r!=="=="&&r!=="!=";return class Pb{constructor(v,x,S){this.type=ri,this.lhs=v,this.rhs=x,this.collator=S,this.hasUntypedArgument=v.type.kind==="value"||x.type.kind==="value"}static parse(v,x){if(v.length!==3&&v.length!==4)return x.error("Expected two or three arguments.");const S=v[0];let M=x.parse(v[1],1,ui);if(!M)return null;if(!kc(S,M.type))return x.concat(1).error(`"${S}" comparisons are not supported for type '${Ni(M.type)}'.`);let z=x.parse(v[2],2,ui);if(!z)return null;if(!kc(S,z.type))return x.concat(2).error(`"${S}" comparisons are not supported for type '${Ni(z.type)}'.`);if(M.type.kind!==z.type.kind&&M.type.kind!=="value"&&z.type.kind!=="value")return x.error(`Cannot compare types '${Ni(M.type)}' and '${Ni(z.type)}'.`);l&&(M.type.kind==="value"&&z.type.kind!=="value"?M=new sn(z.type,[M]):M.type.kind!=="value"&&z.type.kind==="value"&&(z=new sn(M.type,[z])));let D=null;if(v.length===4){if(M.type.kind!=="string"&&z.type.kind!=="string"&&M.type.kind!=="value"&&z.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(D=x.parse(v[3],3,Mc),!D)return null}return new Pb(M,z,D)}evaluate(v){const x=this.lhs.evaluate(v),S=this.rhs.evaluate(v);if(l&&this.hasUntypedArgument){const M=Yt(x),z=Yt(S);if(M.kind!==z.kind||M.kind!=="string"&&M.kind!=="number")throw new Li(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${M.kind}, ${z.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const M=Yt(x),z=Yt(S);if(M.kind!=="string"||z.kind!=="string")return t(v,x,S)}return this.collator?n(v,x,S,this.collator.evaluate(v)):t(v,x,S)}eachChild(v){v(this.lhs),v(this.rhs),this.collator&&v(this.collator)}outputDefined(){return!0}}}const Uh=zr("==",(function(r,t,n){return t===n}),Lc),ku=zr("!=",(function(r,t,n){return t!==n}),(function(r,t,n,l){return!Lc(0,t,n,l)})),Tp=zr("<",(function(r,t,n){return t<n}),(function(r,t,n,l){return l.compare(t,n)<0})),Vh=zr(">",(function(r,t,n){return t>n}),(function(r,t,n,l){return l.compare(t,n)>0})),Cp=zr("<=",(function(r,t,n){return t<=n}),(function(r,t,n,l){return l.compare(t,n)<=0})),Ep=zr(">=",(function(r,t,n){return t>=n}),(function(r,t,n,l){return l.compare(t,n)>=0}));class Lu{constructor(t,n,l){this.type=Mc,this.locale=l,this.caseSensitive=t,this.diacriticSensitive=n}static parse(t,n){if(t.length!==2)return n.error("Expected one argument.");const l=t[1];if(typeof l!="object"||Array.isArray(l))return n.error("Collator options argument must be an object.");const d=n.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,ri);if(!d)return null;const v=n.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,ri);if(!v)return null;let x=null;return l.locale&&(x=n.parse(l.locale,1,ci),!x)?null:new Lu(d,v,x)}evaluate(t){return new Is(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class Gh{constructor(t,n,l,d,v){this.type=ci,this.number=t,this.locale=n,this.currency=l,this.minFractionDigits=d,this.maxFractionDigits=v}static parse(t,n){if(t.length!==3)return n.error("Expected two arguments.");const l=n.parse(t[1],1,Tt);if(!l)return null;const d=t[2];if(typeof d!="object"||Array.isArray(d))return n.error("NumberFormat options argument must be an object.");let v=null;if(d.locale&&(v=n.parse(d.locale,1,ci),!v))return null;let x=null;if(d.currency&&(x=n.parse(d.currency,1,ci),!x))return null;let S=null;if(d["min-fraction-digits"]&&(S=n.parse(d["min-fraction-digits"],1,Tt),!S))return null;let M=null;return d["max-fraction-digits"]&&(M=n.parse(d["max-fraction-digits"],1,Tt),!M)?null:new Gh(l,v,x,S,M)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class Ko{constructor(t){this.type=ta,this.sections=t}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");const l=t[1];if(!Array.isArray(l)&&typeof l=="object")return n.error("First argument must be an image or text section.");const d=[];let v=!1;for(let x=1;x<=t.length-1;++x){const S=t[x];if(v&&typeof S=="object"&&!Array.isArray(S)){v=!1;let M=null;if(S["font-scale"]&&(M=n.parse(S["font-scale"],1,Tt),!M))return null;let z=null;if(S["text-font"]&&(z=n.parse(S["text-font"],1,pr(ci)),!z))return null;let D=null;if(S["text-color"]&&(D=n.parse(S["text-color"],1,Zn),!D))return null;let B=null;if(S["vertical-align"]){if(typeof S["vertical-align"]=="string"&&!Il.includes(S["vertical-align"]))return n.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${S["vertical-align"]}' instead.`);if(B=n.parse(S["vertical-align"],1,ci),!B)return null}const V=d[d.length-1];V.scale=M,V.font=z,V.textColor=D,V.verticalAlign=B}else{const M=n.parse(t[x],1,ui);if(!M)return null;const z=M.type.kind;if(z!=="string"&&z!=="value"&&z!=="null"&&z!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");v=!0,d.push({content:M,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Ko(d)}evaluate(t){return new Kn(this.sections.map((n=>{const l=n.content.evaluate(t);return Yt(l)===En?new Ds("",l,null,null,null,n.verticalAlign?n.verticalAlign.evaluate(t):null):new Ds(ii(l),null,n.scale?n.scale.evaluate(t):null,n.font?n.font.evaluate(t).join(","):null,n.textColor?n.textColor.evaluate(t):null,n.verticalAlign?n.verticalAlign.evaluate(t):null)})))}eachChild(t){for(const n of this.sections)t(n.content),n.scale&&t(n.scale),n.font&&t(n.font),n.textColor&&t(n.textColor),n.verticalAlign&&t(n.verticalAlign)}outputDefined(){return!1}}class Zh{constructor(t){this.type=En,this.input=t}static parse(t,n){if(t.length!==2)return n.error("Expected two arguments.");const l=n.parse(t[1],1,ci);return l?new Zh(l):n.error("No image name provided.")}evaluate(t){const n=this.input.evaluate(t),l=yr.fromString(n);return l&&t.availableImages&&(l.available=t.availableImages.indexOf(n)>-1),l}eachChild(t){t(this.input)}outputDefined(){return!1}}class Ll{constructor(t){this.type=Tt,this.input=t}static parse(t,n){if(t.length!==2)return n.error(`Expected 1 argument, but found ${t.length-1} instead.`);const l=n.parse(t[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${Ni(l.type)} instead.`):new Ll(l):null}evaluate(t){const n=this.input.evaluate(t);if(typeof n=="string")return[...n].length;if(Array.isArray(n))return n.length;throw new Li(`Expected value to be of type string or array, but found ${Ni(Yt(n))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const Gr=8192;function Mp(r,t){const n=(180+r[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,d=Math.pow(2,t.z);return[Math.round(n*d*Gr),Math.round(l*d*Gr)]}function Oc(r,t){const n=Math.pow(2,t.z);return[(d=(r[0]/Gr+t.x)/n,360*d-180),(l=(r[1]/Gr+t.y)/n,360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90)];var l,d}function Ol(r,t){r[0]=Math.min(r[0],t[0]),r[1]=Math.min(r[1],t[1]),r[2]=Math.max(r[2],t[0]),r[3]=Math.max(r[3],t[1])}function Bl(r,t){return!(r[0]<=t[0]||r[2]>=t[2]||r[1]<=t[1]||r[3]>=t[3])}function ef(r,t,n){const l=r[0]-t[0],d=r[1]-t[1],v=r[0]-n[0],x=r[1]-n[1];return l*x-v*d==0&&l*v<=0&&d*x<=0}function Bc(r,t,n,l){return(d=[l[0]-n[0],l[1]-n[1]])[0]*(v=[t[0]-r[0],t[1]-r[1]])[1]-d[1]*v[0]!=0&&!(!$h(r,t,n,l)||!$h(n,l,r,t));var d,v}function Nl(r,t,n){for(const l of n)for(let d=0;d<l.length-1;++d)if(Bc(r,t,l[d],l[d+1]))return!0;return!1}function Qo(r,t,n=!1){let l=!1;for(const S of t)for(let M=0;M<S.length-1;M++){if(ef(r,S[M],S[M+1]))return n;(v=S[M])[1]>(d=r)[1]!=(x=S[M+1])[1]>d[1]&&d[0]<(x[0]-v[0])*(d[1]-v[1])/(x[1]-v[1])+v[0]&&(l=!l)}var d,v,x;return l}function tf(r,t){for(const n of t)if(Qo(r,n))return!0;return!1}function qh(r,t){for(const n of r)if(!Qo(n,t))return!1;for(let n=0;n<r.length-1;++n)if(Nl(r[n],r[n+1],t))return!1;return!0}function nf(r,t){for(const n of t)if(qh(r,n))return!0;return!1}function $h(r,t,n,l){const d=l[0]-n[0],v=l[1]-n[1],x=(r[0]-n[0])*v-d*(r[1]-n[1]),S=(t[0]-n[0])*v-d*(t[1]-n[1]);return x>0&&S<0||x<0&&S>0}function Jo(r,t,n){const l=[];for(let d=0;d<r.length;d++){const v=[];for(let x=0;x<r[d].length;x++){const S=Mp(r[d][x],n);Ol(t,S),v.push(S)}l.push(v)}return l}function jl(r,t,n){const l=[];for(let d=0;d<r.length;d++){const v=Jo(r[d],t,n);l.push(v)}return l}function Ou(r,t,n,l){if(r[0]<n[0]||r[0]>n[2]){const d=.5*l;let v=r[0]-n[0]>d?-l:n[0]-r[0]>d?l:0;v===0&&(v=r[0]-n[2]>d?-l:n[2]-r[0]>d?l:0),r[0]+=v}Ol(t,r)}function Nc(r,t,n,l){const d=Math.pow(2,l.z)*Gr,v=[l.x*Gr,l.y*Gr],x=[];for(const S of r)for(const M of S){const z=[M.x+v[0],M.y+v[1]];Ou(z,t,n,d),x.push(z)}return x}function Hh(r,t,n,l){const d=Math.pow(2,l.z)*Gr,v=[l.x*Gr,l.y*Gr],x=[];for(const M of r){const z=[];for(const D of M){const B=[D.x+v[0],D.y+v[1]];Ol(t,B),z.push(B)}x.push(z)}if(t[2]-t[0]<=d/2){(S=t)[0]=S[1]=1/0,S[2]=S[3]=-1/0;for(const M of x)for(const z of M)Ou(z,t,n,d)}var S;return x}class co{constructor(t,n){this.type=ri,this.geojson=t,this.geometries=n}static parse(t,n){if(t.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(gs(t[1])){const l=t[1];if(l.type==="FeatureCollection"){const d=[];for(const v of l.features){const{type:x,coordinates:S}=v.geometry;x==="Polygon"&&d.push(S),x==="MultiPolygon"&&d.push(...S)}if(d.length)return new co(l,{type:"MultiPolygon",coordinates:d})}else if(l.type==="Feature"){const d=l.geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new co(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new co(l,l)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return(function(n,l){const d=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],x=n.canonicalID();if(l.type==="Polygon"){const S=Jo(l.coordinates,v,x),M=Nc(n.geometry(),d,v,x);if(!Bl(d,v))return!1;for(const z of M)if(!Qo(z,S))return!1}if(l.type==="MultiPolygon"){const S=jl(l.coordinates,v,x),M=Nc(n.geometry(),d,v,x);if(!Bl(d,v))return!1;for(const z of M)if(!tf(z,S))return!1}return!0})(t,this.geometries);if(t.geometryType()==="LineString")return(function(n,l){const d=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],x=n.canonicalID();if(l.type==="Polygon"){const S=Jo(l.coordinates,v,x),M=Hh(n.geometry(),d,v,x);if(!Bl(d,v))return!1;for(const z of M)if(!qh(z,S))return!1}if(l.type==="MultiPolygon"){const S=jl(l.coordinates,v,x),M=Hh(n.geometry(),d,v,x);if(!Bl(d,v))return!1;for(const z of M)if(!nf(z,S))return!1}return!0})(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let jc=class{constructor(r=[],t=(n,l)=>n<l?-1:n>l?1:0){if(this.data=r,this.length=this.data.length,this.compare=t,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(r){this.data.push(r),this._up(this.length++)}pop(){if(this.length===0)return;const r=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:t,compare:n}=this,l=t[r];for(;r>0;){const d=r-1>>1,v=t[d];if(n(l,v)>=0)break;t[r]=v,r=d}t[r]=l}_down(r){const{data:t,compare:n}=this,l=this.length>>1,d=t[r];for(;r<l;){let v=1+(r<<1);const x=v+1;if(x<this.length&&n(t[x],t[v])<0&&(v=x),n(t[v],d)>=0)break;t[r]=t[v],r=v}t[r]=d}};function Fc(r,t,n=0,l=r.length-1,d=rf){for(;l>n;){if(l-n>600){const M=l-n+1,z=t-n+1,D=Math.log(M),B=.5*Math.exp(2*D/3),V=.5*Math.sqrt(D*B*(M-B)/M)*(z-M/2<0?-1:1);Fc(r,t,Math.max(n,Math.floor(t-z*B/M+V)),Math.min(l,Math.floor(t+(M-z)*B/M+V)),d)}const v=r[t];let x=n,S=l;for(Fl(r,n,t),d(r[l],v)>0&&Fl(r,n,l);x<S;){for(Fl(r,x,S),x++,S--;d(r[x],v)<0;)x++;for(;d(r[S],v)>0;)S--}d(r[n],v)===0?Fl(r,n,S):(S++,Fl(r,S,l)),S<=t&&(n=S+1),t<=S&&(l=S-1)}}function Fl(r,t,n){const l=r[t];r[t]=r[n],r[n]=l}function rf(r,t){return r<t?-1:r>t?1:0}function Ul(r,t){if(r.length<=1)return[r];const n=[];let l,d;for(const v of r){const x=Ap(v);x!==0&&(v.area=Math.abs(x),d===void 0&&(d=x<0),d===x<0?(l&&n.push(l),l=[v]):l.push(v))}if(l&&n.push(l),t>1)for(let v=0;v<n.length;v++)n[v].length<=t||(Fc(n[v],t,1,n[v].length-1,af),n[v]=n[v].slice(0,t));return n}function af(r,t){return t.area-r.area}function Ap(r){let t=0;for(let n,l,d=0,v=r.length,x=v-1;d<v;x=d++)n=r[d],l=r[x],t+=(l.x-n.x)*(n.y+l.y);return t}const sf=1/298.257223563,of=sf*(2-sf),Xh=Math.PI/180;class Zr{constructor(t){const n=6378.137*Xh*1e3,l=Math.cos(t*Xh),d=1/(1-of*(1-l*l)),v=Math.sqrt(d);this.kx=n*v*l,this.ky=n*v*d*(1-of)}distance(t,n){const l=this.wrap(t[0]-n[0])*this.kx,d=(t[1]-n[1])*this.ky;return Math.sqrt(l*l+d*d)}pointOnLine(t,n){let l,d,v,x,S=1/0;for(let M=0;M<t.length-1;M++){let z=t[M][0],D=t[M][1],B=this.wrap(t[M+1][0]-z)*this.kx,V=(t[M+1][1]-D)*this.ky,$=0;B===0&&V===0||($=(this.wrap(n[0]-z)*this.kx*B+(n[1]-D)*this.ky*V)/(B*B+V*V),$>1?(z=t[M+1][0],D=t[M+1][1]):$>0&&(z+=B/this.kx*$,D+=V/this.ky*$)),B=this.wrap(n[0]-z)*this.kx,V=(n[1]-D)*this.ky;const H=B*B+V*V;H<S&&(S=H,l=z,d=D,v=M,x=$)}return{point:[l,d],index:v,t:Math.max(0,Math.min(1,x))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function Vl(r,t){return t[0]-r[0]}function Uc(r){return r[1]-r[0]+1}function ys(r,t){return r[1]>=r[0]&&r[1]<t}function Pi(r,t){if(r[0]>r[1])return[null,null];const n=Uc(r);if(t){if(n===2)return[r,null];const d=Math.floor(n/2);return[[r[0],r[0]+d],[r[0]+d,r[1]]]}if(n===1)return[r,null];const l=Math.floor(n/2)-1;return[[r[0],r[0]+l],[r[0]+l+1,r[1]]]}function Bu(r,t){if(!ys(t,r.length))return[1/0,1/0,-1/0,-1/0];const n=[1/0,1/0,-1/0,-1/0];for(let l=t[0];l<=t[1];++l)Ol(n,r[l]);return n}function Vc(r){const t=[1/0,1/0,-1/0,-1/0];for(const n of r)for(const l of n)Ol(t,l);return t}function lf(r){return r[0]!==-1/0&&r[1]!==-1/0&&r[2]!==1/0&&r[3]!==1/0}function uo(r,t,n){if(!lf(r)||!lf(t))return NaN;let l=0,d=0;return r[2]<t[0]&&(l=t[0]-r[2]),r[0]>t[2]&&(l=r[0]-t[2]),r[1]>t[3]&&(d=r[1]-t[3]),r[3]<t[1]&&(d=t[1]-r[3]),n.distance([0,0],[l,d])}function ks(r,t,n){const l=n.pointOnLine(t,r);return n.distance(r,l.point)}function el(r,t,n,l,d){const v=Math.min(ks(r,[n,l],d),ks(t,[n,l],d)),x=Math.min(ks(n,[r,t],d),ks(l,[r,t],d));return Math.min(v,x)}function Yh(r,t,n,l,d){if(!ys(t,r.length)||!ys(l,n.length))return 1/0;let v=1/0;for(let x=t[0];x<t[1];++x){const S=r[x],M=r[x+1];for(let z=l[0];z<l[1];++z){const D=n[z],B=n[z+1];if(Bc(S,M,D,B))return 0;v=Math.min(v,el(S,M,D,B,d))}}return v}function cf(r,t,n,l,d){if(!ys(t,r.length)||!ys(l,n.length))return NaN;let v=1/0;for(let x=t[0];x<=t[1];++x)for(let S=l[0];S<=l[1];++S)if(v=Math.min(v,d.distance(r[x],n[S])),v===0)return v;return v}function tl(r,t,n){if(Qo(r,t,!0))return 0;let l=1/0;for(const d of t){const v=d[0],x=d[d.length-1];if(v!==x&&(l=Math.min(l,ks(r,[x,v],n)),l===0))return l;const S=n.pointOnLine(d,r);if(l=Math.min(l,n.distance(r,S.point)),l===0)return l}return l}function Gl(r,t,n,l){if(!ys(t,r.length))return NaN;for(let v=t[0];v<=t[1];++v)if(Qo(r[v],n,!0))return 0;let d=1/0;for(let v=t[0];v<t[1];++v){const x=r[v],S=r[v+1];for(const M of n)for(let z=0,D=M.length,B=D-1;z<D;B=z++){const V=M[B],$=M[z];if(Bc(x,S,V,$))return 0;d=Math.min(d,el(x,S,V,$,l))}}return d}function Nu(r,t){for(const n of r)for(const l of n)if(Qo(l,t,!0))return!0;return!1}function uf(r,t,n,l=1/0){const d=Vc(r),v=Vc(t);if(l!==1/0&&uo(d,v,n)>=l)return l;if(Bl(d,v)){if(Nu(r,t))return 0}else if(Nu(t,r))return 0;let x=1/0;for(const S of r)for(let M=0,z=S.length,D=z-1;M<z;D=M++){const B=S[D],V=S[M];for(const $ of t)for(let H=0,K=$.length,ne=K-1;H<K;ne=H++){const ce=$[ne],Ae=$[H];if(Bc(B,V,ce,Ae))return 0;x=Math.min(x,el(B,V,ce,Ae,n))}}return x}function ho(r,t,n,l,d,v){if(!v)return;const x=uo(Bu(l,v),d,n);x<t&&r.push([x,v,[0,0]])}function Gc(r,t,n,l,d,v,x){if(!v||!x)return;const S=uo(Bu(l,v),Bu(d,x),n);S<t&&r.push([S,v,x])}function Zc(r,t,n,l,d=1/0){let v=Math.min(l.distance(r[0],n[0][0]),d);if(v===0)return v;const x=new jc([[0,[0,r.length-1],[0,0]]],Vl),S=Vc(n);for(;x.length>0;){const M=x.pop();if(M[0]>=v)continue;const z=M[1],D=t?50:100;if(Uc(z)<=D){if(!ys(z,r.length))return NaN;if(t){const B=Gl(r,z,n,l);if(isNaN(B)||B===0)return B;v=Math.min(v,B)}else for(let B=z[0];B<=z[1];++B){const V=tl(r[B],n,l);if(v=Math.min(v,V),v===0)return 0}}else{const B=Pi(z,t);ho(x,v,l,r,S,B[0]),ho(x,v,l,r,S,B[1])}}return v}function qc(r,t,n,l,d,v=1/0){let x=Math.min(v,d.distance(r[0],n[0]));if(x===0)return x;const S=new jc([[0,[0,r.length-1],[0,n.length-1]]],Vl);for(;S.length>0;){const M=S.pop();if(M[0]>=x)continue;const z=M[1],D=M[2],B=t?50:100,V=l?50:100;if(Uc(z)<=B&&Uc(D)<=V){if(!ys(z,r.length)&&ys(D,n.length))return NaN;let $;if(t&&l)$=Yh(r,z,n,D,d),x=Math.min(x,$);else if(t&&!l){const H=r.slice(z[0],z[1]+1);for(let K=D[0];K<=D[1];++K)if($=ks(n[K],H,d),x=Math.min(x,$),x===0)return x}else if(!t&&l){const H=n.slice(D[0],D[1]+1);for(let K=z[0];K<=z[1];++K)if($=ks(r[K],H,d),x=Math.min(x,$),x===0)return x}else $=cf(r,z,n,D,d),x=Math.min(x,$)}else{const $=Pi(z,t),H=Pi(D,l);Gc(S,x,d,r,n,$[0],H[0]),Gc(S,x,d,r,n,$[0],H[1]),Gc(S,x,d,r,n,$[1],H[0]),Gc(S,x,d,r,n,$[1],H[1])}}return x}function Wh(r){return r.type==="MultiPolygon"?r.coordinates.map((t=>({type:"Polygon",coordinates:t}))):r.type==="MultiLineString"?r.coordinates.map((t=>({type:"LineString",coordinates:t}))):r.type==="MultiPoint"?r.coordinates.map((t=>({type:"Point",coordinates:t}))):[r]}class il{constructor(t,n){this.type=Tt,this.geojson=t,this.geometries=n}static parse(t,n){if(t.length!==2)return n.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(gs(t[1])){const l=t[1];if(l.type==="FeatureCollection")return new il(l,l.features.map((d=>Wh(d.geometry))).flat());if(l.type==="Feature")return new il(l,Wh(l.geometry));if("type"in l&&"coordinates"in l)return new il(l,Wh(l))}return n.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return(function(n,l){const d=n.geometry(),v=d.flat().map((M=>Oc([M.x,M.y],n.canonical)));if(d.length===0)return NaN;const x=new Zr(v[0][1]);let S=1/0;for(const M of l){switch(M.type){case"Point":S=Math.min(S,qc(v,!1,[M.coordinates],!1,x,S));break;case"LineString":S=Math.min(S,qc(v,!1,M.coordinates,!0,x,S));break;case"Polygon":S=Math.min(S,Zc(v,!1,M.coordinates,x,S))}if(S===0)return S}return S})(t,this.geometries);if(t.geometryType()==="LineString")return(function(n,l){const d=n.geometry(),v=d.flat().map((M=>Oc([M.x,M.y],n.canonical)));if(d.length===0)return NaN;const x=new Zr(v[0][1]);let S=1/0;for(const M of l){switch(M.type){case"Point":S=Math.min(S,qc(v,!0,[M.coordinates],!1,x,S));break;case"LineString":S=Math.min(S,qc(v,!0,M.coordinates,!0,x,S));break;case"Polygon":S=Math.min(S,Zc(v,!0,M.coordinates,x,S))}if(S===0)return S}return S})(t,this.geometries);if(t.geometryType()==="Polygon")return(function(n,l){const d=n.geometry();if(d.length===0||d[0].length===0)return NaN;const v=Ul(d,0).map((M=>M.map((z=>z.map((D=>Oc([D.x,D.y],n.canonical))))))),x=new Zr(v[0][0][0][1]);let S=1/0;for(const M of l)for(const z of v){switch(M.type){case"Point":S=Math.min(S,Zc([M.coordinates],!1,z,x,S));break;case"LineString":S=Math.min(S,Zc(M.coordinates,!0,z,x,S));break;case"Polygon":S=Math.min(S,uf(z,M.coordinates,x,S))}if(S===0)return S}return S})(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class $c{constructor(t){this.type=ui,this.key=t}static parse(t,n){if(t.length!==2)return n.error(`Expected 1 argument, but found ${t.length-1} instead.`);const l=t[1];return l==null?n.error("Global state property must be defined."):typeof l!="string"?n.error(`Global state property must be string, but found ${typeof t[1]} instead.`):new $c(l)}evaluate(t){var n;const l=(n=t.globals)===null||n===void 0?void 0:n.globalState;return l&&Object.keys(l).length!==0?Zo(l,this.key):null}eachChild(){}outputDefined(){return!1}}const nl={"==":Uh,"!=":ku,">":Vh,"<":Tp,">=":Ep,"<=":Cp,array:sn,at:Ho,boolean:sn,case:Dl,coalesce:Wo,collator:Lu,format:Ko,image:Zh,in:zc,"index-of":$a,interpolate:vr,"interpolate-hcl":vr,"interpolate-lab":vr,length:Ll,let:$o,literal:Ca,match:lr,number:sn,"number-format":Gh,object:sn,slice:Xo,step:In,string:sn,"to-boolean":ca,"to-color":ca,"to-number":ca,"to-string":ca,var:lo,within:co,distance:il,"global-state":$c};class ua{constructor(t,n,l,d){this.name=t,this.type=n,this._evaluate=l,this.args=d}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,n){const l=t[0],d=ua.definitions[l];if(!d)return n.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const v=Array.isArray(d)?d[0]:d.type,x=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,S=x.filter((([z])=>!Array.isArray(z)||z.length===t.length-1));let M=null;for(const[z,D]of S){M=new oo(n.registry,qr,n.path,null,n.scope);const B=[];let V=!1;for(let $=1;$<t.length;$++){const H=t[$],K=Array.isArray(z)?z[$-1]:z.type,ne=M.parse(H,1+B.length,K);if(!ne){V=!0;break}B.push(ne)}if(!V)if(Array.isArray(z)&&z.length!==B.length)M.error(`Expected ${z.length} arguments, but found ${B.length} instead.`);else{for(let $=0;$<B.length;$++){const H=Array.isArray(z)?z[$]:z.type,K=B[$];M.concat($+1).checkSubtype(H,K.type)}if(M.errors.length===0)return new ua(l,v,D,B)}}if(S.length===1)n.errors.push(...M.errors);else{const z=(S.length?S:x).map((([B])=>{return V=B,Array.isArray(V)?`(${V.map(Ni).join(", ")})`:`(${Ni(V.type)}...)`;var V})).join(" | "),D=[];for(let B=1;B<t.length;B++){const V=n.parse(t[B],1+D.length);if(!V)return null;D.push(Ni(V.type))}n.error(`Expected arguments of type ${z}, but found (${D.join(", ")}) instead.`)}return null}static register(t,n){ua.definitions=n;for(const l in n)t[l]=ua}}function ju(r,[t,n,l,d]){t=t.evaluate(r),n=n.evaluate(r),l=l.evaluate(r);const v=d?d.evaluate(r):1,x=tn(t,n,l,v);if(x)throw new Li(x);return new pi(t/255,n/255,l/255,v,!1)}function Ea(r,t){return r in t}function Fu(r,t){const n=t[r];return n===void 0?null:n}function cr(r){return{type:r}}function qr(r){if(r instanceof lo)return qr(r.boundExpression);if(r instanceof ua&&r.name==="error"||r instanceof Lu||r instanceof co||r instanceof il||r instanceof $c)return!1;const t=r instanceof ca||r instanceof sn;let n=!0;return r.eachChild((l=>{n=t?n&&qr(l):n&&l instanceof Ca})),!!n&&Ls(r)&&al(r,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function Ls(r){if(r instanceof ua&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof co||r instanceof il)return!1;let t=!0;return r.eachChild((n=>{t&&!Ls(n)&&(t=!1)})),t}function rl(r){if(r instanceof ua&&r.name==="feature-state")return!1;let t=!0;return r.eachChild((n=>{t&&!rl(n)&&(t=!1)})),t}function al(r,t){if(r instanceof ua&&t.indexOf(r.name)>=0)return!1;let n=!0;return r.eachChild((l=>{n&&!al(l,t)&&(n=!1)})),n}function Hc(r){return{result:"success",value:r}}function fo(r){return{result:"error",value:r}}function ha(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function Kh(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function Zl(r){return!!r.expression&&r.expression.interpolated}function fi(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function Xc(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)&&Yt(r)===pn}function da(r){return r}function Uu(r,t){const n=r.stops&&typeof r.stops[0][0]=="object",l=n||!(n||r.property!==void 0),d=r.type||(Zl(t)?"exponential":"interval"),v=(function(D){switch(D.type){case"color":return pi.parse;case"padding":return nr.parse;case"numberArray":return gr.parse;case"colorArray":return qn.parse;default:return null}})(t);if(v&&((r=Pr({},r)).stops&&(r.stops=r.stops.map((D=>[D[0],v(D[1])]))),r.default=v(r.default?r.default:t.default)),r.colorSpace&&(x=r.colorSpace)!=="rgb"&&x!=="hcl"&&x!=="lab")throw new Error(`Unknown color space: "${r.colorSpace}"`);var x;const S=(function(D){switch(D){case"exponential":return po;case"interval":return Vu;case"categorical":return Qh;case"identity":return Jh;default:throw new Error(`Unknown function type "${D}"`)}})(d);let M,z;if(d==="categorical"){M=Object.create(null);for(const D of r.stops)M[D[0]]=D[1];z=typeof r.stops[0][0]}if(n){const D={},B=[];for(let H=0;H<r.stops.length;H++){const K=r.stops[H],ne=K[0].zoom;D[ne]===void 0&&(D[ne]={zoom:ne,type:r.type,property:r.property,default:r.default,stops:[]},B.push(ne)),D[ne].stops.push([K[0].value,K[1]])}const V=[];for(const H of B)V.push([D[H].zoom,Uu(D[H],t)]);const $={name:"linear"};return{kind:"composite",interpolationType:$,interpolationFactor:vr.interpolationFactor.bind(void 0,$),zoomStops:V.map((H=>H[0])),evaluate:({zoom:H},K)=>po({stops:V,base:r.base},t,H).evaluate(H,K)}}if(l){const D=d==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:D,interpolationFactor:vr.interpolationFactor.bind(void 0,D),zoomStops:r.stops.map((B=>B[0])),evaluate:({zoom:B})=>S(r,t,B,M,z)}}return{kind:"source",evaluate(D,B){const V=B&&B.properties?B.properties[r.property]:void 0;return V===void 0?Ir(r.default,t.default):S(r,t,V,M,z)}}}function Ir(r,t,n){return r!==void 0?r:t!==void 0?t:n!==void 0?n:void 0}function Qh(r,t,n,l,d){return Ir(typeof n===d?l[n]:void 0,r.default,t.default)}function Vu(r,t,n){if(fi(n)!=="number")return Ir(r.default,t.default);const l=r.stops.length;if(l===1||n<=r.stops[0][0])return r.stops[0][1];if(n>=r.stops[l-1][0])return r.stops[l-1][1];const d=Yo(r.stops.map((v=>v[0])),n);return r.stops[d][1]}function po(r,t,n){const l=r.base!==void 0?r.base:1;if(fi(n)!=="number")return Ir(r.default,t.default);const d=r.stops.length;if(d===1||n<=r.stops[0][0])return r.stops[0][1];if(n>=r.stops[d-1][0])return r.stops[d-1][1];const v=Yo(r.stops.map((D=>D[0])),n),x=(function(D,B,V,$){const H=$-V,K=D-V;return H===0?0:B===1?K/H:(Math.pow(B,K)-1)/(Math.pow(B,H)-1)})(n,l,r.stops[v][0],r.stops[v+1][0]),S=r.stops[v][1],M=r.stops[v+1][1],z=_s[t.type]||da;return typeof S.evaluate=="function"?{evaluate(...D){const B=S.evaluate.apply(void 0,D),V=M.evaluate.apply(void 0,D);if(B!==void 0&&V!==void 0)return z(B,V,x,r.colorSpace)}}:z(S,M,x,r.colorSpace)}function Jh(r,t,n){switch(t.type){case"color":n=pi.parse(n);break;case"formatted":n=Kn.fromString(n.toString());break;case"resolvedImage":n=yr.fromString(n.toString());break;case"padding":n=nr.parse(n);break;case"colorArray":n=qn.parse(n);break;case"numberArray":n=gr.parse(n);break;default:fi(n)===t.type||t.type==="enum"&&t.values[n]||(n=void 0)}return Ir(n,r.default,t.default)}ua.register(nl,{error:[{kind:"error"},[ci],(r,[t])=>{throw new Li(t.evaluate(r))}],typeof:[ci,[ui],(r,[t])=>Ni(Yt(t.evaluate(r)))],"to-rgba":[pr(Tt,4),[Zn],(r,[t])=>{const[n,l,d,v]=t.evaluate(r).rgb;return[255*n,255*l,255*d,v]}],rgb:[Zn,[Tt,Tt,Tt],ju],rgba:[Zn,[Tt,Tt,Tt,Tt],ju],has:{type:ri,overloads:[[[ci],(r,[t])=>Ea(t.evaluate(r),r.properties())],[[ci,pn],(r,[t,n])=>Ea(t.evaluate(r),n.evaluate(r))]]},get:{type:ui,overloads:[[[ci],(r,[t])=>Fu(t.evaluate(r),r.properties())],[[ci,pn],(r,[t,n])=>Fu(t.evaluate(r),n.evaluate(r))]]},"feature-state":[ui,[ci],(r,[t])=>Fu(t.evaluate(r),r.featureState||{})],properties:[pn,[],r=>r.properties()],"geometry-type":[ci,[],r=>r.geometryType()],id:[ui,[],r=>r.id()],zoom:[Tt,[],r=>r.globals.zoom],"heatmap-density":[Tt,[],r=>r.globals.heatmapDensity||0],elevation:[Tt,[],r=>r.globals.elevation||0],"line-progress":[Tt,[],r=>r.globals.lineProgress||0],accumulated:[ui,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[Tt,cr(Tt),(r,t)=>{let n=0;for(const l of t)n+=l.evaluate(r);return n}],"*":[Tt,cr(Tt),(r,t)=>{let n=1;for(const l of t)n*=l.evaluate(r);return n}],"-":{type:Tt,overloads:[[[Tt,Tt],(r,[t,n])=>t.evaluate(r)-n.evaluate(r)],[[Tt],(r,[t])=>-t.evaluate(r)]]},"/":[Tt,[Tt,Tt],(r,[t,n])=>t.evaluate(r)/n.evaluate(r)],"%":[Tt,[Tt,Tt],(r,[t,n])=>t.evaluate(r)%n.evaluate(r)],ln2:[Tt,[],()=>Math.LN2],pi:[Tt,[],()=>Math.PI],e:[Tt,[],()=>Math.E],"^":[Tt,[Tt,Tt],(r,[t,n])=>Math.pow(t.evaluate(r),n.evaluate(r))],sqrt:[Tt,[Tt],(r,[t])=>Math.sqrt(t.evaluate(r))],log10:[Tt,[Tt],(r,[t])=>Math.log(t.evaluate(r))/Math.LN10],ln:[Tt,[Tt],(r,[t])=>Math.log(t.evaluate(r))],log2:[Tt,[Tt],(r,[t])=>Math.log(t.evaluate(r))/Math.LN2],sin:[Tt,[Tt],(r,[t])=>Math.sin(t.evaluate(r))],cos:[Tt,[Tt],(r,[t])=>Math.cos(t.evaluate(r))],tan:[Tt,[Tt],(r,[t])=>Math.tan(t.evaluate(r))],asin:[Tt,[Tt],(r,[t])=>Math.asin(t.evaluate(r))],acos:[Tt,[Tt],(r,[t])=>Math.acos(t.evaluate(r))],atan:[Tt,[Tt],(r,[t])=>Math.atan(t.evaluate(r))],min:[Tt,cr(Tt),(r,t)=>Math.min(...t.map((n=>n.evaluate(r))))],max:[Tt,cr(Tt),(r,t)=>Math.max(...t.map((n=>n.evaluate(r))))],abs:[Tt,[Tt],(r,[t])=>Math.abs(t.evaluate(r))],round:[Tt,[Tt],(r,[t])=>{const n=t.evaluate(r);return n<0?-Math.round(-n):Math.round(n)}],floor:[Tt,[Tt],(r,[t])=>Math.floor(t.evaluate(r))],ceil:[Tt,[Tt],(r,[t])=>Math.ceil(t.evaluate(r))],"filter-==":[ri,[ci,ui],(r,[t,n])=>r.properties()[t.value]===n.value],"filter-id-==":[ri,[ui],(r,[t])=>r.id()===t.value],"filter-type-==":[ri,[ci],(r,[t])=>r.geometryType()===t.value],"filter-<":[ri,[ci,ui],(r,[t,n])=>{const l=r.properties()[t.value],d=n.value;return typeof l==typeof d&&l<d}],"filter-id-<":[ri,[ui],(r,[t])=>{const n=r.id(),l=t.value;return typeof n==typeof l&&n<l}],"filter->":[ri,[ci,ui],(r,[t,n])=>{const l=r.properties()[t.value],d=n.value;return typeof l==typeof d&&l>d}],"filter-id->":[ri,[ui],(r,[t])=>{const n=r.id(),l=t.value;return typeof n==typeof l&&n>l}],"filter-<=":[ri,[ci,ui],(r,[t,n])=>{const l=r.properties()[t.value],d=n.value;return typeof l==typeof d&&l<=d}],"filter-id-<=":[ri,[ui],(r,[t])=>{const n=r.id(),l=t.value;return typeof n==typeof l&&n<=l}],"filter->=":[ri,[ci,ui],(r,[t,n])=>{const l=r.properties()[t.value],d=n.value;return typeof l==typeof d&&l>=d}],"filter-id->=":[ri,[ui],(r,[t])=>{const n=r.id(),l=t.value;return typeof n==typeof l&&n>=l}],"filter-has":[ri,[ui],(r,[t])=>t.value in r.properties()],"filter-has-id":[ri,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[ri,[pr(ci)],(r,[t])=>t.value.indexOf(r.geometryType())>=0],"filter-id-in":[ri,[pr(ui)],(r,[t])=>t.value.indexOf(r.id())>=0],"filter-in-small":[ri,[ci,pr(ui)],(r,[t,n])=>n.value.indexOf(r.properties()[t.value])>=0],"filter-in-large":[ri,[ci,pr(ui)],(r,[t,n])=>(function(l,d,v,x){for(;v<=x;){const S=v+x>>1;if(d[S]===l)return!0;d[S]>l?x=S-1:v=S+1}return!1})(r.properties()[t.value],n.value,0,n.value.length-1)],all:{type:ri,overloads:[[[ri,ri],(r,[t,n])=>t.evaluate(r)&&n.evaluate(r)],[cr(ri),(r,t)=>{for(const n of t)if(!n.evaluate(r))return!1;return!0}]]},any:{type:ri,overloads:[[[ri,ri],(r,[t,n])=>t.evaluate(r)||n.evaluate(r)],[cr(ri),(r,t)=>{for(const n of t)if(n.evaluate(r))return!0;return!1}]]},"!":[ri,[ri],(r,[t])=>!t.evaluate(r)],"is-supported-script":[ri,[ci],(r,[t])=>{const n=r.globals&&r.globals.isSupportedScript;return!n||n(t.evaluate(r))}],upcase:[ci,[ci],(r,[t])=>t.evaluate(r).toUpperCase()],downcase:[ci,[ci],(r,[t])=>t.evaluate(r).toLowerCase()],concat:[ci,cr(ui),(r,t)=>t.map((n=>ii(n.evaluate(r)))).join("")],"resolved-locale":[ci,[Mc],(r,[t])=>t.evaluate(r).resolvedLocale()]});class Yc{constructor(t,n){this.expression=t,this._warningHistory={},this._evaluator=new jh,this._defaultValue=n?(function(l){if(l.type==="color"&&Xc(l.default))return new pi(0,0,0,0);switch(l.type){case"color":return pi.parse(l.default)||null;case"padding":return nr.parse(l.default)||null;case"numberArray":return gr.parse(l.default)||null;case"colorArray":return qn.parse(l.default)||null;case"variableAnchorOffsetCollection":return _r.parse(l.default)||null;case"projectionDefinition":return Mn.parse(l.default)||null;default:return l.default===void 0?null:l.default}})(n):null,this._enumValues=n&&n.type==="enum"?n.values:null}evaluateWithoutErrorHandling(t,n,l,d,v,x){return this._evaluator.globals=t,this._evaluator.feature=n,this._evaluator.featureState=l,this._evaluator.canonical=d,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=x,this.expression.evaluate(this._evaluator)}evaluate(t,n,l,d,v,x){this._evaluator.globals=t,this._evaluator.feature=n||null,this._evaluator.featureState=l||null,this._evaluator.canonical=d,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=x||null;try{const S=this.expression.evaluate(this._evaluator);if(S==null||typeof S=="number"&&S!=S)return this._defaultValue;if(this._enumValues&&!(S in this._enumValues))throw new Li(`Expected value to be one of ${Object.keys(this._enumValues).map((M=>JSON.stringify(M))).join(", ")}, but found ${JSON.stringify(S)} instead.`);return S}catch(S){return this._warningHistory[S.message]||(this._warningHistory[S.message]=!0,typeof console<"u"&&console.warn(S.message)),this._defaultValue}}}function Os(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in nl}function vs(r,t){const n=new oo(nl,qr,[],t?(function(d){const v={color:Zn,string:ci,number:Tt,enum:ci,boolean:ri,formatted:ta,padding:Rs,numberArray:Uo,colorArray:us,projectionDefinition:Ta,resolvedImage:En,variableAnchorOffsetCollection:zu};return d.type==="array"?pr(v[d.value]||ui,d.length):v[d.type]})(t):void 0),l=n.parse(r,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?Hc(new Yc(l,t)):fo(n.errors)}class mo{constructor(t,n){this.kind=t,this._styleExpression=n,this.isStateDependent=t!=="constant"&&!rl(n.expression),this.globalStateRefs=pa(n.expression)}evaluateWithoutErrorHandling(t,n,l,d,v,x){return this._styleExpression.evaluateWithoutErrorHandling(t,n,l,d,v,x)}evaluate(t,n,l,d,v,x){return this._styleExpression.evaluate(t,n,l,d,v,x)}}class ql{constructor(t,n,l,d){this.kind=t,this.zoomStops=l,this._styleExpression=n,this.isStateDependent=t!=="camera"&&!rl(n.expression),this.globalStateRefs=pa(n.expression),this.interpolationType=d}evaluateWithoutErrorHandling(t,n,l,d,v,x){return this._styleExpression.evaluateWithoutErrorHandling(t,n,l,d,v,x)}evaluate(t,n,l,d,v,x){return this._styleExpression.evaluate(t,n,l,d,v,x)}interpolationFactor(t,n,l){return this.interpolationType?vr.interpolationFactor(this.interpolationType,t,n,l):0}}function fa(r,t){const n=vs(r,t);if(n.result==="error")return n;const l=n.value.expression,d=Ls(l);if(!d&&!ha(t))return fo([new Cn("","data expressions not supported")]);const v=al(l,["zoom"]);if(!v&&!Kh(t))return fo([new Cn("","zoom expressions not supported")]);const x=Ha(l);return x||v?x instanceof Cn?fo([x]):x instanceof vr&&!Zl(t)?fo([new Cn("",'"interpolate" expressions cannot be used with this property')]):Hc(x?new ql(d?"camera":"composite",n.value,x.labels,x instanceof vr?x.interpolation:void 0):new mo(d?"constant":"source",n.value)):fo([new Cn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Dr{constructor(t,n){this._parameters=t,this._specification=n,Pr(this,Uu(this._parameters,this._specification))}static deserialize(t){return new Dr(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Ha(r){let t=null;if(r instanceof $o)t=Ha(r.result);else if(r instanceof Wo){for(const n of r.args)if(t=Ha(n),t)break}else(r instanceof In||r instanceof vr)&&r.input instanceof ua&&r.input.name==="zoom"&&(t=r);return t instanceof Cn||r.eachChild((n=>{const l=Ha(n);l instanceof Cn?t=l:!t&&l?t=new Cn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&l&&t!==l&&(t=new Cn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),t}function pa(r,t=new Set){return r instanceof $c&&t.add(r.key),r.eachChild((n=>{pa(n,t)})),t}function Ma(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const t of r.slice(1))if(!Ma(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const Bs={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function go(r){if(r==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Ma(r)||(r=$n(r));const t=vs(r,Bs);if(t.result==="error")throw new Error(t.value.map((n=>`${n.key}: ${n.message}`)).join(", "));return{filter:(n,l,d)=>t.value.evaluate(n,l,{},d),needGeometry:$l(r),getGlobalStateRefs:()=>pa(t.value.expression)}}function Wc(r,t){return r<t?-1:r>t?1:0}function $l(r){if(!Array.isArray(r))return!1;if(r[0]==="within"||r[0]==="distance")return!0;for(let t=1;t<r.length;t++)if($l(r[t]))return!0;return!1}function $n(r){if(!r)return!0;const t=r[0];return r.length<=1?t!=="any":t==="=="?vn(r[1],r[2],"=="):t==="!="?ma(vn(r[1],r[2],"==")):t==="<"||t===">"||t==="<="||t===">="?vn(r[1],r[2],t):t==="any"?(n=r.slice(1),["any"].concat(n.map($n))):t==="all"?["all"].concat(r.slice(1).map($n)):t==="none"?["all"].concat(r.slice(1).map($n).map(ma)):t==="in"?Oi(r[1],r.slice(2)):t==="!in"?ma(Oi(r[1],r.slice(2))):t==="has"?_o(r[1]):t!=="!has"||ma(_o(r[1]));var n}function vn(r,t,n){switch(r){case"$type":return[`filter-type-${n}`,t];case"$id":return[`filter-id-${n}`,t];default:return[`filter-${n}`,r,t]}}function Oi(r,t){if(t.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some((n=>typeof n!=typeof t[0]))?["filter-in-large",r,["literal",t.sort(Wc)]]:["filter-in-small",r,["literal",t]]}}function _o(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function ma(r){return["!",r]}function Kc(r){const t=typeof r;if(t==="number"||t==="boolean"||t==="string"||r==null)return JSON.stringify(r);if(Array.isArray(r)){let d="[";for(const v of r)d+=`${Kc(v)},`;return`${d}]`}const n=Object.keys(r).sort();let l="{";for(let d=0;d<n.length;d++)l+=`${JSON.stringify(n[d])}:${Kc(r[n[d]])},`;return`${l}}`}function sl(r){let t="";for(const n of ei)t+=`/${Kc(r[n])}`;return t}function Gu(r){const t=r.value;return t?[new pt(r.key,t,"constants have been deprecated as of v8")]:[]}function xn(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function na(r){if(Array.isArray(r))return r.map(na);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const t={};for(const n in r)t[n]=na(r[n]);return t}return xn(r)}function kr(r){const t=r.key,n=r.value,l=r.valueSpec||{},d=r.objectElementValidators||{},v=r.style,x=r.styleSpec,S=r.validateSpec;let M=[];const z=fi(n);if(z!=="object")return[new pt(t,n,`object expected, ${z} found`)];for(const D in n){const B=D.split(".")[0],V=Zo(l,B)||l["*"];let $;if(Zo(d,B))$=d[B];else if(Zo(l,B))$=S;else if(d["*"])$=d["*"];else{if(!l["*"]){M.push(new pt(t,n[D],`unknown property "${D}"`));continue}$=S}M=M.concat($({key:(t&&`${t}.`)+D,value:n[D],valueSpec:V,style:v,styleSpec:x,object:n,objectKey:D,validateSpec:S},n))}for(const D in l)d[D]||l[D].required&&l[D].default===void 0&&n[D]===void 0&&M.push(new pt(t,n,`missing required property "${D}"`));return M}function Qc(r){const t=r.value,n=r.valueSpec,l=r.style,d=r.styleSpec,v=r.key,x=r.arrayElementValidator||r.validateSpec;if(fi(t)!=="array")return[new pt(v,t,`array expected, ${fi(t)} found`)];if(n.length&&t.length!==n.length)return[new pt(v,t,`array length ${n.length} expected, length ${t.length} found`)];if(n["min-length"]&&t.length<n["min-length"])return[new pt(v,t,`array length at least ${n["min-length"]} expected, length ${t.length} found`)];let S={type:n.value,values:n.values};d.$version<7&&(S.function=n.function),fi(n.value)==="object"&&(S=n.value);let M=[];for(let z=0;z<t.length;z++)M=M.concat(x({array:t,arrayIndex:z,value:t[z],valueSpec:S,validateSpec:r.validateSpec,style:l,styleSpec:d,key:`${v}[${z}]`}));return M}function Ns(r){const t=r.key,n=r.value,l=r.valueSpec;let d=fi(n);return d==="number"&&n!=n&&(d="NaN"),d!=="number"?[new pt(t,n,`number expected, ${d} found`)]:"minimum"in l&&n<l.minimum?[new pt(t,n,`${n} is less than the minimum value ${l.minimum}`)]:"maximum"in l&&n>l.maximum?[new pt(t,n,`${n} is greater than the maximum value ${l.maximum}`)]:[]}function Zu(r){const t=r.valueSpec,n=xn(r.value.type);let l,d,v,x={};const S=n!=="categorical"&&r.value.property===void 0,M=!S,z=fi(r.value.stops)==="array"&&fi(r.value.stops[0])==="array"&&fi(r.value.stops[0][0])==="object",D=kr({key:r.key,value:r.value,valueSpec:r.styleSpec.function,validateSpec:r.validateSpec,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function($){if(n==="identity")return[new pt($.key,$.value,'identity function may not have a "stops" property')];let H=[];const K=$.value;return H=H.concat(Qc({key:$.key,value:K,valueSpec:$.valueSpec,validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec,arrayElementValidator:B})),fi(K)==="array"&&K.length===0&&H.push(new pt($.key,K,"array must have at least one stop")),H},default:function($){return $.validateSpec({key:$.key,value:$.value,valueSpec:t,validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec})}}});return n==="identity"&&S&&D.push(new pt(r.key,r.value,'missing required property "property"')),n==="identity"||r.value.stops||D.push(new pt(r.key,r.value,'missing required property "stops"')),n==="exponential"&&r.valueSpec.expression&&!Zl(r.valueSpec)&&D.push(new pt(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(M&&!ha(r.valueSpec)?D.push(new pt(r.key,r.value,"property functions not supported")):S&&!Kh(r.valueSpec)&&D.push(new pt(r.key,r.value,"zoom functions not supported"))),n!=="categorical"&&!z||r.value.property!==void 0||D.push(new pt(r.key,r.value,'"property" property is required')),D;function B($){let H=[];const K=$.value,ne=$.key;if(fi(K)!=="array")return[new pt(ne,K,`array expected, ${fi(K)} found`)];if(K.length!==2)return[new pt(ne,K,`array length 2 expected, length ${K.length} found`)];if(z){if(fi(K[0])!=="object")return[new pt(ne,K,`object expected, ${fi(K[0])} found`)];if(K[0].zoom===void 0)return[new pt(ne,K,"object stop key must have zoom")];if(K[0].value===void 0)return[new pt(ne,K,"object stop key must have value")];if(v&&v>xn(K[0].zoom))return[new pt(ne,K[0].zoom,"stop zoom values must appear in ascending order")];xn(K[0].zoom)!==v&&(v=xn(K[0].zoom),d=void 0,x={}),H=H.concat(kr({key:`${ne}[0]`,value:K[0],valueSpec:{zoom:{}},validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec,objectElementValidators:{zoom:Ns,value:V}}))}else H=H.concat(V({key:`${ne}[0]`,value:K[0],validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec},K));return Os(na(K[1]))?H.concat([new pt(`${ne}[1]`,K[1],"expressions are not allowed in function stops.")]):H.concat($.validateSpec({key:`${ne}[1]`,value:K[1],valueSpec:t,validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec}))}function V($,H){const K=fi($.value),ne=xn($.value),ce=$.value!==null?$.value:H;if(l){if(K!==l)return[new pt($.key,ce,`${K} stop domain type must match previous stop domain type ${l}`)]}else l=K;if(K!=="number"&&K!=="string"&&K!=="boolean")return[new pt($.key,ce,"stop domain value must be a number, string, or boolean")];if(K!=="number"&&n!=="categorical"){let Ae=`number expected, ${K} found`;return ha(t)&&n===void 0&&(Ae+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new pt($.key,ce,Ae)]}return n!=="categorical"||K!=="number"||isFinite(ne)&&Math.floor(ne)===ne?n!=="categorical"&&K==="number"&&d!==void 0&&ne<d?[new pt($.key,ce,"stop domain values must appear in ascending order")]:(d=ne,n==="categorical"&&ne in x?[new pt($.key,ce,"stop domain values must be unique")]:(x[ne]=!0,[])):[new pt($.key,ce,`integer expected, found ${ne}`)]}}function ga(r){const t=(r.expressionContext==="property"?fa:vs)(na(r.value),r.valueSpec);if(t.result==="error")return t.value.map((l=>new pt(`${r.key}${l.key}`,r.value,l.message)));const n=t.value.expression||t.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!n.outputDefined())return[new pt(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!rl(n))return[new pt(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter"&&!rl(n))return[new pt(r.key,r.value,'"feature-state" data expressions are not supported with filters.')];if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!al(n,["zoom","feature-state"]))return[new pt(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!Ls(n))return[new pt(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Aa(r){const t=r.key,n=r.value,l=fi(n);return l!=="string"?[new pt(t,n,`color expected, ${l} found`)]:pi.parse(String(n))?[]:[new pt(t,n,`color expected, "${n}" found`)]}function Lr(r){const t=r.key,n=r.value,l=r.valueSpec,d=[];return Array.isArray(l.values)?l.values.indexOf(xn(n))===-1&&d.push(new pt(t,n,`expected one of [${l.values.join(", ")}], ${JSON.stringify(n)} found`)):Object.keys(l.values).indexOf(xn(n))===-1&&d.push(new pt(t,n,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(n)} found`)),d}function Xa(r){return Ma(na(r.value))?ga(Pr({},r,{expressionContext:"filter",valueSpec:{value:"boolean"}})):qu(r)}function qu(r){const t=r.value,n=r.key;if(fi(t)!=="array")return[new pt(n,t,`array expected, ${fi(t)} found`)];const l=r.styleSpec;let d,v=[];if(t.length<1)return[new pt(n,t,"filter array must have at least 1 element")];switch(v=v.concat(Lr({key:`${n}[0]`,value:t[0],valueSpec:l.filter_operator,style:r.style,styleSpec:r.styleSpec})),xn(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&xn(t[1])==="$type"&&v.push(new pt(n,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&v.push(new pt(n,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(d=fi(t[1]),d!=="string"&&v.push(new pt(`${n}[1]`,t[1],`string expected, ${d} found`)));for(let x=2;x<t.length;x++)d=fi(t[x]),xn(t[1])==="$type"?v=v.concat(Lr({key:`${n}[${x}]`,value:t[x],valueSpec:l.geometry_type,style:r.style,styleSpec:r.styleSpec})):d!=="string"&&d!=="number"&&d!=="boolean"&&v.push(new pt(`${n}[${x}]`,t[x],`string, number, or boolean expected, ${d} found`));break;case"any":case"all":case"none":for(let x=1;x<t.length;x++)v=v.concat(qu({key:`${n}[${x}]`,value:t[x],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":d=fi(t[1]),t.length!==2?v.push(new pt(n,t,`filter array for "${t[0]}" operator must have 2 elements`)):d!=="string"&&v.push(new pt(`${n}[1]`,t[1],`string expected, ${d} found`))}return v}function $u(r,t){const n=r.key,l=r.validateSpec,d=r.style,v=r.styleSpec,x=r.value,S=r.objectKey,M=v[`${t}_${r.layerType}`];if(!M)return[];const z=S.match(/^(.*)-transition$/);if(t==="paint"&&z&&M[z[1]]&&M[z[1]].transition)return l({key:n,value:x,valueSpec:v.transition,style:d,styleSpec:v});const D=r.valueSpec||M[S];if(!D)return[new pt(n,x,`unknown property "${S}"`)];let B;if(fi(x)==="string"&&ha(D)&&!D.tokens&&(B=/^{([^}]+)}$/.exec(x)))return[new pt(n,x,`"${S}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(B[1])} }\`.`)];const V=[];return r.layerType==="symbol"&&(S==="text-field"&&d&&!d.glyphs&&V.push(new pt(n,x,'use of "text-field" requires a style "glyphs" property')),S==="text-font"&&Xc(na(x))&&xn(x.type)==="identity"&&V.push(new pt(n,x,'"text-font" does not support identity functions'))),V.concat(l({key:r.key,value:x,valueSpec:D,style:d,styleSpec:v,expressionContext:"property",propertyType:t,propertyKey:S}))}function Hl(r){return $u(r,"paint")}function Jc(r){return $u(r,"layout")}function yo(r){let t=[];const n=r.value,l=r.key,d=r.style,v=r.styleSpec;if(fi(n)!=="object")return[new pt(l,n,`object expected, ${fi(n)} found`)];n.type||n.ref||t.push(new pt(l,n,'either "type" or "ref" is required'));let x=xn(n.type);const S=xn(n.ref);if(n.id){const M=xn(n.id);for(let z=0;z<r.arrayIndex;z++){const D=d.layers[z];xn(D.id)===M&&t.push(new pt(l,n.id,`duplicate layer id "${n.id}", previously used at line ${D.id.__line__}`))}}if("ref"in n){let M;["type","source","source-layer","filter","layout"].forEach((z=>{z in n&&t.push(new pt(l,n[z],`"${z}" is prohibited for ref layers`))})),d.layers.forEach((z=>{xn(z.id)===S&&(M=z)})),M?M.ref?t.push(new pt(l,n.ref,"ref cannot reference another ref layer")):x=xn(M.type):t.push(new pt(l,n.ref,`ref layer "${S}" not found`))}else if(x!=="background")if(n.source){const M=d.sources&&d.sources[n.source],z=M&&xn(M.type);M?z==="vector"&&x==="raster"?t.push(new pt(l,n.source,`layer "${n.id}" requires a raster source`)):z!=="raster-dem"&&x==="hillshade"||z!=="raster-dem"&&x==="color-relief"?t.push(new pt(l,n.source,`layer "${n.id}" requires a raster-dem source`)):z==="raster"&&x!=="raster"?t.push(new pt(l,n.source,`layer "${n.id}" requires a vector source`)):z!=="vector"||n["source-layer"]?z==="raster-dem"&&x!=="hillshade"&&x!=="color-relief"?t.push(new pt(l,n.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):x!=="line"||!n.paint||!n.paint["line-gradient"]||z==="geojson"&&M.lineMetrics||t.push(new pt(l,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new pt(l,n,`layer "${n.id}" must specify a "source-layer"`)):t.push(new pt(l,n.source,`source "${n.source}" not found`))}else t.push(new pt(l,n,'missing required property "source"'));return t=t.concat(kr({key:l,value:n,valueSpec:v.layer,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,objectElementValidators:{"*":()=>[],type:()=>r.validateSpec({key:`${l}.type`,value:n.type,valueSpec:v.layer.type,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,object:n,objectKey:"type"}),filter:Xa,layout:M=>kr({layer:n,key:M.key,value:M.value,style:M.style,styleSpec:M.styleSpec,validateSpec:M.validateSpec,objectElementValidators:{"*":z=>Jc(Pr({layerType:x},z))}}),paint:M=>kr({layer:n,key:M.key,value:M.value,style:M.style,styleSpec:M.styleSpec,validateSpec:M.validateSpec,objectElementValidators:{"*":z=>Hl(Pr({layerType:x},z))}})}})),t}function on(r){const t=r.value,n=r.key,l=fi(t);return l!=="string"?[new pt(n,t,`string expected, ${l} found`)]:[]}const js={promoteId:function({key:r,value:t}){if(fi(t)==="string")return on({key:r,value:t});{const n=[];for(const l in t)n.push(...on({key:`${r}.${l}`,value:t[l]}));return n}}};function $r(r){const t=r.value,n=r.key,l=r.styleSpec,d=r.style,v=r.validateSpec;if(!t.type)return[new pt(n,t,'"type" is required')];const x=xn(t.type);let S;switch(x){case"vector":case"raster":return S=kr({key:n,value:t,valueSpec:l[`source_${x.replace("-","_")}`],style:r.style,styleSpec:l,objectElementValidators:js,validateSpec:v}),S;case"raster-dem":return S=(function(M){var z;const D=(z=M.sourceName)!==null&&z!==void 0?z:"",B=M.value,V=M.styleSpec,$=V.source_raster_dem,H=M.style;let K=[];const ne=fi(B);if(B===void 0)return K;if(ne!=="object")return K.push(new pt("source_raster_dem",B,`object expected, ${ne} found`)),K;const ce=xn(B.encoding)==="custom",Ae=["redFactor","greenFactor","blueFactor","baseShift"],_e=M.value.encoding?`"${M.value.encoding}"`:"Default";for(const xe in B)!ce&&Ae.includes(xe)?K.push(new pt(xe,B[xe],`In "${D}": "${xe}" is only valid when "encoding" is set to "custom". ${_e} encoding found`)):$[xe]?K=K.concat(M.validateSpec({key:xe,value:B[xe],valueSpec:$[xe],validateSpec:M.validateSpec,style:H,styleSpec:V})):K.push(new pt(xe,B[xe],`unknown property "${xe}"`));return K})({sourceName:n,value:t,style:r.style,styleSpec:l,validateSpec:v}),S;case"geojson":if(S=kr({key:n,value:t,valueSpec:l.source_geojson,style:d,styleSpec:l,validateSpec:v,objectElementValidators:js}),t.cluster)for(const M in t.clusterProperties){const[z,D]=t.clusterProperties[M],B=typeof z=="string"?[z,["accumulated"],["get",M]]:z;S.push(...ga({key:`${n}.${M}.map`,value:D,expressionContext:"cluster-map"})),S.push(...ga({key:`${n}.${M}.reduce`,value:B,expressionContext:"cluster-reduce"}))}return S;case"video":return kr({key:n,value:t,valueSpec:l.source_video,style:d,validateSpec:v,styleSpec:l});case"image":return kr({key:n,value:t,valueSpec:l.source_image,style:d,validateSpec:v,styleSpec:l});case"canvas":return[new pt(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Lr({key:`${n}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Xl(r){const t=r.value,n=r.styleSpec,l=n.light,d=r.style;let v=[];const x=fi(t);if(t===void 0)return v;if(x!=="object")return v=v.concat([new pt("light",t,`object expected, ${x} found`)]),v;for(const S in t){const M=S.match(/^(.*)-transition$/);v=v.concat(M&&l[M[1]]&&l[M[1]].transition?r.validateSpec({key:S,value:t[S],valueSpec:n.transition,validateSpec:r.validateSpec,style:d,styleSpec:n}):l[S]?r.validateSpec({key:S,value:t[S],valueSpec:l[S],validateSpec:r.validateSpec,style:d,styleSpec:n}):[new pt(S,t[S],`unknown property "${S}"`)])}return v}function ed(r){const t=r.value,n=r.styleSpec,l=n.sky,d=r.style,v=fi(t);if(t===void 0)return[];if(v!=="object")return[new pt("sky",t,`object expected, ${v} found`)];let x=[];for(const S in t)x=x.concat(l[S]?r.validateSpec({key:S,value:t[S],valueSpec:l[S],style:d,styleSpec:n}):[new pt(S,t[S],`unknown property "${S}"`)]);return x}function hf(r){const t=r.value,n=r.styleSpec,l=n.terrain,d=r.style;let v=[];const x=fi(t);if(t===void 0)return v;if(x!=="object")return v=v.concat([new pt("terrain",t,`object expected, ${x} found`)]),v;for(const S in t)v=v.concat(l[S]?r.validateSpec({key:S,value:t[S],valueSpec:l[S],validateSpec:r.validateSpec,style:d,styleSpec:n}):[new pt(S,t[S],`unknown property "${S}"`)]);return v}function Qn(r){let t=[];const n=r.value,l=r.key;if(Array.isArray(n)){const d=[],v=[];for(const x in n)n[x].id&&d.includes(n[x].id)&&t.push(new pt(l,n,`all the sprites' ids must be unique, but ${n[x].id} is duplicated`)),d.push(n[x].id),n[x].url&&v.includes(n[x].url)&&t.push(new pt(l,n,`all the sprites' URLs must be unique, but ${n[x].url} is duplicated`)),v.push(n[x].url),t=t.concat(kr({key:`${l}[${x}]`,value:n[x],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:r.validateSpec}));return t}return on({key:l,value:n})}function vo(r){return t=r.value,t&&t.constructor===Object?[]:[new pt(r.key,r.value,`object expected, ${fi(r.value)} found`)];var t}const ol={"*":()=>[],array:Qc,boolean:function(r){const t=r.value,n=r.key,l=fi(t);return l!=="boolean"?[new pt(n,t,`boolean expected, ${l} found`)]:[]},number:Ns,color:Aa,constants:Gu,enum:Lr,filter:Xa,function:Zu,layer:yo,object:kr,source:$r,light:Xl,sky:ed,terrain:hf,projection:function(r){const t=r.value,n=r.styleSpec,l=n.projection,d=r.style,v=fi(t);if(t===void 0)return[];if(v!=="object")return[new pt("projection",t,`object expected, ${v} found`)];let x=[];for(const S in t)x=x.concat(l[S]?r.validateSpec({key:S,value:t[S],valueSpec:l[S],style:d,styleSpec:n}):[new pt(S,t[S],`unknown property "${S}"`)]);return x},projectionDefinition:function(r){const t=r.key;let n=r.value;n=n instanceof String?n.valueOf():n;const l=fi(n);return l!=="array"||(function(d){return Array.isArray(d)&&d.length===3&&typeof d[0]=="string"&&typeof d[1]=="string"&&typeof d[2]=="number"})(n)||(function(d){return!!["interpolate","step","literal"].includes(d[0])})(n)?["array","string"].includes(l)?[]:[new pt(t,n,`projection expected, invalid type "${l}" found`)]:[new pt(t,n,`projection expected, invalid array ${JSON.stringify(n)} found`)]},string:on,formatted:function(r){return on(r).length===0?[]:ga(r)},resolvedImage:function(r){return on(r).length===0?[]:ga(r)},padding:function(r){const t=r.key,n=r.value;if(fi(n)==="array"){if(n.length<1||n.length>4)return[new pt(t,n,`padding requires 1 to 4 values; ${n.length} values found`)];const l={type:"number"};let d=[];for(let v=0;v<n.length;v++)d=d.concat(r.validateSpec({key:`${t}[${v}]`,value:n[v],validateSpec:r.validateSpec,valueSpec:l}));return d}return Ns({key:t,value:n,valueSpec:{}})},numberArray:function(r){const t=r.key,n=r.value;if(fi(n)==="array"){const l={type:"number"};if(n.length<1)return[new pt(t,n,"array length at least 1 expected, length 0 found")];let d=[];for(let v=0;v<n.length;v++)d=d.concat(r.validateSpec({key:`${t}[${v}]`,value:n[v],validateSpec:r.validateSpec,valueSpec:l}));return d}return Ns({key:t,value:n,valueSpec:{}})},colorArray:function(r){const t=r.key,n=r.value;if(fi(n)==="array"){if(n.length<1)return[new pt(t,n,"array length at least 1 expected, length 0 found")];let l=[];for(let d=0;d<n.length;d++)l=l.concat(Aa({key:`${t}[${d}]`,value:n[d]}));return l}return Aa({key:t,value:n})},variableAnchorOffsetCollection:function(r){const t=r.key,n=r.value,l=fi(n),d=r.styleSpec;if(l!=="array"||n.length<1||n.length%2!=0)return[new pt(t,n,"variableAnchorOffsetCollection requires a non-empty array of even length")];let v=[];for(let x=0;x<n.length;x+=2)v=v.concat(Lr({key:`${t}[${x}]`,value:n[x],valueSpec:d.layout_symbol["text-anchor"]})),v=v.concat(Qc({key:`${t}[${x+1}]`,value:n[x+1],valueSpec:{length:2,value:"number"},validateSpec:r.validateSpec,style:r.style,styleSpec:d}));return v},sprite:Qn,state:vo};function xs(r){const t=r.value,n=r.valueSpec,l=r.styleSpec;return r.validateSpec=xs,n.expression&&Xc(xn(t))?Zu(r):n.expression&&Os(na(t))?ga(r):n.type&&ol[n.type]?ol[n.type](r):kr(Pr({},r,{valueSpec:n.type?l[n.type]:n}))}function Hu(r){const t=r.value,n=r.key,l=on(r);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new pt(n,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new pt(n,t,'"glyphs" url must include a "{range}" token'))),l}function rr(r,t=Ie){let n=[];return n=n.concat(xs({key:"",value:r,valueSpec:t.$root,styleSpec:t,style:r,validateSpec:xs,objectElementValidators:{glyphs:Hu,"*":()=>[]}})),r.constants&&(n=n.concat(Gu({key:"constants",value:r.constants}))),Yl(n)}function Or(r){return function(t){return r({...t,validateSpec:xs})}}function Yl(r){return[].concat(r).sort(((t,n)=>t.line-n.line))}function Pa(r){return function(...t){return Yl(r.apply(this,t))}}rr.source=Pa(Or($r)),rr.sprite=Pa(Or(Qn)),rr.glyphs=Pa(Or(Hu)),rr.light=Pa(Or(Xl)),rr.sky=Pa(Or(ed)),rr.terrain=Pa(Or(hf)),rr.state=Pa(Or(vo)),rr.layer=Pa(Or(yo)),rr.filter=Pa(Or(Xa)),rr.paintProperty=Pa(Or(Hl)),rr.layoutProperty=Pa(Or(Jc));const Wl=rr,df=Wl.light,Ya=Wl.sky,td=Wl.paintProperty,Xu=Wl.layoutProperty;function Kl(r,t){let n=!1;if(t&&t.length)for(const l of t)r.fire(new nt(new Error(l.message))),n=!0;return n}class Fs{constructor(t,n,l){const d=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const x=new Int32Array(this.arrayBuffer);t=x[0],this.d=(n=x[1])+2*(l=x[2]);for(let M=0;M<this.d*this.d;M++){const z=x[3+M],D=x[3+M+1];d.push(z===D?null:x.subarray(z,D))}const S=x[3+d.length+1];this.keys=x.subarray(x[3+d.length],S),this.bboxes=x.subarray(S),this.insert=this._insertReadonly}else{this.d=n+2*l;for(let x=0;x<this.d*this.d;x++)d.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=t,this.padding=l,this.scale=n/t,this.uid=0;const v=l/n*t;this.min=-v,this.max=t+v}insert(t,n,l,d,v){this._forEachCell(n,l,d,v,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(n),this.bboxes.push(l),this.bboxes.push(d),this.bboxes.push(v)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,n,l,d,v,x){this.cells[v].push(x)}query(t,n,l,d,v){const x=this.min,S=this.max;if(t<=x&&n<=x&&S<=l&&S<=d&&!v)return Array.prototype.slice.call(this.keys);{const M=[];return this._forEachCell(t,n,l,d,this._queryCell,M,{},v),M}}_queryCell(t,n,l,d,v,x,S,M){const z=this.cells[v];if(z!==null){const D=this.keys,B=this.bboxes;for(let V=0;V<z.length;V++){const $=z[V];if(S[$]===void 0){const H=4*$;(M?M(B[H+0],B[H+1],B[H+2],B[H+3]):t<=B[H+2]&&n<=B[H+3]&&l>=B[H+0]&&d>=B[H+1])?(S[$]=!0,x.push(D[$])):S[$]=!1}}}}_forEachCell(t,n,l,d,v,x,S,M){const z=this._convertToCellCoord(t),D=this._convertToCellCoord(n),B=this._convertToCellCoord(l),V=this._convertToCellCoord(d);for(let $=z;$<=B;$++)for(let H=D;H<=V;H++){const K=this.d*H+$;if((!M||M(this._convertFromCellCoord($),this._convertFromCellCoord(H),this._convertFromCellCoord($+1),this._convertFromCellCoord(H+1)))&&v.call(this,t,n,l,d,K,x,S,M))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,n=3+this.cells.length+1+1;let l=0;for(let x=0;x<this.cells.length;x++)l+=this.cells[x].length;const d=new Int32Array(n+l+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;let v=n;for(let x=0;x<t.length;x++){const S=t[x];d[3+x]=v,d.set(S,v),v+=S.length}return d[3+t.length]=v,d.set(this.keys,v),v+=this.keys.length,d[3+t.length+1]=v,d.set(this.bboxes,v),v+=this.bboxes.length,d.buffer}static serialize(t,n){const l=t.toArrayBuffer();return n&&n.push(l),{buffer:l}}static deserialize(t){return new Fs(t.buffer)}}const Ra={};function Mt(r,t,n={}){if(Ra[r])throw new Error(`${r} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:r,writeable:!1}),Ra[r]={klass:t,omit:n.omit||[],shallow:n.shallow||[]}}Mt("Object",Object),Mt("Set",Set),Mt("TransferableGridIndex",Fs),Mt("Color",pi),Mt("Error",Error),Mt("AJAXError",de),Mt("ResolvedImage",yr),Mt("StylePropertyFunction",Dr),Mt("StyleExpression",Yc,{omit:["_evaluator"]}),Mt("ZoomDependentExpression",ql),Mt("ZoomConstantExpression",mo),Mt("CompoundExpression",ua,{omit:["_evaluate"]});for(const r in nl)nl[r]._classRegistryKey||Mt(`Expression_${r}`,nl[r]);function eu(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function tu(r){return r.$name||r.constructor._classRegistryKey}function Ql(r){return!(function(t){if(t===null||typeof t!="object")return!1;const n=tu(t);return!(!n||n==="Object")})(r)&&(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob||r instanceof Error||eu(r)||wa(r)||ArrayBuffer.isView(r)||r instanceof ImageData)}function ll(r,t){if(Ql(r))return(eu(r)||wa(r))&&t&&t.push(r),ArrayBuffer.isView(r)&&t&&t.push(r.buffer),r instanceof ImageData&&t&&t.push(r.data.buffer),r;if(Array.isArray(r)){const v=[];for(const x of r)v.push(ll(x,t));return v}if(typeof r!="object")throw new Error("can't serialize object of type "+typeof r);const n=tu(r);if(!n)throw new Error(`can't serialize object of unregistered class ${r.constructor.name}`);if(!Ra[n])throw new Error(`${n} is not registered.`);const{klass:l}=Ra[n],d=l.serialize?l.serialize(r,t):{};if(l.serialize){if(t&&d===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const v in r){if(!r.hasOwnProperty(v)||Ra[n].omit.indexOf(v)>=0)continue;const x=r[v];d[v]=Ra[n].shallow.indexOf(v)>=0?x:ll(x,t)}r instanceof Error&&(d.message=r.message)}if(d.$name)throw new Error("$name property is reserved for worker serialization logic.");return n!=="Object"&&(d.$name=n),d}function Wa(r){if(Ql(r))return r;if(Array.isArray(r))return r.map(Wa);if(typeof r!="object")throw new Error("can't deserialize object of type "+typeof r);const t=tu(r)||"Object";if(!Ra[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:n}=Ra[t];if(!n)throw new Error(`can't deserialize unregistered class ${t}`);if(n.deserialize)return n.deserialize(r);const l=Object.create(n.prototype);for(const d of Object.keys(r)){if(d==="$name")continue;const v=r[d];l[d]=Ra[t].shallow.indexOf(d)>=0?v:Wa(v)}return l}class iu{constructor(){this.first=!0}update(t,n){const l=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=l,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=l,!0):(this.lastFloorZoom>l?(this.lastIntegerZoom=l+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<l&&(this.lastIntegerZoom=l,this.lastIntegerZoomTime=n),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=l,!0))}}const Si={"Latin-1 Supplement":r=>r>=128&&r<=255,"Hangul Jamo":r=>r>=4352&&r<=4607,Khmer:r=>r>=6016&&r<=6143,"General Punctuation":r=>r>=8192&&r<=8303,"Letterlike Symbols":r=>r>=8448&&r<=8527,"Number Forms":r=>r>=8528&&r<=8591,"Miscellaneous Technical":r=>r>=8960&&r<=9215,"Control Pictures":r=>r>=9216&&r<=9279,"Optical Character Recognition":r=>r>=9280&&r<=9311,"Enclosed Alphanumerics":r=>r>=9312&&r<=9471,"Geometric Shapes":r=>r>=9632&&r<=9727,"Miscellaneous Symbols":r=>r>=9728&&r<=9983,"Miscellaneous Symbols and Arrows":r=>r>=11008&&r<=11263,"Ideographic Description Characters":r=>r>=12272&&r<=12287,"CJK Symbols and Punctuation":r=>r>=12288&&r<=12351,Hiragana:r=>r>=12352&&r<=12447,Katakana:r=>r>=12448&&r<=12543,Kanbun:r=>r>=12688&&r<=12703,"CJK Strokes":r=>r>=12736&&r<=12783,"Enclosed CJK Letters and Months":r=>r>=12800&&r<=13055,"CJK Compatibility":r=>r>=13056&&r<=13311,"Yijing Hexagram Symbols":r=>r>=19904&&r<=19967,"CJK Unified Ideographs":r=>r>=19968&&r<=40959,"Hangul Syllables":r=>r>=44032&&r<=55215,"Private Use Area":r=>r>=57344&&r<=63743,"Vertical Forms":r=>r>=65040&&r<=65055,"CJK Compatibility Forms":r=>r>=65072&&r<=65103,"Small Form Variants":r=>r>=65104&&r<=65135,"Halfwidth and Fullwidth Forms":r=>r>=65280&&r<=65519};function Ka(r){for(const t of r)if(nu(t.charCodeAt(0)))return!0;return!1}function id(r){for(const t of r)if(!Us(t.charCodeAt(0)))return!1;return!0}function Jl(r){const t=r.map((n=>{try{return new RegExp(`\\p{sc=${n}}`,"u").source}catch{return null}})).filter((n=>n));return new RegExp(t.join("|"),"u")}const xo=Jl(["Arab","Dupl","Mong","Ougr","Syrc"]);function Us(r){return!xo.test(String.fromCodePoint(r))}const cl=Jl(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function nu(r){return!(r!==746&&r!==747&&(r<4352||!(Si["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||Si["CJK Compatibility"](r)||Si["CJK Strokes"](r)||!(!Si["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||Si["Enclosed CJK Letters and Months"](r)||Si["Ideographic Description Characters"](r)||Si.Kanbun(r)||Si.Katakana(r)&&r!==12540||!(!Si["Halfwidth and Fullwidth Forms"](r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!Si["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||Si["Vertical Forms"](r)||Si["Yijing Hexagram Symbols"](r)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(r))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(r))||cl.test(String.fromCodePoint(r)))))}function Yu(r){return!(nu(r)||(function(t){return!!(Si["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Si["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Si["Letterlike Symbols"](t)||Si["Number Forms"](t)||Si["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Si["Control Pictures"](t)&&t!==9251||Si["Optical Character Recognition"](t)||Si["Enclosed Alphanumerics"](t)||Si["Geometric Shapes"](t)||Si["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Si["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Si["CJK Symbols and Punctuation"](t)||Si.Katakana(t)||Si["Private Use Area"](t)||Si["CJK Compatibility Forms"](t)||Si["Small Form Variants"](t)||Si["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)})(r))}const ec=Jl(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function ul(r){return ec.test(String.fromCodePoint(r))}function nd(r,t){return!(!t&&ul(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||Si.Khmer(r))}function rd(r){for(const t of r)if(ul(t.charCodeAt(0)))return!0;return!1}const Br=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(r){this.pluginStatus=r.pluginStatus,this.pluginURL=r.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(r){if(Br.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=r.applyArabicShaping,this.processBidirectionalText=r.processBidirectionalText,this.processStyledBidirectionalText=r.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(r,t){return o(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if(r.pluginStatus!=="loading")return this.setState(r),r;const n=r.pluginURL,l=new Promise((v=>{this.loadScriptResolve=v}));t(n);const d=new Promise((v=>setTimeout((()=>v()),this.TIMEOUT)));if(yield Promise.race([l,d]),this.isParsed()){const v={pluginStatus:"loaded",pluginURL:n};return this.setState(v),v}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${n}`)}))}};class ji{constructor(t,n){this.zoom=t,n?(this.now=n.now||0,this.fadeDuration=n.fadeDuration||0,this.zoomHistory=n.zoomHistory||new iu,this.transition=n.transition||{},this.globalState=n.globalState||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new iu,this.transition={},this.globalState={})}isSupportedScript(t){return(function(n,l){for(const d of n)if(!nd(d.charCodeAt(0),l))return!1;return!0})(t,Br.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,n=t-Math.floor(t),l=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*l}:{fromScale:.5,toScale:1,t:1-(1-l)*n}}}class hl{constructor(t,n){this.property=t,this.value=n,this.expression=(function(l,d){if(Xc(l))return new Dr(l,d);if(Os(l)){const v=fa(l,d);if(v.result==="error")throw new Error(v.value.map((x=>`${x.key}: ${x.message}`)).join(", "));return v.value}{let v=l;return d.type==="color"&&typeof l=="string"?v=pi.parse(l):d.type!=="padding"||typeof l!="number"&&!Array.isArray(l)?d.type!=="numberArray"||typeof l!="number"&&!Array.isArray(l)?d.type!=="colorArray"||typeof l!="string"&&!Array.isArray(l)?d.type==="variableAnchorOffsetCollection"&&Array.isArray(l)?v=_r.parse(l):d.type==="projectionDefinition"&&typeof l=="string"&&(v=Mn.parse(l)):v=qn.parse(l):v=gr.parse(l):v=nr.parse(l),{globalStateRefs:new Set,kind:"constant",evaluate:()=>v}}})(n===void 0?t.specification.default:n,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(t,n,l){return this.property.possiblyEvaluate(this,t,n,l)}}class ru{constructor(t){this.property=t,this.value=new hl(t,void 0)}transitioned(t,n){return new bs(this.property,this.value,n,Nt({},t.transition,this.transition),t.now)}untransitioned(){return new bs(this.property,this.value,null,{},0)}}class Wu{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return ni(this._values[t].value.value)}setValue(t,n){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new ru(this._values[t].property)),this._values[t].value=new hl(this._values[t].property,n===null?void 0:ni(n))}getTransition(t){return ni(this._values[t].transition)}setTransition(t,n){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new ru(this._values[t].property)),this._values[t].transition=ni(n)||void 0}serialize(){const t={};for(const n of Object.keys(this._values)){const l=this.getValue(n);l!==void 0&&(t[n]=l);const d=this.getTransition(n);d!==void 0&&(t[`${n}-transition`]=d)}return t}transitioned(t,n){const l=new xi(this._properties);for(const d of Object.keys(this._values))l._values[d]=this._values[d].transitioned(t,n._values[d]);return l}untransitioned(){const t=new xi(this._properties);for(const n of Object.keys(this._values))t._values[n]=this._values[n].untransitioned();return t}}class bs{constructor(t,n,l,d,v){this.property=t,this.value=n,this.begin=v+d.delay||0,this.end=this.begin+d.duration||0,t.specification.transition&&(d.delay||d.duration)&&(this.prior=l)}possiblyEvaluate(t,n,l){const d=t.now||0,v=this.value.possiblyEvaluate(t,n,l),x=this.prior;if(x){if(d>this.end)return this.prior=null,v;if(this.value.isDataDriven())return this.prior=null,v;if(d<this.begin)return x.possiblyEvaluate(t,n,l);{const S=(d-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(t,n,l),v,ft(S))}}return v}}class xi{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,n,l){const d=new dl(this._properties);for(const v of Object.keys(this._values))d._values[v]=this._values[v].possiblyEvaluate(t,n,l);return d}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class Wi{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return ni(this._values[t].value)}setValue(t,n){this._values[t]=new hl(this._values[t].property,n===null?void 0:ni(n))}serialize(){const t={};for(const n of Object.keys(this._values)){const l=this.getValue(n);l!==void 0&&(t[n]=l)}return t}possiblyEvaluate(t,n,l){const d=new dl(this._properties);for(const v of Object.keys(this._values))d._values[v]=this._values[v].possiblyEvaluate(t,n,l);return d}}class Ki{constructor(t,n,l){this.property=t,this.value=n,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,n,l,d){return this.property.evaluate(this.value,this.parameters,t,n,l,d)}}class dl{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Pt{constructor(t){this.specification=t}possiblyEvaluate(t,n){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(n)}interpolate(t,n,l){const d=_s[this.specification.type];return d?d(t,n,l):t}}class Ft{constructor(t,n){this.specification=t,this.overrides=n}possiblyEvaluate(t,n,l,d){return new Ki(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(n,null,{},l,d)}:t.expression,n)}interpolate(t,n,l){if(t.value.kind!=="constant"||n.value.kind!=="constant")return t;if(t.value.value===void 0||n.value.value===void 0)return new Ki(this,{kind:"constant",value:void 0},t.parameters);const d=_s[this.specification.type];if(d){const v=d(t.value.value,n.value.value,l);return new Ki(this,{kind:"constant",value:v},t.parameters)}return t}evaluate(t,n,l,d,v,x){return t.kind==="constant"?t.value:t.evaluate(n,l,d,v,x)}}class fl extends Ft{possiblyEvaluate(t,n,l,d){if(t.value===void 0)return new Ki(this,{kind:"constant",value:void 0},n);if(t.expression.kind==="constant"){const v=t.expression.evaluate(n,null,{},l,d),x=t.property.specification.type==="resolvedImage"&&typeof v!="string"?v.name:v,S=this._calculate(x,x,x,n);return new Ki(this,{kind:"constant",value:S},n)}if(t.expression.kind==="camera"){const v=this._calculate(t.expression.evaluate({zoom:n.zoom-1}),t.expression.evaluate({zoom:n.zoom}),t.expression.evaluate({zoom:n.zoom+1}),n);return new Ki(this,{kind:"constant",value:v},n)}return new Ki(this,t.expression,n)}evaluate(t,n,l,d,v,x){if(t.kind==="source"){const S=t.evaluate(n,l,d,v,x);return this._calculate(S,S,S,n)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(n.zoom)-1},l,d),t.evaluate({zoom:Math.floor(n.zoom)},l,d),t.evaluate({zoom:Math.floor(n.zoom)+1},l,d),n):t.value}_calculate(t,n,l,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:t,to:n}:{from:l,to:n}}interpolate(t){return t}}class za{constructor(t){this.specification=t}possiblyEvaluate(t,n,l,d){if(t.value!==void 0){if(t.expression.kind==="constant"){const v=t.expression.evaluate(n,null,{},l,d);return this._calculate(v,v,v,n)}return this._calculate(t.expression.evaluate(new ji(Math.floor(n.zoom-1),n)),t.expression.evaluate(new ji(Math.floor(n.zoom),n)),t.expression.evaluate(new ji(Math.floor(n.zoom+1),n)),n)}}_calculate(t,n,l,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:t,to:n}:{from:l,to:n}}interpolate(t){return t}}class Vs{constructor(t){this.specification=t}possiblyEvaluate(t,n,l,d){return!!t.expression.evaluate(n,null,{},l,d)}interpolate(){return!1}}class Hr{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const n in t){const l=t[n];l.specification.overridable&&this.overridableProperties.push(n);const d=this.defaultPropertyValues[n]=new hl(l,void 0),v=this.defaultTransitionablePropertyValues[n]=new ru(l);this.defaultTransitioningPropertyValues[n]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=d.possiblyEvaluate({})}}}Mt("DataDrivenProperty",Ft),Mt("DataConstantProperty",Pt),Mt("CrossFadedDataDrivenProperty",fl),Mt("CrossFadedProperty",za),Mt("ColorRampProperty",Vs);const Dn="-transition";class ra extends It{constructor(t,n){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter,this._featureFilter=go(t.filter)),n.layout&&(this._unevaluatedLayout=new Wi(n.layout)),n.paint)){this._transitionablePaint=new Wu(n.paint);for(const l in t.paint)this.setPaintProperty(l,t.paint[l],{validate:!1});for(const l in t.layout)this.setLayoutProperty(l,t.layout[l],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new dl(n.paint)}}setFilter(t){this.filter=t,this._featureFilter=go(t)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}getLayoutAffectingGlobalStateRefs(){const t=new Set;if(this._unevaluatedLayout)for(const n in this._unevaluatedLayout._values){const l=this._unevaluatedLayout._values[n];for(const d of l.getGlobalStateRefs())t.add(d)}for(const n of this._featureFilter.getGlobalStateRefs())t.add(n);return t}getPaintAffectingGlobalStateRefs(){var t;const n=new globalThis.Map;if(this._transitionablePaint)for(const l in this._transitionablePaint._values){const d=this._transitionablePaint._values[l].value;for(const v of d.getGlobalStateRefs()){const x=(t=n.get(v))!==null&&t!==void 0?t:[];x.push({name:l,value:d.value}),n.set(v,x)}}return n}setLayoutProperty(t,n,l={}){n!=null&&this._validate(Xu,`layers.${this.id}.layout.${t}`,t,n,l)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,n):this.visibility=n)}getPaintProperty(t){return t.endsWith(Dn)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,n,l={}){if(n!=null&&this._validate(td,`layers.${this.id}.paint.${t}`,t,n,l))return!1;if(t.endsWith(Dn))return this._transitionablePaint.setTransition(t.slice(0,-11),n||void 0),!1;{const d=this._transitionablePaint._values[t],v=d.property.specification["property-type"]==="cross-faded-data-driven",x=d.value.isDataDriven(),S=d.value;this._transitionablePaint.setValue(t,n),this._handleSpecialPaintPropertyUpdate(t);const M=this._transitionablePaint._values[t].value;return M.isDataDriven()||x||v||this._handleOverridablePaintPropertyUpdate(t,S,M)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,n,l){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,n){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,n)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),gi(t,((n,l)=>!(n===void 0||l==="layout"&&!Object.keys(n).length||l==="paint"&&!Object.keys(n).length)))}_validate(t,n,l,d,v={}){return(!v||v.validate!==!1)&&Kl(this,t.call(Wl,{key:n,layerType:this.type,objectKey:l,value:d,styleSpec:Ie,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const n=this.paint.get(t);if(n instanceof Ki&&ha(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}}const ad={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class tc{constructor(t,n){this._structArray=t,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Zi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,n){return t._trim(),n&&(t.isTransferred=!0,n.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const n=Object.create(this.prototype);return n.arrayBuffer=t.arrayBuffer,n.length=t.length,n.capacity=t.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function kn(r,t=1){let n=0,l=0;return{members:r.map((d=>{const v=ad[d.type].BYTES_PER_ELEMENT,x=n=ic(n,Math.max(t,v)),S=d.components||1;return l=Math.max(l,v),n+=v*S,{name:d.name,type:d.type,components:S,offset:x}})),size:ic(n,Math.max(l,t)),alignment:t}}function ic(r,t){return Math.ceil(r/t)*t}class bo extends Zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n){const l=this.length;return this.resize(l+1),this.emplace(l,t,n)}emplace(t,n,l){const d=2*t;return this.int16[d+0]=n,this.int16[d+1]=l,t}}bo.prototype.bytesPerElement=4,Mt("StructArrayLayout2i4",bo);class wo extends Zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l){const d=this.length;return this.resize(d+1),this.emplace(d,t,n,l)}emplace(t,n,l,d){const v=3*t;return this.int16[v+0]=n,this.int16[v+1]=l,this.int16[v+2]=d,t}}wo.prototype.bytesPerElement=6,Mt("StructArrayLayout3i6",wo);class Nr extends Zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l,d){const v=this.length;return this.resize(v+1),this.emplace(v,t,n,l,d)}emplace(t,n,l,d,v){const x=4*t;return this.int16[x+0]=n,this.int16[x+1]=l,this.int16[x+2]=d,this.int16[x+3]=v,t}}Nr.prototype.bytesPerElement=8,Mt("StructArrayLayout4i8",Nr);class mn extends Zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l,d,v,x){const S=this.length;return this.resize(S+1),this.emplace(S,t,n,l,d,v,x)}emplace(t,n,l,d,v,x,S){const M=6*t;return this.int16[M+0]=n,this.int16[M+1]=l,this.int16[M+2]=d,this.int16[M+3]=v,this.int16[M+4]=x,this.int16[M+5]=S,t}}mn.prototype.bytesPerElement=12,Mt("StructArrayLayout2i4i12",mn);class Gs extends Zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l,d,v,x){const S=this.length;return this.resize(S+1),this.emplace(S,t,n,l,d,v,x)}emplace(t,n,l,d,v,x,S){const M=4*t,z=8*t;return this.int16[M+0]=n,this.int16[M+1]=l,this.uint8[z+4]=d,this.uint8[z+5]=v,this.uint8[z+6]=x,this.uint8[z+7]=S,t}}Gs.prototype.bytesPerElement=8,Mt("StructArrayLayout2i4ub8",Gs);class Zs extends Zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n){const l=this.length;return this.resize(l+1),this.emplace(l,t,n)}emplace(t,n,l){const d=2*t;return this.float32[d+0]=n,this.float32[d+1]=l,t}}Zs.prototype.bytesPerElement=8,Mt("StructArrayLayout2f8",Zs);class pl extends Zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,l,d,v,x,S,M,z,D){const B=this.length;return this.resize(B+1),this.emplace(B,t,n,l,d,v,x,S,M,z,D)}emplace(t,n,l,d,v,x,S,M,z,D,B){const V=10*t;return this.uint16[V+0]=n,this.uint16[V+1]=l,this.uint16[V+2]=d,this.uint16[V+3]=v,this.uint16[V+4]=x,this.uint16[V+5]=S,this.uint16[V+6]=M,this.uint16[V+7]=z,this.uint16[V+8]=D,this.uint16[V+9]=B,t}}pl.prototype.bytesPerElement=20,Mt("StructArrayLayout10ui20",pl);class qs extends Zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,l,d,v,x,S,M,z,D,B,V){const $=this.length;return this.resize($+1),this.emplace($,t,n,l,d,v,x,S,M,z,D,B,V)}emplace(t,n,l,d,v,x,S,M,z,D,B,V,$){const H=12*t;return this.int16[H+0]=n,this.int16[H+1]=l,this.int16[H+2]=d,this.int16[H+3]=v,this.uint16[H+4]=x,this.uint16[H+5]=S,this.uint16[H+6]=M,this.uint16[H+7]=z,this.int16[H+8]=D,this.int16[H+9]=B,this.int16[H+10]=V,this.int16[H+11]=$,t}}qs.prototype.bytesPerElement=24,Mt("StructArrayLayout4i4ui4i24",qs);class Qa extends Zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,l){const d=this.length;return this.resize(d+1),this.emplace(d,t,n,l)}emplace(t,n,l,d){const v=3*t;return this.float32[v+0]=n,this.float32[v+1]=l,this.float32[v+2]=d,t}}Qa.prototype.bytesPerElement=12,Mt("StructArrayLayout3f12",Qa);class nc extends Zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.uint32[1*t+0]=n,t}}nc.prototype.bytesPerElement=4,Mt("StructArrayLayout1ul4",nc);class rc extends Zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,l,d,v,x,S,M,z){const D=this.length;return this.resize(D+1),this.emplace(D,t,n,l,d,v,x,S,M,z)}emplace(t,n,l,d,v,x,S,M,z,D){const B=10*t,V=5*t;return this.int16[B+0]=n,this.int16[B+1]=l,this.int16[B+2]=d,this.int16[B+3]=v,this.int16[B+4]=x,this.int16[B+5]=S,this.uint32[V+3]=M,this.uint16[B+8]=z,this.uint16[B+9]=D,t}}rc.prototype.bytesPerElement=20,Mt("StructArrayLayout6i1ul2ui20",rc);class au extends Zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l,d,v,x){const S=this.length;return this.resize(S+1),this.emplace(S,t,n,l,d,v,x)}emplace(t,n,l,d,v,x,S){const M=6*t;return this.int16[M+0]=n,this.int16[M+1]=l,this.int16[M+2]=d,this.int16[M+3]=v,this.int16[M+4]=x,this.int16[M+5]=S,t}}au.prototype.bytesPerElement=12,Mt("StructArrayLayout2i2i2i12",au);class m extends Zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l,d,v){const x=this.length;return this.resize(x+1),this.emplace(x,t,n,l,d,v)}emplace(t,n,l,d,v,x){const S=4*t,M=8*t;return this.float32[S+0]=n,this.float32[S+1]=l,this.float32[S+2]=d,this.int16[M+6]=v,this.int16[M+7]=x,t}}m.prototype.bytesPerElement=16,Mt("StructArrayLayout2f1f2i16",m);class e extends Zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l,d,v,x){const S=this.length;return this.resize(S+1),this.emplace(S,t,n,l,d,v,x)}emplace(t,n,l,d,v,x,S){const M=16*t,z=4*t,D=8*t;return this.uint8[M+0]=n,this.uint8[M+1]=l,this.float32[z+1]=d,this.float32[z+2]=v,this.int16[D+6]=x,this.int16[D+7]=S,t}}e.prototype.bytesPerElement=16,Mt("StructArrayLayout2ub2f2i16",e);class a extends Zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,l){const d=this.length;return this.resize(d+1),this.emplace(d,t,n,l)}emplace(t,n,l,d){const v=3*t;return this.uint16[v+0]=n,this.uint16[v+1]=l,this.uint16[v+2]=d,t}}a.prototype.bytesPerElement=6,Mt("StructArrayLayout3ui6",a);class c extends Zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,l,d,v,x,S,M,z,D,B,V,$,H,K,ne,ce){const Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,t,n,l,d,v,x,S,M,z,D,B,V,$,H,K,ne,ce)}emplace(t,n,l,d,v,x,S,M,z,D,B,V,$,H,K,ne,ce,Ae){const _e=24*t,xe=12*t,Ue=48*t;return this.int16[_e+0]=n,this.int16[_e+1]=l,this.uint16[_e+2]=d,this.uint16[_e+3]=v,this.uint32[xe+2]=x,this.uint32[xe+3]=S,this.uint32[xe+4]=M,this.uint16[_e+10]=z,this.uint16[_e+11]=D,this.uint16[_e+12]=B,this.float32[xe+7]=V,this.float32[xe+8]=$,this.uint8[Ue+36]=H,this.uint8[Ue+37]=K,this.uint8[Ue+38]=ne,this.uint32[xe+10]=ce,this.int16[_e+22]=Ae,t}}c.prototype.bytesPerElement=48,Mt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",c);class f extends Zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,l,d,v,x,S,M,z,D,B,V,$,H,K,ne,ce,Ae,_e,xe,Ue,Ye,ot,xt,gt,yt,Ot,bt){const vt=this.length;return this.resize(vt+1),this.emplace(vt,t,n,l,d,v,x,S,M,z,D,B,V,$,H,K,ne,ce,Ae,_e,xe,Ue,Ye,ot,xt,gt,yt,Ot,bt)}emplace(t,n,l,d,v,x,S,M,z,D,B,V,$,H,K,ne,ce,Ae,_e,xe,Ue,Ye,ot,xt,gt,yt,Ot,bt,vt){const et=32*t,Xt=16*t;return this.int16[et+0]=n,this.int16[et+1]=l,this.int16[et+2]=d,this.int16[et+3]=v,this.int16[et+4]=x,this.int16[et+5]=S,this.int16[et+6]=M,this.int16[et+7]=z,this.uint16[et+8]=D,this.uint16[et+9]=B,this.uint16[et+10]=V,this.uint16[et+11]=$,this.uint16[et+12]=H,this.uint16[et+13]=K,this.uint16[et+14]=ne,this.uint16[et+15]=ce,this.uint16[et+16]=Ae,this.uint16[et+17]=_e,this.uint16[et+18]=xe,this.uint16[et+19]=Ue,this.uint16[et+20]=Ye,this.uint16[et+21]=ot,this.uint16[et+22]=xt,this.uint32[Xt+12]=gt,this.float32[Xt+13]=yt,this.float32[Xt+14]=Ot,this.uint16[et+30]=bt,this.uint16[et+31]=vt,t}}f.prototype.bytesPerElement=64,Mt("StructArrayLayout8i15ui1ul2f2ui64",f);class y extends Zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.float32[1*t+0]=n,t}}y.prototype.bytesPerElement=4,Mt("StructArrayLayout1f4",y);class w extends Zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,l){const d=this.length;return this.resize(d+1),this.emplace(d,t,n,l)}emplace(t,n,l,d){const v=3*t;return this.uint16[6*t+0]=n,this.float32[v+1]=l,this.float32[v+2]=d,t}}w.prototype.bytesPerElement=12,Mt("StructArrayLayout1ui2f12",w);class A extends Zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,l){const d=this.length;return this.resize(d+1),this.emplace(d,t,n,l)}emplace(t,n,l,d){const v=4*t;return this.uint32[2*t+0]=n,this.uint16[v+2]=l,this.uint16[v+3]=d,t}}A.prototype.bytesPerElement=8,Mt("StructArrayLayout1ul2ui8",A);class P extends Zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n){const l=this.length;return this.resize(l+1),this.emplace(l,t,n)}emplace(t,n,l){const d=2*t;return this.uint16[d+0]=n,this.uint16[d+1]=l,t}}P.prototype.bytesPerElement=4,Mt("StructArrayLayout2ui4",P);class k extends Zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.uint16[1*t+0]=n,t}}k.prototype.bytesPerElement=2,Mt("StructArrayLayout1ui2",k);class O extends Zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,l,d){const v=this.length;return this.resize(v+1),this.emplace(v,t,n,l,d)}emplace(t,n,l,d,v){const x=4*t;return this.float32[x+0]=n,this.float32[x+1]=l,this.float32[x+2]=d,this.float32[x+3]=v,t}}O.prototype.bytesPerElement=16,Mt("StructArrayLayout4f16",O);class F extends tc{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new L(this.anchorPointX,this.anchorPointY)}}F.prototype.size=20;class j extends rc{get(t){return new F(this,t)}}Mt("CollisionBoxArray",j);class G extends tc{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}G.prototype.size=48;class X extends c{get(t){return new G(this,t)}}Mt("PlacedSymbolArray",X);class se extends tc{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}se.prototype.size=64;class ae extends f{get(t){return new se(this,t)}}Mt("SymbolInstanceArray",ae);class oe extends y{getoffsetX(t){return this.float32[1*t+0]}}Mt("GlyphOffsetArray",oe);class ue extends wo{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}Mt("SymbolLineVertexArray",ue);class ge extends tc{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}ge.prototype.size=12;class he extends w{get(t){return new ge(this,t)}}Mt("TextAnchorOffsetArray",he);class ye extends tc{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ye.prototype.size=8;class Te extends A{get(t){return new ye(this,t)}}Mt("FeatureIndexArray",Te);class fe extends bo{}class Re extends bo{}class $e extends bo{}class Ne extends mn{}class Fe extends Gs{}class Ze extends Zs{}class mt extends pl{}class _t extends qs{}class st extends Qa{}class Dt extends nc{}class hi extends au{}class Ri extends e{}class qi extends a{}class Fi extends P{}const bn=kn([{name:"a_pos",components:2,type:"Int16"}],4),{members:gn}=bn;class oi{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,n,l,d){const v=this.segments[this.segments.length-1];return t>oi.MAX_VERTEX_ARRAY_LENGTH&&ki(`Max vertices per segment is ${oi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${oi.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!v||v.vertexLength+t>oi.MAX_VERTEX_ARRAY_LENGTH||v.sortKey!==d?this.createNewSegment(n,l,d):v}createNewSegment(t,n,l){const d={vertexOffset:t.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0,vaos:{}};return l!==void 0&&(d.sortKey=l),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(d),d}getOrCreateLatestSegment(t,n,l){return this.prepareSegment(0,t,n,l)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const t of this.segments)for(const n in t.vaos)t.vaos[n].destroy()}static simpleSegment(t,n,l,d){return new oi([{vertexOffset:t,primitiveOffset:n,vertexLength:l,primitiveLength:d,vaos:{},sortKey:0}])}}function $i(r,t){return 256*(r=kt(Math.floor(r),0,255))+kt(Math.floor(t),0,255)}oi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Mt("SegmentVector",oi);const Ln=kn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Jn,ar,Xr,Ja={exports:{}},$s={exports:{}},Ia={exports:{}},So=(function(){if(Xr)return Ja.exports;Xr=1;var r=(Jn||(Jn=1,$s.exports=function(n,l){var d,v,x,S,M,z,D,B;for(v=n.length-(d=3&n.length),x=l,M=3432918353,z=461845907,B=0;B<v;)D=255&n.charCodeAt(B)|(255&n.charCodeAt(++B))<<8|(255&n.charCodeAt(++B))<<16|(255&n.charCodeAt(++B))<<24,++B,x=27492+(65535&(S=5*(65535&(x=(x^=D=(65535&(D=(D=(65535&D)*M+(((D>>>16)*M&65535)<<16)&4294967295)<<15|D>>>17))*z+(((D>>>16)*z&65535)<<16)&4294967295)<<13|x>>>19))+((5*(x>>>16)&65535)<<16)&4294967295))+((58964+(S>>>16)&65535)<<16);switch(D=0,d){case 3:D^=(255&n.charCodeAt(B+2))<<16;case 2:D^=(255&n.charCodeAt(B+1))<<8;case 1:x^=D=(65535&(D=(D=(65535&(D^=255&n.charCodeAt(B)))*M+(((D>>>16)*M&65535)<<16)&4294967295)<<15|D>>>17))*z+(((D>>>16)*z&65535)<<16)&4294967295}return x^=n.length,x=2246822507*(65535&(x^=x>>>16))+((2246822507*(x>>>16)&65535)<<16)&4294967295,x=3266489909*(65535&(x^=x>>>13))+((3266489909*(x>>>16)&65535)<<16)&4294967295,(x^=x>>>16)>>>0}),$s.exports),t=(ar||(ar=1,Ia.exports=function(n,l){for(var d,v=n.length,x=l^v,S=0;v>=4;)d=1540483477*(65535&(d=255&n.charCodeAt(S)|(255&n.charCodeAt(++S))<<8|(255&n.charCodeAt(++S))<<16|(255&n.charCodeAt(++S))<<24))+((1540483477*(d>>>16)&65535)<<16),x=1540483477*(65535&x)+((1540483477*(x>>>16)&65535)<<16)^(d=1540483477*(65535&(d^=d>>>24))+((1540483477*(d>>>16)&65535)<<16)),v-=4,++S;switch(v){case 3:x^=(255&n.charCodeAt(S+2))<<16;case 2:x^=(255&n.charCodeAt(S+1))<<8;case 1:x=1540483477*(65535&(x^=255&n.charCodeAt(S)))+((1540483477*(x>>>16)&65535)<<16)}return x=1540483477*(65535&(x^=x>>>13))+((1540483477*(x>>>16)&65535)<<16),(x^=x>>>15)>>>0}),Ia.exports);return Ja.exports=r,Ja.exports.murmur3=r,Ja.exports.murmur2=t,Ja.exports})(),Hs=N(So);class To{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,n,l,d){this.ids.push(Co(t)),this.positions.push(n,l,d)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const n=Co(t);let l=0,d=this.ids.length-1;for(;l<d;){const x=l+d>>1;this.ids[x]>=n?d=x:l=x+1}const v=[];for(;this.ids[l]===n;)v.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return v}static serialize(t,n){const l=new Float64Array(t.ids),d=new Uint32Array(t.positions);return xr(l,d,0,l.length-1),n&&n.push(l.buffer,d.buffer),{ids:l,positions:d}}static deserialize(t){const n=new To;return n.ids=t.ids,n.positions=t.positions,n.indexed=!0,n}}function Co(r){const t=+r;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:Hs(String(r))}function xr(r,t,n,l){for(;n<l;){const d=r[n+l>>1];let v=n-1,x=l+1;for(;;){do v++;while(r[v]<d);do x--;while(r[x]>d);if(v>=x)break;Da(r,v,x),Da(t,3*v,3*x),Da(t,3*v+1,3*x+1),Da(t,3*v+2,3*x+2)}x-n<l-x?(xr(r,t,n,x),n=x+1):(xr(r,t,x+1,l),l=x)}}function Da(r,t,n){const l=r[t];r[t]=r[n],r[n]=l}Mt("FeaturePositionMap",To);class jr{constructor(t,n){this.gl=t.gl,this.location=n}}class Eo extends jr{constructor(t,n){super(t,n),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class _n extends jr{constructor(t,n){super(t,n),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class An extends jr{constructor(t,n){super(t,n),this.current=pi.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const Yr=new Float32Array(16);function wn(r){return[$i(255*r.r,255*r.g),$i(255*r.b,255*r.a)]}class Mo{constructor(t,n,l){this.value=t,this.uniformNames=n.map((d=>`u_${d}`)),this.type=l}setUniform(t,n,l){t.set(l.constantOr(this.value))}getBinding(t,n,l){return this.type==="color"?new An(t,n):new Eo(t,n)}}class ml{constructor(t,n){this.uniformNames=n.map((l=>`u_${l}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,n){this.pixelRatioFrom=n.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=n.tlbr,this.patternTo=t.tlbr}setUniform(t,n,l,d){const v=d==="u_pattern_to"?this.patternTo:d==="u_pattern_from"?this.patternFrom:d==="u_pixel_ratio_to"?this.pixelRatioTo:d==="u_pixel_ratio_from"?this.pixelRatioFrom:null;v&&t.set(v)}getBinding(t,n,l){return l.substr(0,9)==="u_pattern"?new _n(t,n):new Eo(t,n)}}class ws{constructor(t,n,l,d){this.expression=t,this.type=l,this.maxValue=0,this.paintVertexAttributes=n.map((v=>({name:`a_${v}`,type:"Float32",components:l==="color"?2:1,offset:0}))),this.paintVertexArray=new d}populatePaintArray(t,n,l){const d=this.paintVertexArray.length,v=this.expression.evaluate(new ji(0,l),n,{},l.canonical,[],l.formattedSection);this.paintVertexArray.resize(t),this._setPaintValue(d,t,v)}updatePaintArray(t,n,l,d,v){const x=this.expression.evaluate(new ji(0,v),l,d);this._setPaintValue(t,n,x)}_setPaintValue(t,n,l){if(this.type==="color"){const d=wn(l);for(let v=t;v<n;v++)this.paintVertexArray.emplace(v,d[0],d[1])}else{for(let d=t;d<n;d++)this.paintVertexArray.emplace(d,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Fr{constructor(t,n,l,d,v,x){this.expression=t,this.uniformNames=n.map((S=>`u_${S}_t`)),this.type=l,this.useIntegerZoom=d,this.zoom=v,this.maxValue=0,this.paintVertexAttributes=n.map((S=>({name:`a_${S}`,type:"Float32",components:l==="color"?4:2,offset:0}))),this.paintVertexArray=new x}populatePaintArray(t,n,l){const d=this.expression.evaluate(new ji(this.zoom,l),n,{},l.canonical,[],l.formattedSection),v=this.expression.evaluate(new ji(this.zoom+1,l),n,{},l.canonical,[],l.formattedSection),x=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(x,t,d,v)}updatePaintArray(t,n,l,d,v){const x=this.expression.evaluate(new ji(this.zoom,v),l,d),S=this.expression.evaluate(new ji(this.zoom+1,v),l,d);this._setPaintValue(t,n,x,S)}_setPaintValue(t,n,l,d){if(this.type==="color"){const v=wn(l),x=wn(d);for(let S=t;S<n;S++)this.paintVertexArray.emplace(S,v[0],v[1],x[0],x[1])}else{for(let v=t;v<n;v++)this.paintVertexArray.emplace(v,l,d);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(d))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,n){const l=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,d=kt(this.expression.interpolationFactor(l,this.zoom,this.zoom+1),0,1);t.set(d)}getBinding(t,n,l){return new Eo(t,n)}}class Xs{constructor(t,n,l,d,v,x){this.expression=t,this.type=n,this.useIntegerZoom=l,this.zoom=d,this.layerId=x,this.zoomInPaintVertexArray=new v,this.zoomOutPaintVertexArray=new v}populatePaintArray(t,n,l){const d=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(d,t,n.patterns&&n.patterns[this.layerId],l.imagePositions)}updatePaintArray(t,n,l,d,v){this._setPaintValues(t,n,l.patterns&&l.patterns[this.layerId],v.imagePositions)}_setPaintValues(t,n,l,d){if(!d||!l)return;const{min:v,mid:x,max:S}=l,M=d[v],z=d[x],D=d[S];if(M&&z&&D)for(let B=t;B<n;B++)this.zoomInPaintVertexArray.emplace(B,z.tl[0],z.tl[1],z.br[0],z.br[1],M.tl[0],M.tl[1],M.br[0],M.br[1],z.pixelRatio,M.pixelRatio),this.zoomOutPaintVertexArray.emplace(B,z.tl[0],z.tl[1],z.br[0],z.br[1],D.tl[0],D.tl[1],D.br[0],D.br[1],z.pixelRatio,D.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Ln.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Ln.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class _a{constructor(t,n,l){this.binders={},this._buffers=[];const d=[];for(const v in t.paint._values){if(!l(v))continue;const x=t.paint.get(v);if(!(x instanceof Ki&&ha(x.property.specification)))continue;const S=Ys(v,t.type),M=x.value,z=x.property.specification.type,D=x.property.useIntegerZoom,B=x.property.specification["property-type"],V=B==="cross-faded"||B==="cross-faded-data-driven";if(M.kind==="constant")this.binders[v]=V?new ml(M.value,S):new Mo(M.value,S,z),d.push(`/u_${v}`);else if(M.kind==="source"||V){const $=Ku(v,z,"source");this.binders[v]=V?new Xs(M,z,D,n,$,t.id):new ws(M,S,z,$),d.push(`/a_${v}`)}else{const $=Ku(v,z,"composite");this.binders[v]=new Fr(M,S,z,D,n,$),d.push(`/z_${v}`)}}this.cacheKey=d.sort().join("")}getMaxValue(t){const n=this.binders[t];return n instanceof ws||n instanceof Fr?n.maxValue:0}populatePaintArrays(t,n,l){for(const d in this.binders){const v=this.binders[d];(v instanceof ws||v instanceof Fr||v instanceof Xs)&&v.populatePaintArray(t,n,l)}}setConstantPatternPositions(t,n){for(const l in this.binders){const d=this.binders[l];d instanceof ml&&d.setConstantPatternPositions(t,n)}}updatePaintArrays(t,n,l,d,v){let x=!1;for(const S in t){const M=n.getPositions(S);for(const z of M){const D=l.feature(z.index);for(const B in this.binders){const V=this.binders[B];if((V instanceof ws||V instanceof Fr||V instanceof Xs)&&V.expression.isStateDependent===!0){const $=d.paint.get(B);V.expression=$.value,V.updatePaintArray(z.start,z.end,D,t[S],v),x=!0}}}}return x}defines(){const t=[];for(const n in this.binders){const l=this.binders[n];(l instanceof Mo||l instanceof ml)&&t.push(...l.uniformNames.map((d=>`#define HAS_UNIFORM_${d}`)))}return t}getBinderAttributes(){const t=[];for(const n in this.binders){const l=this.binders[n];if(l instanceof ws||l instanceof Fr)for(let d=0;d<l.paintVertexAttributes.length;d++)t.push(l.paintVertexAttributes[d].name);else if(l instanceof Xs)for(let d=0;d<Ln.members.length;d++)t.push(Ln.members[d].name)}return t}getBinderUniforms(){const t=[];for(const n in this.binders){const l=this.binders[n];if(l instanceof Mo||l instanceof ml||l instanceof Fr)for(const d of l.uniformNames)t.push(d)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,n){const l=[];for(const d in this.binders){const v=this.binders[d];if(v instanceof Mo||v instanceof ml||v instanceof Fr){for(const x of v.uniformNames)if(n[x]){const S=v.getBinding(t,n[x],x);l.push({name:x,property:d,binding:S})}}}return l}setUniforms(t,n,l,d){for(const{name:v,property:x,binding:S}of n)this.binders[x].setUniform(S,d,l.get(x),v)}updatePaintBuffers(t){this._buffers=[];for(const n in this.binders){const l=this.binders[n];if(t&&l instanceof Xs){const d=t.fromScale===2?l.zoomInPaintVertexBuffer:l.zoomOutPaintVertexBuffer;d&&this._buffers.push(d)}else(l instanceof ws||l instanceof Fr)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(t){for(const n in this.binders){const l=this.binders[n];(l instanceof ws||l instanceof Fr||l instanceof Xs)&&l.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const n=this.binders[t];(n instanceof ws||n instanceof Fr||n instanceof Xs)&&n.destroy()}}}class On{constructor(t,n,l=()=>!0){this.programConfigurations={};for(const d of t)this.programConfigurations[d.id]=new _a(d,n,l);this.needsUpload=!1,this._featureMap=new To,this._bufferOffset=0}populatePaintArrays(t,n,l,d){for(const v in this.programConfigurations)this.programConfigurations[v].populatePaintArrays(t,n,d);n.id!==void 0&&this._featureMap.add(n.id,l,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,n,l,d){for(const v of l)this.needsUpload=this.programConfigurations[v.id].updatePaintArrays(t,this._featureMap,n,v,d)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function Ys(r,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[r]||[r.replace(`${t}-`,"").replace(/-/g,"_")]}function Ku(r,t,n){const l={color:{source:Zs,composite:O},number:{source:y,composite:Zs}},d=(function(v){return{"line-pattern":{source:mt,composite:mt},"fill-pattern":{source:mt,composite:mt},"fill-extrusion-pattern":{source:mt,composite:mt}}[v]})(r);return d&&d[n]||l[t][n]}Mt("ConstantBinder",Mo),Mt("CrossFadedConstantBinder",ml),Mt("SourceExpressionBinder",ws),Mt("CrossFadedCompositeBinder",Xs),Mt("CompositeExpressionBinder",Fr),Mt("ProgramConfiguration",_a,{omit:["_buffers"]}),Mt("ProgramConfigurationSet",On);const es=Math.pow(2,14)-1,ka=-es-1;function ln(r){const t=St/r.extent,n=r.loadGeometry();for(let l=0;l<n.length;l++){const d=n[l];for(let v=0;v<d.length;v++){const x=d[v],S=Math.round(x.x*t),M=Math.round(x.y*t);x.x=kt(S,ka,es),x.y=kt(M,ka,es),(S<x.x||S>x.x+1||M<x.y||M>x.y+1)&&ki("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return n}function La(r,t){return{type:r.type,id:r.id,properties:r.properties,geometry:t?ln(r):[]}}const ff=-32768;function Pp(r,t,n,l,d){r.emplaceBack(ff+8*t+l,ff+8*n+d)}class pf{constructor(t){this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((n=>n.id)),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Re,this.indexArray=new qi,this.segments=new oi,this.programConfigurations=new On(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter((n=>n.isStateDependent())).map((n=>n.id))}populate(t,n,l){const d=this.layers[0],v=[];let x=null,S=!1,M=d.type==="heatmap";if(d.type==="circle"){const D=d;x=D.layout.get("circle-sort-key"),S=!x.isConstant(),M=M||D.paint.get("circle-pitch-alignment")==="map"}const z=M?n.subdivisionGranularity.circle:1;for(const{feature:D,id:B,index:V,sourceLayerIndex:$}of t){const H=this.layers[0]._featureFilter.needGeometry,K=La(D,H);if(!this.layers[0]._featureFilter.filter(new ji(this.zoom,{globalState:this.globalState}),K,l))continue;const ne=S?x.evaluate(K,{},l):void 0,ce={id:B,properties:D.properties,type:D.type,sourceLayerIndex:$,index:V,geometry:H?K.geometry:ln(D),patterns:{},sortKey:ne};v.push(ce)}S&&v.sort(((D,B)=>D.sortKey-B.sortKey));for(const D of v){const{geometry:B,index:V,sourceLayerIndex:$}=D,H=t[V].feature;this.addFeature(D,B,V,l,z),n.featureIndex.insert(H,B,V,$,this.index)}}update(t,n,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,{imagePositions:l,globalState:this.globalState})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,gn),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,n,l,d,v=1){let x;switch(v){case 1:x=[0,7];break;case 3:x=[0,2,5,7];break;case 5:x=[0,1,3,4,6,7];break;case 7:x=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${v}; valid values are 1, 3, 5, 7.`)}const S=x.length;for(const M of n)for(const z of M){const D=z.x,B=z.y;if(D<0||D>=St||B<0||B>=St)continue;const V=this.segments.prepareSegment(S*S,this.layoutVertexArray,this.indexArray,t.sortKey),$=V.vertexLength;for(let H=0;H<S;H++)for(let K=0;K<S;K++)Pp(this.layoutVertexArray,D,B,x[K],x[H]);for(let H=0;H<S-1;H++)for(let K=0;K<S-1;K++){const ne=$+H*S+K,ce=$+(H+1)*S+K;this.indexArray.emplaceBack(ne,ce+1,ne+1),this.indexArray.emplaceBack(ne,ce,ce+1)}V.vertexLength+=S*S,V.primitiveLength+=(S-1)*(S-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,{imagePositions:{},canonical:d,globalState:this.globalState})}}function Rp(r,t){for(let n=0;n<r.length;n++)if(ou(t,r[n]))return!0;for(let n=0;n<t.length;n++)if(ou(r,t[n]))return!0;return!!mf(r,t)}function su(r,t,n){return!!ou(r,t)||!!Qu(t,r,n)}function sd(r,t){if(r.length===1)return gf(t,r[0]);for(let n=0;n<t.length;n++){const l=t[n];for(let d=0;d<l.length;d++)if(ou(r,l[d]))return!0}for(let n=0;n<r.length;n++)if(gf(t,r[n]))return!0;for(let n=0;n<t.length;n++)if(mf(r,t[n]))return!0;return!1}function Gm(r,t,n){if(r.length>1){if(mf(r,t))return!0;for(let l=0;l<t.length;l++)if(Qu(t[l],r,n))return!0}for(let l=0;l<r.length;l++)if(Qu(r[l],t,n))return!0;return!1}function mf(r,t){if(r.length===0||t.length===0)return!1;for(let n=0;n<r.length-1;n++){const l=r[n],d=r[n+1];for(let v=0;v<t.length-1;v++)if(Zm(l,d,t[v],t[v+1]))return!0}return!1}function Zm(r,t,n,l){return fr(r,n,l)!==fr(t,n,l)&&fr(r,t,n)!==fr(r,t,l)}function Qu(r,t,n){const l=n*n;if(t.length===1)return r.distSqr(t[0])<l;for(let d=1;d<t.length;d++)if(zp(r,t[d-1],t[d])<l)return!0;return!1}function zp(r,t,n){const l=t.distSqr(n);if(l===0)return r.distSqr(t);const d=((r.x-t.x)*(n.x-t.x)+(r.y-t.y)*(n.y-t.y))/l;return r.distSqr(d<0?t:d>1?n:n.sub(t)._mult(d)._add(t))}function gf(r,t){let n,l,d,v=!1;for(let x=0;x<r.length;x++){n=r[x];for(let S=0,M=n.length-1;S<n.length;M=S++)l=n[S],d=n[M],l.y>t.y!=d.y>t.y&&t.x<(d.x-l.x)*(t.y-l.y)/(d.y-l.y)+l.x&&(v=!v)}return v}function ou(r,t){let n=!1;for(let l=0,d=r.length-1;l<r.length;d=l++){const v=r[l],x=r[d];v.y>t.y!=x.y>t.y&&t.x<(x.x-v.x)*(t.y-v.y)/(x.y-v.y)+v.x&&(n=!n)}return n}function qm(r,t,n){const l=n[0],d=n[2];if(r.x<l.x&&t.x<l.x||r.x>d.x&&t.x>d.x||r.y<l.y&&t.y<l.y||r.y>d.y&&t.y>d.y)return!1;const v=fr(r,t,n[0]);return v!==fr(r,t,n[1])||v!==fr(r,t,n[2])||v!==fr(r,t,n[3])}function od(r,t,n){const l=t.paint.get(r).value;return l.kind==="constant"?l.value:n.programConfigurations.get(t.id).getMaxValue(r)}function ld(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function sr(r,t,n,l,d){if(!t[0]&&!t[1])return r;const v=L.convert(t)._mult(d);n==="viewport"&&v._rotate(-l);const x=[];for(let S=0;S<r.length;S++)x.push(r[S].sub(v));return x}let Ur,Ip;Mt("CircleBucket",pf,{omit:["layers"]});var $m={get paint(){return Ip=Ip||new Hr({"circle-radius":new Ft(Ie.paint_circle["circle-radius"]),"circle-color":new Ft(Ie.paint_circle["circle-color"]),"circle-blur":new Ft(Ie.paint_circle["circle-blur"]),"circle-opacity":new Ft(Ie.paint_circle["circle-opacity"]),"circle-translate":new Pt(Ie.paint_circle["circle-translate"]),"circle-translate-anchor":new Pt(Ie.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Pt(Ie.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Pt(Ie.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ft(Ie.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ft(Ie.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ft(Ie.paint_circle["circle-stroke-opacity"])})},get layout(){return Ur=Ur||new Hr({"circle-sort-key":new Ft(Ie.layout_circle["circle-sort-key"])})}};class Hm extends ra{constructor(t){super(t,$m)}createBucket(t){return new pf(t)}queryRadius(t){const n=t;return od("circle-radius",this,n)+od("circle-stroke-width",this,n)+ld(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:l,geometry:d,transform:v,pixelsToTileUnits:x,unwrappedTileID:S,getElevation:M}){const z=sr(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-v.bearingInRadians,x),D=this.paint.get("circle-radius").evaluate(n,l)+this.paint.get("circle-stroke-width").evaluate(n,l),B=this.paint.get("circle-pitch-alignment")==="map",V=B?z:(function(H,K,ne,ce){return H.map((Ae=>Dp(Ae,K,ne,ce)))})(z,v,S,M),$=B?D*x:D;for(const H of d)for(const K of H){const ne=B?K:Dp(K,v,S,M);let ce=$;const Ae=v.projectTileCoordinates(K.x,K.y,S,M).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ce*=Ae/v.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ce*=v.cameraToCenterDistance/Ae),su(V,ne,ce))return!0}return!1}}function Dp(r,t,n,l){const d=t.projectTileCoordinates(r.x,r.y,n,l).point;return new L((.5*d.x+.5)*t.width,(.5*-d.y+.5)*t.height)}class kp extends pf{}let cd;Mt("HeatmapBucket",kp,{omit:["layers"]});var Lp={get paint(){return cd=cd||new Hr({"heatmap-radius":new Ft(Ie.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ft(Ie.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Pt(Ie.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Vs(Ie.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Pt(Ie.paint_heatmap["heatmap-opacity"])})}};function _f(r,{width:t,height:n},l,d){if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==t*n*l)throw new RangeError(`mismatched image size. expected: ${d.length} but got: ${t*n*l}`)}else d=new Uint8Array(t*n*l);return r.width=t,r.height=n,r.data=d,r}function Op(r,{width:t,height:n},l){if(t===r.width&&n===r.height)return;const d=_f({},{width:t,height:n},l);yf(r,d,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,t),height:Math.min(r.height,n)},l),r.width=t,r.height=n,r.data=d.data}function yf(r,t,n,l,d,v){if(d.width===0||d.height===0)return t;if(d.width>r.width||d.height>r.height||n.x>r.width-d.width||n.y>r.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>t.width||d.height>t.height||l.x>t.width-d.width||l.y>t.height-d.height)throw new RangeError("out of range destination coordinates for image copy");const x=r.data,S=t.data;if(x===S)throw new Error("srcData equals dstData, so image is already copied");for(let M=0;M<d.height;M++){const z=((n.y+M)*r.width+n.x)*v,D=((l.y+M)*t.width+l.x)*v;for(let B=0;B<d.width*v;B++)S[D+B]=x[z+B]}return t}class lu{constructor(t,n){_f(this,t,1,n)}resize(t){Op(this,t,1)}clone(){return new lu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,n,l,d,v){yf(t,n,l,d,v,1)}}class Wr{constructor(t,n){_f(this,t,4,n)}resize(t){Op(this,t,4)}replace(t,n){n?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Wr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,n,l,d,v){yf(t,n,l,d,v,4)}setPixel(t,n,l){const d=4*(t*this.width+n);this.data[d+0]=Math.round(255*l.r/l.a),this.data[d+1]=Math.round(255*l.g/l.a),this.data[d+2]=Math.round(255*l.b/l.a),this.data[d+3]=Math.round(255*l.a)}}function vf(r){const t={},n=r.resolution||256,l=r.clips?r.clips.length:1,d=r.image||new Wr({width:n,height:l});if(Math.log(n)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${n}`);const v=(x,S,M)=>{t[r.evaluationKey]=M;const z=r.expression.evaluate(t);d.setPixel(x/4/n,S/4,z)};if(r.clips)for(let x=0,S=0;x<l;++x,S+=4*n)for(let M=0,z=0;M<n;M++,z+=4){const D=M/(n-1),{start:B,end:V}=r.clips[x];v(S,z,B*(1-D)+V*D)}else for(let x=0,S=0;x<n;x++,S+=4)v(0,S,x/(n-1));return d}Mt("AlphaImage",lu),Mt("RGBAImage",Wr);const xf="big-fb";class Bp extends ra{createBucket(t){return new kp(t)}constructor(t){super(t,Lp),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=vf({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(xf)&&this.heatmapFbos.delete(xf)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let ud;var Np={get paint(){return ud=ud||new Hr({"hillshade-illumination-direction":new Pt(Ie.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Pt(Ie.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Pt(Ie.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Pt(Ie.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Pt(Ie.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Pt(Ie.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Pt(Ie.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Pt(Ie.paint_hillshade["hillshade-method"])})}};class Xm extends ra{constructor(t){super(t,Np),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let t=this.paint.get("hillshade-illumination-direction").values,n=this.paint.get("hillshade-illumination-altitude").values,l=this.paint.get("hillshade-highlight-color").values,d=this.paint.get("hillshade-shadow-color").values;const v=Math.max(t.length,n.length,l.length,d.length);t=t.concat(Array(v-t.length).fill(t.at(-1))),n=n.concat(Array(v-n.length).fill(n.at(-1))),l=l.concat(Array(v-l.length).fill(l.at(-1))),d=d.concat(Array(v-d.length).fill(d.at(-1)));const x=n.map(Fo);return{directionRadians:t.map(Fo),altitudeRadians:x,shadowColor:d,highlightColor:l}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let bf;var Ym={get paint(){return bf=bf||new Hr({"color-relief-opacity":new Pt(Ie["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new Vs(Ie["paint_color-relief"]["color-relief-color"])})}};class Ws{constructor(t,n,l,d){this.context=t,this.format=l,this.texture=t.gl.createTexture(),this.update(n,d)}update(t,n,l){const{width:d,height:v}=t,x=!(this.size&&this.size[0]===d&&this.size[1]===v||l),{context:S}=this,{gl:M}=S;if(this.useMipmap=!!(n&&n.useMipmap),M.bindTexture(M.TEXTURE_2D,this.texture),S.pixelStoreUnpackFlipY.set(!1),S.pixelStoreUnpack.set(1),S.pixelStoreUnpackPremultiplyAlpha.set(this.format===M.RGBA&&(!n||n.premultiply!==!1)),x)this.size=[d,v],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||wa(t)?M.texImage2D(M.TEXTURE_2D,0,this.format,this.format,M.UNSIGNED_BYTE,t):M.texImage2D(M.TEXTURE_2D,0,this.format,d,v,0,this.format,M.UNSIGNED_BYTE,t.data);else{const{x:z,y:D}=l||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||wa(t)?M.texSubImage2D(M.TEXTURE_2D,0,z,D,M.RGBA,M.UNSIGNED_BYTE,t):M.texSubImage2D(M.TEXTURE_2D,0,z,D,d,v,M.RGBA,M.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&M.generateMipmap(M.TEXTURE_2D),S.pixelStoreUnpackFlipY.setDefault(),S.pixelStoreUnpack.setDefault(),S.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(t,n,l){const{context:d}=this,{gl:v}=d;v.bindTexture(v.TEXTURE_2D,this.texture),l!==v.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(l=v.LINEAR),t!==this.filter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,t),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,l||t),this.filter=t),n!==this.wrap&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,n),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class wf{constructor(t,n,l,d=1,v=1,x=1,S=0){if(this.uid=t,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(l&&!["mapbox","terrarium","custom"].includes(l))return void ki(`"${l}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=n.height;const M=this.dim=n.height-2;switch(this.data=new Uint32Array(n.data.buffer),l){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=d,this.greenFactor=v,this.blueFactor=x,this.baseShift=S;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let z=0;z<M;z++)this.data[this._idx(-1,z)]=this.data[this._idx(0,z)],this.data[this._idx(M,z)]=this.data[this._idx(M-1,z)],this.data[this._idx(z,-1)]=this.data[this._idx(z,0)],this.data[this._idx(z,M)]=this.data[this._idx(z,M-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(M,-1)]=this.data[this._idx(M-1,0)],this.data[this._idx(-1,M)]=this.data[this._idx(0,M-1)],this.data[this._idx(M,M)]=this.data[this._idx(M-1,M-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let z=0;z<M;z++)for(let D=0;D<M;D++){const B=this.get(z,D);B>this.max&&(this.max=B),B<this.min&&(this.min=B)}}get(t,n){const l=new Uint8Array(this.data.buffer),d=4*this._idx(t,n);return this.unpack(l[d],l[d+1],l[d+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,n){if(t<-1||t>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(t+1)}unpack(t,n,l){return t*this.redFactor+n*this.greenFactor+l*this.blueFactor-this.baseShift}pack(t){return Wm(t,this.getUnpackVector())}getPixels(){return new Wr({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,n,l){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let d=n*this.dim,v=n*this.dim+this.dim,x=l*this.dim,S=l*this.dim+this.dim;switch(n){case-1:d=v-1;break;case 1:v=d+1}switch(l){case-1:x=S-1;break;case 1:S=x+1}const M=-n*this.dim,z=-l*this.dim;for(let D=x;D<S;D++)for(let B=d;B<v;B++)this.data[this._idx(B,D)]=t.data[this._idx(B+M,D+z)]}}function Wm(r,t){const n=t[0],l=t[1],d=t[2],v=t[3],x=Math.min(n,l,d),S=Math.round((r+v)/x);return{r:Math.floor(S*x/n)%256,g:Math.floor(S*x/l)%256,b:Math.floor(S*x/d)%256}}Mt("DEMData",wf);class Km extends ra{constructor(t){super(t,Ym)}_createColorRamp(t){const n={elevationStops:[],colorStops:[]},l=this._transitionablePaint._values["color-relief-color"].value.expression;if(l instanceof mo&&l._styleExpression.expression instanceof vr){this.colorRampExpression=l;const x=l._styleExpression.expression;n.elevationStops=x.labels,n.colorStops=[];for(const S of n.elevationStops)n.colorStops.push(x.evaluate({globals:{elevation:S}}))}if(n.elevationStops.length<1&&(n.elevationStops=[0],n.colorStops=[pi.transparent]),n.elevationStops.length<2&&(n.elevationStops.push(n.elevationStops[0]+1),n.colorStops.push(n.colorStops[0])),n.elevationStops.length<=t)return n;const d={elevationStops:[],colorStops:[]},v=(n.elevationStops.length-1)/(t-1);for(let x=0;x<n.elevationStops.length-.5;x+=v)d.elevationStops.push(n.elevationStops[Math.round(x)]),d.colorStops.push(n.colorStops[Math.round(x)]);return ki(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),d}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(t,n,l){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const d=this._createColorRamp(n),v=new Wr({width:d.colorStops.length,height:1}),x=new Wr({width:d.colorStops.length,height:1});for(let S=0;S<d.elevationStops.length;S++){const M=Wm(d.elevationStops[S],l);x.setPixel(0,S,new pi(M.r/255,M.g/255,M.b/255,1)),v.setPixel(0,S,d.colorStops[S])}return this.colorRampTextures={elevationTexture:new Ws(t,x,t.gl.RGBA),colorTexture:new Ws(t,v,t.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const gl=kn([{name:"a_pos",components:2,type:"Int16"}],4),{members:Qm}=gl;function Ju(r,t,n){const l=n.patternDependencies;let d=!1;for(const v of t){const x=v.paint.get(`${r}-pattern`);x.isConstant()||(d=!0);const S=x.constantOr(null);S&&(d=!0,l[S.to]=!0,l[S.from]=!0)}return d}function cu(r,t,n,l,d){const v=d.patternDependencies;for(const x of t){const S=x.paint.get(`${r}-pattern`).value;if(S.kind!=="constant"){let M=S.evaluate({zoom:l-1},n,{},d.availableImages),z=S.evaluate({zoom:l},n,{},d.availableImages),D=S.evaluate({zoom:l+1},n,{},d.availableImages);M=M&&M.name?M.name:M,z=z&&z.name?z.name:z,D=D&&D.name?D.name:D,v[M]=!0,v[z]=!0,v[D]=!0,n.patterns[x.id]={min:M,mid:z,max:D}}}return n}function Bn(r,t,n,l,d){let v;if(d===(function(x,S,M,z){let D=0;for(let B=S,V=M-z;B<M;B+=z)D+=(x[V]-x[B])*(x[B+1]+x[V+1]),V=B;return D})(r,t,n,l)>0)for(let x=t;x<n;x+=l)v=ig(x/l|0,r[x],r[x+1],v);else for(let x=n-l;x>=t;x-=l)v=ig(x/l|0,r[x],r[x+1],v);return v&&du(v,v.next)&&(ih(v),v=v.next),v}function uu(r,t){if(!r)return r;t||(t=r);let n,l=r;do if(n=!1,l.steiner||!du(l,l.next)&&Sn(l.prev,l,l.next)!==0)l=l.next;else{if(ih(l),l=t=l.prev,l===l.next)break;n=!0}while(n||l!==t);return t}function hd(r,t,n,l,d,v,x){if(!r)return;!x&&v&&(function(M,z,D,B){let V=M;do V.z===0&&(V.z=Sf(V.x,V.y,z,D,B)),V.prevZ=V.prev,V.nextZ=V.next,V=V.next;while(V!==M);V.prevZ.nextZ=null,V.prevZ=null,(function($){let H,K=1;do{let ne,ce=$;$=null;let Ae=null;for(H=0;ce;){H++;let _e=ce,xe=0;for(let Ye=0;Ye<K&&(xe++,_e=_e.nextZ,_e);Ye++);let Ue=K;for(;xe>0||Ue>0&&_e;)xe!==0&&(Ue===0||!_e||ce.z<=_e.z)?(ne=ce,ce=ce.nextZ,xe--):(ne=_e,_e=_e.nextZ,Ue--),Ae?Ae.nextZ=ne:$=ne,ne.prevZ=Ae,Ae=ne;ce=_e}Ae.nextZ=null,K*=2}while(H>1)})(V)})(r,l,d,v);let S=r;for(;r.prev!==r.next;){const M=r.prev,z=r.next;if(v?dd(r,l,d,v):Jm(r))t.push(M.i,r.i,z.i),ih(r),r=z.next,S=z.next;else if((r=z)===S){x?x===1?hd(r=ac(uu(r),t),t,n,l,d,v,2):x===2&&eg(r,t,n,l,d,v):hd(uu(r),t,n,l,d,v,1);break}}}function Jm(r){const t=r.prev,n=r,l=r.next;if(Sn(t,n,l)>=0)return!1;const d=t.x,v=n.x,x=l.x,S=t.y,M=n.y,z=l.y,D=Math.min(d,v,x),B=Math.min(S,M,z),V=Math.max(d,v,x),$=Math.max(S,M,z);let H=l.next;for(;H!==t;){if(H.x>=D&&H.x<=V&&H.y>=B&&H.y<=$&&hu(d,S,v,M,x,z,H.x,H.y)&&Sn(H.prev,H,H.next)>=0)return!1;H=H.next}return!0}function dd(r,t,n,l){const d=r.prev,v=r,x=r.next;if(Sn(d,v,x)>=0)return!1;const S=d.x,M=v.x,z=x.x,D=d.y,B=v.y,V=x.y,$=Math.min(S,M,z),H=Math.min(D,B,V),K=Math.max(S,M,z),ne=Math.max(D,B,V),ce=Sf($,H,t,n,l),Ae=Sf(K,ne,t,n,l);let _e=r.prevZ,xe=r.nextZ;for(;_e&&_e.z>=ce&&xe&&xe.z<=Ae;){if(_e.x>=$&&_e.x<=K&&_e.y>=H&&_e.y<=ne&&_e!==d&&_e!==x&&hu(S,D,M,B,z,V,_e.x,_e.y)&&Sn(_e.prev,_e,_e.next)>=0||(_e=_e.prevZ,xe.x>=$&&xe.x<=K&&xe.y>=H&&xe.y<=ne&&xe!==d&&xe!==x&&hu(S,D,M,B,z,V,xe.x,xe.y)&&Sn(xe.prev,xe,xe.next)>=0))return!1;xe=xe.nextZ}for(;_e&&_e.z>=ce;){if(_e.x>=$&&_e.x<=K&&_e.y>=H&&_e.y<=ne&&_e!==d&&_e!==x&&hu(S,D,M,B,z,V,_e.x,_e.y)&&Sn(_e.prev,_e,_e.next)>=0)return!1;_e=_e.prevZ}for(;xe&&xe.z<=Ae;){if(xe.x>=$&&xe.x<=K&&xe.y>=H&&xe.y<=ne&&xe!==d&&xe!==x&&hu(S,D,M,B,z,V,xe.x,xe.y)&&Sn(xe.prev,xe,xe.next)>=0)return!1;xe=xe.nextZ}return!0}function ac(r,t){let n=r;do{const l=n.prev,d=n.next.next;!du(l,d)&&Po(l,n,n.next,d)&&th(l,d)&&th(d,l)&&(t.push(l.i,n.i,d.i),ih(n),ih(n.next),n=r=d),n=n.next}while(n!==r);return uu(n)}function eg(r,t,n,l,d,v){let x=r;do{let S=x.next.next;for(;S!==x.prev;){if(x.i!==S.i&&Up(x,S)){let M=br(x,S);return x=uu(x,x.next),M=uu(M,M.next),hd(x,t,n,l,d,v,0),void hd(M,t,n,l,d,v,0)}S=S.next}x=x.next}while(x!==r)}function tg(r,t){let n=r.x-t.x;return n===0&&(n=r.y-t.y,n===0)&&(n=(r.next.y-r.y)/(r.next.x-r.x)-(t.next.y-t.y)/(t.next.x-t.x)),n}function fd(r,t){const n=(function(d,v){let x=v;const S=d.x,M=d.y;let z,D=-1/0;if(du(d,x))return x;do{if(du(d,x.next))return x.next;if(M<=x.y&&M>=x.next.y&&x.next.y!==x.y){const K=x.x+(M-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(K<=S&&K>D&&(D=K,z=x.x<x.next.x?x:x.next,K===S))return z}x=x.next}while(x!==v);if(!z)return null;const B=z,V=z.x,$=z.y;let H=1/0;x=z;do{if(S>=x.x&&x.x>=V&&S!==x.x&&Fp(M<$?S:D,M,V,$,M<$?D:S,M,x.x,x.y)){const K=Math.abs(M-x.y)/(S-x.x);th(x,d)&&(K<H||K===H&&(x.x>z.x||x.x===z.x&&Ao(z,x)))&&(z=x,H=K)}x=x.next}while(x!==B);return z})(r,t);if(!n)return t;const l=br(n,r);return uu(l,l.next),uu(n,n.next)}function Ao(r,t){return Sn(r.prev,r,t.prev)<0&&Sn(t.next,r,r.next)<0}function Sf(r,t,n,l,d){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-n)*d|0)|r<<8))|r<<4))|r<<2))|r<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-l)*d|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function jp(r){let t=r,n=r;do(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next;while(t!==r);return n}function Fp(r,t,n,l,d,v,x,S){return(d-x)*(t-S)>=(r-x)*(v-S)&&(r-x)*(l-S)>=(n-x)*(t-S)&&(n-x)*(v-S)>=(d-x)*(l-S)}function hu(r,t,n,l,d,v,x,S){return!(r===x&&t===S)&&Fp(r,t,n,l,d,v,x,S)}function Up(r,t){return r.next.i!==t.i&&r.prev.i!==t.i&&!(function(n,l){let d=n;do{if(d.i!==n.i&&d.next.i!==n.i&&d.i!==l.i&&d.next.i!==l.i&&Po(d,d.next,n,l))return!0;d=d.next}while(d!==n);return!1})(r,t)&&(th(r,t)&&th(t,r)&&(function(n,l){let d=n,v=!1;const x=(n.x+l.x)/2,S=(n.y+l.y)/2;do d.y>S!=d.next.y>S&&d.next.y!==d.y&&x<(d.next.x-d.x)*(S-d.y)/(d.next.y-d.y)+d.x&&(v=!v),d=d.next;while(d!==n);return v})(r,t)&&(Sn(r.prev,r,t.prev)||Sn(r,t.prev,t))||du(r,t)&&Sn(r.prev,r,r.next)>0&&Sn(t.prev,t,t.next)>0)}function Sn(r,t,n){return(t.y-r.y)*(n.x-t.x)-(t.x-r.x)*(n.y-t.y)}function du(r,t){return r.x===t.x&&r.y===t.y}function Po(r,t,n,l){const d=eh(Sn(r,t,n)),v=eh(Sn(r,t,l)),x=eh(Sn(n,l,r)),S=eh(Sn(n,l,t));return d!==v&&x!==S||!(d!==0||!Nn(r,n,t))||!(v!==0||!Nn(r,l,t))||!(x!==0||!Nn(n,r,l))||!(S!==0||!Nn(n,t,l))}function Nn(r,t,n){return t.x<=Math.max(r.x,n.x)&&t.x>=Math.min(r.x,n.x)&&t.y<=Math.max(r.y,n.y)&&t.y>=Math.min(r.y,n.y)}function eh(r){return r>0?1:r<0?-1:0}function th(r,t){return Sn(r.prev,r,r.next)<0?Sn(r,t,r.next)>=0&&Sn(r,r.prev,t)>=0:Sn(r,t,r.prev)<0||Sn(r,r.next,t)<0}function br(r,t){const n=Tf(r.i,r.x,r.y),l=Tf(t.i,t.x,t.y),d=r.next,v=t.prev;return r.next=t,t.prev=r,n.next=d,d.prev=n,l.next=n,n.prev=l,v.next=l,l.prev=v,l}function ig(r,t,n,l){const d=Tf(r,t,n);return l?(d.next=l.next,d.prev=l,l.next.prev=d,l.next=d):(d.prev=d,d.next=d),d}function ih(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Tf(r,t,n){return{i:r,x:t,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class an{constructor(t,n){if(n>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=n}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class Kr{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}Kr.noSubdivision=new Kr({fill:new an(0,0),line:new an(0,0),tile:new an(0,0),stencil:new an(0,0),circle:1}),Mt("SubdivisionGranularityExpression",an),Mt("SubdivisionGranularitySetting",Kr);const Oa=-32768,nh=32767;class ng{constructor(t,n){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=St/t,this._canonical=n}_getKey(t,n){return(t+=32768)<<16|n+32768}_vertexToIndex(t,n){if(t<-32768||n<-32768||t>32767||n>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const l=0|Math.round(t),d=0|Math.round(n),v=this._getKey(l,d);if(this._vertexDictionary.has(v))return this._vertexDictionary.get(v);const x=this._vertexBuffer.length/2;return this._vertexDictionary.set(v,x),this._vertexBuffer.push(l,d),x}_subdivideTrianglesScanline(t){if(this._granularity<2)return(function(d,v){const x=[];for(let S=0;S<v.length;S+=3){const M=v[S],z=v[S+1],D=v[S+2],B=d[2*M],V=d[2*M+1];(d[2*z]-B)*(d[2*D+1]-V)-(d[2*z+1]-V)*(d[2*D]-B)>0?(x.push(M),x.push(D),x.push(z)):(x.push(M),x.push(z),x.push(D))}return x})(this._vertexBuffer,t);const n=[],l=t.length;for(let d=0;d<l;d+=3){const v=[t[d+0],t[d+1],t[d+2]],x=[this._vertexBuffer[2*t[d+0]+0],this._vertexBuffer[2*t[d+0]+1],this._vertexBuffer[2*t[d+1]+0],this._vertexBuffer[2*t[d+1]+1],this._vertexBuffer[2*t[d+2]+0],this._vertexBuffer[2*t[d+2]+1]];let S=1/0,M=1/0,z=-1/0,D=-1/0;for(let K=0;K<3;K++){const ne=x[2*K],ce=x[2*K+1];S=Math.min(S,ne),z=Math.max(z,ne),M=Math.min(M,ce),D=Math.max(D,ce)}if(S===z||M===D)continue;const B=Math.floor(S/this._granularityCellSize),V=Math.ceil(z/this._granularityCellSize),$=Math.floor(M/this._granularityCellSize),H=Math.ceil(D/this._granularityCellSize);if(B!==V||$!==H)for(let K=$;K<H;K++){const ne=this._scanlineGenerateVertexRingForCellRow(K,x,v);ts(this._vertexBuffer,ne,n)}else n.push(...v)}return n}_scanlineGenerateVertexRingForCellRow(t,n,l){const d=t*this._granularityCellSize,v=d+this._granularityCellSize,x=[];for(let S=0;S<3;S++){const M=n[2*S],z=n[2*S+1],D=n[2*(S+1)%6],B=n[(2*(S+1)+1)%6],V=n[2*(S+2)%6],$=n[(2*(S+2)+1)%6],H=D-M,K=B-z,ne=H===0,ce=K===0,Ae=(d-z)/K,_e=(v-z)/K,xe=Math.min(Ae,_e),Ue=Math.max(Ae,_e);if(!ce&&(xe>=1||Ue<=0)||ce&&(z<d||z>v)){B>=d&&B<=v&&x.push(l[(S+1)%3]);continue}!ce&&xe>0&&x.push(this._vertexToIndex(M+H*xe,z+K*xe));const Ye=M+H*Math.max(xe,0),ot=M+H*Math.min(Ue,1);ne||this._generateIntraEdgeVertices(x,M,z,D,B,Ye,ot),!ce&&Ue<1&&x.push(this._vertexToIndex(M+H*Ue,z+K*Ue)),(ce||B>=d&&B<=v)&&x.push(l[(S+1)%3]),!ce&&(B<=d||B>=v)&&this._generateInterEdgeVertices(x,M,z,D,B,V,$,ot,d,v)}return x}_generateIntraEdgeVertices(t,n,l,d,v,x,S){const M=d-n,z=v-l,D=z===0,B=D?Math.min(n,d):Math.min(x,S),V=D?Math.max(n,d):Math.max(x,S),$=Math.floor(B/this._granularityCellSize)+1,H=Math.ceil(V/this._granularityCellSize)-1;if(D?n<d:x<S)for(let K=$;K<=H;K++){const ne=K*this._granularityCellSize;t.push(this._vertexToIndex(ne,l+z*(ne-n)/M))}else for(let K=H;K>=$;K--){const ne=K*this._granularityCellSize;t.push(this._vertexToIndex(ne,l+z*(ne-n)/M))}}_generateInterEdgeVertices(t,n,l,d,v,x,S,M,z,D){const B=v-l,V=x-d,$=S-v,H=(z-v)/$,K=(D-v)/$,ne=Math.min(H,K),ce=Math.max(H,K),Ae=d+V*ne;let _e=Math.floor(Math.min(Ae,M)/this._granularityCellSize)+1,xe=Math.ceil(Math.max(Ae,M)/this._granularityCellSize)-1,Ue=M<Ae;const Ye=$===0;if(Ye&&(S===z||S===D))return;if(Ye||ne>=1||ce<=0){const xt=l-S,gt=x+(n-x)*Math.min((z-S)/xt,(D-S)/xt);_e=Math.floor(Math.min(gt,M)/this._granularityCellSize)+1,xe=Math.ceil(Math.max(gt,M)/this._granularityCellSize)-1,Ue=M<gt}const ot=B>0?D:z;if(Ue)for(let xt=_e;xt<=xe;xt++)t.push(this._vertexToIndex(xt*this._granularityCellSize,ot));else for(let xt=xe;xt>=_e;xt--)t.push(this._vertexToIndex(xt*this._granularityCellSize,ot))}_generateOutline(t){const n=[];for(const l of t){const d=_l(l,this._granularity,!0),v=this._pointArrayToIndices(d),x=[];for(let S=1;S<v.length;S++)x.push(v[S-1]),x.push(v[S]);n.push(x)}return n}_handlePoles(t){let n=!1,l=!1;this._canonical&&(this._canonical.y===0&&(n=!0),this._canonical.y===(1<<this._canonical.z)-1&&(l=!0)),(n||l)&&this._fillPoles(t,n,l)}_ensureNoPoleVertices(){const t=this._vertexBuffer;for(let n=0;n<t.length;n+=2){const l=t[n+1];l===Oa&&(t[n+1]=-32767),l===nh&&(t[n+1]=32766)}}_generatePoleQuad(t,n,l,d,v,x){d>v!=(x===Oa)?(t.push(n),t.push(l),t.push(this._vertexToIndex(d,x)),t.push(l),t.push(this._vertexToIndex(v,x)),t.push(this._vertexToIndex(d,x))):(t.push(l),t.push(n),t.push(this._vertexToIndex(d,x)),t.push(this._vertexToIndex(v,x)),t.push(l),t.push(this._vertexToIndex(d,x)))}_fillPoles(t,n,l){const d=this._vertexBuffer,v=St,x=t.length;for(let S=2;S<x;S+=3){const M=t[S-2],z=t[S-1],D=t[S],B=d[2*M],V=d[2*M+1],$=d[2*z],H=d[2*z+1],K=d[2*D],ne=d[2*D+1];n&&(V===0&&H===0&&this._generatePoleQuad(t,M,z,B,$,Oa),H===0&&ne===0&&this._generatePoleQuad(t,z,D,$,K,Oa),ne===0&&V===0&&this._generatePoleQuad(t,D,M,K,B,Oa)),l&&(V===v&&H===v&&this._generatePoleQuad(t,M,z,B,$,nh),H===v&&ne===v&&this._generatePoleQuad(t,z,D,$,K,nh),ne===v&&V===v&&this._generatePoleQuad(t,D,M,K,B,nh))}}_initializeVertices(t){for(let n=0;n<t.length;n+=2)this._vertexToIndex(t[n],t[n+1])}subdividePolygonInternal(t,n){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:l,holeIndices:d}=(function(S){const M=[],z=[];for(const D of S)if(D.length!==0){D!==S[0]&&M.push(z.length/2);for(let B=0;B<D.length;B++)z.push(D[B].x),z.push(D[B].y)}return{flattened:z,holeIndices:M}})(t);let v;this._initializeVertices(l);try{const S=(function(z,D,B=2){const V=D&&D.length,$=V?D[0]*B:z.length;let H=Bn(z,0,$,B,!0);const K=[];if(!H||H.next===H.prev)return K;let ne,ce,Ae;if(V&&(H=(function(_e,xe,Ue,Ye){const ot=[];for(let xt=0,gt=xe.length;xt<gt;xt++){const yt=Bn(_e,xe[xt]*Ye,xt<gt-1?xe[xt+1]*Ye:_e.length,Ye,!1);yt===yt.next&&(yt.steiner=!0),ot.push(jp(yt))}ot.sort(tg);for(let xt=0;xt<ot.length;xt++)Ue=fd(ot[xt],Ue);return Ue})(z,D,H,B)),z.length>80*B){ne=z[0],ce=z[1];let _e=ne,xe=ce;for(let Ue=B;Ue<$;Ue+=B){const Ye=z[Ue],ot=z[Ue+1];Ye<ne&&(ne=Ye),ot<ce&&(ce=ot),Ye>_e&&(_e=Ye),ot>xe&&(xe=ot)}Ae=Math.max(_e-ne,xe-ce),Ae=Ae!==0?32767/Ae:0}return hd(H,K,B,ne,ce,Ae,0),K})(l,d),M=this._convertIndices(l,S);v=this._subdivideTrianglesScanline(M)}catch(S){console.error(S)}let x=[];return n&&(x=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(v),{verticesFlattened:this._vertexBuffer,indicesTriangles:v,indicesLineList:x}}_convertIndices(t,n){const l=[];for(let d=0;d<n.length;d++)l.push(this._vertexToIndex(t[2*n[d]],t[2*n[d]+1]));return l}_pointArrayToIndices(t){const n=[];for(let l=0;l<t.length;l++){const d=t[l];n.push(this._vertexToIndex(d.x,d.y))}return n}}function rg(r,t,n,l=!0){return new ng(n,t).subdividePolygonInternal(r,l)}function _l(r,t,n=!1){if(!r||r.length<1)return[];if(r.length<2)return[];const l=r[0],d=r[r.length-1],v=n&&(l.x!==d.x||l.y!==d.y);if(t<2)return v?[...r,r[0]]:[...r];const x=Math.floor(St/t),S=[];S.push(new L(r[0].x,r[0].y));const M=r.length,z=v?M:M-1;for(let D=0;D<z;D++){const B=r[D],V=D<M-1?r[D+1]:r[0],$=B.x,H=B.y,K=V.x,ne=V.y,ce=$!==K,Ae=H!==ne;if(!ce&&!Ae)continue;const _e=K-$,xe=ne-H,Ue=Math.abs(_e),Ye=Math.abs(xe);let ot=$,xt=H;for(;;){const yt=_e>0?(Math.floor(ot/x)+1)*x:(Math.ceil(ot/x)-1)*x,Ot=xe>0?(Math.floor(xt/x)+1)*x:(Math.ceil(xt/x)-1)*x,bt=Math.abs(ot-yt),vt=Math.abs(xt-Ot),et=Math.abs(ot-K),Xt=Math.abs(xt-ne),Qt=ce?bt/Ue:Number.POSITIVE_INFINITY,Ut=Ae?vt/Ye:Number.POSITIVE_INFINITY;if((et<=bt||!ce)&&(Xt<=vt||!Ae))break;if(Qt<Ut&&ce||!Ae){ot=yt,xt+=xe*Qt;const zt=new L(ot,Math.round(xt));S[S.length-1].x===zt.x&&S[S.length-1].y===zt.y||S.push(zt)}else{ot+=_e*Ut,xt=Ot;const zt=new L(Math.round(ot),xt);S[S.length-1].x===zt.x&&S[S.length-1].y===zt.y||S.push(zt)}}const gt=new L(K,ne);S[S.length-1].x===gt.x&&S[S.length-1].y===gt.y||S.push(gt)}return S}function ts(r,t,n){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let l=0,d=r[2*t[0]];for(let M=1;M<t.length;M++){const z=r[2*t[M]];z<d&&(d=z,l=M)}const v=t.length;let x=l,S=(x+1)%v;for(;;){const M=x-1>=0?x-1:v-1,z=(S+1)%v,D=r[2*t[M]],B=r[2*t[z]],V=r[2*t[x]],$=r[2*t[x]+1],H=r[2*t[S]+1];let K=!1;if(D<B)K=!0;else if(D>B)K=!1;else{const ne=H-$,ce=-(r[2*t[S]]-V),Ae=$<H?1:-1;((D-V)*ne+(r[2*t[M]+1]-$)*ce)*Ae>((B-V)*ne+(r[2*t[z]+1]-$)*ce)*Ae&&(K=!0)}if(K){const ne=t[M],ce=t[x],Ae=t[S];ne!==ce&&ne!==Ae&&ce!==Ae&&n.push(Ae,ce,ne),x--,x<0&&(x=v-1)}else{const ne=t[z],ce=t[x],Ae=t[S];ne!==ce&&ne!==Ae&&ce!==Ae&&n.push(Ae,ce,ne),S++,S>=v&&(S=0)}if(M===z)break}}function Ss(r,t,n,l,d,v,x,S,M){const z=d.length/2,D=x&&S&&M;if(z<oi.MAX_VERTEX_ARRAY_LENGTH){const B=t.prepareSegment(z,n,l),V=B.vertexLength;for(let K=0;K<v.length;K+=3)l.emplaceBack(V+v[K],V+v[K+1],V+v[K+2]);let $,H;B.vertexLength+=z,B.primitiveLength+=v.length/3,D&&(H=x.prepareSegment(z,n,S),$=H.vertexLength,H.vertexLength+=z);for(let K=0;K<d.length;K+=2)r(d[K],d[K+1]);if(D)for(let K=0;K<M.length;K++){const ne=M[K];for(let ce=1;ce<ne.length;ce+=2)S.emplaceBack($+ne[ce-1],$+ne[ce]);H.primitiveLength+=ne.length/2}}else(function(B,V,$,H,K,ne){const ce=[];for(let Ye=0;Ye<H.length/2;Ye++)ce.push(-1);const Ae={count:0};let _e=0,xe=B.getOrCreateLatestSegment(V,$),Ue=xe.vertexLength;for(let Ye=2;Ye<K.length;Ye+=3){const ot=K[Ye-2],xt=K[Ye-1],gt=K[Ye];let yt=ce[ot]<_e,Ot=ce[xt]<_e,bt=ce[gt]<_e;xe.vertexLength+((yt?1:0)+(Ot?1:0)+(bt?1:0))>oi.MAX_VERTEX_ARRAY_LENGTH&&(xe=B.createNewSegment(V,$),_e=Ae.count,yt=!0,Ot=!0,bt=!0,Ue=0);const vt=rh(ce,H,ne,Ae,ot,yt,xe),et=rh(ce,H,ne,Ae,xt,Ot,xe),Xt=rh(ce,H,ne,Ae,gt,bt,xe);$.emplaceBack(Ue+vt-_e,Ue+et-_e,Ue+Xt-_e),xe.primitiveLength++}})(t,n,l,d,v,r),D&&(function(B,V,$,H,K,ne){const ce=[];for(let Ye=0;Ye<H.length/2;Ye++)ce.push(-1);const Ae={count:0};let _e=0,xe=B.getOrCreateLatestSegment(V,$),Ue=xe.vertexLength;for(let Ye=0;Ye<K.length;Ye++){const ot=K[Ye];for(let xt=1;xt<K[Ye].length;xt+=2){const gt=ot[xt-1],yt=ot[xt];let Ot=ce[gt]<_e,bt=ce[yt]<_e;xe.vertexLength+((Ot?1:0)+(bt?1:0))>oi.MAX_VERTEX_ARRAY_LENGTH&&(xe=B.createNewSegment(V,$),_e=Ae.count,Ot=!0,bt=!0,Ue=0);const vt=rh(ce,H,ne,Ae,gt,Ot,xe),et=rh(ce,H,ne,Ae,yt,bt,xe);$.emplaceBack(Ue+vt-_e,Ue+et-_e),xe.primitiveLength++}}})(x,n,S,d,M,r),t.forceNewSegmentOnNextPrepare(),x==null||x.forceNewSegmentOnNextPrepare()}function rh(r,t,n,l,d,v,x){if(v){const S=l.count;return n(t[2*d],t[2*d+1]),r[d]=l.count,l.count++,x.vertexLength++,S}return r[d]}class ya{constructor(t){this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((n=>n.id)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new $e,this.indexArray=new qi,this.indexArray2=new Fi,this.programConfigurations=new On(t.layers,t.zoom),this.segments=new oi,this.segments2=new oi,this.stateDependentLayerIds=this.layers.filter((n=>n.isStateDependent())).map((n=>n.id))}populate(t,n,l){this.hasPattern=Ju("fill",this.layers,n);const d=this.layers[0].layout.get("fill-sort-key"),v=!d.isConstant(),x=[];for(const{feature:S,id:M,index:z,sourceLayerIndex:D}of t){const B=this.layers[0]._featureFilter.needGeometry,V=La(S,B);if(!this.layers[0]._featureFilter.filter(new ji(this.zoom,{globalState:this.globalState}),V,l))continue;const $=v?d.evaluate(V,{},l,n.availableImages):void 0,H={id:M,properties:S.properties,type:S.type,sourceLayerIndex:D,index:z,geometry:B?V.geometry:ln(S),patterns:{},sortKey:$};x.push(H)}v&&x.sort(((S,M)=>S.sortKey-M.sortKey));for(const S of x){const{geometry:M,index:z,sourceLayerIndex:D}=S;if(this.hasPattern){const B=cu("fill",this.layers,S,this.zoom,n);this.patternFeatures.push(B)}else this.addFeature(S,M,z,l,{},n.subdivisionGranularity);n.featureIndex.insert(t[z].feature,M,z,D,this.index)}}update(t,n,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,{imagePositions:l,globalState:this.globalState})}addFeatures(t,n,l){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,n,l,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Qm),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,n,l,d,v,x){for(const S of Ul(n,500)){const M=rg(S,d,x.fill.getGranularityForZoomLevel(d.z)),z=this.layoutVertexArray;Ss(((D,B)=>{z.emplaceBack(D,B)}),this.segments,this.layoutVertexArray,this.indexArray,M.verticesFlattened,M.indicesTriangles,this.segments2,this.indexArray2,M.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,{imagePositions:v,canonical:d,globalState:this.globalState})}}let Vp,yl;Mt("FillBucket",ya,{omit:["layers","patternFeatures"]});var fu={get paint(){return yl=yl||new Hr({"fill-antialias":new Pt(Ie.paint_fill["fill-antialias"]),"fill-opacity":new Ft(Ie.paint_fill["fill-opacity"]),"fill-color":new Ft(Ie.paint_fill["fill-color"]),"fill-outline-color":new Ft(Ie.paint_fill["fill-outline-color"]),"fill-translate":new Pt(Ie.paint_fill["fill-translate"]),"fill-translate-anchor":new Pt(Ie.paint_fill["fill-translate-anchor"]),"fill-pattern":new fl(Ie.paint_fill["fill-pattern"])})},get layout(){return Vp=Vp||new Hr({"fill-sort-key":new Ft(Ie.layout_fill["fill-sort-key"])})}};class sc extends ra{constructor(t){super(t,fu)}recalculate(t,n){super.recalculate(t,n);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new ya(t)}queryRadius(){return ld(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:n,transform:l,pixelsToTileUnits:d}){return sd(sr(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-l.bearingInRadians,d),n)}isTileClipped(){return!0}}const Gp=kn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Zp=kn([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Ro}=Gp;class pu{constructor(t,n,l,d,v){this.properties={},this.extent=l,this.type=0,this.id=void 0,this._pbf=t,this._geometry=-1,this._keys=d,this._values=v,t.readFields(ah,this,n)}loadGeometry(){const t=this._pbf;t.pos=this._geometry;const n=t.readVarint()+t.pos,l=[];let d,v=1,x=0,S=0,M=0;for(;t.pos<n;){if(x<=0){const z=t.readVarint();v=7&z,x=z>>3}if(x--,v===1||v===2)S+=t.readSVarint(),M+=t.readSVarint(),v===1&&(d&&l.push(d),d=[]),d&&d.push(new L(S,M));else{if(v!==7)throw new Error(`unknown command ${v}`);d&&d.push(d[0].clone())}}return d&&l.push(d),l}bbox(){const t=this._pbf;t.pos=this._geometry;const n=t.readVarint()+t.pos;let l=1,d=0,v=0,x=0,S=1/0,M=-1/0,z=1/0,D=-1/0;for(;t.pos<n;){if(d<=0){const B=t.readVarint();l=7&B,d=B>>3}if(d--,l===1||l===2)v+=t.readSVarint(),x+=t.readSVarint(),v<S&&(S=v),v>M&&(M=v),x<z&&(z=x),x>D&&(D=x);else if(l!==7)throw new Error(`unknown command ${l}`)}return[S,z,M,D]}toGeoJSON(t,n,l){const d=this.extent*Math.pow(2,l),v=this.extent*t,x=this.extent*n,S=this.loadGeometry();function M(V){return[360*(V.x+v)/d-180,360/Math.PI*Math.atan(Math.exp((1-2*(V.y+x)/d)*Math.PI))-90]}function z(V){return V.map(M)}let D;if(this.type===1){const V=[];for(const H of S)V.push(H[0]);const $=z(V);D=V.length===1?{type:"Point",coordinates:$[0]}:{type:"MultiPoint",coordinates:$}}else if(this.type===2){const V=S.map(z);D=V.length===1?{type:"LineString",coordinates:V[0]}:{type:"MultiLineString",coordinates:V}}else{if(this.type!==3)throw new Error("unknown feature type");{const V=(function(H){const K=H.length;if(K<=1)return[H];const ne=[];let ce,Ae;for(let _e=0;_e<K;_e++){const xe=pd(H[_e]);xe!==0&&(Ae===void 0&&(Ae=xe<0),Ae===xe<0?(ce&&ne.push(ce),ce=[H[_e]]):ce&&ce.push(H[_e]))}return ce&&ne.push(ce),ne})(S),$=[];for(const H of V)$.push(H.map(z));D=$.length===1?{type:"Polygon",coordinates:$[0]}:{type:"MultiPolygon",coordinates:$}}}const B={type:"Feature",geometry:D,properties:this.properties};return this.id!=null&&(B.id=this.id),B}}function ah(r,t,n){r===1?t.id=n.readVarint():r===2?(function(l,d){const v=l.readVarint()+l.pos;for(;l.pos<v;){const x=d._keys[l.readVarint()],S=d._values[l.readVarint()];d.properties[x]=S}})(n,t):r===3?t.type=n.readVarint():r===4&&(t._geometry=n.pos)}function pd(r){let t=0;for(let n,l,d=0,v=r.length,x=v-1;d<v;x=d++)n=r[d],l=r[x],t+=(l.x-n.x)*(n.y+l.y);return t}pu.types=["Unknown","Point","LineString","Polygon"];class sh{constructor(t,n){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(oh,this,n),this.length=this._features.length}feature(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];const n=this._pbf.readVarint()+this._pbf.pos;return new pu(this._pbf,n,this.extent,this._keys,this._values)}}function oh(r,t,n){r===15?t.version=n.readVarint():r===1?t.name=n.readString():r===5?t.extent=n.readVarint():r===2?t._features.push(n.pos):r===3?t._keys.push(n.readString()):r===4&&t._values.push((function(l){let d=null;const v=l.readVarint()+l.pos;for(;l.pos<v;){const x=l.readVarint()>>3;d=x===1?l.readString():x===2?l.readFloat():x===3?l.readDouble():x===4?l.readVarint64():x===5?l.readVarint():x===6?l.readSVarint():x===7?l.readBoolean():null}if(d==null)throw new Error("unknown feature value");return d})(n))}class qp{constructor(t,n){this.layers=t.readFields(ag,{},n)}}function ag(r,t,n){if(r===3){const l=new sh(n,n.readVarint()+n.pos);l.length&&(t[l.name]=l)}}const mu=Math.pow(2,13);function lh(r,t,n,l,d,v,x,S){r.emplaceBack(t,n,2*Math.floor(l*mu)+x,d*mu*2,v*mu*2,Math.round(S))}class ch{constructor(t){this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((n=>n.id)),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Ne,this.centroidVertexArray=new fe,this.indexArray=new qi,this.programConfigurations=new On(t.layers,t.zoom),this.segments=new oi,this.stateDependentLayerIds=this.layers.filter((n=>n.isStateDependent())).map((n=>n.id))}populate(t,n,l){this.features=[],this.hasPattern=Ju("fill-extrusion",this.layers,n);for(const{feature:d,id:v,index:x,sourceLayerIndex:S}of t){const M=this.layers[0]._featureFilter.needGeometry,z=La(d,M);if(!this.layers[0]._featureFilter.filter(new ji(this.zoom,{globalState:this.globalState}),z,l))continue;const D={id:v,sourceLayerIndex:S,index:x,geometry:M?z.geometry:ln(d),properties:d.properties,type:d.type,patterns:{}};this.hasPattern?this.features.push(cu("fill-extrusion",this.layers,D,this.zoom,n)):this.addFeature(D,D.geometry,x,l,{},n.subdivisionGranularity),n.featureIndex.insert(d,D.geometry,x,S,this.index,!0)}}addFeatures(t,n,l){for(const d of this.features){const{geometry:v}=d;this.addFeature(d,v,d.index,n,l,t.subdivisionGranularity)}}update(t,n,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,{imagePositions:l,globalState:this.globalState})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ro),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,Zp.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,n,l,d,v,x){for(const S of Ul(n,500)){const M={x:0,y:0,sampleCount:0},z=this.layoutVertexArray.length;this.processPolygon(M,d,t,S,x);const D=this.layoutVertexArray.length-z,B=Math.floor(M.x/M.sampleCount),V=Math.floor(M.y/M.sampleCount);for(let $=0;$<D;$++)this.centroidVertexArray.emplaceBack(B,V)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,{imagePositions:v,canonical:d,globalState:this.globalState})}processPolygon(t,n,l,d,v){if(d.length<1||og(d[0]))return;for(const B of d)B.length!==0&&sg(t,B);const x={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},S=v.fill.getGranularityForZoomLevel(n.z),M=pu.types[l.type]==="Polygon";for(const B of d){if(B.length===0||og(B))continue;const V=_l(B,S,M);this._generateSideFaces(V,x)}if(!M)return;const z=rg(d,n,S,!1),D=this.layoutVertexArray;Ss(((B,V)=>{lh(D,B,V,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,z.verticesFlattened,z.indicesTriangles)}_generateSideFaces(t,n){let l=0;for(let d=1;d<t.length;d++){const v=t[d],x=t[d-1];if(C_(v,x))continue;n.segment.vertexLength+4>oi.MAX_VERTEX_ARRAY_LENGTH&&(n.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const S=v.sub(x)._perp()._unit(),M=x.dist(v);l+M>32768&&(l=0),lh(this.layoutVertexArray,v.x,v.y,S.x,S.y,0,0,l),lh(this.layoutVertexArray,v.x,v.y,S.x,S.y,0,1,l),l+=M,lh(this.layoutVertexArray,x.x,x.y,S.x,S.y,0,0,l),lh(this.layoutVertexArray,x.x,x.y,S.x,S.y,0,1,l);const z=n.segment.vertexLength;this.indexArray.emplaceBack(z,z+2,z+1),this.indexArray.emplaceBack(z+1,z+2,z+3),n.segment.vertexLength+=4,n.segment.primitiveLength+=2}}}function sg(r,t){for(let n=0;n<t.length;n++){const l=t[n];n===t.length-1&&t[0].x===l.x&&t[0].y===l.y||(r.x+=l.x,r.y+=l.y,r.sampleCount++)}}function C_(r,t){return r.x===t.x&&(r.x<0||r.x>St)||r.y===t.y&&(r.y<0||r.y>St)}function og(r){return r.every((t=>t.x<0))||r.every((t=>t.x>St))||r.every((t=>t.y<0))||r.every((t=>t.y>St))}let nn;Mt("FillExtrusionBucket",ch,{omit:["layers","features"]});var Tn={get paint(){return nn=nn||new Hr({"fill-extrusion-opacity":new Pt(Ie["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ft(Ie["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Pt(Ie["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Pt(Ie["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new fl(Ie["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ft(Ie["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ft(Ie["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Pt(Ie["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class zi extends ra{constructor(t){super(t,Tn)}createBucket(t){return new ch(t)}queryRadius(){return ld(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:l,geometry:d,transform:v,pixelsToTileUnits:x,pixelPosMatrix:S}){const M=sr(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-v.bearingInRadians,x),z=this.paint.get("fill-extrusion-height").evaluate(n,l),D=this.paint.get("fill-extrusion-base").evaluate(n,l),B=(function($,H){const K=[];for(const ne of $){const ce=[ne.x,ne.y,0,1];Gt(ce,ce,H),K.push(new L(ce[0]/ce[3],ce[1]/ce[3]))}return K})(M,S),V=(function($,H,K,ne){const ce=[],Ae=[],_e=ne[8]*H,xe=ne[9]*H,Ue=ne[10]*H,Ye=ne[11]*H,ot=ne[8]*K,xt=ne[9]*K,gt=ne[10]*K,yt=ne[11]*K;for(const Ot of $){const bt=[],vt=[];for(const et of Ot){const Xt=et.x,Qt=et.y,Ut=ne[0]*Xt+ne[4]*Qt+ne[12],zt=ne[1]*Xt+ne[5]*Qt+ne[13],di=ne[2]*Xt+ne[6]*Qt+ne[14],Hi=ne[3]*Xt+ne[7]*Qt+ne[15],un=di+Ue,er=Hi+Ye,Jr=Ut+ot,tr=zt+xt,Sr=di+gt,yn=Hi+yt,jn=new L((Ut+_e)/er,(zt+xe)/er);jn.z=un/er,bt.push(jn);const Tr=new L(Jr/yn,tr/yn);Tr.z=Sr/yn,vt.push(Tr)}ce.push(bt),Ae.push(vt)}return[ce,Ae]})(d,D,z,S);return(function($,H,K){let ne=1/0;sd(K,H)&&(ne=rn(K,H[0]));for(let ce=0;ce<H.length;ce++){const Ae=H[ce],_e=$[ce];for(let xe=0;xe<Ae.length-1;xe++){const Ue=Ae[xe],Ye=[Ue,Ae[xe+1],_e[xe+1],_e[xe],Ue];Rp(K,Ye)&&(ne=Math.min(ne,rn(K,Ye)))}}return ne!==1/0&&ne})(V[0],V[1],B)}}function Mi(r,t){return r.x*t.x+r.y*t.y}function rn(r,t){if(r.length===1){let n=0;const l=t[n++];let d;for(;!d||l.equals(d);)if(d=t[n++],!d)return 1/0;for(;n<t.length;n++){const v=t[n],x=r[0],S=d.sub(l),M=v.sub(l),z=x.sub(l),D=Mi(S,S),B=Mi(S,M),V=Mi(M,M),$=Mi(z,S),H=Mi(z,M),K=D*V-B*B,ne=(V*$-B*H)/K,ce=(D*H-B*$)/K,Ae=l.z*(1-ne-ce)+d.z*ne+v.z*ce;if(isFinite(Ae))return Ae}return 1/0}{let n=1/0;for(const l of t)n=Math.min(n,l.z);return n}}const is=kn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:oc}=is,uh=kn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:$p}=uh,vl=Math.cos(Math.PI/180*37.5),Hn=Math.pow(2,14)/.5;class zo{constructor(t){this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((n=>n.id)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((n=>{this.gradients[n.id]={}})),this.layoutVertexArray=new Fe,this.layoutVertexArray2=new Ze,this.indexArray=new qi,this.programConfigurations=new On(t.layers,t.zoom),this.segments=new oi,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((n=>n.isStateDependent())).map((n=>n.id))}populate(t,n,l){this.hasPattern=Ju("line",this.layers,n);const d=this.layers[0].layout.get("line-sort-key"),v=!d.isConstant(),x=[];for(const{feature:S,id:M,index:z,sourceLayerIndex:D}of t){const B=this.layers[0]._featureFilter.needGeometry,V=La(S,B);if(!this.layers[0]._featureFilter.filter(new ji(this.zoom,{globalState:this.globalState}),V,l))continue;const $=v?d.evaluate(V,{},l):void 0,H={id:M,properties:S.properties,type:S.type,sourceLayerIndex:D,index:z,geometry:B?V.geometry:ln(S),patterns:{},sortKey:$};x.push(H)}v&&x.sort(((S,M)=>S.sortKey-M.sortKey));for(const S of x){const{geometry:M,index:z,sourceLayerIndex:D}=S;if(this.hasPattern){const B=cu("line",this.layers,S,this.zoom,n);this.patternFeatures.push(B)}else this.addFeature(S,M,z,l,{},n.subdivisionGranularity);n.featureIndex.insert(t[z].feature,M,z,D,this.index)}}update(t,n,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,{imagePositions:l,globalState:this.globalState})}addFeatures(t,n,l){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,n,l,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,$p)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,oc),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,n,l,d,v,x){const S=this.layers[0].layout,M=S.get("line-join").evaluate(t,{}),z=S.get("line-cap"),D=S.get("line-miter-limit"),B=S.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const V of n)this.addLine(V,t,M,z,D,B,d,x);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,{imagePositions:v,canonical:d,globalState:this.globalState})}addLine(t,n,l,d,v,x,S,M){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=_l(t,S?M.line.getGranularityForZoomLevel(S.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let _e=0;_e<t.length-1;_e++)this.totalDistance+=t[_e].dist(t[_e+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const z=pu.types[n.type]==="Polygon";let D=t.length;for(;D>=2&&t[D-1].equals(t[D-2]);)D--;let B=0;for(;B<D-1&&t[B].equals(t[B+1]);)B++;if(D<(z?3:2))return;l==="bevel"&&(v=1.05);const V=this.overscaling<=16?122880/(512*this.overscaling):0,$=this.segments.prepareSegment(10*D,this.layoutVertexArray,this.indexArray);let H,K,ne,ce,Ae;this.e1=this.e2=-1,z&&(H=t[D-2],Ae=t[B].sub(H)._unit()._perp());for(let _e=B;_e<D;_e++){if(ne=_e===D-1?z?t[B+1]:void 0:t[_e+1],ne&&t[_e].equals(ne))continue;Ae&&(ce=Ae),H&&(K=H),H=t[_e],Ae=ne?ne.sub(H)._unit()._perp():ce,ce=ce||Ae;let xe=ce.add(Ae);xe.x===0&&xe.y===0||xe._unit();const Ue=ce.x*Ae.x+ce.y*Ae.y,Ye=xe.x*Ae.x+xe.y*Ae.y,ot=Ye!==0?1/Ye:1/0,xt=2*Math.sqrt(2-2*Ye),gt=Ye<vl&&K&&ne,yt=ce.x*Ae.y-ce.y*Ae.x>0;if(gt&&_e>B){const vt=H.dist(K);if(vt>2*V){const et=H.sub(H.sub(K)._mult(V/vt)._round());this.updateDistance(K,et),this.addCurrentVertex(et,ce,0,0,$),K=et}}const Ot=K&&ne;let bt=Ot?l:z?"butt":d;if(Ot&&bt==="round"&&(ot<x?bt="miter":ot<=2&&(bt="fakeround")),bt==="miter"&&ot>v&&(bt="bevel"),bt==="bevel"&&(ot>2&&(bt="flipbevel"),ot<v&&(bt="miter")),K&&this.updateDistance(K,H),bt==="miter")xe._mult(ot),this.addCurrentVertex(H,xe,0,0,$);else if(bt==="flipbevel"){if(ot>100)xe=Ae.mult(-1);else{const vt=ot*ce.add(Ae).mag()/ce.sub(Ae).mag();xe._perp()._mult(vt*(yt?-1:1))}this.addCurrentVertex(H,xe,0,0,$),this.addCurrentVertex(H,xe.mult(-1),0,0,$)}else if(bt==="bevel"||bt==="fakeround"){const vt=-Math.sqrt(ot*ot-1),et=yt?vt:0,Xt=yt?0:vt;if(K&&this.addCurrentVertex(H,ce,et,Xt,$),bt==="fakeround"){const Qt=Math.round(180*xt/Math.PI/20);for(let Ut=1;Ut<Qt;Ut++){let zt=Ut/Qt;if(zt!==.5){const Hi=zt-.5;zt+=zt*Hi*(zt-1)*((1.0904+Ue*(Ue*(3.55645-1.43519*Ue)-3.2452))*Hi*Hi+(.848013+Ue*(.215638*Ue-1.06021)))}const di=Ae.sub(ce)._mult(zt)._add(ce)._unit()._mult(yt?-1:1);this.addHalfVertex(H,di.x,di.y,!1,yt,0,$)}}ne&&this.addCurrentVertex(H,Ae,-et,-Xt,$)}else if(bt==="butt")this.addCurrentVertex(H,xe,0,0,$);else if(bt==="square"){const vt=K?1:-1;this.addCurrentVertex(H,xe,vt,vt,$)}else bt==="round"&&(K&&(this.addCurrentVertex(H,ce,0,0,$),this.addCurrentVertex(H,ce,1,1,$,!0)),ne&&(this.addCurrentVertex(H,Ae,-1,-1,$,!0),this.addCurrentVertex(H,Ae,0,0,$)));if(gt&&_e<D-1){const vt=H.dist(ne);if(vt>2*V){const et=H.add(ne.sub(H)._mult(V/vt)._round());this.updateDistance(H,et),this.addCurrentVertex(et,Ae,0,0,$),H=et}}}}addCurrentVertex(t,n,l,d,v,x=!1){const S=n.y*d-n.x,M=-n.y-n.x*d;this.addHalfVertex(t,n.x+n.y*l,n.y-n.x*l,x,!1,l,v),this.addHalfVertex(t,S,M,x,!0,-d,v),this.distance>Hn/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,n,l,d,v,x))}addHalfVertex({x:t,y:n},l,d,v,x,S,M){const z=.5*(this.lineClips?this.scaledDistance*(Hn-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(v?1:0),(n<<1)+(x?1:0),Math.round(63*l)+128,Math.round(63*d)+128,1+(S===0?0:S<0?-1:1)|(63&z)<<2,z>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const D=M.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,D,this.e2),M.primitiveLength++),x?this.e2=D:this.e1=D}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,n){this.distance+=t.dist(n),this.updateScaledDistance()}}let lc,Cf;Mt("LineBucket",zo,{omit:["layers","patternFeatures"]});var ns={get paint(){return Cf=Cf||new Hr({"line-opacity":new Ft(Ie.paint_line["line-opacity"]),"line-color":new Ft(Ie.paint_line["line-color"]),"line-translate":new Pt(Ie.paint_line["line-translate"]),"line-translate-anchor":new Pt(Ie.paint_line["line-translate-anchor"]),"line-width":new Ft(Ie.paint_line["line-width"]),"line-gap-width":new Ft(Ie.paint_line["line-gap-width"]),"line-offset":new Ft(Ie.paint_line["line-offset"]),"line-blur":new Ft(Ie.paint_line["line-blur"]),"line-dasharray":new za(Ie.paint_line["line-dasharray"]),"line-pattern":new fl(Ie.paint_line["line-pattern"]),"line-gradient":new Vs(Ie.paint_line["line-gradient"])})},get layout(){return lc=lc||new Hr({"line-cap":new Pt(Ie.layout_line["line-cap"]),"line-join":new Ft(Ie.layout_line["line-join"]),"line-miter-limit":new Pt(Ie.layout_line["line-miter-limit"]),"line-round-limit":new Pt(Ie.layout_line["line-round-limit"]),"line-sort-key":new Ft(Ie.layout_line["line-sort-key"])})}};class hh extends Ft{possiblyEvaluate(t,n){return n=new ji(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),super.possiblyEvaluate(t,n)}evaluate(t,n,l,d){return n=Nt({},n,{zoom:Math.floor(n.zoom)}),super.evaluate(t,n,l,d)}}let cc;class Ba extends ra{constructor(t){super(t,ns),this.gradientVersion=0,cc||(cc=new hh(ns.paint.properties["line-width"].specification),cc.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const n=this.gradientExpression();this.stepInterpolant=!!(function(l){return l._styleExpression!==void 0})(n)&&n._styleExpression.expression instanceof In,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,n){super.recalculate(t,n),this.paint._values["line-floorwidth"]=cc.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new zo(t)}queryRadius(t){const n=t,l=Ef(od("line-width",this,n),od("line-gap-width",this,n)),d=od("line-offset",this,n);return l/2+Math.abs(d)+ld(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:l,geometry:d,transform:v,pixelsToTileUnits:x}){const S=sr(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-v.bearingInRadians,x),M=x/2*Ef(this.paint.get("line-width").evaluate(n,l),this.paint.get("line-gap-width").evaluate(n,l)),z=this.paint.get("line-offset").evaluate(n,l);return z&&(d=(function(D,B){const V=[];for(let $=0;$<D.length;$++){const H=D[$],K=[];for(let ne=0;ne<H.length;ne++){const ce=H[ne-1],Ae=H[ne],_e=H[ne+1],xe=ne===0?new L(0,0):Ae.sub(ce)._unit()._perp(),Ue=ne===H.length-1?new L(0,0):_e.sub(Ae)._unit()._perp(),Ye=xe._add(Ue)._unit(),ot=Ye.x*Ue.x+Ye.y*Ue.y;ot!==0&&Ye._mult(1/ot),K.push(Ye._mult(B)._add(Ae))}V.push(K)}return V})(d,z*x)),(function(D,B,V){for(let $=0;$<B.length;$++){const H=B[$];if(D.length>=3){for(let K=0;K<H.length;K++)if(ou(D,H[K]))return!0}if(Gm(D,H,V))return!0}return!1})(S,d,M)}isTileClipped(){return!0}}function Ef(r,t){return t>0?t+2*r:r}const Hp=kn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Mf=kn([{name:"a_projected_pos",components:3,type:"Float32"}],4);kn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Af=kn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);kn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const xl=kn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Qr=kn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function uc(r,t,n){return r.sections.forEach((l=>{l.text=(function(d,v,x){const S=v.layout.get("text-transform").evaluate(x,{});return S==="uppercase"?d=d.toLocaleUpperCase():S==="lowercase"&&(d=d.toLocaleLowerCase()),Br.applyArabicShaping&&(d=Br.applyArabicShaping(d)),d})(l.text,t,n)})),r}kn([{name:"triangle",components:3,type:"Uint16"}]),kn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),kn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),kn([{type:"Float32",name:"offsetX"}]),kn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),kn([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Io={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Pn=24;const md=4294967296,Pf=1/md,Xp=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class gu{constructor(t=new Uint8Array(16)){this.buf=ArrayBuffer.isView(t)?t:new Uint8Array(t),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(t,n,l=this.length){for(;this.pos<l;){const d=this.readVarint(),v=d>>3,x=this.pos;this.type=7&d,t(v,n,this),this.pos===x&&this.skip(d)}return n}readMessage(t,n){return this.readFields(t,n,this.readVarint()+this.pos)}readFixed32(){const t=this.dataView.getUint32(this.pos,!0);return this.pos+=4,t}readSFixed32(){const t=this.dataView.getInt32(this.pos,!0);return this.pos+=4,t}readFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*md;return this.pos+=8,t}readSFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*md;return this.pos+=8,t}readFloat(){const t=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,t}readDouble(){const t=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,t}readVarint(t){const n=this.buf;let l,d;return d=n[this.pos++],l=127&d,d<128?l:(d=n[this.pos++],l|=(127&d)<<7,d<128?l:(d=n[this.pos++],l|=(127&d)<<14,d<128?l:(d=n[this.pos++],l|=(127&d)<<21,d<128?l:(d=n[this.pos],l|=(15&d)<<28,(function(v,x,S){const M=S.buf;let z,D;if(D=M[S.pos++],z=(112&D)>>4,D<128||(D=M[S.pos++],z|=(127&D)<<3,D<128)||(D=M[S.pos++],z|=(127&D)<<10,D<128)||(D=M[S.pos++],z|=(127&D)<<17,D<128)||(D=M[S.pos++],z|=(127&D)<<24,D<128)||(D=M[S.pos++],z|=(1&D)<<31,D<128))return hc(v,z,x);throw new Error("Expected varint not more than 10 bytes")})(l,t,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const t=this.readVarint();return t%2==1?(t+1)/-2:t/2}readBoolean(){return!!this.readVarint()}readString(){const t=this.readVarint()+this.pos,n=this.pos;return this.pos=t,t-n>=12&&Xp?Xp.decode(this.buf.subarray(n,t)):(function(l,d,v){let x="",S=d;for(;S<v;){const M=l[S];let z,D,B,V=null,$=M>239?4:M>223?3:M>191?2:1;if(S+$>v)break;$===1?M<128&&(V=M):$===2?(z=l[S+1],(192&z)==128&&(V=(31&M)<<6|63&z,V<=127&&(V=null))):$===3?(z=l[S+1],D=l[S+2],(192&z)==128&&(192&D)==128&&(V=(15&M)<<12|(63&z)<<6|63&D,(V<=2047||V>=55296&&V<=57343)&&(V=null))):$===4&&(z=l[S+1],D=l[S+2],B=l[S+3],(192&z)==128&&(192&D)==128&&(192&B)==128&&(V=(15&M)<<18|(63&z)<<12|(63&D)<<6|63&B,(V<=65535||V>=1114112)&&(V=null))),V===null?(V=65533,$=1):V>65535&&(V-=65536,x+=String.fromCharCode(V>>>10&1023|55296),V=56320|1023&V),x+=String.fromCharCode(V),S+=$}return x})(this.buf,n,t)}readBytes(){const t=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,t);return this.pos=t,n}readPackedVarint(t=[],n){const l=this.readPackedEnd();for(;this.pos<l;)t.push(this.readVarint(n));return t}readPackedSVarint(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readSVarint());return t}readPackedBoolean(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readBoolean());return t}readPackedFloat(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readFloat());return t}readPackedDouble(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readDouble());return t}readPackedFixed32(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readFixed32());return t}readPackedSFixed32(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readSFixed32());return t}readPackedFixed64(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readFixed64());return t}readPackedSFixed64(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readSFixed64());return t}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(t){const n=7&t;if(n===0)for(;this.buf[this.pos++]>127;);else if(n===2)this.pos=this.readVarint()+this.pos;else if(n===5)this.pos+=4;else{if(n!==1)throw new Error(`Unimplemented type: ${n}`);this.pos+=8}}writeTag(t,n){this.writeVarint(t<<3|n)}realloc(t){let n=this.length||16;for(;n<this.pos+t;)n*=2;if(n!==this.length){const l=new Uint8Array(n);l.set(this.buf),this.buf=l,this.dataView=new DataView(l.buffer),this.length=n}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeSFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,-1&t,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*Pf),!0),this.pos+=8}writeSFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,-1&t,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*Pf),!0),this.pos+=8}writeVarint(t){(t=+t||0)>268435455||t<0?(function(n,l){let d,v;if(n>=0?(d=n%4294967296|0,v=n/4294967296|0):(d=~(-n%4294967296),v=~(-n/4294967296),4294967295^d?d=d+1|0:(d=0,v=v+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");l.realloc(10),(function(x,S,M){M.buf[M.pos++]=127&x|128,x>>>=7,M.buf[M.pos++]=127&x|128,x>>>=7,M.buf[M.pos++]=127&x|128,x>>>=7,M.buf[M.pos++]=127&x|128,M.buf[M.pos]=127&(x>>>=7)})(d,0,l),(function(x,S){const M=(7&x)<<4;S.buf[S.pos++]|=M|((x>>>=3)?128:0),x&&(S.buf[S.pos++]=127&x|((x>>>=7)?128:0),x&&(S.buf[S.pos++]=127&x|((x>>>=7)?128:0),x&&(S.buf[S.pos++]=127&x|((x>>>=7)?128:0),x&&(S.buf[S.pos++]=127&x|((x>>>=7)?128:0),x&&(S.buf[S.pos++]=127&x)))))})(v,l)})(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))}writeSVarint(t){this.writeVarint(t<0?2*-t-1:2*t)}writeBoolean(t){this.writeVarint(+t)}writeString(t){t=String(t),this.realloc(4*t.length),this.pos++;const n=this.pos;this.pos=(function(d,v,x){for(let S,M,z=0;z<v.length;z++){if(S=v.charCodeAt(z),S>55295&&S<57344){if(!M){S>56319||z+1===v.length?(d[x++]=239,d[x++]=191,d[x++]=189):M=S;continue}if(S<56320){d[x++]=239,d[x++]=191,d[x++]=189,M=S;continue}S=M-55296<<10|S-56320|65536,M=null}else M&&(d[x++]=239,d[x++]=191,d[x++]=189,M=null);S<128?d[x++]=S:(S<2048?d[x++]=S>>6|192:(S<65536?d[x++]=S>>12|224:(d[x++]=S>>18|240,d[x++]=S>>12&63|128),d[x++]=S>>6&63|128),d[x++]=63&S|128)}return x})(this.buf,t,this.pos);const l=this.pos-n;l>=128&&Na(n,l,this),this.pos=n-1,this.writeVarint(l),this.pos+=l}writeFloat(t){this.realloc(4),this.dataView.setFloat32(this.pos,t,!0),this.pos+=4}writeDouble(t){this.realloc(8),this.dataView.setFloat64(this.pos,t,!0),this.pos+=8}writeBytes(t){const n=t.length;this.writeVarint(n),this.realloc(n);for(let l=0;l<n;l++)this.buf[this.pos++]=t[l]}writeRawMessage(t,n){this.pos++;const l=this.pos;t(n,this);const d=this.pos-l;d>=128&&Na(l,d,this),this.pos=l-1,this.writeVarint(d),this.pos+=d}writeMessage(t,n,l){this.writeTag(t,2),this.writeRawMessage(n,l)}writePackedVarint(t,n){n.length&&this.writeMessage(t,lg,n)}writePackedSVarint(t,n){n.length&&this.writeMessage(t,rs,n)}writePackedBoolean(t,n){n.length&&this.writeMessage(t,E_,n)}writePackedFloat(t,n){n.length&&this.writeMessage(t,cg,n)}writePackedDouble(t,n){n.length&&this.writeMessage(t,ug,n)}writePackedFixed32(t,n){n.length&&this.writeMessage(t,dc,n)}writePackedSFixed32(t,n){n.length&&this.writeMessage(t,Rf,n)}writePackedFixed64(t,n){n.length&&this.writeMessage(t,Yp,n)}writePackedSFixed64(t,n){n.length&&this.writeMessage(t,dh,n)}writeBytesField(t,n){this.writeTag(t,2),this.writeBytes(n)}writeFixed32Field(t,n){this.writeTag(t,5),this.writeFixed32(n)}writeSFixed32Field(t,n){this.writeTag(t,5),this.writeSFixed32(n)}writeFixed64Field(t,n){this.writeTag(t,1),this.writeFixed64(n)}writeSFixed64Field(t,n){this.writeTag(t,1),this.writeSFixed64(n)}writeVarintField(t,n){this.writeTag(t,0),this.writeVarint(n)}writeSVarintField(t,n){this.writeTag(t,0),this.writeSVarint(n)}writeStringField(t,n){this.writeTag(t,2),this.writeString(n)}writeFloatField(t,n){this.writeTag(t,5),this.writeFloat(n)}writeDoubleField(t,n){this.writeTag(t,1),this.writeDouble(n)}writeBooleanField(t,n){this.writeVarintField(t,+n)}}function hc(r,t,n){return n?4294967296*t+(r>>>0):4294967296*(t>>>0)+(r>>>0)}function Na(r,t,n){const l=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));n.realloc(l);for(let d=n.pos-1;d>=r;d--)n.buf[d+l]=n.buf[d]}function lg(r,t){for(let n=0;n<r.length;n++)t.writeVarint(r[n])}function rs(r,t){for(let n=0;n<r.length;n++)t.writeSVarint(r[n])}function cg(r,t){for(let n=0;n<r.length;n++)t.writeFloat(r[n])}function ug(r,t){for(let n=0;n<r.length;n++)t.writeDouble(r[n])}function E_(r,t){for(let n=0;n<r.length;n++)t.writeBoolean(r[n])}function dc(r,t){for(let n=0;n<r.length;n++)t.writeFixed32(r[n])}function Rf(r,t){for(let n=0;n<r.length;n++)t.writeSFixed32(r[n])}function Yp(r,t){for(let n=0;n<r.length;n++)t.writeFixed64(r[n])}function dh(r,t){for(let n=0;n<r.length;n++)t.writeSFixed64(r[n])}function hg(r,t,n){r===1&&n.readMessage(dg,t)}function dg(r,t,n){if(r===3){const{id:l,bitmap:d,width:v,height:x,left:S,top:M,advance:z}=n.readMessage(fg,{});t.push({id:l,bitmap:new lu({width:v+6,height:x+6},d),metrics:{width:v,height:x,left:S,top:M,advance:z}})}}function fg(r,t,n){r===1?t.id=n.readVarint():r===2?t.bitmap=n.readBytes():r===3?t.width=n.readVarint():r===4?t.height=n.readVarint():r===5?t.left=n.readSVarint():r===6?t.top=n.readSVarint():r===7&&(t.advance=n.readVarint())}function zf(r){let t=0,n=0;for(const x of r)t+=x.w*x.h,n=Math.max(n,x.w);r.sort(((x,S)=>S.h-x.h));const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),n),h:1/0}];let d=0,v=0;for(const x of r)for(let S=l.length-1;S>=0;S--){const M=l[S];if(!(x.w>M.w||x.h>M.h)){if(x.x=M.x,x.y=M.y,v=Math.max(v,x.y+x.h),d=Math.max(d,x.x+x.w),x.w===M.w&&x.h===M.h){const z=l.pop();z&&S<l.length&&(l[S]=z)}else x.h===M.h?(M.x+=x.w,M.w-=x.w):x.w===M.w?(M.y+=x.h,M.h-=x.h):(l.push({x:M.x+x.w,y:M.y,w:M.w-x.w,h:x.h}),M.y+=x.h,M.h-=x.h);break}}return{w:d,h:v,fill:t/(d*v)||0}}class gd{constructor(t,{pixelRatio:n,version:l,stretchX:d,stretchY:v,content:x,textFitWidth:S,textFitHeight:M}){this.paddedRect=t,this.pixelRatio=n,this.stretchX=d,this.stretchY=v,this.content=x,this.version=l,this.textFitWidth=S,this.textFitHeight=M}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class pg{constructor(t,n){const l={},d={};this.haveRenderCallbacks=[];const v=[];this.addImages(t,l,v),this.addImages(n,d,v);const{w:x,h:S}=zf(v),M=new Wr({width:x||1,height:S||1});for(const z in t){const D=t[z],B=l[z].paddedRect;Wr.copy(D.data,M,{x:0,y:0},{x:B.x+1,y:B.y+1},D.data)}for(const z in n){const D=n[z],B=d[z].paddedRect,V=B.x+1,$=B.y+1,H=D.data.width,K=D.data.height;Wr.copy(D.data,M,{x:0,y:0},{x:V,y:$},D.data),Wr.copy(D.data,M,{x:0,y:K-1},{x:V,y:$-1},{width:H,height:1}),Wr.copy(D.data,M,{x:0,y:0},{x:V,y:$+K},{width:H,height:1}),Wr.copy(D.data,M,{x:H-1,y:0},{x:V-1,y:$},{width:1,height:K}),Wr.copy(D.data,M,{x:0,y:0},{x:V+H,y:$},{width:1,height:K})}this.image=M,this.iconPositions=l,this.patternPositions=d}addImages(t,n,l){for(const d in t){const v=t[d],x={x:0,y:0,w:v.data.width+2,h:v.data.height+2};l.push(x),n[d]=new gd(x,v),v.hasRenderCallback&&this.haveRenderCallbacks.push(d)}}patchUpdatedImages(t,n){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const l in t.updatedImages)this.patchUpdatedImage(this.iconPositions[l],t.getImage(l),n),this.patchUpdatedImage(this.patternPositions[l],t.getImage(l),n)}patchUpdatedImage(t,n,l){if(!t||!n||t.version===n.version)return;t.version=n.version;const[d,v]=t.tl;l.update(n.data,void 0,{x:d,y:v})}}var fc;Mt("ImagePosition",gd),Mt("ImageAtlas",pg),T.ao=void 0,(fc=T.ao||(T.ao={}))[fc.none=0]="none",fc[fc.horizontal=1]="horizontal",fc[fc.vertical=2]="vertical",fc[fc.horizontalOnly=3]="horizontalOnly";class _d{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(t,n,l){const d=new _d;return d.scale=t||1,d.fontStack=n,d.verticalAlign=l||"bottom",d}static forImage(t,n){const l=new _d;return l.imageName=t,l.verticalAlign=n||"bottom",l}}class _u{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,n){const l=new _u;for(let d=0;d<t.sections.length;d++){const v=t.sections[d];v.image?l.addImageSection(v):l.addTextSection(v,n)}return l}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=(function(t){let n="";for(let l=0;l<t.length;l++){const d=t.charCodeAt(l+1)||null,v=t.charCodeAt(l-1)||null;n+=d&&Yu(d)&&!Io[t[l+1]]||v&&Yu(v)&&!Io[t[l-1]]||!Io[t[l]]?t[l]:Io[t[l]]}return n})(this.text)}trim(){let t=0;for(let l=0;l<this.text.length&&bl[this.text.charCodeAt(l)];l++)t++;let n=this.text.length;for(let l=this.text.length-1;l>=0&&l>=t&&bl[this.text.charCodeAt(l)];l--)n--;this.text=this.text.substring(t,n),this.sectionIndex=this.sectionIndex.slice(t,n)}substring(t,n){const l=new _u;return l.text=this.text.substring(t,n),l.sectionIndex=this.sectionIndex.slice(t,n),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((t,n)=>Math.max(t,this.sections[n].scale)),0)}getMaxImageSize(t){let n=0,l=0;for(let d=0;d<this.length();d++){const v=this.getSection(d);if(v.imageName){const x=t[v.imageName];if(!x)continue;const S=x.displaySize;n=Math.max(n,S[0]),l=Math.max(l,S[1])}}return{maxImageWidth:n,maxImageHeight:l}}addTextSection(t,n){this.text+=t.text,this.sections.push(_d.forText(t.scale,t.fontStack||n,t.verticalAlign));const l=this.sections.length-1;for(let d=0;d<t.text.length;++d)this.sectionIndex.push(l)}addImageSection(t){const n=t.image?t.image.name:"";if(n.length===0)return void ki("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(_d.forImage(n,t.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):ki("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function yd(r,t,n,l,d,v,x,S,M,z,D,B,V,$,H){const K=_u.fromFeature(r,d);let ne;B===T.ao.vertical&&K.verticalizePunctuation();const{processBidirectionalText:ce,processStyledBidirectionalText:Ae}=Br;if(ce&&K.sections.length===1){ne=[];const Ue=ce(K.toString(),fh(K,z,v,t,l,$));for(const Ye of Ue){const ot=new _u;ot.text=Ye,ot.sections=K.sections;for(let xt=0;xt<Ye.length;xt++)ot.sectionIndex.push(0);ne.push(ot)}}else if(Ae){ne=[];const Ue=Ae(K.text,K.sectionIndex,fh(K,z,v,t,l,$));for(const Ye of Ue){const ot=new _u;ot.text=Ye[0],ot.sectionIndex=Ye[1],ot.sections=K.sections,ne.push(ot)}}else ne=(function(Ue,Ye){const ot=[],xt=Ue.text;let gt=0;for(const yt of Ye)ot.push(Ue.substring(gt,yt)),gt=yt;return gt<xt.length&&ot.push(Ue.substring(gt,xt.length)),ot})(K,fh(K,z,v,t,l,$));const _e=[],xe={positionedLines:_e,text:K.toString(),top:D[1],bottom:D[1],left:D[0],right:D[0],writingMode:B,iconsInText:!1,verticalizable:!1};return(function(Ue,Ye,ot,xt,gt,yt,Ot,bt,vt,et,Xt,Qt){let Ut=0,zt=0,di=0,Hi=0;const un=bt==="right"?1:bt==="left"?0:.5,er=Pn/Qt;let Jr=0;for(const yn of gt){yn.trim();const jn=yn.getMaxScale(),Tr={positionedGlyphs:[],lineOffset:0};Ue.positionedLines[Jr]=Tr;const ur=Tr.positionedGlyphs;let Cr=0;if(!yn.length()){zt+=yt,++Jr;continue}const Fa=_g(xt,yn,er);for(let Vr=0;Vr<yn.length();Vr++){const Fn=yn.getSection(Vr),or=yn.getSectionIndex(Vr),Un=yn.getCharCode(Vr),Vn=em(vt,Xt,Un);let Qi;if(Fn.imageName){if(Ue.iconsInText=!0,Fn.scale=Fn.scale*er,Qi=yg(Fn,Vn,jn,Fa,xt),!Qi)continue;Cr=Math.max(Cr,Qi.imageOffset)}else if(Qi=M_(Fn,Un,Vn,Fa,Ye,ot),!Qi)continue;const{rect:Ts,metrics:vh,baselineOffset:Ua}=Qi;ur.push({glyph:Un,imageName:Fn.imageName,x:Ut,y:zt+Ua+-17,vertical:Vn,scale:Fn.scale,fontStack:Fn.fontStack,sectionIndex:or,metrics:vh,rect:Ts}),Vn?(Ue.verticalizable=!0,Ut+=(Fn.imageName?vh.advance:Pn)*Fn.scale+et):Ut+=vh.advance*Fn.scale+et}ur.length!==0&&(di=Math.max(Ut-et,di),A_(ur,0,ur.length-1,un)),Ut=0,Tr.lineOffset=Math.max(Cr,(jn-1)*Pn);const hr=yt*jn+Cr;zt+=hr,Hi=Math.max(hr,Hi),++Jr}const{horizontalAlign:tr,verticalAlign:Sr}=Df(Ot);(function(yn,jn,Tr,ur,Cr,Fa,hr,Vr,Fn){const or=(jn-Tr)*Cr;let Un=0;Un=Fa!==hr?-Vr*ur- -17:-ur*Fn*hr+.5*hr;for(const Vn of yn)for(const Qi of Vn.positionedGlyphs)Qi.x+=or,Qi.y+=Un})(Ue.positionedLines,un,tr,Sr,di,Hi,yt,zt,gt.length),Ue.top+=-Sr*zt,Ue.bottom=Ue.top+zt,Ue.left+=-tr*di,Ue.right=Ue.left+di})(xe,t,n,l,ne,x,S,M,B,z,V,H),!(function(Ue){for(const Ye of Ue)if(Ye.positionedGlyphs.length!==0)return!1;return!0})(_e)&&xe}const bl={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},If={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},mg={40:!0};function Wp(r,t,n,l,d,v){if(t.imageName){const x=l[t.imageName];return x?x.displaySize[0]*t.scale*Pn/v+d:0}{const x=n[t.fontStack],S=x&&x[r];return S?S.metrics.advance*t.scale+d:0}}function Kp(r,t,n,l){const d=Math.pow(r-t,2);return l?r<t?d/2:2*d:d+Math.abs(n)*n}function gg(r,t,n){let l=0;return r===10&&(l-=1e4),n&&(l+=150),r!==40&&r!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function Qp(r,t,n,l,d,v){let x=null,S=Kp(t,n,d,v);for(const M of l){const z=Kp(t-M.x,n,d,v)+M.badness;z<=S&&(x=M,S=z)}return{index:r,x:t,priorBreak:x,badness:S}}function Jp(r){return r?Jp(r.priorBreak).concat(r.index):[]}function fh(r,t,n,l,d,v){if(!r)return[];const x=[],S=(function(B,V,$,H,K,ne){let ce=0;for(let Ae=0;Ae<B.length();Ae++){const _e=B.getSection(Ae);ce+=Wp(B.getCharCode(Ae),_e,H,K,V,ne)}return ce/Math.max(1,Math.ceil(ce/$))})(r,t,n,l,d,v),M=r.text.indexOf("")>=0;let z=0;for(let B=0;B<r.length();B++){const V=r.getSection(B),$=r.getCharCode(B);if(bl[$]||(z+=Wp($,V,l,d,t,v)),B<r.length()-1){const H=!((D=$)<11904)&&(!!Si["CJK Compatibility Forms"](D)||!!Si["CJK Compatibility"](D)||!!Si["CJK Strokes"](D)||!!Si["CJK Symbols and Punctuation"](D)||!!Si["Enclosed CJK Letters and Months"](D)||!!Si["Halfwidth and Fullwidth Forms"](D)||!!Si["Ideographic Description Characters"](D)||!!Si["Vertical Forms"](D)||cl.test(String.fromCodePoint(D)));(If[$]||H||V.imageName||B!==r.length()-2&&mg[r.getCharCode(B+1)])&&x.push(Qp(B+1,z,S,x,gg($,r.getCharCode(B+1),H&&M),!1))}}var D;return Jp(Qp(r.length(),z,S,x,0,!0))}function Df(r){let t=.5,n=.5;switch(r){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:t,verticalAlign:n}}function _g(r,t,n){const l=t.getMaxScale()*Pn,{maxImageWidth:d,maxImageHeight:v}=t.getMaxImageSize(r),x=Math.max(l,v*n);return{verticalLineContentWidth:Math.max(l,d*n),horizontalLineContentHeight:x}}function cn(r){switch(r){case"top":return 0;case"center":return .5;default:return 1}}function em(r,t,n){return!(r===T.ao.horizontal||!t&&!nu(n)||t&&(bl[n]||(l=n,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(l)))));var l}function M_(r,t,n,l,d,v){const x=v[r.fontStack],S=(function(z,D,B,V){if(z&&z.rect)return z;const $=D[B.fontStack],H=$&&$[V];return H?{rect:null,metrics:H.metrics}:null})(x&&x[t],d,r,t);if(S===null)return null;let M;if(n)M=l.verticalLineContentWidth-r.scale*Pn;else{const z=cn(r.verticalAlign);M=(l.horizontalLineContentHeight-r.scale*Pn)*z}return{rect:S.rect,metrics:S.metrics,baselineOffset:M}}function yg(r,t,n,l,d){const v=d[r.imageName];if(!v)return null;const x=v.paddedRect,S=v.displaySize,M={width:S[0],height:S[1],left:1,top:-3,advance:t?S[1]:S[0]};let z;if(t)z=l.verticalLineContentWidth-S[1]*r.scale;else{const D=cn(r.verticalAlign);z=(l.horizontalLineContentHeight-S[1]*r.scale)*D}return{rect:x,metrics:M,baselineOffset:z,imageOffset:(t?S[0]:S[1])*r.scale-Pn*n}}function A_(r,t,n,l){if(l===0)return;const d=r[n],v=(r[n].x+d.metrics.advance*d.scale)*l;for(let x=t;x<=n;x++)r[x].x-=v}function P_(r,t,n){const{horizontalAlign:l,verticalAlign:d}=Df(n),v=t[0]-r.displaySize[0]*l,x=t[1]-r.displaySize[1]*d;return{image:r,top:x,bottom:x+r.displaySize[1],left:v,right:v+r.displaySize[0]}}function vg(r){var t,n;let l=r.left,d=r.top,v=r.right-l,x=r.bottom-d;const S=(t=r.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",M=(n=r.image.textFitHeight)!==null&&n!==void 0?n:"stretchOrShrink",z=(r.image.content[2]-r.image.content[0])/(r.image.content[3]-r.image.content[1]);if(M==="proportional"){if(S==="stretchOnly"&&v/x<z||S==="proportional"){const D=Math.ceil(x*z);l*=D/v,v=D}}else if(S==="proportional"&&M==="stretchOnly"&&z!==0&&v/x>z){const D=Math.ceil(v/z);d*=D/x,x=D}return{x1:l,y1:d,x2:l+v,y2:d+x}}function vd(r,t,n,l,d,v){const x=r.image;let S;if(x.content){const ne=x.content,ce=x.pixelRatio||1;S=[ne[0]/ce,ne[1]/ce,x.displaySize[0]-ne[2]/ce,x.displaySize[1]-ne[3]/ce]}const M=t.left*v,z=t.right*v;let D,B,V,$;n==="width"||n==="both"?($=d[0]+M-l[3],B=d[0]+z+l[1]):($=d[0]+(M+z-x.displaySize[0])/2,B=$+x.displaySize[0]);const H=t.top*v,K=t.bottom*v;return n==="height"||n==="both"?(D=d[1]+H-l[0],V=d[1]+K+l[2]):(D=d[1]+(H+K-x.displaySize[1])/2,V=D+x.displaySize[1]),{image:x,top:D,right:B,bottom:V,left:$,collisionPadding:S}}const ja=128,Do=32640;function xd(r,t){const{expression:n}=t;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new ji(r+1))};if(n.kind==="source")return{kind:"source"};{const{zoomStops:l,interpolationType:d}=n;let v=0;for(;v<l.length&&l[v]<=r;)v++;v=Math.max(0,v-1);let x=v;for(;x<l.length&&l[x]<r+1;)x++;x=Math.min(l.length-1,x);const S=l[v],M=l[x];return n.kind==="composite"?{kind:"composite",minZoom:S,maxZoom:M,interpolationType:d}:{kind:"camera",minZoom:S,maxZoom:M,minSize:n.evaluate(new ji(S)),maxSize:n.evaluate(new ji(M)),interpolationType:d}}}function bd(r,t,n){let l="never";const d=r.get(t);return d?l=d:r.get(n)&&(l="always"),l}const yu=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function as(r,t,n,l,d,v,x,S,M,z,D,B,V){const $=S?Math.min(Do,Math.round(S[0])):0,H=S?Math.min(Do,Math.round(S[1])):0;r.emplaceBack(t,n,Math.round(32*l),Math.round(32*d),v,x,($<<1)+(M?1:0),H,16*z,16*D,256*B,256*V)}function vu(r,t,n){r.emplaceBack(t.x,t.y,n),r.emplaceBack(t.x,t.y,n),r.emplaceBack(t.x,t.y,n),r.emplaceBack(t.x,t.y,n)}function R_(r){for(const t of r.sections)if(rd(t.text))return!0;return!1}class kf{constructor(t){this.layoutVertexArray=new _t,this.indexArray=new qi,this.programConfigurations=t,this.segments=new oi,this.dynamicLayoutVertexArray=new st,this.opacityVertexArray=new Dt,this.hasVisibleVertices=!1,this.placedSymbolArray=new X}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,n,l,d){this.isEmpty()||(l&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Hp.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Mf.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,yu,!0),this.opacityVertexBuffer.itemSize=1),(l||d)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Mt("SymbolBuffers",kf);class Lf{constructor(t,n,l){this.layoutVertexArray=new t,this.layoutAttributes=n,this.indexArray=new l,this.segments=new oi,this.collisionVertexArray=new Ri}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Af.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Mt("CollisionBuffers",Lf);class xu{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((x=>x.id)),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=xd(this.zoom,n["text-size"]),this.iconSizeData=xd(this.zoom,n["icon-size"]);const l=this.layers[0].layout,d=l.get("symbol-sort-key"),v=l.get("symbol-z-order");this.canOverlap=bd(l,"text-overlap","text-allow-overlap")!=="never"||bd(l,"icon-overlap","icon-allow-overlap")!=="never"||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=v!=="viewport-y"&&!d.isConstant(),this.sortFeaturesByY=(v==="viewport-y"||v==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,l.get("symbol-placement")==="point"&&(this.writingModes=l.get("text-writing-mode").map((x=>T.ao[x]))),this.stateDependentLayerIds=this.layers.filter((x=>x.isStateDependent())).map((x=>x.id)),this.sourceID=t.sourceID}createArrays(){this.text=new kf(new On(this.layers,this.zoom,(t=>/^text/.test(t)))),this.icon=new kf(new On(this.layers,this.zoom,(t=>/^icon/.test(t)))),this.glyphOffsetArray=new oe,this.lineVertexArray=new ue,this.symbolInstances=new ae,this.textAnchorOffsets=new he}calculateGlyphDependencies(t,n,l,d,v){for(let x=0;x<t.length;x++)if(n[t.charCodeAt(x)]=!0,(l||d)&&v){const S=Io[t.charAt(x)];S&&(n[S.charCodeAt(0)]=!0)}}populate(t,n,l){const d=this.layers[0],v=d.layout,x=v.get("text-font"),S=v.get("text-field"),M=v.get("icon-image"),z=(S.value.kind!=="constant"||S.value.value instanceof Kn&&!S.value.value.isEmpty()||S.value.value.toString().length>0)&&(x.value.kind!=="constant"||x.value.value.length>0),D=M.value.kind!=="constant"||!!M.value.value||Object.keys(M.parameters).length>0,B=v.get("symbol-sort-key");if(this.features=[],!z&&!D)return;const V=n.iconDependencies,$=n.glyphDependencies,H=n.availableImages,K=new ji(this.zoom,{globalState:this.globalState});for(const{feature:ne,id:ce,index:Ae,sourceLayerIndex:_e}of t){const xe=d._featureFilter.needGeometry,Ue=La(ne,xe);if(!d._featureFilter.filter(K,Ue,l))continue;let Ye,ot;if(xe||(Ue.geometry=ln(ne)),z){const gt=d.getValueAndResolveTokens("text-field",Ue,l,H),yt=Kn.factory(gt),Ot=this.hasRTLText=this.hasRTLText||R_(yt);(!Ot||Br.getRTLTextPluginStatus()==="unavailable"||Ot&&Br.isParsed())&&(Ye=uc(yt,d,Ue))}if(D){const gt=d.getValueAndResolveTokens("icon-image",Ue,l,H);ot=gt instanceof yr?gt:yr.fromString(gt)}if(!Ye&&!ot)continue;const xt=this.sortFeaturesByKey?B.evaluate(Ue,{},l):void 0;if(this.features.push({id:ce,text:Ye,icon:ot,index:Ae,sourceLayerIndex:_e,geometry:Ue.geometry,properties:ne.properties,type:pu.types[ne.type],sortKey:xt}),ot&&(V[ot.name]=!0),Ye){const gt=x.evaluate(Ue,{},l).join(","),yt=v.get("text-rotation-alignment")!=="viewport"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(T.ao.vertical)>=0;for(const Ot of Ye.sections)if(Ot.image)V[Ot.image.name]=!0;else{const bt=Ka(Ye.toString()),vt=Ot.fontStack||gt,et=$[vt]=$[vt]||{};this.calculateGlyphDependencies(Ot.text,et,yt,this.allowVerticalPlacement,bt)}}}v.get("symbol-placement")==="line"&&(this.features=(function(ne){const ce={},Ae={},_e=[];let xe=0;function Ue(gt){_e.push(ne[gt]),xe++}function Ye(gt,yt,Ot){const bt=Ae[gt];return delete Ae[gt],Ae[yt]=bt,_e[bt].geometry[0].pop(),_e[bt].geometry[0]=_e[bt].geometry[0].concat(Ot[0]),bt}function ot(gt,yt,Ot){const bt=ce[yt];return delete ce[yt],ce[gt]=bt,_e[bt].geometry[0].shift(),_e[bt].geometry[0]=Ot[0].concat(_e[bt].geometry[0]),bt}function xt(gt,yt,Ot){const bt=Ot?yt[0][yt[0].length-1]:yt[0][0];return`${gt}:${bt.x}:${bt.y}`}for(let gt=0;gt<ne.length;gt++){const yt=ne[gt],Ot=yt.geometry,bt=yt.text?yt.text.toString():null;if(!bt){Ue(gt);continue}const vt=xt(bt,Ot),et=xt(bt,Ot,!0);if(vt in Ae&&et in ce&&Ae[vt]!==ce[et]){const Xt=ot(vt,et,Ot),Qt=Ye(vt,et,_e[Xt].geometry);delete ce[vt],delete Ae[et],Ae[xt(bt,_e[Qt].geometry,!0)]=Qt,_e[Xt].geometry=null}else vt in Ae?Ye(vt,et,Ot):et in ce?ot(vt,et,Ot):(Ue(gt),ce[vt]=xe-1,Ae[et]=xe-1)}return _e.filter((gt=>gt.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((ne,ce)=>ne.sortKey-ce.sortKey))}update(t,n,l){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,n,this.layers,{imagePositions:l,globalState:this.globalState}),this.icon.programConfigurations.updatePaintArrays(t,n,this.layers,{imagePositions:l,globalState:this.globalState}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,n){const l=this.lineVertexArray.length;if(t.segment!==void 0){let d=t.dist(n[t.segment+1]),v=t.dist(n[t.segment]);const x={};for(let S=t.segment+1;S<n.length;S++)x[S]={x:n[S].x,y:n[S].y,tileUnitDistanceFromAnchor:d},S<n.length-1&&(d+=n[S+1].dist(n[S]));for(let S=t.segment||0;S>=0;S--)x[S]={x:n[S].x,y:n[S].y,tileUnitDistanceFromAnchor:v},S>0&&(v+=n[S-1].dist(n[S]));for(let S=0;S<n.length;S++){const M=x[S];this.lineVertexArray.emplaceBack(M.x,M.y,M.tileUnitDistanceFromAnchor)}}return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(t,n,l,d,v,x,S,M,z,D,B,V){const $=t.indexArray,H=t.layoutVertexArray,K=t.segments.prepareSegment(4*n.length,H,$,this.canOverlap?x.sortKey:void 0),ne=this.glyphOffsetArray.length,ce=K.vertexLength,Ae=this.allowVerticalPlacement&&S===T.ao.vertical?Math.PI/2:0,_e=x.text&&x.text.sections;for(let xe=0;xe<n.length;xe++){const{tl:Ue,tr:Ye,bl:ot,br:xt,tex:gt,pixelOffsetTL:yt,pixelOffsetBR:Ot,minFontScaleX:bt,minFontScaleY:vt,glyphOffset:et,isSDF:Xt,sectionIndex:Qt}=n[xe],Ut=K.vertexLength,zt=et[1];as(H,M.x,M.y,Ue.x,zt+Ue.y,gt.x,gt.y,l,Xt,yt.x,yt.y,bt,vt),as(H,M.x,M.y,Ye.x,zt+Ye.y,gt.x+gt.w,gt.y,l,Xt,Ot.x,yt.y,bt,vt),as(H,M.x,M.y,ot.x,zt+ot.y,gt.x,gt.y+gt.h,l,Xt,yt.x,Ot.y,bt,vt),as(H,M.x,M.y,xt.x,zt+xt.y,gt.x+gt.w,gt.y+gt.h,l,Xt,Ot.x,Ot.y,bt,vt),vu(t.dynamicLayoutVertexArray,M,Ae),$.emplaceBack(Ut,Ut+2,Ut+1),$.emplaceBack(Ut+1,Ut+2,Ut+3),K.vertexLength+=4,K.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(et[0]),xe!==n.length-1&&Qt===n[xe+1].sectionIndex||t.programConfigurations.populatePaintArrays(H.length,x,x.index,{imagePositions:{},canonical:V,formattedSection:_e&&_e[Qt],globalState:this.globalState})}t.placedSymbolArray.emplaceBack(M.x,M.y,ne,this.glyphOffsetArray.length-ne,ce,z,D,M.segment,l?l[0]:0,l?l[1]:0,d[0],d[1],S,0,!1,0,B)}_addCollisionDebugVertex(t,n,l,d,v,x){return n.emplaceBack(0,0),t.emplaceBack(l.x,l.y,d,v,Math.round(x.x),Math.round(x.y))}addCollisionDebugVertices(t,n,l,d,v,x,S){const M=v.segments.prepareSegment(4,v.layoutVertexArray,v.indexArray),z=M.vertexLength,D=v.layoutVertexArray,B=v.collisionVertexArray,V=S.anchorX,$=S.anchorY;this._addCollisionDebugVertex(D,B,x,V,$,new L(t,n)),this._addCollisionDebugVertex(D,B,x,V,$,new L(l,n)),this._addCollisionDebugVertex(D,B,x,V,$,new L(l,d)),this._addCollisionDebugVertex(D,B,x,V,$,new L(t,d)),M.vertexLength+=4;const H=v.indexArray;H.emplaceBack(z,z+1),H.emplaceBack(z+1,z+2),H.emplaceBack(z+2,z+3),H.emplaceBack(z+3,z),M.primitiveLength+=4}addDebugCollisionBoxes(t,n,l,d){for(let v=t;v<n;v++){const x=this.collisionBoxArray.get(v);this.addCollisionDebugVertices(x.x1,x.y1,x.x2,x.y2,d?this.textCollisionBox:this.iconCollisionBox,x.anchorPoint,l)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Lf(hi,xl.members,Fi),this.iconCollisionBox=new Lf(hi,xl.members,Fi);for(let t=0;t<this.symbolInstances.length;t++){const n=this.symbolInstances.get(t);this.addDebugCollisionBoxes(n.textBoxStartIndex,n.textBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.iconBoxStartIndex,n.iconBoxEndIndex,n,!1),this.addDebugCollisionBoxes(n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex,n,!1)}}_deserializeCollisionBoxesForSymbol(t,n,l,d,v,x,S,M,z){const D={};for(let B=n;B<l;B++){const V=t.get(B);D.textBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,anchorPointX:V.anchorPointX,anchorPointY:V.anchorPointY},D.textFeatureIndex=V.featureIndex;break}for(let B=d;B<v;B++){const V=t.get(B);D.verticalTextBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,anchorPointX:V.anchorPointX,anchorPointY:V.anchorPointY},D.verticalTextFeatureIndex=V.featureIndex;break}for(let B=x;B<S;B++){const V=t.get(B);D.iconBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,anchorPointX:V.anchorPointX,anchorPointY:V.anchorPointY},D.iconFeatureIndex=V.featureIndex;break}for(let B=M;B<z;B++){const V=t.get(B);D.verticalIconBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,anchorPointX:V.anchorPointX,anchorPointY:V.anchorPointY},D.verticalIconFeatureIndex=V.featureIndex;break}return D}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const l=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,n){const l=t.placedSymbolArray.get(n),d=l.vertexStartIndex+4*l.numGlyphs;for(let v=l.vertexStartIndex;v<d;v+=4)t.indexArray.emplaceBack(v,v+2,v+1),t.indexArray.emplaceBack(v+1,v+2,v+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(t),l=Math.cos(t),d=[],v=[],x=[];for(let S=0;S<this.symbolInstances.length;++S){x.push(S);const M=this.symbolInstances.get(S);d.push(0|Math.round(n*M.anchorX+l*M.anchorY)),v.push(M.featureIndex)}return x.sort(((S,M)=>d[S]-d[M]||v[M]-v[S])),x}addToSortKeyRanges(t,n){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===n?l.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const l=this.symbolInstances.get(n);this.featureSortOrder.push(l.featureIndex),[l.rightJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.leftJustifiedTextSymbolIndex].forEach(((d,v,x)=>{d>=0&&x.indexOf(d)===v&&this.addIndicesForPlacedSymbol(this.text,d)})),l.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,l.verticalPlacedTextSymbolIndex),l.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.placedIconSymbolIndex),l.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let tm,xg;Mt("SymbolBucket",xu,{omit:["layers","collisionBoxArray","features","compareText"]}),xu.MAX_GLYPHS=65535,xu.addDynamicAttributes=vu;var wd={get paint(){return xg=xg||new Hr({"icon-opacity":new Ft(Ie.paint_symbol["icon-opacity"]),"icon-color":new Ft(Ie.paint_symbol["icon-color"]),"icon-halo-color":new Ft(Ie.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ft(Ie.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ft(Ie.paint_symbol["icon-halo-blur"]),"icon-translate":new Pt(Ie.paint_symbol["icon-translate"]),"icon-translate-anchor":new Pt(Ie.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ft(Ie.paint_symbol["text-opacity"]),"text-color":new Ft(Ie.paint_symbol["text-color"],{runtimeType:Zn,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new Ft(Ie.paint_symbol["text-halo-color"]),"text-halo-width":new Ft(Ie.paint_symbol["text-halo-width"]),"text-halo-blur":new Ft(Ie.paint_symbol["text-halo-blur"]),"text-translate":new Pt(Ie.paint_symbol["text-translate"]),"text-translate-anchor":new Pt(Ie.paint_symbol["text-translate-anchor"])})},get layout(){return tm=tm||new Hr({"symbol-placement":new Pt(Ie.layout_symbol["symbol-placement"]),"symbol-spacing":new Pt(Ie.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Pt(Ie.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ft(Ie.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Pt(Ie.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Pt(Ie.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Pt(Ie.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Pt(Ie.layout_symbol["icon-ignore-placement"]),"icon-optional":new Pt(Ie.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Pt(Ie.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ft(Ie.layout_symbol["icon-size"]),"icon-text-fit":new Pt(Ie.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Pt(Ie.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ft(Ie.layout_symbol["icon-image"]),"icon-rotate":new Ft(Ie.layout_symbol["icon-rotate"]),"icon-padding":new Ft(Ie.layout_symbol["icon-padding"]),"icon-keep-upright":new Pt(Ie.layout_symbol["icon-keep-upright"]),"icon-offset":new Ft(Ie.layout_symbol["icon-offset"]),"icon-anchor":new Ft(Ie.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Pt(Ie.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Pt(Ie.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Pt(Ie.layout_symbol["text-rotation-alignment"]),"text-field":new Ft(Ie.layout_symbol["text-field"]),"text-font":new Ft(Ie.layout_symbol["text-font"]),"text-size":new Ft(Ie.layout_symbol["text-size"]),"text-max-width":new Ft(Ie.layout_symbol["text-max-width"]),"text-line-height":new Pt(Ie.layout_symbol["text-line-height"]),"text-letter-spacing":new Ft(Ie.layout_symbol["text-letter-spacing"]),"text-justify":new Ft(Ie.layout_symbol["text-justify"]),"text-radial-offset":new Ft(Ie.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Pt(Ie.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Ft(Ie.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Ft(Ie.layout_symbol["text-anchor"]),"text-max-angle":new Pt(Ie.layout_symbol["text-max-angle"]),"text-writing-mode":new Pt(Ie.layout_symbol["text-writing-mode"]),"text-rotate":new Ft(Ie.layout_symbol["text-rotate"]),"text-padding":new Pt(Ie.layout_symbol["text-padding"]),"text-keep-upright":new Pt(Ie.layout_symbol["text-keep-upright"]),"text-transform":new Ft(Ie.layout_symbol["text-transform"]),"text-offset":new Ft(Ie.layout_symbol["text-offset"]),"text-allow-overlap":new Pt(Ie.layout_symbol["text-allow-overlap"]),"text-overlap":new Pt(Ie.layout_symbol["text-overlap"]),"text-ignore-placement":new Pt(Ie.layout_symbol["text-ignore-placement"]),"text-optional":new Pt(Ie.layout_symbol["text-optional"])})}};class im{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:cs,this.defaultValue=t}evaluate(t){if(t.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(t.formattedSection))return n.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Mt("FormatSectionOverride",im,{omit:["defaultValue"]});class Sd extends ra{constructor(t){super(t,wd)}recalculate(t,n){if(super.recalculate(t,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const l=this.layout.get("text-writing-mode");if(l){const d=[];for(const v of l)d.indexOf(v)<0&&d.push(v);this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,n,l,d){const v=this.layout.get(t).evaluate(n,{},l,d),x=this._unevaluatedLayout._values[t];return x.isDataDriven()||Os(x.value)||!v?v:(function(S,M){return M.replace(/{([^{}]+)}/g,((z,D)=>S&&D in S?String(S[D]):""))})(n.properties,v)}createBucket(t){return new xu(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of wd.paint.overridableProperties){if(!Sd.hasPaintOverride(this.layout,t))continue;const n=this.paint.get(t),l=new im(n),d=new Yc(l,n.property.specification);let v=null;v=n.value.kind==="constant"||n.value.kind==="source"?new mo("source",d):new ql("composite",d,n.value.zoomStops),this.paint._values[t]=new Ki(n.property,v,n.parameters)}}_handleOverridablePaintPropertyUpdate(t,n,l){return!(!this.layout||n.isDataDriven()||l.isDataDriven())&&Sd.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,n){const l=t.get("text-field"),d=wd.paint.properties[n];let v=!1;const x=S=>{for(const M of S)if(d.overrides&&d.overrides.hasOverride(M))return void(v=!0)};if(l.value.kind==="constant"&&l.value.value instanceof Kn)x(l.value.value.sections);else if(l.value.kind==="source"){const S=z=>{v||(z instanceof Ca&&Yt(z.value)===ta?x(z.value.sections):z instanceof Ko?x(z.sections):z.eachChild(S))},M=l.value;M._styleExpression&&S(M._styleExpression.expression)}return v}}let bg;var nm={get paint(){return bg=bg||new Hr({"background-color":new Pt(Ie.paint_background["background-color"]),"background-pattern":new za(Ie.paint_background["background-pattern"]),"background-opacity":new Pt(Ie.paint_background["background-opacity"])})}};class rm extends ra{constructor(t){super(t,nm)}}let wg;var z_={get paint(){return wg=wg||new Hr({"raster-opacity":new Pt(Ie.paint_raster["raster-opacity"]),"raster-hue-rotate":new Pt(Ie.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Pt(Ie.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Pt(Ie.paint_raster["raster-brightness-max"]),"raster-saturation":new Pt(Ie.paint_raster["raster-saturation"]),"raster-contrast":new Pt(Ie.paint_raster["raster-contrast"]),"raster-resampling":new Pt(Ie.paint_raster["raster-resampling"]),"raster-fade-duration":new Pt(Ie.paint_raster["raster-fade-duration"])})}};class Td extends ra{constructor(t){super(t,z_)}}class I_ extends ra{constructor(t){super(t,{}),this.onAdd=n=>{this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)},this.onRemove=n=>{this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Sg{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Ii={once:!0},Cd=63710088e-1;class Ks{constructor(t,n){if(isNaN(t)||isNaN(n))throw new Error(`Invalid LngLat object: (${t}, ${n})`);if(this.lng=+t,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ks(At(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const n=Math.PI/180,l=this.lat*n,d=t.lat*n,v=Math.sin(l)*Math.sin(d)+Math.cos(l)*Math.cos(d)*Math.cos((t.lng-this.lng)*n);return Cd*Math.acos(Math.min(v,1))}static convert(t){if(t instanceof Ks)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Ks(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Ks(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Of=2*Math.PI*Cd;function am(r){return Of*Math.cos(r*Math.PI/180)}function Bf(r){return(180+r)/360}function ph(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function Ed(r,t){return r/am(t)}function pc(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}function sm(r,t){return r*am(pc(t))}class Md{constructor(t,n,l=0){this.x=+t,this.y=+n,this.z=+l}static fromLngLat(t,n=0){const l=Ks.convert(t);return new Md(Bf(l.lng),ph(l.lat),Ed(n,l.lat))}toLngLat(){return new Ks(360*this.x-180,pc(this.y))}toAltitude(){return sm(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Of*(t=pc(this.y),1/Math.cos(t*Math.PI/180));var t}}function Tg(r,t,n){var l=2*Math.PI*6378137/256/Math.pow(2,n);return[r*l-2*Math.PI*6378137/2,t*l-2*Math.PI*6378137/2]}class Nf{constructor(t,n,l){if(!(function(d,v,x){return!(d<0||d>25||x<0||x>=Math.pow(2,d)||v<0||v>=Math.pow(2,d))})(t,n,l))throw new Error(`x=${n}, y=${l}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=n,this.y=l,this.key=Ui(0,t,t,n,l)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,n,l){const d=(x=this.y,S=this.z,M=Tg(256*(v=this.x),256*(x=Math.pow(2,S)-x-1),S),z=Tg(256*(v+1),256*(x+1),S),M[0]+","+M[1]+","+z[0]+","+z[1]);var v,x,S,M,z;const D=(function(B,V,$){let H,K="";for(let ne=B;ne>0;ne--)H=1<<ne-1,K+=(V&H?1:0)+($&H?2:0);return K})(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,n>1?"@2x":"").replace(/{quadkey}/g,D).replace(/{bbox-epsg-3857}/g,d)}isChildOf(t){const n=this.z-t.z;return n>0&&t.x===this.x>>n&&t.y===this.y>>n}getTilePoint(t){const n=Math.pow(2,this.z);return new L((t.x*n-this.x)*St,(t.y*n-this.y)*St)}toString(){return`${this.z}/${this.x}/${this.y}`}}class om{constructor(t,n){this.wrap=t,this.canonical=n,this.key=Ui(t,n.z,n.z,n.x,n.y)}}class aa{constructor(t,n,l,d,v){if(this.terrainRttPosMatrix32f=null,t<l)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${l}`);this.overscaledZ=t,this.wrap=n,this.canonical=new Nf(l,+d,+v),this.key=Ui(n,t,l,d,v)}clone(){return new aa(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const n=this.canonical.z-t;return t>this.canonical.z?new aa(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new aa(t,this.wrap,t,this.canonical.x>>n,this.canonical.y>>n)}calculateScaledKey(t,n){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-t;return t>this.canonical.z?Ui(this.wrap*+n,t,this.canonical.z,this.canonical.x,this.canonical.y):Ui(this.wrap*+n,t,t,this.canonical.x>>l,this.canonical.y>>l)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const n=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>n&&t.canonical.y===this.canonical.y>>n}children(t){if(this.overscaledZ>=t)return[new aa(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,l=2*this.canonical.x,d=2*this.canonical.y;return[new aa(n,this.wrap,n,l,d),new aa(n,this.wrap,n,l+1,d),new aa(n,this.wrap,n,l,d+1),new aa(n,this.wrap,n,l+1,d+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new aa(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new aa(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new om(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new Md(t.x-this.wrap,t.y))}}function Ui(r,t,n,l,d){(r*=2)<0&&(r=-1*r-1);const v=1<<n;return(v*v*r+v*d+l).toString(36)+n.toString(36)+t.toString(36)}function bu(r,t){return t?r.properties[t]:r.id}Mt("CanonicalTileID",Nf),Mt("OverscaledTileID",aa,{omit:["terrainRttPosMatrix32f"]});class Xn{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(t){return this.minX=Math.min(this.minX,t.x),this.minY=Math.min(this.minY,t.y),this.maxX=Math.max(this.maxX,t.x),this.maxY=Math.max(this.maxY,t.y),this}expandBy(t){return this.minX-=t,this.minY-=t,this.maxX+=t,this.maxY+=t,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(t){return this.expandBy(-t)}map(t){const n=new Xn;return n.extend(t(new L(this.minX,this.minY))),n.extend(t(new L(this.maxX,this.minY))),n.extend(t(new L(this.minX,this.maxY))),n.extend(t(new L(this.maxX,this.maxY))),n}static fromPoints(t){const n=new Xn;for(const l of t)n.extend(l);return n}contains(t){return t.x>=this.minX&&t.x<=this.maxX&&t.y>=this.minY&&t.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(t){return!this.empty()&&!t.empty()&&t.minX>=this.minX&&t.maxX<=this.maxX&&t.minY>=this.minY&&t.maxY<=this.maxY}intersects(t){return!this.empty()&&!t.empty()&&t.minX<=this.maxX&&t.maxX>=this.minX&&t.minY<=this.maxY&&t.maxY>=this.minY}}class Cg{constructor(t){this._stringToNumber={},this._numberToString=[];for(let n=0;n<t.length;n++){const l=t[n];this._stringToNumber[l]=n,this._numberToString[n]=l}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class jf{constructor(t,n,l,d,v){this.type="Feature",this._vectorTileFeature=t,t._z=n,t._x=l,t._y=d,this.properties=t.properties,this.id=v}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const n in this)n!=="_geometry"&&n!=="_vectorTileFeature"&&(t[n]=this[n]);return t}}class Ff{constructor(t,n){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Fs(St,16,0),this.grid3D=new Fs(St,16,0),this.featureIndexArray=new Te,this.promoteId=n}insert(t,n,l,d,v,x){const S=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,d,v);const M=x?this.grid3D:this.grid;for(let z=0;z<n.length;z++){const D=n[z],B=[1/0,1/0,-1/0,-1/0];for(let V=0;V<D.length;V++){const $=D[V];B[0]=Math.min(B[0],$.x),B[1]=Math.min(B[1],$.y),B[2]=Math.max(B[2],$.x),B[3]=Math.max(B[3],$.y)}B[0]<St&&B[1]<St&&B[2]>=0&&B[3]>=0&&M.insert(S,B[0],B[1],B[2],B[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new qp(new gu(this.rawTileData)).layers,this.sourceLayerCoder=new Cg(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,n,l,d){this.loadVTLayers();const v=t.params,x=St/t.tileSize/t.scale,S=go(v.filter),M=t.queryGeometry,z=t.queryPadding*x,D=Xn.fromPoints(M),B=this.grid.query(D.minX-z,D.minY-z,D.maxX+z,D.maxY+z),V=Xn.fromPoints(t.cameraQueryGeometry).expandBy(z),$=this.grid3D.query(V.minX,V.minY,V.maxX,V.maxY,((ne,ce,Ae,_e)=>(function(xe,Ue,Ye,ot,xt){for(const yt of xe)if(Ue<=yt.x&&Ye<=yt.y&&ot>=yt.x&&xt>=yt.y)return!0;const gt=[new L(Ue,Ye),new L(Ue,xt),new L(ot,xt),new L(ot,Ye)];if(xe.length>2){for(const yt of gt)if(ou(xe,yt))return!0}for(let yt=0;yt<xe.length-1;yt++)if(qm(xe[yt],xe[yt+1],gt))return!0;return!1})(t.cameraQueryGeometry,ne-z,ce-z,Ae+z,_e+z)));for(const ne of $)B.push(ne);B.sort(Eg);const H={};let K;for(let ne=0;ne<B.length;ne++){const ce=B[ne];if(ce===K)continue;K=ce;const Ae=this.featureIndexArray.get(ce);let _e=null;this.loadMatchingFeature(H,Ae.bucketIndex,Ae.sourceLayerIndex,Ae.featureIndex,S,v.layers,v.availableImages,n,l,d,((xe,Ue,Ye)=>(_e||(_e=ln(xe)),Ue.queryIntersectsFeature({queryGeometry:M,feature:xe,featureState:Ye,geometry:_e,zoom:this.z,transform:t.transform,pixelsToTileUnits:x,pixelPosMatrix:t.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:t.getElevation}))))}return H}loadMatchingFeature(t,n,l,d,v,x,S,M,z,D,B){const V=this.bucketLayerIDs[n];if(x&&!V.some((ne=>x.has(ne))))return;const $=this.sourceLayerCoder.decode(l),H=this.vtLayers[$].feature(d);if(v.needGeometry){const ne=La(H,!0);if(!v.filter(new ji(this.tileID.overscaledZ),ne,this.tileID.canonical))return}else if(!v.filter(new ji(this.tileID.overscaledZ),H))return;const K=this.getId(H,$);for(let ne=0;ne<V.length;ne++){const ce=V[ne];if(x&&!x.has(ce))continue;const Ae=M[ce];if(!Ae)continue;let _e={};K&&D&&(_e=D.getState(Ae.sourceLayer||"_geojsonTileLayer",K));const xe=Nt({},z[ce]);xe.paint=Ad(xe.paint,Ae.paint,H,_e,S),xe.layout=Ad(xe.layout,Ae.layout,H,_e,S);const Ue=!B||B(H,Ae,_e);if(!Ue)continue;const Ye=new jf(H,this.z,this.x,this.y,K);Ye.layer=xe;let ot=t[ce];ot===void 0&&(ot=t[ce]=[]),ot.push({featureIndex:d,feature:Ye,intersectionZ:Ue})}}lookupSymbolFeatures(t,n,l,d,v,x,S,M){const z={};this.loadVTLayers();const D=go(v);for(const B of t)this.loadMatchingFeature(z,l,d,B,D,x,S,M,n);return z}hasLayer(t){for(const n of this.bucketLayerIDs)for(const l of n)if(t===l)return!0;return!1}getId(t,n){var l;let d=t.id;return this.promoteId&&(d=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[n]],typeof d=="boolean"&&(d=Number(d)),d===void 0&&(!((l=t.properties)===null||l===void 0)&&l.cluster)&&this.promoteId&&(d=Number(t.properties.cluster_id))),d}}function Ad(r,t,n,l,d){return wi(r,((v,x)=>{const S=t instanceof dl?t.get(x):null;return S&&S.evaluate?S.evaluate(n,l,d):S}))}function Eg(r,t){return t-r}function lm(r,t,n,l,d){const v=[];for(let x=0;x<r.length;x++){const S=r[x];let M;for(let z=0;z<S.length-1;z++){let D=S[z],B=S[z+1];D.x<t&&B.x<t||(D.x<t?D=new L(t,D.y+(t-D.x)/(B.x-D.x)*(B.y-D.y))._round():B.x<t&&(B=new L(t,D.y+(t-D.x)/(B.x-D.x)*(B.y-D.y))._round()),D.y<n&&B.y<n||(D.y<n?D=new L(D.x+(n-D.y)/(B.y-D.y)*(B.x-D.x),n)._round():B.y<n&&(B=new L(D.x+(n-D.y)/(B.y-D.y)*(B.x-D.x),n)._round()),D.x>=l&&B.x>=l||(D.x>=l?D=new L(l,D.y+(l-D.x)/(B.x-D.x)*(B.y-D.y))._round():B.x>=l&&(B=new L(l,D.y+(l-D.x)/(B.x-D.x)*(B.y-D.y))._round()),D.y>=d&&B.y>=d||(D.y>=d?D=new L(D.x+(d-D.y)/(B.y-D.y)*(B.x-D.x),d)._round():B.y>=d&&(B=new L(D.x+(d-D.y)/(B.y-D.y)*(B.x-D.x),d)._round()),M&&D.equals(M[M.length-1])||(M=[D],v.push(M)),M.push(B)))))}}return v}Mt("FeatureIndex",Ff,{omit:["rawTileData","sourceLayerCoder"]});class ko extends L{constructor(t,n,l,d){super(t,n),this.angle=l,d!==void 0&&(this.segment=d)}clone(){return new ko(this.x,this.y,this.angle,this.segment)}}function Uf(r,t,n,l,d){if(t.segment===void 0||n===0)return!0;let v=t,x=t.segment+1,S=0;for(;S>-n/2;){if(x--,x<0)return!1;S-=r[x].dist(v),v=r[x]}S+=r[x].dist(r[x+1]),x++;const M=[];let z=0;for(;S<n/2;){const D=r[x],B=r[x+1];if(!B)return!1;let V=r[x-1].angleTo(D)-D.angleTo(B);for(V=Math.abs((V+3*Math.PI)%(2*Math.PI)-Math.PI),M.push({distance:S,angleDelta:V}),z+=V;S-M[0].distance>l;)z-=M.shift().angleDelta;if(z>d)return!1;x++,S+=D.dist(B)}return!0}function Mg(r){let t=0;for(let n=0;n<r.length-1;n++)t+=r[n].dist(r[n+1]);return t}function cm(r,t,n){return r?.6*t*n:0}function Ag(r,t){return Math.max(r?r.right-r.left:0,t?t.right-t.left:0)}function Pg(r,t,n,l,d,v){const x=cm(n,d,v),S=Ag(n,l)*v;let M=0;const z=Mg(r)/2;for(let D=0;D<r.length-1;D++){const B=r[D],V=r[D+1],$=B.dist(V);if(M+$>z){const H=(z-M)/$,K=_s.number(B.x,V.x,H),ne=_s.number(B.y,V.y,H),ce=new ko(K,ne,V.angleTo(B),D);return ce._round(),!x||Uf(r,ce,S,x,t)?ce:void 0}M+=$}}function D_(r,t,n,l,d,v,x,S,M){const z=cm(l,v,x),D=Ag(l,d),B=D*x,V=r[0].x===0||r[0].x===M||r[0].y===0||r[0].y===M;return t-B<t/4&&(t=B+t/4),Rg(r,V?t/2*S%t:(D/2+2*v)*x*S%t,t,z,n,B,V,!1,M)}function Rg(r,t,n,l,d,v,x,S,M){const z=v/2,D=Mg(r);let B=0,V=t-n,$=[];for(let H=0;H<r.length-1;H++){const K=r[H],ne=r[H+1],ce=K.dist(ne),Ae=ne.angleTo(K);for(;V+n<B+ce;){V+=n;const _e=(V-B)/ce,xe=_s.number(K.x,ne.x,_e),Ue=_s.number(K.y,ne.y,_e);if(xe>=0&&xe<M&&Ue>=0&&Ue<M&&V-z>=0&&V+z<=D){const Ye=new ko(xe,Ue,Ae,H);Ye._round(),l&&!Uf(r,Ye,v,l,d)||$.push(Ye)}}B+=ce}return S||$.length||x||($=Rg(r,B/2,n,l,d,v,x,!0,M)),$}function wl(r,t,n,l){const d=[],v=r.image,x=v.pixelRatio,S=v.paddedRect.w-2,M=v.paddedRect.h-2;let z={x1:r.left,y1:r.top,x2:r.right,y2:r.bottom};const D=v.stretchX||[[0,S]],B=v.stretchY||[[0,M]],V=(et,Xt)=>et+Xt[1]-Xt[0],$=D.reduce(V,0),H=B.reduce(V,0),K=S-$,ne=M-H;let ce=0,Ae=$,_e=0,xe=H,Ue=0,Ye=K,ot=0,xt=ne;if(v.content&&l){const et=v.content,Xt=et[2]-et[0],Qt=et[3]-et[1];(v.textFitWidth||v.textFitHeight)&&(z=vg(r)),ce=Pd(D,0,et[0]),_e=Pd(B,0,et[1]),Ae=Pd(D,et[0],et[2]),xe=Pd(B,et[1],et[3]),Ue=et[0]-ce,ot=et[1]-_e,Ye=Xt-Ae,xt=Qt-xe}const gt=z.x1,yt=z.y1,Ot=z.x2-gt,bt=z.y2-yt,vt=(et,Xt,Qt,Ut)=>{const zt=Gf(et.stretch-ce,Ae,Ot,gt),di=Zf(et.fixed-Ue,Ye,et.stretch,$),Hi=Gf(Xt.stretch-_e,xe,bt,yt),un=Zf(Xt.fixed-ot,xt,Xt.stretch,H),er=Gf(Qt.stretch-ce,Ae,Ot,gt),Jr=Zf(Qt.fixed-Ue,Ye,Qt.stretch,$),tr=Gf(Ut.stretch-_e,xe,bt,yt),Sr=Zf(Ut.fixed-ot,xt,Ut.stretch,H),yn=new L(zt,Hi),jn=new L(er,Hi),Tr=new L(er,tr),ur=new L(zt,tr),Cr=new L(di/x,un/x),Fa=new L(Jr/x,Sr/x),hr=t*Math.PI/180;if(hr){const or=Math.sin(hr),Un=Math.cos(hr),Vn=[Un,-or,or,Un];yn._matMult(Vn),jn._matMult(Vn),ur._matMult(Vn),Tr._matMult(Vn)}const Vr=et.stretch+et.fixed,Fn=Xt.stretch+Xt.fixed;return{tl:yn,tr:jn,bl:ur,br:Tr,tex:{x:v.paddedRect.x+1+Vr,y:v.paddedRect.y+1+Fn,w:Qt.stretch+Qt.fixed-Vr,h:Ut.stretch+Ut.fixed-Fn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Cr,pixelOffsetBR:Fa,minFontScaleX:Ye/x/Ot,minFontScaleY:xt/x/bt,isSDF:n}};if(l&&(v.stretchX||v.stretchY)){const et=Vf(D,K,$),Xt=Vf(B,ne,H);for(let Qt=0;Qt<et.length-1;Qt++){const Ut=et[Qt],zt=et[Qt+1];for(let di=0;di<Xt.length-1;di++)d.push(vt(Ut,Xt[di],zt,Xt[di+1]))}}else d.push(vt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:S+1},{fixed:0,stretch:M+1}));return d}function Pd(r,t,n){let l=0;for(const d of r)l+=Math.max(t,Math.min(n,d[1]))-Math.max(t,Math.min(n,d[0]));return l}function Vf(r,t,n){const l=[{fixed:-1,stretch:0}];for(const[d,v]of r){const x=l[l.length-1];l.push({fixed:d-x.stretch,stretch:x.stretch}),l.push({fixed:d-x.stretch,stretch:x.stretch+(v-d)})}return l.push({fixed:t+1,stretch:n}),l}function Gf(r,t,n,l){return r/t*n+l}function Zf(r,t,n,l){return r-t*n/l}Mt("Anchor",ko);class mh{constructor(t,n,l,d,v,x,S,M,z,D){var B;if(this.boxStartIndex=t.length,z){let V=x.top,$=x.bottom;const H=x.collisionPadding;H&&(V-=H[1],$+=H[3]);let K=$-V;K>0&&(K=Math.max(10,K),this.circleDiameter=K)}else{const V=!((B=x.image)===null||B===void 0)&&B.content&&(x.image.textFitWidth||x.image.textFitHeight)?vg(x):{x1:x.left,y1:x.top,x2:x.right,y2:x.bottom};V.y1=V.y1*S-M[0],V.y2=V.y2*S+M[2],V.x1=V.x1*S-M[3],V.x2=V.x2*S+M[1];const $=x.collisionPadding;if($&&(V.x1-=$[0]*S,V.y1-=$[1]*S,V.x2+=$[2]*S,V.y2+=$[3]*S),D){const H=new L(V.x1,V.y1),K=new L(V.x2,V.y1),ne=new L(V.x1,V.y2),ce=new L(V.x2,V.y2),Ae=D*Math.PI/180;H._rotate(Ae),K._rotate(Ae),ne._rotate(Ae),ce._rotate(Ae),V.x1=Math.min(H.x,K.x,ne.x,ce.x),V.x2=Math.max(H.x,K.x,ne.x,ce.x),V.y1=Math.min(H.y,K.y,ne.y,ce.y),V.y2=Math.max(H.y,K.y,ne.y,ce.y)}t.emplaceBack(n.x,n.y,V.x1,V.y1,V.x2,V.y2,l,d,v)}this.boxEndIndex=t.length}}class k_{constructor(t=[],n=(l,d)=>l<d?-1:l>d?1:0){if(this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:n,compare:l}=this,d=n[t];for(;t>0;){const v=t-1>>1,x=n[v];if(l(d,x)>=0)break;n[t]=x,t=v}n[t]=d}_down(t){const{data:n,compare:l}=this,d=this.length>>1,v=n[t];for(;t<d;){let x=1+(t<<1);const S=x+1;if(S<this.length&&l(n[S],n[x])<0&&(x=S),l(n[x],v)>=0)break;n[t]=n[x],t=x}n[t]=v}}function Qs(r,t=1,n=!1){const l=Xn.fromPoints(r[0]),d=Math.min(l.width(),l.height());let v=d/2;const x=new k_([],um),{minX:S,minY:M,maxX:z,maxY:D}=l;if(d===0)return new L(S,M);for(let $=S;$<z;$+=d)for(let H=M;H<D;H+=d)x.push(new wu($+v,H+v,v,r));let B=(function($){let H=0,K=0,ne=0;const ce=$[0];for(let Ae=0,_e=ce.length,xe=_e-1;Ae<_e;xe=Ae++){const Ue=ce[Ae],Ye=ce[xe],ot=Ue.x*Ye.y-Ye.x*Ue.y;K+=(Ue.x+Ye.x)*ot,ne+=(Ue.y+Ye.y)*ot,H+=3*ot}return new wu(K/H,ne/H,0,$)})(r),V=x.length;for(;x.length;){const $=x.pop();($.d>B.d||!B.d)&&(B=$,n&&console.log("found best %d after %d probes",Math.round(1e4*$.d)/1e4,V)),$.max-B.d<=t||(v=$.h/2,x.push(new wu($.p.x-v,$.p.y-v,v,r)),x.push(new wu($.p.x+v,$.p.y-v,v,r)),x.push(new wu($.p.x-v,$.p.y+v,v,r)),x.push(new wu($.p.x+v,$.p.y+v,v,r)),V+=4)}return n&&(console.log(`num probes: ${V}`),console.log(`best distance: ${B.d}`)),B.p}function um(r,t){return t.max-r.max}function wu(r,t,n,l){this.p=new L(r,t),this.h=n,this.d=(function(d,v){let x=!1,S=1/0;for(let M=0;M<v.length;M++){const z=v[M];for(let D=0,B=z.length,V=B-1;D<B;V=D++){const $=z[D],H=z[V];$.y>d.y!=H.y>d.y&&d.x<(H.x-$.x)*(d.y-$.y)/(H.y-$.y)+$.x&&(x=!x),S=Math.min(S,zp(d,$,H))}}return(x?1:-1)*Math.sqrt(S)})(this.p,l),this.max=this.d+this.h*Math.SQRT2}var wr;T.aE=void 0,(wr=T.aE||(T.aE={}))[wr.center=1]="center",wr[wr.left=2]="left",wr[wr.right=3]="right",wr[wr.top=4]="top",wr[wr.bottom=5]="bottom",wr[wr["top-left"]=6]="top-left",wr[wr["top-right"]=7]="top-right",wr[wr["bottom-left"]=8]="bottom-left",wr[wr["bottom-right"]=9]="bottom-right";const Su=Number.POSITIVE_INFINITY;function ss(r,t){return t[1]!==Su?(function(n,l,d){let v=0,x=0;switch(l=Math.abs(l),d=Math.abs(d),n){case"top-right":case"top-left":case"top":x=d-7;break;case"bottom-right":case"bottom-left":case"bottom":x=7-d}switch(n){case"top-right":case"bottom-right":case"right":v=-l;break;case"top-left":case"bottom-left":case"left":v=l}return[v,x]})(r,t[0],t[1]):(function(n,l){let d=0,v=0;l<0&&(l=0);const x=l/Math.SQRT2;switch(n){case"top-right":case"top-left":v=x-7;break;case"bottom-right":case"bottom-left":v=7-x;break;case"bottom":v=7-l;break;case"top":v=l-7}switch(n){case"top-right":case"bottom-right":d=-x;break;case"top-left":case"bottom-left":d=x;break;case"left":d=l;break;case"right":d=-l}return[d,v]})(r,t[0])}function hm(r,t,n){var l;const d=r.layout,v=(l=d.get("text-variable-anchor-offset"))===null||l===void 0?void 0:l.evaluate(t,{},n);if(v){const S=v.values,M=[];for(let z=0;z<S.length;z+=2){const D=M[z]=S[z],B=S[z+1].map((V=>V*Pn));D.startsWith("top")?B[1]-=7:D.startsWith("bottom")&&(B[1]+=7),M[z+1]=B}return new _r(M)}const x=d.get("text-variable-anchor");if(x){let S;S=r._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[d.get("text-radial-offset").evaluate(t,{},n)*Pn,Su]:d.get("text-offset").evaluate(t,{},n).map((z=>z*Pn));const M=[];for(const z of x)M.push(z,ss(z,S));return new _r(M)}return null}function gh(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Sl(r,t,n,l,d,v,x,S,M,z,D,B){let V=v.textMaxSize.evaluate(t,{});V===void 0&&(V=x);const $=r.layers[0].layout,H=$.get("icon-offset").evaluate(t,{},D),K=Ig(n.horizontal),ne=x/24,ce=r.tilePixelRatio*ne,Ae=r.tilePixelRatio*V/24,_e=r.tilePixelRatio*S,xe=r.tilePixelRatio*$.get("symbol-spacing"),Ue=$.get("text-padding")*r.tilePixelRatio,Ye=(function(Qt,Ut,zt,di=1){const Hi=Qt.get("icon-padding").evaluate(Ut,{},zt),un=Hi&&Hi.values;return[un[0]*di,un[1]*di,un[2]*di,un[3]*di]})($,t,D,r.tilePixelRatio),ot=$.get("text-max-angle")/180*Math.PI,xt=$.get("text-rotation-alignment")!=="viewport"&&$.get("symbol-placement")!=="point",gt=$.get("icon-rotation-alignment")==="map"&&$.get("symbol-placement")!=="point",yt=$.get("symbol-placement"),Ot=xe/2,bt=$.get("icon-text-fit");let vt;l&&bt!=="none"&&(r.allowVerticalPlacement&&n.vertical&&(vt=vd(l,n.vertical,bt,$.get("icon-text-fit-padding"),H,ne)),K&&(l=vd(l,K,bt,$.get("icon-text-fit-padding"),H,ne)));const et=D?B.line.getGranularityForZoomLevel(D.z):1,Xt=(Qt,Ut)=>{Ut.x<0||Ut.x>=St||Ut.y<0||Ut.y>=St||(function(zt,di,Hi,un,er,Jr,tr,Sr,yn,jn,Tr,ur,Cr,Fa,hr,Vr,Fn,or,Un,Vn,Qi,Ts,vh,Ua,i){const s=zt.addToLineVertexArray(di,Hi);let u,_,E,I,q=0,te=0,ve=0,qe=0,rt=-1,ut=-1;const He={};let We=Hs("");if(zt.allowVerticalPlacement&&un.vertical){const va=Sr.layout.get("text-rotate").evaluate(Qi,{},Ua)+90;E=new mh(yn,di,jn,Tr,ur,un.vertical,Cr,Fa,hr,va),tr&&(I=new mh(yn,di,jn,Tr,ur,tr,Fn,or,hr,va))}if(er){const va=Sr.layout.get("icon-rotate").evaluate(Qi,{}),Js=Sr.layout.get("icon-text-fit")!=="none",Id=wl(er,va,vh,Js),Tl=tr?wl(tr,va,vh,Js):void 0;_=new mh(yn,di,jn,Tr,ur,er,Fn,or,!1,va),q=4*Id.length;const Dd=zt.iconSizeData;let gc=null;Dd.kind==="source"?(gc=[ja*Sr.layout.get("icon-size").evaluate(Qi,{})],gc[0]>Do&&ki(`${zt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Dd.kind==="composite"&&(gc=[ja*Ts.compositeIconSizes[0].evaluate(Qi,{},Ua),ja*Ts.compositeIconSizes[1].evaluate(Qi,{},Ua)],(gc[0]>Do||gc[1]>Do)&&ki(`${zt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),zt.addSymbols(zt.icon,Id,gc,Vn,Un,Qi,T.ao.none,di,s.lineStartIndex,s.lineLength,-1,Ua),rt=zt.icon.placedSymbolArray.length-1,Tl&&(te=4*Tl.length,zt.addSymbols(zt.icon,Tl,gc,Vn,Un,Qi,T.ao.vertical,di,s.lineStartIndex,s.lineLength,-1,Ua),ut=zt.icon.placedSymbolArray.length-1)}const li=Object.keys(un.horizontal);for(const va of li){const Js=un.horizontal[va];if(!u){We=Hs(Js.text);const Tl=Sr.layout.get("text-rotate").evaluate(Qi,{},Ua);u=new mh(yn,di,jn,Tr,ur,Js,Cr,Fa,hr,Tl)}const Id=Js.positionedLines.length===1;if(ve+=zg(zt,di,Js,Jr,Sr,hr,Qi,Vr,s,un.vertical?T.ao.horizontal:T.ao.horizontalOnly,Id?li:[va],He,rt,Ts,Ua),Id)break}un.vertical&&(qe+=zg(zt,di,un.vertical,Jr,Sr,hr,Qi,Vr,s,T.ao.vertical,["vertical"],He,ut,Ts,Ua));const ai=u?u.boxStartIndex:zt.collisionBoxArray.length,hn=u?u.boxEndIndex:zt.collisionBoxArray.length,Be=E?E.boxStartIndex:zt.collisionBoxArray.length,De=E?E.boxEndIndex:zt.collisionBoxArray.length,Ge=_?_.boxStartIndex:zt.collisionBoxArray.length,lt=_?_.boxEndIndex:zt.collisionBoxArray.length,Vt=I?I.boxStartIndex:zt.collisionBoxArray.length,Ai=I?I.boxEndIndex:zt.collisionBoxArray.length;let Bt=-1;const Jt=(va,Js)=>va&&va.circleDiameter?Math.max(va.circleDiameter,Js):Js;Bt=Jt(u,Bt),Bt=Jt(E,Bt),Bt=Jt(_,Bt),Bt=Jt(I,Bt);const Er=Bt>-1?1:0;Er&&(Bt*=i/Pn),zt.glyphOffsetArray.length>=xu.MAX_GLYPHS&&ki("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Qi.sortKey!==void 0&&zt.addToSortKeyRanges(zt.symbolInstances.length,Qi.sortKey);const Xi=hm(Sr,Qi,Ua),[mc,L_]=(function(va,Js){const Id=va.length,Tl=Js==null?void 0:Js.values;if((Tl==null?void 0:Tl.length)>0)for(let Dd=0;Dd<Tl.length;Dd+=2){const gc=Tl[Dd+1];va.emplaceBack(T.aE[Tl[Dd]],gc[0],gc[1])}return[Id,va.length]})(zt.textAnchorOffsets,Xi);zt.symbolInstances.emplaceBack(di.x,di.y,He.right>=0?He.right:-1,He.center>=0?He.center:-1,He.left>=0?He.left:-1,He.vertical||-1,rt,ut,We,ai,hn,Be,De,Ge,lt,Vt,Ai,jn,ve,qe,q,te,Er,0,Cr,Bt,mc,L_)})(r,Ut,Qt,n,l,d,vt,r.layers[0],r.collisionBoxArray,t.index,t.sourceLayerIndex,r.index,ce,[Ue,Ue,Ue,Ue],xt,M,_e,Ye,gt,H,t,v,z,D,x)};if(yt==="line")for(const Qt of lm(t.geometry,0,0,St,St)){const Ut=_l(Qt,et),zt=D_(Ut,xe,ot,n.vertical||K,l,24,Ae,r.overscaling,St);for(const di of zt)K&&_h(r,K.text,Ot,di)||Xt(Ut,di)}else if(yt==="line-center"){for(const Qt of t.geometry)if(Qt.length>1){const Ut=_l(Qt,et),zt=Pg(Ut,ot,n.vertical||K,l,24,Ae);zt&&Xt(Ut,zt)}}else if(t.type==="Polygon")for(const Qt of Ul(t.geometry,0)){const Ut=Qs(Qt,16);Xt(_l(Qt[0],et,!0),new ko(Ut.x,Ut.y,0))}else if(t.type==="LineString")for(const Qt of t.geometry){const Ut=_l(Qt,et);Xt(Ut,new ko(Ut[0].x,Ut[0].y,0))}else if(t.type==="Point")for(const Qt of t.geometry)for(const Ut of Qt)Xt([Ut],new ko(Ut.x,Ut.y,0))}function zg(r,t,n,l,d,v,x,S,M,z,D,B,V,$,H){const K=(function(Ae,_e,xe,Ue,Ye,ot,xt,gt){const yt=Ue.layout.get("text-rotate").evaluate(ot,{})*Math.PI/180,Ot=[];for(const bt of _e.positionedLines)for(const vt of bt.positionedGlyphs){if(!vt.rect)continue;const et=vt.rect||{};let Xt=4,Qt=!0,Ut=1,zt=0;const di=(Ye||gt)&&vt.vertical,Hi=vt.metrics.advance*vt.scale/2;if(gt&&_e.verticalizable&&(zt=bt.lineOffset/2-(vt.imageName?-(Pn-vt.metrics.width*vt.scale)/2:(vt.scale-1)*Pn)),vt.imageName){const or=xt[vt.imageName];Qt=or.sdf,Ut=or.pixelRatio,Xt=1/Ut}const un=Ye?[vt.x+Hi,vt.y]:[0,0];let er=Ye?[0,0]:[vt.x+Hi+xe[0],vt.y+xe[1]-zt],Jr=[0,0];di&&(Jr=er,er=[0,0]);const tr=vt.metrics.isDoubleResolution?2:1,Sr=(vt.metrics.left-Xt)*vt.scale-Hi+er[0],yn=(-vt.metrics.top-Xt)*vt.scale+er[1],jn=Sr+et.w/tr*vt.scale/Ut,Tr=yn+et.h/tr*vt.scale/Ut,ur=new L(Sr,yn),Cr=new L(jn,yn),Fa=new L(Sr,Tr),hr=new L(jn,Tr);if(di){const or=new L(-Hi,Hi- -17),Un=-Math.PI/2,Vn=12-Hi,Qi=new L(22-Vn,-(vt.imageName?Vn:0)),Ts=new L(...Jr);ur._rotateAround(Un,or)._add(Qi)._add(Ts),Cr._rotateAround(Un,or)._add(Qi)._add(Ts),Fa._rotateAround(Un,or)._add(Qi)._add(Ts),hr._rotateAround(Un,or)._add(Qi)._add(Ts)}if(yt){const or=Math.sin(yt),Un=Math.cos(yt),Vn=[Un,-or,or,Un];ur._matMult(Vn),Cr._matMult(Vn),Fa._matMult(Vn),hr._matMult(Vn)}const Vr=new L(0,0),Fn=new L(0,0);Ot.push({tl:ur,tr:Cr,bl:Fa,br:hr,tex:et,writingMode:_e.writingMode,glyphOffset:un,sectionIndex:vt.sectionIndex,isSDF:Qt,pixelOffsetTL:Vr,pixelOffsetBR:Fn,minFontScaleX:0,minFontScaleY:0})}return Ot})(0,n,S,d,v,x,l,r.allowVerticalPlacement),ne=r.textSizeData;let ce=null;ne.kind==="source"?(ce=[ja*d.layout.get("text-size").evaluate(x,{})],ce[0]>Do&&ki(`${r.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ne.kind==="composite"&&(ce=[ja*$.compositeTextSizes[0].evaluate(x,{},H),ja*$.compositeTextSizes[1].evaluate(x,{},H)],(ce[0]>Do||ce[1]>Do)&&ki(`${r.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),r.addSymbols(r.text,K,ce,S,v,x,z,t,M.lineStartIndex,M.lineLength,V,H);for(const Ae of D)B[Ae]=r.text.placedSymbolArray.length-1;return 4*K.length}function Ig(r){for(const t in r)return r[t];return null}function _h(r,t,n,l){const d=r.compareText;if(t in d){const v=d[t];for(let x=v.length-1;x>=0;x--)if(l.dist(v[x])<n)return!0}else d[t]=[];return d[t].push(l),!1}const dm=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class fm{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,l]=new Uint8Array(t,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const d=l>>4;if(d!==1)throw new Error(`Got v${d} data when expected v1.`);const v=dm[15&l];if(!v)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(t,2,1),[S]=new Uint32Array(t,4,1);return new fm(S,x,v,t)}constructor(t,n=64,l=Float64Array,d){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=l,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const v=dm.indexOf(this.ArrayType),x=2*t*this.ArrayType.BYTES_PER_ELEMENT,S=t*this.IndexArrayType.BYTES_PER_ELEMENT,M=(8-S%8)%8;if(v<0)throw new Error(`Unexpected typed array class: ${l}.`);d&&d instanceof ArrayBuffer?(this.data=d,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+S+M,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+x+S+M),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+S+M,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+v]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=t)}add(t,n){const l=this._pos>>1;return this.ids[l]=l,this.coords[this._pos++]=t,this.coords[this._pos++]=n,l}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return pm(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,n,l,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:x,nodeSize:S}=this,M=[0,v.length-1,0],z=[];for(;M.length;){const D=M.pop()||0,B=M.pop()||0,V=M.pop()||0;if(B-V<=S){for(let ne=V;ne<=B;ne++){const ce=x[2*ne],Ae=x[2*ne+1];ce>=t&&ce<=l&&Ae>=n&&Ae<=d&&z.push(v[ne])}continue}const $=V+B>>1,H=x[2*$],K=x[2*$+1];H>=t&&H<=l&&K>=n&&K<=d&&z.push(v[$]),(D===0?t<=H:n<=K)&&(M.push(V),M.push($-1),M.push(1-D)),(D===0?l>=H:d>=K)&&(M.push($+1),M.push(B),M.push(1-D))}return z}within(t,n,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:d,coords:v,nodeSize:x}=this,S=[0,d.length-1,0],M=[],z=l*l;for(;S.length;){const D=S.pop()||0,B=S.pop()||0,V=S.pop()||0;if(B-V<=x){for(let ne=V;ne<=B;ne++)kg(v[2*ne],v[2*ne+1],t,n)<=z&&M.push(d[ne]);continue}const $=V+B>>1,H=v[2*$],K=v[2*$+1];kg(H,K,t,n)<=z&&M.push(d[$]),(D===0?t-l<=H:n-l<=K)&&(S.push(V),S.push($-1),S.push(1-D)),(D===0?t+l>=H:n+l>=K)&&(S.push($+1),S.push(B),S.push(1-D))}return M}}function pm(r,t,n,l,d,v){if(d-l<=n)return;const x=l+d>>1;Dg(r,t,x,l,d,v),pm(r,t,n,l,x-1,1-v),pm(r,t,n,x+1,d,1-v)}function Dg(r,t,n,l,d,v){for(;d>l;){if(d-l>600){const z=d-l+1,D=n-l+1,B=Math.log(z),V=.5*Math.exp(2*B/3),$=.5*Math.sqrt(B*V*(z-V)/z)*(D-z/2<0?-1:1);Dg(r,t,n,Math.max(l,Math.floor(n-D*V/z+$)),Math.min(d,Math.floor(n+(z-D)*V/z+$)),v)}const x=t[2*n+v];let S=l,M=d;for(Rd(r,t,l,n),t[2*d+v]>x&&Rd(r,t,l,d);S<M;){for(Rd(r,t,S,M),S++,M--;t[2*S+v]<x;)S++;for(;t[2*M+v]>x;)M--}t[2*l+v]===x?Rd(r,t,l,M):(M++,Rd(r,t,M,d)),M<=n&&(l=M+1),n<=M&&(d=M-1)}}function Rd(r,t,n,l){mm(r,n,l),mm(t,2*n,2*l),mm(t,2*n+1,2*l+1)}function mm(r,t,n){const l=r[t];r[t]=r[n],r[n]=l}function kg(r,t,n,l){const d=r-n,v=t-l;return d*d+v*v}var gm;T.cx=void 0,(gm=T.cx||(T.cx={})).create="create",gm.load="load",gm.fullLoad="fullLoad";let zd=null,Lo=[];const Tu=1e3/60,qf="loadTime",_m="fullLoadTime",yh={mark(r){performance.mark(r)},frame(r){const t=r;zd!=null&&Lo.push(t-zd),zd=t},clearMetrics(){zd=null,Lo=[],performance.clearMeasures(qf),performance.clearMeasures(_m);for(const r in T.cx)performance.clearMarks(T.cx[r])},getPerformanceMetrics(){performance.measure(qf,T.cx.create,T.cx.load),performance.measure(_m,T.cx.create,T.cx.fullLoad);const r=performance.getEntriesByName(qf)[0].duration,t=performance.getEntriesByName(_m)[0].duration,n=Lo.length,l=1/(Lo.reduce(((v,x)=>v+x),0)/n/1e3),d=Lo.filter((v=>v>Tu)).reduce(((v,x)=>v+(x-Tu)/Tu),0);return{loadTime:r,fullLoadTime:t,fps:l,percentDroppedFrames:d/(n+d)*100,totalFrames:n}}};T.$=St,T.A=Ee,T.B=function([r,t,n]){return t+=90,t*=Math.PI/180,n*=Math.PI/180,{x:r*Math.cos(t)*Math.sin(n),y:r*Math.sin(t)*Math.sin(n),z:r*Math.cos(n)}},T.C=_s,T.D=Pt,T.E=It,T.F=ji,T.G=Ya,T.H=function(r){if(zn==null){const t=r.navigator?r.navigator.userAgent:null;zn=!!r.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return zn},T.I=gd,T.J=class{constructor(r,t){this.target=r,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Sg((()=>this.process())),this.subscription=As(this.target,"message",(n=>this.receive(n)),!1),this.globalScope=Mr(self)?r:window}registerMessageHandler(r,t){this.messageHandlers[r]=t}sendAsync(r,t){return new Promise(((n,l)=>{const d=Math.round(1e18*Math.random()).toString(36).substring(0,10),v=t?As(t.signal,"abort",(()=>{v==null||v.unsubscribe(),delete this.resolveRejects[d];const M={id:d,type:"<cancel>",origin:location.origin,targetMapId:r.targetMapId,sourceMapId:this.mapId};this.target.postMessage(M)}),Ii):null;this.resolveRejects[d]={resolve:M=>{v==null||v.unsubscribe(),n(M)},reject:M=>{v==null||v.unsubscribe(),l(M)}};const x=[],S=Object.assign(Object.assign({},r),{id:d,sourceMapId:this.mapId,origin:location.origin,data:ll(r.data,x)});this.target.postMessage(S,{transfer:x})}))}receive(r){const t=r.data,n=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[n];const l=this.abortControllers[n];return delete this.abortControllers[n],void(l&&l.abort())}if(Mr(self)||t.mustQueue)return this.tasks[n]=t,this.taskQueue.push(n),void this.invoker.trigger();this.processTask(n,t)}}process(){if(this.taskQueue.length===0)return;const r=this.taskQueue.shift(),t=this.tasks[r];delete this.tasks[r],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(r,t)}processTask(r,t){return o(this,void 0,void 0,(function*(){if(t.type==="<response>"){const d=this.resolveRejects[r];return delete this.resolveRejects[r],d?void(t.error?d.reject(Wa(t.error)):d.resolve(Wa(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(r,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const n=Wa(t.data),l=new AbortController;this.abortControllers[r]=l;try{const d=yield this.messageHandlers[t.type](t.sourceMapId,n,l);this.completeTask(r,null,d)}catch(d){this.completeTask(r,d)}}))}completeTask(r,t,n){const l=[];delete this.abortControllers[r];const d={id:r,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?ll(t):null,data:ll(n,l)};this.target.postMessage(d,{transfer:l})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},T.K=re,T.L=function(){var r=new Ee(16);return Ee!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},T.M=function(r,t,n){var l,d,v,x,S,M,z,D,B,V,$,H,K=n[0],ne=n[1],ce=n[2];return t===r?(r[12]=t[0]*K+t[4]*ne+t[8]*ce+t[12],r[13]=t[1]*K+t[5]*ne+t[9]*ce+t[13],r[14]=t[2]*K+t[6]*ne+t[10]*ce+t[14],r[15]=t[3]*K+t[7]*ne+t[11]*ce+t[15]):(d=t[1],v=t[2],x=t[3],S=t[4],M=t[5],z=t[6],D=t[7],B=t[8],V=t[9],$=t[10],H=t[11],r[0]=l=t[0],r[1]=d,r[2]=v,r[3]=x,r[4]=S,r[5]=M,r[6]=z,r[7]=D,r[8]=B,r[9]=V,r[10]=$,r[11]=H,r[12]=l*K+S*ne+B*ce+t[12],r[13]=d*K+M*ne+V*ce+t[13],r[14]=v*K+z*ne+$*ce+t[14],r[15]=x*K+D*ne+H*ce+t[15]),r},T.N=function(r,t,n){var l=n[0],d=n[1],v=n[2];return r[0]=t[0]*l,r[1]=t[1]*l,r[2]=t[2]*l,r[3]=t[3]*l,r[4]=t[4]*d,r[5]=t[5]*d,r[6]=t[6]*d,r[7]=t[7]*d,r[8]=t[8]*v,r[9]=t[9]*v,r[10]=t[10]*v,r[11]=t[11]*v,r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},T.O=function(r,t,n){var l=t[0],d=t[1],v=t[2],x=t[3],S=t[4],M=t[5],z=t[6],D=t[7],B=t[8],V=t[9],$=t[10],H=t[11],K=t[12],ne=t[13],ce=t[14],Ae=t[15],_e=n[0],xe=n[1],Ue=n[2],Ye=n[3];return r[0]=_e*l+xe*S+Ue*B+Ye*K,r[1]=_e*d+xe*M+Ue*V+Ye*ne,r[2]=_e*v+xe*z+Ue*$+Ye*ce,r[3]=_e*x+xe*D+Ue*H+Ye*Ae,r[4]=(_e=n[4])*l+(xe=n[5])*S+(Ue=n[6])*B+(Ye=n[7])*K,r[5]=_e*d+xe*M+Ue*V+Ye*ne,r[6]=_e*v+xe*z+Ue*$+Ye*ce,r[7]=_e*x+xe*D+Ue*H+Ye*Ae,r[8]=(_e=n[8])*l+(xe=n[9])*S+(Ue=n[10])*B+(Ye=n[11])*K,r[9]=_e*d+xe*M+Ue*V+Ye*ne,r[10]=_e*v+xe*z+Ue*$+Ye*ce,r[11]=_e*x+xe*D+Ue*H+Ye*Ae,r[12]=(_e=n[12])*l+(xe=n[13])*S+(Ue=n[14])*B+(Ye=n[15])*K,r[13]=_e*d+xe*M+Ue*V+Ye*ne,r[14]=_e*v+xe*z+Ue*$+Ye*ce,r[15]=_e*x+xe*D+Ue*H+Ye*Ae,r},T.P=L,T.Q=function(r,t){const n={};for(let l=0;l<t.length;l++){const d=t[l];d in r&&(n[d]=r[d])}return n},T.R=Wr,T.S=Ks,T.T=Ws,T.U=ph,T.V=Bf,T.W=me,T.X=Ce,T.Y=jo,T.Z=aa,T._=o,T.a=W,T.a$=Lt,T.a0=function(r,t){var n,l,d,v;if(!r)return t??{};if(!t)return r;const x=Object.assign({},r);if(t.removeAll&&(x.removeAll=!0),t.remove){const S=new Set(x.remove?x.remove.concat(t.remove):t.remove);x.remove=Array.from(S.values())}if(t.add){const S=x.add?x.add.concat(t.add):t.add,M=new Map(S.map((z=>[z.id,z])));x.add=Array.from(M.values())}if(t.update){const S=new Map((n=x.update)===null||n===void 0?void 0:n.map((M=>[M.id,M])));for(const M of t.update){const z=(l=S.get(M.id))!==null&&l!==void 0?l:{id:M.id};M.newGeometry&&(z.newGeometry=M.newGeometry),M.addOrUpdateProperties&&(z.addOrUpdateProperties=((d=z.addOrUpdateProperties)!==null&&d!==void 0?d:[]).concat(M.addOrUpdateProperties)),M.removeProperties&&(z.removeProperties=((v=z.removeProperties)!==null&&v!==void 0?v:[]).concat(M.removeProperties)),M.removeAllProperties&&(z.removeAllProperties=!0),S.set(M.id,z)}x.update=Array.from(S.values())}return x},T.a1=Md,T.a2=Xn,T.a3=25,T.a4=Nf,T.a5=r=>{const t=window.document.createElement("video");return t.muted=!0,new Promise((n=>{t.onloadstart=()=>{n(t)};for(const l of r){const d=window.document.createElement("source");je(l)||(t.crossOrigin="Anonymous"),d.src=l,t.appendChild(d)}}))},T.a6=pt,T.a7=function(){return bi++},T.a8=j,T.a9=xu,T.aA=function(r){let t=1/0,n=1/0,l=-1/0,d=-1/0;for(const v of r)t=Math.min(t,v.x),n=Math.min(n,v.y),l=Math.max(l,v.x),d=Math.max(d,v.y);return[t,n,l,d]},T.aB=Pn,T.aC=be,T.aD=function(r,t,n,l,d=!1){if(!n[0]&&!n[1])return[0,0];const v=d?l==="map"?-r.bearingInRadians:0:l==="viewport"?r.bearingInRadians:0;if(v){const x=Math.sin(v),S=Math.cos(v);n=[n[0]*S-n[1]*x,n[0]*x+n[1]*S]}return[d?n[0]:be(t,n[0],r.zoom),d?n[1]:be(t,n[1],r.zoom)]},T.aF=bd,T.aG=gh,T.aH=Df,T.aI=fm,T.aJ=kn,T.aK=Kr,T.aL=fe,T.aM=oi,T.aN=qi,T.aO=At,T.aP=no,T.aQ=sm,T.aR=ht,T.aS=at,T.aT=function(r){var t=new Ee(3);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t},T.aU=function(r,t,n){return r[0]=t[0]-n[0],r[1]=t[1]-n[1],r[2]=t[2]-n[2],r},T.aV=function(r,t){var n=t[0],l=t[1],d=t[2],v=n*n+l*l+d*d;return v>0&&(v=1/Math.sqrt(v)),r[0]=t[0]*v,r[1]=t[1]*v,r[2]=t[2]*v,r},T.aW=Ct,T.aX=function(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]},T.aY=function(r,t,n){return r[0]=t[0]*n[0],r[1]=t[1]*n[1],r[2]=t[2]*n[2],r[3]=t[3]*n[3],r},T.aZ=tt,T.a_=function(r,t,n){const l=t[0]*n[0]+t[1]*n[1]+t[2]*n[2];return l===0?null:(-(r[0]*n[0]+r[1]*n[1]+r[2]*n[2])-n[3])/l},T.aa=go,T.ab=La,T.ac=jf,T.ad=function(r){const t={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((n,l,d,v)=>{const x=d||v;return t[l]=!x||x.toLowerCase(),""})),t["max-age"]){const n=parseInt(t["max-age"],10);isNaN(n)?delete t["max-age"]:t["max-age"]=n}return t},T.ae=Fo,T.af=function(r){return Math.pow(2,r)},T.ag=Ve,T.ah=kt,T.ai=85.051129,T.aj=Ed,T.ak=function(r){return Math.log(r)/Math.LN2},T.al=function(r){var t=r[0],n=r[1];return t*t+n*n},T.am=function(r,t){const n=[];for(const l in r)l in t||n.push(l);return n},T.an=function(r,t){let n=0,l=0;if(r.kind==="constant")l=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:d,minZoom:v,maxZoom:x}=r,S=d?kt(vr.interpolationFactor(d,t,v,x),0,1):0;r.kind==="camera"?l=_s.number(r.minSize,r.maxSize,S):n=S}return{uSizeT:n,uSize:l}},T.ap=function(r,{uSize:t,uSizeT:n},{lowerSize:l,upperSize:d}){return r.kind==="source"?l/ja:r.kind==="composite"?_s.number(l/ja,d/ja,n):t},T.aq=function(r,t){var n=t[0],l=t[1],d=t[2],v=t[3],x=t[4],S=t[5],M=t[6],z=t[7],D=t[8],B=t[9],V=t[10],$=t[11],H=t[12],K=t[13],ne=t[14],ce=t[15],Ae=n*S-l*x,_e=n*M-d*x,xe=n*z-v*x,Ue=l*M-d*S,Ye=l*z-v*S,ot=d*z-v*M,xt=D*K-B*H,gt=D*ne-V*H,yt=D*ce-$*H,Ot=B*ne-V*K,bt=B*ce-$*K,vt=V*ce-$*ne,et=Ae*vt-_e*bt+xe*Ot+Ue*yt-Ye*gt+ot*xt;return et?(r[0]=(S*vt-M*bt+z*Ot)*(et=1/et),r[1]=(d*bt-l*vt-v*Ot)*et,r[2]=(K*ot-ne*Ye+ce*Ue)*et,r[3]=(V*Ye-B*ot-$*Ue)*et,r[4]=(M*yt-x*vt-z*gt)*et,r[5]=(n*vt-d*yt+v*gt)*et,r[6]=(ne*xe-H*ot-ce*_e)*et,r[7]=(D*ot-V*xe+$*_e)*et,r[8]=(x*bt-S*yt+z*xt)*et,r[9]=(l*yt-n*bt-v*xt)*et,r[10]=(H*Ye-K*xe+ce*Ae)*et,r[11]=(B*xe-D*Ye-$*Ae)*et,r[12]=(S*gt-x*Ot-M*xt)*et,r[13]=(n*Ot-l*gt+d*xt)*et,r[14]=(K*_e-H*Ue-ne*Ae)*et,r[15]=(D*Ue-B*_e+V*Ae)*et,r):null},T.ar=it,T.as=function(r){var t=r[0],n=r[1];return Math.sqrt(t*t+n*n)},T.at=function(r){return r[0]=0,r[1]=0,r},T.au=function(r,t,n){return r[0]=t[0]*n,r[1]=t[1]*n,r},T.av=vu,T.aw=Gt,T.ax=function(r,t,n,l){const d=t.y-r.y,v=t.x-r.x,x=l.y-n.y,S=l.x-n.x,M=x*v-S*d;if(M===0)return null;const z=(S*(r.y-n.y)-x*(r.x-n.x))/M;return new L(r.x+z*v,r.y+z*d)},T.ay=lm,T.az=Rp,T.b=wa,T.b$=class extends m{},T.b0=function(r,t,n){return r[0]=t[0]*n,r[1]=t[1]*n,r[2]=t[2]*n,r[3]=t[3]*n,r},T.b1=function(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]+r[3]},T.b2=om,T.b3=Ui,T.b4=function(r,t,n,l,d){var v=1/Math.tan(t/2);if(r[0]=v/n,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=v,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,d!=null&&d!==1/0){var x=1/(l-d);r[10]=(d+l)*x,r[14]=2*d*l*x}else r[10]=-1,r[14]=-2*l;return r},T.b5=function(r){var t=new Ee(16);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},T.b6=function(r,t,n){var l=Math.sin(n),d=Math.cos(n),v=t[0],x=t[1],S=t[2],M=t[3],z=t[4],D=t[5],B=t[6],V=t[7];return t!==r&&(r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=v*d+z*l,r[1]=x*d+D*l,r[2]=S*d+B*l,r[3]=M*d+V*l,r[4]=z*d-v*l,r[5]=D*d-x*l,r[6]=B*d-S*l,r[7]=V*d-M*l,r},T.b7=function(r,t,n){var l=Math.sin(n),d=Math.cos(n),v=t[4],x=t[5],S=t[6],M=t[7],z=t[8],D=t[9],B=t[10],V=t[11];return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[4]=v*d+z*l,r[5]=x*d+D*l,r[6]=S*d+B*l,r[7]=M*d+V*l,r[8]=z*d-v*l,r[9]=D*d-x*l,r[10]=B*d-S*l,r[11]=V*d-M*l,r},T.b8=function(){const r=new Float32Array(16);return Ve(r),r},T.b9=function(){const r=new Float64Array(16);return Ve(r),r},T.bA=function(r,t){const n=Ke(r,360),l=Ke(t,360),d=l-n,v=l>n?d-360:d+360;return Math.abs(d)<Math.abs(v)?d:v},T.bB=function(r){return r[0]=0,r[1]=0,r[2]=0,r},T.bC=function(r,t,n,l){const d=Math.sqrt(r*r+t*t),v=Math.sqrt(n*n+l*l);r/=d,t/=d,n/=v,l/=v;const x=Math.acos(r*n+t*l);return-t*n+r*l>0?x:-x},T.bD=function(r,t){const n=Ke(r,2*Math.PI),l=Ke(t,2*Math.PI);return Math.min(Math.abs(n-l),Math.abs(n-l+2*Math.PI),Math.abs(n-l-2*Math.PI))},T.bE=function(){const r={},t=Ie.$version;for(const n in Ie.$root){const l=Ie.$root[n];if(l.required){let d=null;d=n==="version"?t:l.type==="array"?[]:{},d!=null&&(r[n]=d)}}return r},T.bF=iu,T.bG=we,T.bH=function r(t,n){if(Array.isArray(t)){if(!Array.isArray(n)||t.length!==n.length)return!1;for(let l=0;l<t.length;l++)if(!r(t[l],n[l]))return!1;return!0}if(typeof t=="object"&&t!==null&&n!==null){if(typeof n!="object"||Object.keys(t).length!==Object.keys(n).length)return!1;for(const l in t)if(!r(t[l],n[l]))return!1;return!0}return t===n},T.bI=function(r){r=r.slice();const t=Object.create(null);for(let n=0;n<r.length;n++)t[r[n].id]=r[n];for(let n=0;n<r.length;n++)"ref"in r[n]&&(r[n]=_i(r[n],t[r[n].ref]));return r},T.bJ=function(r){if(r.type==="custom")return new I_(r);switch(r.type){case"background":return new rm(r);case"circle":return new Hm(r);case"color-relief":return new Km(r);case"fill":return new sc(r);case"fill-extrusion":return new zi(r);case"heatmap":return new Bp(r);case"hillshade":return new Xm(r);case"line":return new Ba(r);case"raster":return new Td(r);case"symbol":return new Sd(r)}},T.bK=ni,T.bL=function(r,t){if(!r)return[{command:"setStyle",args:[t]}];let n=[];try{if(!jt(r.version,t.version))return[{command:"setStyle",args:[t]}];jt(r.center,t.center)||n.push({command:"setCenter",args:[t.center]}),jt(r.state,t.state)||n.push({command:"setGlobalState",args:[t.state]}),jt(r.centerAltitude,t.centerAltitude)||n.push({command:"setCenterAltitude",args:[t.centerAltitude]}),jt(r.zoom,t.zoom)||n.push({command:"setZoom",args:[t.zoom]}),jt(r.bearing,t.bearing)||n.push({command:"setBearing",args:[t.bearing]}),jt(r.pitch,t.pitch)||n.push({command:"setPitch",args:[t.pitch]}),jt(r.roll,t.roll)||n.push({command:"setRoll",args:[t.roll]}),jt(r.sprite,t.sprite)||n.push({command:"setSprite",args:[t.sprite]}),jt(r.glyphs,t.glyphs)||n.push({command:"setGlyphs",args:[t.glyphs]}),jt(r.transition,t.transition)||n.push({command:"setTransition",args:[t.transition]}),jt(r.light,t.light)||n.push({command:"setLight",args:[t.light]}),jt(r.terrain,t.terrain)||n.push({command:"setTerrain",args:[t.terrain]}),jt(r.sky,t.sky)||n.push({command:"setSky",args:[t.sky]}),jt(r.projection,t.projection)||n.push({command:"setProjection",args:[t.projection]});const l={},d=[];(function(x,S,M,z){let D;for(D in S=S||{},x=x||{})Object.prototype.hasOwnProperty.call(x,D)&&(Object.prototype.hasOwnProperty.call(S,D)||Wn(D,M,z));for(D in S)Object.prototype.hasOwnProperty.call(S,D)&&(Object.prototype.hasOwnProperty.call(x,D)?jt(x[D],S[D])||(x[D].type==="geojson"&&S[D].type==="geojson"&&en(x,S,D)?si(M,{command:"setGeoJSONSourceData",args:[D,S[D].data]}):ir(D,S,M,z)):Yi(D,S,M))})(r.sources,t.sources,d,l);const v=[];r.layers&&r.layers.forEach((x=>{"source"in x&&l[x.source]?n.push({command:"removeLayer",args:[x.id]}):v.push(x)})),n=n.concat(d),(function(x,S,M){S=S||[];const z=(x=x||[]).map(ti),D=S.map(ti),B=x.reduce(fn,{}),V=S.reduce(fn,{}),$=z.slice(),H=Object.create(null);let K,ne,ce,Ae,_e;for(let xe=0,Ue=0;xe<z.length;xe++)K=z[xe],Object.prototype.hasOwnProperty.call(V,K)?Ue++:(si(M,{command:"removeLayer",args:[K]}),$.splice($.indexOf(K,Ue),1));for(let xe=0,Ue=0;xe<D.length;xe++)K=D[D.length-1-xe],$[$.length-1-xe]!==K&&(Object.prototype.hasOwnProperty.call(B,K)?(si(M,{command:"removeLayer",args:[K]}),$.splice($.lastIndexOf(K,$.length-Ue),1)):Ue++,Ae=$[$.length-xe],si(M,{command:"addLayer",args:[V[K],Ae]}),$.splice($.length-xe,0,K),H[K]=!0);for(let xe=0;xe<D.length;xe++)if(K=D[xe],ne=B[K],ce=V[K],!H[K]&&!jt(ne,ce))if(jt(ne.source,ce.source)&&jt(ne["source-layer"],ce["source-layer"])&&jt(ne.type,ce.type)){for(_e in Wt(ne.layout,ce.layout,M,K,null,"setLayoutProperty"),Wt(ne.paint,ce.paint,M,K,null,"setPaintProperty"),jt(ne.filter,ce.filter)||si(M,{command:"setFilter",args:[K,ce.filter]}),jt(ne.minzoom,ce.minzoom)&&jt(ne.maxzoom,ce.maxzoom)||si(M,{command:"setLayerZoomRange",args:[K,ce.minzoom,ce.maxzoom]}),ne)Object.prototype.hasOwnProperty.call(ne,_e)&&_e!=="layout"&&_e!=="paint"&&_e!=="filter"&&_e!=="metadata"&&_e!=="minzoom"&&_e!=="maxzoom"&&(_e.indexOf("paint.")===0?Wt(ne[_e],ce[_e],M,K,_e.slice(6),"setPaintProperty"):jt(ne[_e],ce[_e])||si(M,{command:"setLayerProperty",args:[K,_e,ce[_e]]}));for(_e in ce)Object.prototype.hasOwnProperty.call(ce,_e)&&!Object.prototype.hasOwnProperty.call(ne,_e)&&_e!=="layout"&&_e!=="paint"&&_e!=="filter"&&_e!=="metadata"&&_e!=="minzoom"&&_e!=="maxzoom"&&(_e.indexOf("paint.")===0?Wt(ne[_e],ce[_e],M,K,_e.slice(6),"setPaintProperty"):jt(ne[_e],ce[_e])||si(M,{command:"setLayerProperty",args:[K,_e,ce[_e]]}))}else si(M,{command:"removeLayer",args:[K]}),Ae=$[$.lastIndexOf(K)+1],si(M,{command:"addLayer",args:[ce,Ae]})})(v,t.layers,n)}catch(l){console.warn("Unable to compute style diff:",l),n=[{command:"setStyle",args:[t]}]}return n},T.bM=function(r){const t=[],n=r.id;return n===void 0&&t.push({message:`layers.${n}: missing required property "id"`}),r.render===void 0&&t.push({message:`layers.${n}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&t.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),t},T.bN=wi,T.bO=gi,T.bP=class extends jr{constructor(r,t){super(r,t),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},T.bQ=An,T.bR=class extends jr{constructor(r,t){super(r,t),this.current=Yr}set(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let t=1;t<16;t++)if(r[t]!==this.current[t]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}},T.bS=_n,T.bT=class extends jr{constructor(r,t){super(r,t),this.current=[0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))}},T.bU=class extends jr{constructor(r,t){super(r,t),this.current=[0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))}},T.bV=ke,T.bW=function(r,t){var n=Math.sin(t),l=Math.cos(t);return r[0]=l,r[1]=n,r[2]=0,r[3]=-n,r[4]=l,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},T.bX=function(r,t,n){var l=t[0],d=t[1],v=t[2];return r[0]=l*n[0]+d*n[3]+v*n[6],r[1]=l*n[1]+d*n[4]+v*n[7],r[2]=l*n[2]+d*n[5]+v*n[8],r},T.bY=function(r,t,n,l,d,v,x){var S=1/(t-n),M=1/(l-d),z=1/(v-x);return r[0]=-2*S,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*M,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*z,r[11]=0,r[12]=(t+n)*S,r[13]=(d+l)*M,r[14]=(x+v)*z,r[15]=1,r},T.bZ=class extends jr{constructor(r,t){super(r,t),this.current=new Array}set(r){if(r!=this.current){this.current=r;const t=new Float32Array(4*r.length);for(let n=0;n<r.length;n++)t[4*n]=r[n].r,t[4*n+1]=r[n].g,t[4*n+2]=r[n].b,t[4*n+3]=r[n].a;this.gl.uniform4fv(this.location,t)}}},T.b_=class extends jr{constructor(r,t){super(r,t),this.current=new Array}set(r){if(r!=this.current){this.current=r;const t=new Float32Array(r);this.gl.uniform1fv(this.location,t)}}},T.ba=function(){return new Float64Array(16)},T.bb=function(r,t,n){const l=new Float64Array(4);return Oe(l,r,t-90,n),l},T.bc=function(r,t,n,l){var d,v,x,S,M,z=t[0],D=t[1],B=t[2],V=t[3],$=n[0],H=n[1],K=n[2],ne=n[3];return(v=z*$+D*H+B*K+V*ne)<0&&(v=-v,$=-$,H=-H,K=-K,ne=-ne),1-v>Se?(d=Math.acos(v),x=Math.sin(d),S=Math.sin((1-l)*d)/x,M=Math.sin(l*d)/x):(S=1-l,M=l),r[0]=S*z+M*$,r[1]=S*D+M*H,r[2]=S*B+M*K,r[3]=S*V+M*ne,r},T.bd=function(r){const t=new Float64Array(9);var n,l,d,v,x,S,M,z,D,B,V,$,H,K,ne,ce,Ae,_e;B=(d=(l=r)[0])*(M=d+d),V=(v=l[1])*M,H=(x=l[2])*M,K=x*(z=v+v),ce=(S=l[3])*M,Ae=S*z,_e=S*(D=x+x),(n=t)[0]=1-($=v*z)-(ne=x*D),n[3]=V-_e,n[6]=H+Ae,n[1]=V+_e,n[4]=1-B-ne,n[7]=K-ce,n[2]=H-Ae,n[5]=K+ce,n[8]=1-B-$;const xe=no(-Math.asin(kt(t[2],-1,1)));let Ue,Ye;return Math.hypot(t[5],t[8])<.001?(Ue=0,Ye=-no(Math.atan2(t[3],t[4]))):(Ue=no(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),Ye=no(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:Ue,pitch:xe+90,bearing:Ye}},T.be=function(r,t){return r.roll==t.roll&&r.pitch==t.pitch&&r.bearing==t.bearing},T.bf=pi,T.bg=Eo,T.bh=Oa,T.bi=nh,T.bj=an,T.bk=wt,T.bl=ft,T.bm=Mn,T.bn=function(r,t,n,l,d){return wt(l,d,kt((r-t)/(n-t),0,1))},T.bo=Ke,T.bp=function(){return new Float64Array(3)},T.bq=function(r,t,n,l){return r[0]=t[0]+n[0]*l,r[1]=t[1]+n[1]*l,r[2]=t[2]+n[2]*l,r},T.br=Oe,T.bs=function(r,t,n){var l=n[0],d=n[1],v=n[2],x=n[3],S=t[0],M=t[1],z=t[2],D=d*z-v*M,B=v*S-l*z,V=l*M-d*S;return r[0]=S+x*(D+=D)+d*(V+=V)-v*(B+=B),r[1]=M+x*B+v*D-l*V,r[2]=z+x*V+l*B-d*D,r},T.bt=function(r,t,n){const l=(d=[r[0],r[1],r[2],t[0],t[1],t[2],n[0],n[1],n[2]])[0]*((D=d[8])*(x=d[4])-(S=d[5])*(z=d[7]))+d[1]*(-D*(v=d[3])+S*(M=d[6]))+d[2]*(z*v-x*M);var d,v,x,S,M,z,D;if(l===0)return null;const B=Ct([],[t[0],t[1],t[2]],[n[0],n[1],n[2]]),V=Ct([],[n[0],n[1],n[2]],[r[0],r[1],r[2]]),$=Ct([],[r[0],r[1],r[2]],[t[0],t[1],t[2]]),H=ht([],B,-r[3]);return at(H,H,ht([],V,-t[3])),at(H,H,ht([],$,-n[3])),ht(H,H,1/l),H},T.bu=Cd,T.bv=function(){return new Float64Array(4)},T.bw=function(r,t,n,l){var d=[],v=[];return d[0]=t[0]-n[0],d[1]=t[1]-n[1],d[2]=t[2]-n[2],v[0]=d[0]*Math.cos(l)-d[1]*Math.sin(l),v[1]=d[0]*Math.sin(l)+d[1]*Math.cos(l),v[2]=d[2],r[0]=v[0]+n[0],r[1]=v[1]+n[1],r[2]=v[2]+n[2],r},T.bx=function(r,t,n,l){var d=[],v=[];return d[0]=t[0]-n[0],d[1]=t[1]-n[1],d[2]=t[2]-n[2],v[0]=d[0],v[1]=d[1]*Math.cos(l)-d[2]*Math.sin(l),v[2]=d[1]*Math.sin(l)+d[2]*Math.cos(l),r[0]=v[0]+n[0],r[1]=v[1]+n[1],r[2]=v[2]+n[2],r},T.by=function(r,t,n,l){var d=[],v=[];return d[0]=t[0]-n[0],d[1]=t[1]-n[1],d[2]=t[2]-n[2],v[0]=d[2]*Math.sin(l)+d[0]*Math.cos(l),v[1]=d[1],v[2]=d[2]*Math.cos(l)-d[0]*Math.sin(l),r[0]=v[0]+n[0],r[1]=v[1]+n[1],r[2]=v[2]+n[2],r},T.bz=function(r,t,n){var l=Math.sin(n),d=Math.cos(n),v=t[0],x=t[1],S=t[2],M=t[3],z=t[8],D=t[9],B=t[10],V=t[11];return t!==r&&(r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=v*d-z*l,r[1]=x*d-D*l,r[2]=S*d-B*l,r[3]=M*d-V*l,r[8]=v*l+z*d,r[9]=x*l+D*d,r[10]=S*l+B*d,r[11]=M*l+V*d,r},T.c=Me,T.c0=Qr,T.c1=class extends a{},T.c2=xf,T.c3=function(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))},T.c4=vf,T.c5=function(r,t,n){var l=t[0],d=t[1],v=t[2],x=n[3]*l+n[7]*d+n[11]*v+n[15];return r[0]=(n[0]*l+n[4]*d+n[8]*v+n[12])/(x=x||1),r[1]=(n[1]*l+n[5]*d+n[9]*v+n[13])/x,r[2]=(n[2]*l+n[6]*d+n[10]*v+n[14])/x,r},T.c6=class extends Nr{},T.c7=class extends k{},T.c8=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]&&r[4]===t[4]&&r[5]===t[5]&&r[6]===t[6]&&r[7]===t[7]&&r[8]===t[8]&&r[9]===t[9]&&r[10]===t[10]&&r[11]===t[11]&&r[12]===t[12]&&r[13]===t[13]&&r[14]===t[14]&&r[15]===t[15]},T.c9=function(r,t){var n=r[0],l=r[1],d=r[2],v=r[3],x=r[4],S=r[5],M=r[6],z=r[7],D=r[8],B=r[9],V=r[10],$=r[11],H=r[12],K=r[13],ne=r[14],ce=r[15],Ae=t[0],_e=t[1],xe=t[2],Ue=t[3],Ye=t[4],ot=t[5],xt=t[6],gt=t[7],yt=t[8],Ot=t[9],bt=t[10],vt=t[11],et=t[12],Xt=t[13],Qt=t[14],Ut=t[15];return Math.abs(n-Ae)<=Se*Math.max(1,Math.abs(n),Math.abs(Ae))&&Math.abs(l-_e)<=Se*Math.max(1,Math.abs(l),Math.abs(_e))&&Math.abs(d-xe)<=Se*Math.max(1,Math.abs(d),Math.abs(xe))&&Math.abs(v-Ue)<=Se*Math.max(1,Math.abs(v),Math.abs(Ue))&&Math.abs(x-Ye)<=Se*Math.max(1,Math.abs(x),Math.abs(Ye))&&Math.abs(S-ot)<=Se*Math.max(1,Math.abs(S),Math.abs(ot))&&Math.abs(M-xt)<=Se*Math.max(1,Math.abs(M),Math.abs(xt))&&Math.abs(z-gt)<=Se*Math.max(1,Math.abs(z),Math.abs(gt))&&Math.abs(D-yt)<=Se*Math.max(1,Math.abs(D),Math.abs(yt))&&Math.abs(B-Ot)<=Se*Math.max(1,Math.abs(B),Math.abs(Ot))&&Math.abs(V-bt)<=Se*Math.max(1,Math.abs(V),Math.abs(bt))&&Math.abs($-vt)<=Se*Math.max(1,Math.abs($),Math.abs(vt))&&Math.abs(H-et)<=Se*Math.max(1,Math.abs(H),Math.abs(et))&&Math.abs(K-Xt)<=Se*Math.max(1,Math.abs(K),Math.abs(Xt))&&Math.abs(ne-Qt)<=Se*Math.max(1,Math.abs(ne),Math.abs(Qt))&&Math.abs(ce-Ut)<=Se*Math.max(1,Math.abs(ce),Math.abs(Ut))},T.cA=function(r,t){W.REGISTERED_PROTOCOLS[r]=t},T.cB=function(r){delete W.REGISTERED_PROTOCOLS[r]},T.cC=function(r,t){const n={};for(let d=0;d<r.length;d++){const v=t&&t[r[d].id]||sl(r[d]);t&&(t[r[d].id]=v);let x=n[v];x||(x=n[v]=[]),x.push(r[d])}const l=[];for(const d in n)l.push(n[d]);return l},T.cD=Mt,T.cE=Cg,T.cF=Ff,T.cG=pg,T.cH=function(r){r.bucket.createArrays(),r.bucket.tilePixelRatio=St/(512*r.bucket.overscaling),r.bucket.compareText={},r.bucket.iconsNeedLinear=!1;const t=r.bucket.layers[0],n=t.layout,l=t._unevaluatedLayout._values,d={layoutIconSize:l["icon-size"].possiblyEvaluate(new ji(r.bucket.zoom+1),r.canonical),layoutTextSize:l["text-size"].possiblyEvaluate(new ji(r.bucket.zoom+1),r.canonical),textMaxSize:l["text-size"].possiblyEvaluate(new ji(18))};if(r.bucket.textSizeData.kind==="composite"){const{minZoom:z,maxZoom:D}=r.bucket.textSizeData;d.compositeTextSizes=[l["text-size"].possiblyEvaluate(new ji(z),r.canonical),l["text-size"].possiblyEvaluate(new ji(D),r.canonical)]}if(r.bucket.iconSizeData.kind==="composite"){const{minZoom:z,maxZoom:D}=r.bucket.iconSizeData;d.compositeIconSizes=[l["icon-size"].possiblyEvaluate(new ji(z),r.canonical),l["icon-size"].possiblyEvaluate(new ji(D),r.canonical)]}const v=n.get("text-line-height")*Pn,x=n.get("text-rotation-alignment")!=="viewport"&&n.get("symbol-placement")!=="point",S=n.get("text-keep-upright"),M=n.get("text-size");for(const z of r.bucket.features){const D=n.get("text-font").evaluate(z,{},r.canonical).join(","),B=M.evaluate(z,{},r.canonical),V=d.layoutTextSize.evaluate(z,{},r.canonical),$=d.layoutIconSize.evaluate(z,{},r.canonical),H={horizontal:{},vertical:void 0},K=z.text;let ne,ce=[0,0];if(K){const xe=K.toString(),Ue=n.get("text-letter-spacing").evaluate(z,{},r.canonical)*Pn,Ye=id(xe)?Ue:0,ot=n.get("text-anchor").evaluate(z,{},r.canonical),xt=hm(t,z,r.canonical);if(!xt){const bt=n.get("text-radial-offset").evaluate(z,{},r.canonical);ce=bt?ss(ot,[bt*Pn,Su]):n.get("text-offset").evaluate(z,{},r.canonical).map((vt=>vt*Pn))}let gt=x?"center":n.get("text-justify").evaluate(z,{},r.canonical);const yt=n.get("symbol-placement")==="point"?n.get("text-max-width").evaluate(z,{},r.canonical)*Pn:1/0,Ot=()=>{r.bucket.allowVerticalPlacement&&Ka(xe)&&(H.vertical=yd(K,r.glyphMap,r.glyphPositions,r.imagePositions,D,yt,v,ot,"left",Ye,ce,T.ao.vertical,!0,V,B))};if(!x&&xt){const bt=new Set;if(gt==="auto")for(let et=0;et<xt.values.length;et+=2)bt.add(gh(xt.values[et]));else bt.add(gt);let vt=!1;for(const et of bt)if(!H.horizontal[et])if(vt)H.horizontal[et]=H.horizontal[0];else{const Xt=yd(K,r.glyphMap,r.glyphPositions,r.imagePositions,D,yt,v,"center",et,Ye,ce,T.ao.horizontal,!1,V,B);Xt&&(H.horizontal[et]=Xt,vt=Xt.positionedLines.length===1)}Ot()}else{gt==="auto"&&(gt=gh(ot));const bt=yd(K,r.glyphMap,r.glyphPositions,r.imagePositions,D,yt,v,ot,gt,Ye,ce,T.ao.horizontal,!1,V,B);bt&&(H.horizontal[gt]=bt),Ot(),Ka(xe)&&x&&S&&(H.vertical=yd(K,r.glyphMap,r.glyphPositions,r.imagePositions,D,yt,v,ot,gt,Ye,ce,T.ao.vertical,!1,V,B))}}let Ae=!1;if(z.icon&&z.icon.name){const xe=r.imageMap[z.icon.name];xe&&(ne=P_(r.imagePositions[z.icon.name],n.get("icon-offset").evaluate(z,{},r.canonical),n.get("icon-anchor").evaluate(z,{},r.canonical)),Ae=!!xe.sdf,r.bucket.sdfIcons===void 0?r.bucket.sdfIcons=Ae:r.bucket.sdfIcons!==Ae&&ki("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(xe.pixelRatio!==r.bucket.pixelRatio||n.get("icon-rotate").constantOr(1)!==0)&&(r.bucket.iconsNeedLinear=!0))}const _e=Ig(H.horizontal)||H.vertical;r.bucket.iconsInText=!!_e&&_e.iconsInText,(_e||ne)&&Sl(r.bucket,z,H,ne,r.imageMap,d,V,$,ce,Ae,r.canonical,r.subdivisionGranularity)}r.showCollisionBoxes&&r.bucket.generateCollisionDebugBuffers()},T.cI=zo,T.cJ=ya,T.cK=ch,T.cL=qp,T.cM=gu,T.cN=class{constructor(r){this._marks={start:[r.url,"start"].join("#"),end:[r.url,"end"].join("#"),measure:r.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let r=performance.getEntriesByName(this._marks.measure);return r.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),r=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),r}},T.cO=function(r,t,n,l,d){return o(this,void 0,void 0,(function*(){if(Ce())try{return yield jo(r,t,n,l,d)}catch{}return(function(v,x,S,M,z){const D=v.width,B=v.height;Za&&io||(Za=new OffscreenCanvas(D,B),io=Za.getContext("2d",{willReadFrequently:!0})),Za.width=D,Za.height=B,io.drawImage(v,0,0,D,B);const V=io.getImageData(x,S,M,z);return io.clearRect(0,0,D,B),V.data})(r,t,n,l,d)}))},T.cP=wf,T.cQ=N,T.cR=sh,T.cS=pu,T.cT=vs,T.cU=function(r,t){const n=new Map;if(r!=null)if(r.type==="Feature")n.set(bu(r,t),r);else for(const l of r.features)n.set(bu(l,t),l);return n},T.cV=function(r,t){if(r==null)return!0;if(r.type==="Feature")return bu(r,t)!=null;if(r.type==="FeatureCollection"){const n=new Set;for(const l of r.features){const d=bu(l,t);if(d==null||n.has(d))return!1;n.add(d)}return!0}return!1},T.cW=function(r,t,n){var l,d,v,x;if(t.removeAll&&r.clear(),t.remove)for(const S of t.remove)r.delete(S);if(t.add)for(const S of t.add){const M=bu(S,n);M!=null&&r.set(M,S)}if(t.update)for(const S of t.update){let M=r.get(S.id);if(M==null)continue;const z=!S.removeAllProperties&&(((l=S.removeProperties)===null||l===void 0?void 0:l.length)>0||((d=S.addOrUpdateProperties)===null||d===void 0?void 0:d.length)>0);if((S.newGeometry||S.removeAllProperties||z)&&(M=Object.assign({},M),r.set(S.id,M),z&&(M.properties=Object.assign({},M.properties))),S.newGeometry&&(M.geometry=S.newGeometry),S.removeAllProperties)M.properties={};else if(((v=S.removeProperties)===null||v===void 0?void 0:v.length)>0)for(const D of S.removeProperties)Object.prototype.hasOwnProperty.call(M.properties,D)&&delete M.properties[D];if(((x=S.addOrUpdateProperties)===null||x===void 0?void 0:x.length)>0)for(const{key:D,value:B}of S.addOrUpdateProperties)M.properties[D]=B}},T.cX=Br,T.ca=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},T.cb=r=>r.type==="symbol",T.cc=r=>r.type==="circle",T.cd=r=>r.type==="heatmap",T.ce=r=>r.type==="line",T.cf=r=>r.type==="fill",T.cg=r=>r.type==="fill-extrusion",T.ch=r=>r.type==="hillshade",T.ci=r=>r.type==="color-relief",T.cj=r=>r.type==="raster",T.ck=r=>r.type==="background",T.cl=r=>r.type==="custom",T.cm=Et,T.cn=function(r,t,n){const l=Xe(t.x-n.x,t.y-n.y),d=Xe(r.x-n.x,r.y-n.y);var v,x;return no(Math.atan2(l[0]*d[1]-l[1]*d[0],(v=l)[0]*(x=d)[0]+v[1]*x[1]))},T.co=Kt,T.cp=function(r,t){return Yn[t]&&(r instanceof MouseEvent||r instanceof WheelEvent)},T.cq=function(r,t){return Sa[t]&&"touches"in r},T.cr=function(r){return Sa[r]||Yn[r]},T.cs=function(r,t,n){var l=t[0],d=t[1];return r[0]=n[0]*l+n[4]*d+n[12],r[1]=n[1]*l+n[5]*d+n[13],r},T.ct=function(r,t){const{x:n,y:l}=Md.fromLngLat(t);return!(r<0||r>25||l<0||l>=1||n<0||n>=1)},T.cu=function(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=t[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},T.cv=class extends wo{},T.cw=yh,T.cy=function(r){return r.message===oa},T.cz=de,T.d=je,T.e=Nt,T.f=r=>o(void 0,void 0,void 0,(function*(){if(r.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(r)],{type:"image/png"});try{return createImageBitmap(t)}catch(n){throw new Error(`Could not load image because of ${n.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),T.g=Q,T.h=r=>new Promise(((t,n)=>{const l=new Image;l.onload=()=>{t(l),URL.revokeObjectURL(l.src),l.onload=null,window.requestAnimationFrame((()=>{l.src=Ar}))},l.onerror=()=>n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const d=new Blob([new Uint8Array(r)],{type:"image/png"});l.src=r.byteLength?URL.createObjectURL(d):Ar})),T.i=Mr,T.j=(r,t)=>Pe(Nt(r,{type:"json"}),t),T.k=nt,T.l=dt,T.m=Pe,T.n=(r,t)=>Pe(Nt(r,{type:"arrayBuffer"}),t),T.o=function(r){return new gu(r).readFields(hg,[])},T.p=zf,T.q=lu,T.r=Hr,T.s=As,T.t=Wu,T.u=Si,T.v=Ie,T.w=ki,T.x=df,T.y=Kl,T.z=Wl})),C("worker",["./shared"],(function(T){class o{constructor(W){this.keyCache={},W&&this.replace(W)}replace(W){this._layerConfigs={},this._layers={},this.update(W,[])}update(W,Q){for(const de of W){this._layerConfigs[de.id]=de;const we=this._layers[de.id]=T.bJ(de);we._featureFilter=T.aa(we.filter),this.keyCache[de.id]&&delete this.keyCache[de.id]}for(const de of Q)delete this.keyCache[de],delete this._layerConfigs[de],delete this._layers[de];this.familiesBySource={};const re=T.cC(Object.values(this._layerConfigs),this.keyCache);for(const de of re){const we=de.map((nt=>this._layers[nt.id])),Pe=we[0];if(Pe.visibility==="none")continue;const je=Pe.source||"";let ze=this.familiesBySource[je];ze||(ze=this.familiesBySource[je]={});const Je=Pe.sourceLayer||"_geojsonTileLayer";let dt=ze[Je];dt||(dt=ze[Je]=[]),dt.push(we)}}}class L{constructor(W){const Q={},re=[];for(const je in W){const ze=W[je],Je=Q[je]={};for(const dt in ze){const nt=ze[+dt];if(!nt||nt.bitmap.width===0||nt.bitmap.height===0)continue;const It={x:0,y:0,w:nt.bitmap.width+2,h:nt.bitmap.height+2};re.push(It),Je[dt]={rect:It,metrics:nt.metrics}}}const{w:de,h:we}=T.p(re),Pe=new T.q({width:de||1,height:we||1});for(const je in W){const ze=W[je];for(const Je in ze){const dt=ze[+Je];if(!dt||dt.bitmap.width===0||dt.bitmap.height===0)continue;const nt=Q[je][Je].rect;T.q.copy(dt.bitmap,Pe,{x:0,y:0},{x:nt.x+1,y:nt.y+1},dt.bitmap)}}this.image=Pe,this.positions=Q}}T.cD("GlyphAtlas",L);class N{constructor(W){this.tileID=new T.Z(W.tileID.overscaledZ,W.tileID.wrap,W.tileID.canonical.z,W.tileID.canonical.x,W.tileID.canonical.y),this.uid=W.uid,this.zoom=W.zoom,this.pixelRatio=W.pixelRatio,this.tileSize=W.tileSize,this.source=W.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=W.showCollisionBoxes,this.collectResourceTiming=!!W.collectResourceTiming,this.returnDependencies=!!W.returnDependencies,this.promoteId=W.promoteId,this.inFlightDependencies=[],this.globalState=W.globalState}parse(W,Q,re,de,we){return T._(this,void 0,void 0,(function*(){this.status="parsing",this.data=W,this.collisionBoxArray=new T.a8;const Pe=new T.cE(Object.keys(W.layers).sort()),je=new T.cF(this.tileID,this.promoteId);je.bucketLayerIDs=[];const ze={},Je={featureIndex:je,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:re,subdivisionGranularity:we},dt=Q.familiesBySource[this.source];for(const Wt in dt){const ti=W.layers[Wt];if(!ti)continue;ti.version===1&&T.w(`Vector tile source "${this.source}" layer "${Wt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const fn=Pe.encode(Wt),pt=[];for(let Pr=0;Pr<ti.length;Pr++){const Cn=ti.feature(Pr),Ps=je.getId(Cn,Wt);pt.push({feature:Cn,id:Ps,index:Pr,sourceLayerIndex:fn})}for(const Pr of dt[Wt]){const Cn=Pr[0];Cn.source!==this.source&&T.w(`layer.source = ${Cn.source} does not equal this.source = ${this.source}`),Cn.minzoom&&this.zoom<Math.floor(Cn.minzoom)||Cn.maxzoom&&this.zoom>=Cn.maxzoom||Cn.visibility!=="none"&&(Z(Pr,this.zoom,re,this.globalState),(ze[Cn.id]=Cn.createBucket({index:je.bucketLayerIDs.length,layers:Pr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:fn,sourceID:this.source,globalState:this.globalState})).populate(pt,Je,this.tileID.canonical),je.bucketLayerIDs.push(Pr.map((Ps=>Ps.id))))}}const nt=T.bN(Je.glyphDependencies,(Wt=>Object.keys(Wt).map(Number)));this.inFlightDependencies.forEach((Wt=>Wt==null?void 0:Wt.abort())),this.inFlightDependencies=[];let It=Promise.resolve({});if(Object.keys(nt).length){const Wt=new AbortController;this.inFlightDependencies.push(Wt),It=de.sendAsync({type:"GG",data:{stacks:nt,source:this.source,tileID:this.tileID,type:"glyphs"}},Wt)}const Ie=Object.keys(Je.iconDependencies);let ei=Promise.resolve({});if(Ie.length){const Wt=new AbortController;this.inFlightDependencies.push(Wt),ei=de.sendAsync({type:"GI",data:{icons:Ie,source:this.source,tileID:this.tileID,type:"icons"}},Wt)}const _i=Object.keys(Je.patternDependencies);let jt=Promise.resolve({});if(_i.length){const Wt=new AbortController;this.inFlightDependencies.push(Wt),jt=de.sendAsync({type:"GI",data:{icons:_i,source:this.source,tileID:this.tileID,type:"patterns"}},Wt)}const[si,Yi,Wn]=yield Promise.all([It,ei,jt]),ir=new L(si),en=new T.cG(Yi,Wn);for(const Wt in ze){const ti=ze[Wt];ti instanceof T.a9?(Z(ti.layers,this.zoom,re,this.globalState),T.cH({bucket:ti,glyphMap:si,glyphPositions:ir.positions,imageMap:Yi,imagePositions:en.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Je.subdivisionGranularity})):ti.hasPattern&&(ti instanceof T.cI||ti instanceof T.cJ||ti instanceof T.cK)&&(Z(ti.layers,this.zoom,re,this.globalState),ti.addFeatures(Je,this.tileID.canonical,en.patternPositions))}return this.status="done",{buckets:Object.values(ze).filter((Wt=>!Wt.isEmpty())),featureIndex:je,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ir.image,imageAtlas:en,glyphMap:this.returnDependencies?si:null,iconMap:this.returnDependencies?Yi:null,glyphPositions:this.returnDependencies?ir.positions:null}}))}}function Z(Me,W,Q,re){const de=new T.F(W,{globalState:re});for(const we of Me)we.recalculate(de,Q)}class Y{constructor(W,Q,re){this.actor=W,this.layerIndex=Q,this.availableImages=re,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(W,Q){return T._(this,void 0,void 0,(function*(){const re=yield T.n(W.request,Q);try{return{vectorTile:new T.cL(new T.cM(re.data)),rawData:re.data,cacheControl:re.cacheControl,expires:re.expires}}catch(de){const we=new Uint8Array(re.data);let Pe=`Unable to parse the tile at ${W.request.url}, `;throw Pe+=we[0]===31&&we[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${de.message}`,new Error(Pe)}}))}loadTile(W){return T._(this,void 0,void 0,(function*(){const Q=W.uid,re=!!(W&&W.request&&W.request.collectResourceTiming)&&new T.cN(W.request),de=new N(W);this.loading[Q]=de;const we=new AbortController;de.abort=we;try{const Pe=yield this.loadVectorTile(W,we);if(delete this.loading[Q],!Pe)return null;const je=Pe.rawData,ze={};Pe.expires&&(ze.expires=Pe.expires),Pe.cacheControl&&(ze.cacheControl=Pe.cacheControl);const Je={};if(re){const nt=re.finish();nt&&(Je.resourceTiming=JSON.parse(JSON.stringify(nt)))}de.vectorTile=Pe.vectorTile;const dt=de.parse(Pe.vectorTile,this.layerIndex,this.availableImages,this.actor,W.subdivisionGranularity);this.loaded[Q]=de,this.fetching[Q]={rawTileData:je,cacheControl:ze,resourceTiming:Je};try{const nt=yield dt;return T.e({rawTileData:je.slice(0)},nt,ze,Je)}finally{delete this.fetching[Q]}}catch(Pe){throw delete this.loading[Q],de.status="done",this.loaded[Q]=de,Pe}}))}reloadTile(W){return T._(this,void 0,void 0,(function*(){const Q=W.uid;if(!this.loaded||!this.loaded[Q])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const re=this.loaded[Q];if(re.showCollisionBoxes=W.showCollisionBoxes,re.globalState=W.globalState,re.status==="parsing"){const de=yield re.parse(re.vectorTile,this.layerIndex,this.availableImages,this.actor,W.subdivisionGranularity);let we;if(this.fetching[Q]){const{rawTileData:Pe,cacheControl:je,resourceTiming:ze}=this.fetching[Q];delete this.fetching[Q],we=T.e({rawTileData:Pe.slice(0)},de,je,ze)}else we=de;return we}if(re.status==="done"&&re.vectorTile)return re.parse(re.vectorTile,this.layerIndex,this.availableImages,this.actor,W.subdivisionGranularity)}))}abortTile(W){return T._(this,void 0,void 0,(function*(){const Q=this.loading,re=W.uid;Q&&Q[re]&&Q[re].abort&&(Q[re].abort.abort(),delete Q[re])}))}removeTile(W){return T._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[W.uid]&&delete this.loaded[W.uid]}))}}class ee{constructor(){this.loaded={}}loadTile(W){return T._(this,void 0,void 0,(function*(){const{uid:Q,encoding:re,rawImageData:de,redFactor:we,greenFactor:Pe,blueFactor:je,baseShift:ze}=W,Je=de.width+2,dt=de.height+2,nt=T.b(de)?new T.R({width:Je,height:dt},yield T.cO(de,-1,-1,Je,dt)):de,It=new T.cP(Q,nt,re,we,Pe,je,ze);return this.loaded=this.loaded||{},this.loaded[Q]=It,It}))}removeTile(W){const Q=this.loaded,re=W.uid;Q&&Q[re]&&delete Q[re]}}var U,le,ie=(function(){if(le)return U;function Me(Q,re){if(Q.length!==0){W(Q[0],re);for(var de=1;de<Q.length;de++)W(Q[de],!re)}}function W(Q,re){for(var de=0,we=0,Pe=0,je=Q.length,ze=je-1;Pe<je;ze=Pe++){var Je=(Q[Pe][0]-Q[ze][0])*(Q[ze][1]+Q[Pe][1]),dt=de+Je;we+=Math.abs(de)>=Math.abs(Je)?de-dt+Je:Je-dt+de,de=dt}de+we>=0!=!!re&&Q.reverse()}return le=1,U=function Q(re,de){var we,Pe=re&&re.type;if(Pe==="FeatureCollection")for(we=0;we<re.features.length;we++)Q(re.features[we],de);else if(Pe==="GeometryCollection")for(we=0;we<re.geometries.length;we++)Q(re.geometries[we],de);else if(Pe==="Feature")Q(re.geometry,de);else if(Pe==="Polygon")Me(re.coordinates,de);else if(Pe==="MultiPolygon")for(we=0;we<re.coordinates.length;we++)Me(re.coordinates[we],de);return re}})(),me=T.cQ(ie);class Ce extends T.cS{constructor(W,Q){super(new T.cM,0,Q,[],[]),this.feature=W,this.type=W.type,this.properties=W.tags?W.tags:{},"id"in W&&(typeof W.id=="string"?this.id=parseInt(W.id,10):typeof W.id!="number"||isNaN(W.id)||(this.id=W.id))}loadGeometry(){const W=[],Q=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const re of Q){const de=[];for(const we of re)de.push(new T.P(we[0],we[1]));W.push(de)}return W}}class Se extends T.cR{constructor(W,Q){super(new T.cM),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=Q?Q.version:1,this.extent=Q?Q.extent:4096,this.length=W.length,this.features=W}feature(W){return new Ce(this.features[W],this.extent)}}function Ee(Me,W){W.writeVarintField(15,Me.version||1),W.writeStringField(1,Me.name||""),W.writeVarintField(5,Me.extent||4096);const Q={keys:[],values:[],keycache:{},valuecache:{}};for(let we=0;we<Me.length;we++)Q.feature=Me.feature(we),W.writeMessage(2,ke,Q);const re=Q.keys;for(const we of re)W.writeStringField(3,we);const de=Q.values;for(const we of de)W.writeMessage(4,at,we)}function ke(Me,W){if(!Me.feature)return;const Q=Me.feature;Q.id!==void 0&&W.writeVarintField(1,Q.id),W.writeMessage(2,Ve,Me),W.writeVarintField(3,Q.type),W.writeMessage(4,Qe,Q)}function Ve(Me,W){var Q;for(const re in(Q=Me.feature)==null?void 0:Q.properties){let de=Me.feature.properties[re],we=Me.keycache[re];if(de===null)continue;we===void 0&&(Me.keys.push(re),we=Me.keys.length-1,Me.keycache[re]=we),W.writeVarint(we),typeof de!="string"&&typeof de!="boolean"&&typeof de!="number"&&(de=JSON.stringify(de));const Pe=typeof de+":"+de;let je=Me.valuecache[Pe];je===void 0&&(Me.values.push(de),je=Me.values.length-1,Me.valuecache[Pe]=je),W.writeVarint(je)}}function ct(Me,W){return(W<<3)+(7&Me)}function tt(Me){return Me<<1^Me>>31}function Qe(Me,W){const Q=Me.loadGeometry(),re=Me.type;let de=0,we=0;for(const Pe of Q){let je=1;re===1&&(je=Pe.length),W.writeVarint(ct(1,je));const ze=re===3?Pe.length-1:Pe.length;for(let Je=0;Je<ze;Je++){Je===1&&re!==1&&W.writeVarint(ct(2,ze-1));const dt=Pe[Je].x-de,nt=Pe[Je].y-we;W.writeVarint(tt(dt)),W.writeVarint(tt(nt)),de+=dt,we+=nt}Me.type===3&&W.writeVarint(ct(7,1))}}function at(Me,W){const Q=typeof Me;Q==="string"?W.writeStringField(1,Me):Q==="boolean"?W.writeBooleanField(7,Me):Q==="number"&&(Me%1!=0?W.writeDoubleField(3,Me):Me<0?W.writeSVarintField(6,Me):W.writeVarintField(5,Me))}const ht={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Me=>Me},Ct=Math.fround||(Rt=new Float32Array(1),Me=>(Rt[0]=+Me,Rt[0]));var Rt;class Lt{constructor(W){this.options=Object.assign(Object.create(ht),W),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(W){const{log:Q,minZoom:re,maxZoom:de}=this.options;Q&&console.time("total time");const we=`prepare ${W.length} points`;Q&&console.time(we),this.points=W;const Pe=[];for(let ze=0;ze<W.length;ze++){const Je=W[ze];if(!Je.geometry)continue;const[dt,nt]=Je.geometry.coordinates,It=Ct(Oe(dt)),Ie=Ct(it(nt));Pe.push(It,Ie,1/0,ze,-1,1),this.options.reduce&&Pe.push(0)}let je=this.trees[de+1]=this._createTree(Pe);Q&&console.timeEnd(we);for(let ze=de;ze>=re;ze--){const Je=+Date.now();je=this.trees[ze]=this._createTree(this._cluster(je,ze)),Q&&console.log("z%d: %d clusters in %dms",ze,je.numItems,+Date.now()-Je)}return Q&&console.timeEnd("total time"),this}getClusters(W,Q){let re=((W[0]+180)%360+360)%360-180;const de=Math.max(-90,Math.min(90,W[1]));let we=W[2]===180?180:((W[2]+180)%360+360)%360-180;const Pe=Math.max(-90,Math.min(90,W[3]));if(W[2]-W[0]>=360)re=-180,we=180;else if(re>we){const nt=this.getClusters([re,de,180,Pe],Q),It=this.getClusters([-180,de,we,Pe],Q);return nt.concat(It)}const je=this.trees[this._limitZoom(Q)],ze=je.range(Oe(re),it(Pe),Oe(we),it(de)),Je=je.data,dt=[];for(const nt of ze){const It=this.stride*nt;dt.push(Je[It+5]>1?Gt(Je,It,this.clusterProps):this.points[Je[It+3]])}return dt}getChildren(W){const Q=this._getOriginId(W),re=this._getOriginZoom(W),de="No cluster with the specified id.",we=this.trees[re];if(!we)throw new Error(de);const Pe=we.data;if(Q*this.stride>=Pe.length)throw new Error(de);const je=this.options.radius/(this.options.extent*Math.pow(2,re-1)),ze=we.within(Pe[Q*this.stride],Pe[Q*this.stride+1],je),Je=[];for(const dt of ze){const nt=dt*this.stride;Pe[nt+4]===W&&Je.push(Pe[nt+5]>1?Gt(Pe,nt,this.clusterProps):this.points[Pe[nt+3]])}if(Je.length===0)throw new Error(de);return Je}getLeaves(W,Q,re){const de=[];return this._appendLeaves(de,W,Q=Q||10,re=re||0,0),de}getTile(W,Q,re){const de=this.trees[this._limitZoom(W)],we=Math.pow(2,W),{extent:Pe,radius:je}=this.options,ze=je/Pe,Je=(re-ze)/we,dt=(re+1+ze)/we,nt={features:[]};return this._addTileFeatures(de.range((Q-ze)/we,Je,(Q+1+ze)/we,dt),de.data,Q,re,we,nt),Q===0&&this._addTileFeatures(de.range(1-ze/we,Je,1,dt),de.data,we,re,we,nt),Q===we-1&&this._addTileFeatures(de.range(0,Je,ze/we,dt),de.data,-1,re,we,nt),nt.features.length?nt:null}getClusterExpansionZoom(W){let Q=this._getOriginZoom(W)-1;for(;Q<=this.options.maxZoom;){const re=this.getChildren(W);if(Q++,re.length!==1)break;W=re[0].properties.cluster_id}return Q}_appendLeaves(W,Q,re,de,we){const Pe=this.getChildren(Q);for(const je of Pe){const ze=je.properties;if(ze&&ze.cluster?we+ze.point_count<=de?we+=ze.point_count:we=this._appendLeaves(W,ze.cluster_id,re,de,we):we<de?we++:W.push(je),W.length===re)break}return we}_createTree(W){const Q=new T.aI(W.length/this.stride|0,this.options.nodeSize,Float32Array);for(let re=0;re<W.length;re+=this.stride)Q.add(W[re],W[re+1]);return Q.finish(),Q.data=W,Q}_addTileFeatures(W,Q,re,de,we,Pe){for(const je of W){const ze=je*this.stride,Je=Q[ze+5]>1;let dt,nt,It;if(Je)dt=Ht(Q,ze,this.clusterProps),nt=Q[ze],It=Q[ze+1];else{const _i=this.points[Q[ze+3]];dt=_i.properties;const[jt,si]=_i.geometry.coordinates;nt=Oe(jt),It=it(si)}const Ie={type:1,geometry:[[Math.round(this.options.extent*(nt*we-re)),Math.round(this.options.extent*(It*we-de))]],tags:dt};let ei;ei=Je||this.options.generateId?Q[ze+3]:this.points[Q[ze+3]].id,ei!==void 0&&(Ie.id=ei),Pe.features.push(Ie)}}_limitZoom(W){return Math.max(this.options.minZoom,Math.min(Math.floor(+W),this.options.maxZoom+1))}_cluster(W,Q){const{radius:re,extent:de,reduce:we,minPoints:Pe}=this.options,je=re/(de*Math.pow(2,Q)),ze=W.data,Je=[],dt=this.stride;for(let nt=0;nt<ze.length;nt+=dt){if(ze[nt+2]<=Q)continue;ze[nt+2]=Q;const It=ze[nt],Ie=ze[nt+1],ei=W.within(ze[nt],ze[nt+1],je),_i=ze[nt+5];let jt=_i;for(const si of ei){const Yi=si*dt;ze[Yi+2]>Q&&(jt+=ze[Yi+5])}if(jt>_i&&jt>=Pe){let si,Yi=It*_i,Wn=Ie*_i,ir=-1;const en=(nt/dt<<5)+(Q+1)+this.points.length;for(const Wt of ei){const ti=Wt*dt;if(ze[ti+2]<=Q)continue;ze[ti+2]=Q;const fn=ze[ti+5];Yi+=ze[ti]*fn,Wn+=ze[ti+1]*fn,ze[ti+4]=en,we&&(si||(si=this._map(ze,nt,!0),ir=this.clusterProps.length,this.clusterProps.push(si)),we(si,this._map(ze,ti)))}ze[nt+4]=en,Je.push(Yi/jt,Wn/jt,1/0,en,-1,jt),we&&Je.push(ir)}else{for(let si=0;si<dt;si++)Je.push(ze[nt+si]);if(jt>1)for(const si of ei){const Yi=si*dt;if(!(ze[Yi+2]<=Q)){ze[Yi+2]=Q;for(let Wn=0;Wn<dt;Wn++)Je.push(ze[Yi+Wn])}}}}return Je}_getOriginId(W){return W-this.points.length>>5}_getOriginZoom(W){return(W-this.points.length)%32}_map(W,Q,re){if(W[Q+5]>1){const Pe=this.clusterProps[W[Q+6]];return re?Object.assign({},Pe):Pe}const de=this.points[W[Q+3]].properties,we=this.options.map(de);return re&&we===de?Object.assign({},we):we}}function Gt(Me,W,Q){return{type:"Feature",id:Me[W+3],properties:Ht(Me,W,Q),geometry:{type:"Point",coordinates:[(re=Me[W],360*(re-.5)),Xe(Me[W+1])]}};var re}function Ht(Me,W,Q){const re=Me[W+5],de=re>=1e4?`${Math.round(re/1e3)}k`:re>=1e3?Math.round(re/100)/10+"k":re,we=Me[W+6],Pe=we===-1?{}:Object.assign({},Q[we]);return Object.assign(Pe,{cluster:!0,cluster_id:Me[W+3],point_count:re,point_count_abbreviated:de})}function Oe(Me){return Me/360+.5}function it(Me){const W=Math.sin(Me*Math.PI/180),Q=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return Q<0?0:Q>1?1:Q}function Xe(Me){const W=(180-360*Me)*Math.PI/180;return 360*Math.atan(Math.exp(W))/Math.PI-90}function St(Me,W,Q,re){let de=re;const we=W+(Q-W>>1);let Pe,je=Q-W;const ze=Me[W],Je=Me[W+1],dt=Me[Q],nt=Me[Q+1];for(let It=W+3;It<Q;It+=3){const Ie=be(Me[It],Me[It+1],ze,Je,dt,nt);if(Ie>de)Pe=It,de=Ie;else if(Ie===de){const ei=Math.abs(It-we);ei<je&&(Pe=It,je=ei)}}de>re&&(Pe-W>3&&St(Me,W,Pe,re),Me[Pe+2]=de,Q-Pe>3&&St(Me,Pe,Q,re))}function be(Me,W,Q,re,de,we){let Pe=de-Q,je=we-re;if(Pe!==0||je!==0){const ze=((Me-Q)*Pe+(W-re)*je)/(Pe*Pe+je*je);ze>1?(Q=de,re=we):ze>0&&(Q+=Pe*ze,re+=je*ze)}return Pe=Me-Q,je=W-re,Pe*Pe+je*je}function Ke(Me,W,Q,re){const de={id:Me??null,type:W,geometry:Q,tags:re,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(W==="Point"||W==="MultiPoint"||W==="LineString")wt(de,Q);else if(W==="Polygon")wt(de,Q[0]);else if(W==="MultiLineString")for(const we of Q)wt(de,we);else if(W==="MultiPolygon")for(const we of Q)wt(de,we[0]);return de}function wt(Me,W){for(let Q=0;Q<W.length;Q+=3)Me.minX=Math.min(Me.minX,W[Q]),Me.minY=Math.min(Me.minY,W[Q+1]),Me.maxX=Math.max(Me.maxX,W[Q]),Me.maxY=Math.max(Me.maxY,W[Q+1])}function ft(Me,W,Q,re){if(!W.geometry)return;const de=W.geometry.coordinates;if(de&&de.length===0)return;const we=W.geometry.type,Pe=Math.pow(Q.tolerance/((1<<Q.maxZoom)*Q.extent),2);let je=[],ze=W.id;if(Q.promoteId?ze=W.properties[Q.promoteId]:Q.generateId&&(ze=re||0),we==="Point")Et(de,je);else if(we==="MultiPoint")for(const Je of de)Et(Je,je);else if(we==="LineString")Kt(de,je,Pe,!1);else if(we==="MultiLineString"){if(Q.lineMetrics){for(const Je of de)je=[],Kt(Je,je,Pe,!1),Me.push(Ke(ze,"LineString",je,W.properties));return}kt(de,je,Pe,!1)}else if(we==="Polygon")kt(de,je,Pe,!0);else{if(we!=="MultiPolygon"){if(we==="GeometryCollection"){for(const Je of W.geometry.geometries)ft(Me,{id:ze,geometry:Je,properties:W.properties},Q,re);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Je of de){const dt=[];kt(Je,dt,Pe,!0),je.push(dt)}}Me.push(Ke(ze,we,je,W.properties))}function Et(Me,W){W.push(At(Me[0]),Nt(Me[1]),0)}function Kt(Me,W,Q,re){let de,we,Pe=0;for(let ze=0;ze<Me.length;ze++){const Je=At(Me[ze][0]),dt=Nt(Me[ze][1]);W.push(Je,dt,0),ze>0&&(Pe+=re?(de*dt-Je*we)/2:Math.sqrt(Math.pow(Je-de,2)+Math.pow(dt-we,2))),de=Je,we=dt}const je=W.length-3;W[2]=1,St(W,0,je,Q),W[je+2]=1,W.size=Math.abs(Pe),W.start=0,W.end=W.size}function kt(Me,W,Q,re){for(let de=0;de<Me.length;de++){const we=[];Kt(Me[de],we,Q,re),W.push(we)}}function At(Me){return Me/360+.5}function Nt(Me){const W=Math.sin(Me*Math.PI/180),Q=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return Q<0?0:Q>1?1:Q}function bi(Me,W,Q,re,de,we,Pe,je){if(re/=W,we>=(Q/=W)&&Pe<re)return Me;if(Pe<Q||we>=re)return null;const ze=[];for(const Je of Me){const dt=Je.geometry;let nt=Je.type;const It=de===0?Je.minX:Je.minY,Ie=de===0?Je.maxX:Je.maxY;if(It>=Q&&Ie<re){ze.push(Je);continue}if(Ie<Q||It>=re)continue;let ei=[];if(nt==="Point"||nt==="MultiPoint")wi(dt,ei,Q,re,de);else if(nt==="LineString")gi(dt,ei,Q,re,de,!1,je.lineMetrics);else if(nt==="MultiLineString")Ti(dt,ei,Q,re,de,!1);else if(nt==="Polygon")Ti(dt,ei,Q,re,de,!0);else if(nt==="MultiPolygon")for(const _i of dt){const jt=[];Ti(_i,jt,Q,re,de,!0),jt.length&&ei.push(jt)}if(ei.length){if(je.lineMetrics&&nt==="LineString"){for(const _i of ei)ze.push(Ke(Je.id,nt,_i,Je.tags));continue}nt!=="LineString"&&nt!=="MultiLineString"||(ei.length===1?(nt="LineString",ei=ei[0]):nt="MultiLineString"),nt!=="Point"&&nt!=="MultiPoint"||(nt=ei.length===3?"Point":"MultiPoint"),ze.push(Ke(Je.id,nt,ei,Je.tags))}}return ze.length?ze:null}function wi(Me,W,Q,re,de){for(let we=0;we<Me.length;we+=3){const Pe=Me[we+de];Pe>=Q&&Pe<=re&&ki(W,Me[we],Me[we+1],Me[we+2])}}function gi(Me,W,Q,re,de,we,Pe){let je=ni(Me);const ze=de===0?fr:Mr;let Je,dt,nt=Me.start;for(let jt=0;jt<Me.length-3;jt+=3){const si=Me[jt],Yi=Me[jt+1],Wn=Me[jt+2],ir=Me[jt+3],en=Me[jt+4],Wt=de===0?si:Yi,ti=de===0?ir:en;let fn=!1;Pe&&(Je=Math.sqrt(Math.pow(si-ir,2)+Math.pow(Yi-en,2))),Wt<Q?ti>Q&&(dt=ze(je,si,Yi,ir,en,Q),Pe&&(je.start=nt+Je*dt)):Wt>re?ti<re&&(dt=ze(je,si,Yi,ir,en,re),Pe&&(je.start=nt+Je*dt)):ki(je,si,Yi,Wn),ti<Q&&Wt>=Q&&(dt=ze(je,si,Yi,ir,en,Q),fn=!0),ti>re&&Wt<=re&&(dt=ze(je,si,Yi,ir,en,re),fn=!0),!we&&fn&&(Pe&&(je.end=nt+Je*dt),W.push(je),je=ni(Me)),Pe&&(nt+=Je)}let It=Me.length-3;const Ie=Me[It],ei=Me[It+1],_i=de===0?Ie:ei;_i>=Q&&_i<=re&&ki(je,Ie,ei,Me[It+2]),It=je.length-3,we&&It>=3&&(je[It]!==je[0]||je[It+1]!==je[1])&&ki(je,je[0],je[1],je[2]),je.length&&W.push(je)}function ni(Me){const W=[];return W.size=Me.size,W.start=Me.start,W.end=Me.end,W}function Ti(Me,W,Q,re,de,we){for(const Pe of Me)gi(Pe,W,Q,re,de,we,!1)}function ki(Me,W,Q,re){Me.push(W,Q,re)}function fr(Me,W,Q,re,de,we){const Pe=(we-W)/(re-W);return ki(Me,we,Q+(de-Q)*Pe,1),Pe}function Mr(Me,W,Q,re,de,we){const Pe=(we-Q)/(de-Q);return ki(Me,W+(re-W)*Pe,we,1),Pe}function zn(Me,W){const Q=[];for(let re=0;re<Me.length;re++){const de=Me[re],we=de.type;let Pe;if(we==="Point"||we==="MultiPoint"||we==="LineString")Pe=wa(de.geometry,W);else if(we==="MultiLineString"||we==="Polygon"){Pe=[];for(const je of de.geometry)Pe.push(wa(je,W))}else if(we==="MultiPolygon"){Pe=[];for(const je of de.geometry){const ze=[];for(const Je of je)ze.push(wa(Je,W));Pe.push(ze)}}Q.push(Ke(de.id,we,Pe,de.tags))}return Q}function wa(Me,W){const Q=[];Q.size=Me.size,Me.start!==void 0&&(Q.start=Me.start,Q.end=Me.end);for(let re=0;re<Me.length;re+=3)Q.push(Me[re]+W,Me[re+1],Me[re+2]);return Q}function Ar(Me,W){if(Me.transformed)return Me;const Q=1<<Me.z,re=Me.x,de=Me.y;for(const we of Me.features){const Pe=we.geometry,je=we.type;if(we.geometry=[],je===1)for(let ze=0;ze<Pe.length;ze+=2)we.geometry.push(jo(Pe[ze],Pe[ze+1],W,Q,re,de));else for(let ze=0;ze<Pe.length;ze++){const Je=[];for(let dt=0;dt<Pe[ze].length;dt+=2)Je.push(jo(Pe[ze][dt],Pe[ze][dt+1],W,Q,re,de));we.geometry.push(Je)}}return Me.transformed=!0,Me}function jo(Me,W,Q,re,de,we){return[Math.round(Q*(Me*re-de)),Math.round(Q*(W*re-we))]}function Za(Me,W,Q,re,de){const we=W===de.maxZoom?0:de.tolerance/((1<<W)*de.extent),Pe={features:[],numPoints:0,numSimplified:0,numFeatures:Me.length,source:null,x:Q,y:re,z:W,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const je of Me)io(Pe,je,we,de);return Pe}function io(Me,W,Q,re){const de=W.geometry,we=W.type,Pe=[];if(Me.minX=Math.min(Me.minX,W.minX),Me.minY=Math.min(Me.minY,W.minY),Me.maxX=Math.max(Me.maxX,W.maxX),Me.maxY=Math.max(Me.maxY,W.maxY),we==="Point"||we==="MultiPoint")for(let je=0;je<de.length;je+=3)Pe.push(de[je],de[je+1]),Me.numPoints++,Me.numSimplified++;else if(we==="LineString")As(Pe,de,Me,Q,!1,!1);else if(we==="MultiLineString"||we==="Polygon")for(let je=0;je<de.length;je++)As(Pe,de[je],Me,Q,we==="Polygon",je===0);else if(we==="MultiPolygon")for(let je=0;je<de.length;je++){const ze=de[je];for(let Je=0;Je<ze.length;Je++)As(Pe,ze[Je],Me,Q,!0,Je===0)}if(Pe.length){let je=W.tags||null;if(we==="LineString"&&re.lineMetrics){je={};for(const Je in W.tags)je[Je]=W.tags[Je];je.mapbox_clip_start=de.start/de.size,je.mapbox_clip_end=de.end/de.size}const ze={geometry:Pe,type:we==="Polygon"||we==="MultiPolygon"?3:we==="LineString"||we==="MultiLineString"?2:1,tags:je};W.id!==null&&(ze.id=W.id),Me.features.push(ze)}}function As(Me,W,Q,re,de,we){const Pe=re*re;if(re>0&&W.size<(de?Pe:re))return void(Q.numPoints+=W.length/3);const je=[];for(let ze=0;ze<W.length;ze+=3)(re===0||W[ze+2]>Pe)&&(Q.numSimplified++,je.push(W[ze],W[ze+1])),Q.numPoints++;de&&(function(ze,Je){let dt=0;for(let nt=0,It=ze.length,Ie=It-2;nt<It;Ie=nt,nt+=2)dt+=(ze[nt]-ze[Ie])*(ze[nt+1]+ze[Ie+1]);if(dt>0===Je)for(let nt=0,It=ze.length;nt<It/2;nt+=2){const Ie=ze[nt],ei=ze[nt+1];ze[nt]=ze[It-2-nt],ze[nt+1]=ze[It-1-nt],ze[It-2-nt]=Ie,ze[It-1-nt]=ei}})(je,we),Me.push(je)}const Fo={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class no{constructor(W,Q){const re=(Q=this.options=(function(we,Pe){for(const je in Pe)we[je]=Pe[je];return we})(Object.create(Fo),Q)).debug;if(re&&console.time("preprocess data"),Q.maxZoom<0||Q.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Q.promoteId&&Q.generateId)throw new Error("promoteId and generateId cannot be used together.");let de=(function(we,Pe){const je=[];if(we.type==="FeatureCollection")for(let ze=0;ze<we.features.length;ze++)ft(je,we.features[ze],Pe,ze);else ft(je,we.type==="Feature"?we:{geometry:we},Pe);return je})(W,Q);this.tiles={},this.tileCoords=[],re&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Q.indexMaxZoom,Q.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),de=(function(we,Pe){const je=Pe.buffer/Pe.extent;let ze=we;const Je=bi(we,1,-1-je,je,0,-1,2,Pe),dt=bi(we,1,1-je,2+je,0,-1,2,Pe);return(Je||dt)&&(ze=bi(we,1,-je,1+je,0,-1,2,Pe)||[],Je&&(ze=zn(Je,1).concat(ze)),dt&&(ze=ze.concat(zn(dt,-1)))),ze})(de,Q),de.length&&this.splitTile(de,0,0,0),re&&(de.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(W,Q,re,de,we,Pe,je){const ze=[W,Q,re,de],Je=this.options,dt=Je.debug;for(;ze.length;){de=ze.pop(),re=ze.pop(),Q=ze.pop(),W=ze.pop();const nt=1<<Q,It=Sa(Q,re,de);let Ie=this.tiles[It];if(!Ie&&(dt>1&&console.time("creation"),Ie=this.tiles[It]=Za(W,Q,re,de,Je),this.tileCoords.push({z:Q,x:re,y:de}),dt)){dt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Q,re,de,Ie.numFeatures,Ie.numPoints,Ie.numSimplified),console.timeEnd("creation"));const fn=`z${Q}`;this.stats[fn]=(this.stats[fn]||0)+1,this.total++}if(Ie.source=W,we==null){if(Q===Je.indexMaxZoom||Ie.numPoints<=Je.indexMaxPoints)continue}else{if(Q===Je.maxZoom||Q===we)continue;if(we!=null){const fn=we-Q;if(re!==Pe>>fn||de!==je>>fn)continue}}if(Ie.source=null,W.length===0)continue;dt>1&&console.time("clipping");const ei=.5*Je.buffer/Je.extent,_i=.5-ei,jt=.5+ei,si=1+ei;let Yi=null,Wn=null,ir=null,en=null,Wt=bi(W,nt,re-ei,re+jt,0,Ie.minX,Ie.maxX,Je),ti=bi(W,nt,re+_i,re+si,0,Ie.minX,Ie.maxX,Je);W=null,Wt&&(Yi=bi(Wt,nt,de-ei,de+jt,1,Ie.minY,Ie.maxY,Je),Wn=bi(Wt,nt,de+_i,de+si,1,Ie.minY,Ie.maxY,Je),Wt=null),ti&&(ir=bi(ti,nt,de-ei,de+jt,1,Ie.minY,Ie.maxY,Je),en=bi(ti,nt,de+_i,de+si,1,Ie.minY,Ie.maxY,Je),ti=null),dt>1&&console.timeEnd("clipping"),ze.push(Yi||[],Q+1,2*re,2*de),ze.push(Wn||[],Q+1,2*re,2*de+1),ze.push(ir||[],Q+1,2*re+1,2*de),ze.push(en||[],Q+1,2*re+1,2*de+1)}}getTile(W,Q,re){W=+W,Q=+Q,re=+re;const de=this.options,{extent:we,debug:Pe}=de;if(W<0||W>24)return null;const je=1<<W,ze=Sa(W,Q=Q+je&je-1,re);if(this.tiles[ze])return Ar(this.tiles[ze],we);Pe>1&&console.log("drilling down to z%d-%d-%d",W,Q,re);let Je,dt=W,nt=Q,It=re;for(;!Je&&dt>0;)dt--,nt>>=1,It>>=1,Je=this.tiles[Sa(dt,nt,It)];return Je&&Je.source?(Pe>1&&(console.log("found parent tile z%d-%d-%d",dt,nt,It),console.time("drilling down")),this.splitTile(Je.source,dt,nt,It,W,Q,re),Pe>1&&console.timeEnd("drilling down"),this.tiles[ze]?Ar(this.tiles[ze],we):null):null}}function Sa(Me,W,Q){return 32*((1<<Me)*Q+W)+Me}class Yn extends Y{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(W,Q){return T._(this,void 0,void 0,(function*(){const re=W.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const de=this._geoJSONIndex.getTile(re.z,re.x,re.y);if(!de)return null;const we=new Se(de.features,{version:2,extent:T.$});let Pe=(function(je){const ze=new T.cM;return(function(Je,dt){for(const nt in Je.layers)dt.writeMessage(3,Ee,Je.layers[nt])})(je,ze),ze.finish()})(we);return Pe.byteOffset===0&&Pe.byteLength===Pe.buffer.byteLength||(Pe=new Uint8Array(Pe)),{vectorTile:we,rawData:Pe.buffer}}))}loadData(W){return T._(this,void 0,void 0,(function*(){var Q;(Q=this._pendingRequest)===null||Q===void 0||Q.abort();const re=!!(W&&W.request&&W.request.collectResourceTiming)&&new T.cN(W.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(W,this._pendingRequest);const de=yield this._pendingData;this._geoJSONIndex=W.cluster?new Lt((function({superclusterOptions:Pe,clusterProperties:je}){if(!je||!Pe)return Pe;const ze={},Je={},dt={accumulated:null,zoom:0},nt={properties:null},It=Object.keys(je);for(const Ie of It){const[ei,_i]=je[Ie],jt=T.cT(_i),si=T.cT(typeof ei=="string"?[ei,["accumulated"],["get",Ie]]:ei);ze[Ie]=jt.value,Je[Ie]=si.value}return Pe.map=Ie=>{nt.properties=Ie;const ei={};for(const _i of It)ei[_i]=ze[_i].evaluate(dt,nt);return ei},Pe.reduce=(Ie,ei)=>{nt.properties=ei;for(const _i of It)dt.accumulated=Ie[_i],Ie[_i]=Je[_i].evaluate(dt,nt)},Pe})(W)).load(de.features):(function(Pe,je){return new no(Pe,je)})(de,W.geojsonVtOptions),this.loaded={};const we={data:de};if(re){const Pe=re.finish();Pe&&(we.resourceTiming={},we.resourceTiming[W.source]=JSON.parse(JSON.stringify(Pe)))}return we}catch(de){if(delete this._pendingRequest,T.cy(de))return{abandoned:!0};throw de}}))}getData(){return T._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(W){const Q=this.loaded;return Q&&Q[W.uid]?super.reloadTile(W):this.loadTile(W)}loadAndProcessGeoJSON(W,Q){return T._(this,void 0,void 0,(function*(){let re=yield this.loadGeoJSON(W,Q);if(delete this._pendingRequest,typeof re!="object")throw new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`);if(me(re,!0),W.filter){const de=T.cT(W.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(de.result==="error")throw new Error(de.value.map((Pe=>`${Pe.key}: ${Pe.message}`)).join(", "));re={type:"FeatureCollection",features:re.features.filter((Pe=>de.value.evaluate({zoom:0},Pe)))}}return re}))}loadGeoJSON(W,Q){return T._(this,void 0,void 0,(function*(){const{promoteId:re}=W;if(W.request){const de=yield T.j(W.request,Q);return this._dataUpdateable=T.cV(de.data,re)?T.cU(de.data,re):void 0,de.data}if(typeof W.data=="string")try{const de=JSON.parse(W.data);return this._dataUpdateable=T.cV(de,re)?T.cU(de,re):void 0,de}catch{throw new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`)}if(!W.dataDiff)throw new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${W.source}`);return T.cW(this._dataUpdateable,W.dataDiff,re),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}))}removeSource(W){return T._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(W){return this._geoJSONIndex.getClusterExpansionZoom(W.clusterId)}getClusterChildren(W){return this._geoJSONIndex.getChildren(W.clusterId)}getClusterLeaves(W){return this._geoJSONIndex.getLeaves(W.clusterId,W.limit,W.offset)}}class oa{constructor(W){this.self=W,this.actor=new T.J(W),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(Q,re)=>{if(this.externalWorkerSourceTypes[Q])throw new Error(`Worker source with name "${Q}" already registered.`);this.externalWorkerSourceTypes[Q]=re},this.self.addProtocol=T.cA,this.self.removeProtocol=T.cB,this.self.registerRTLTextPlugin=Q=>{T.cX.setMethods(Q)},this.actor.registerMessageHandler("LDT",((Q,re)=>this._getDEMWorkerSource(Q,re.source).loadTile(re))),this.actor.registerMessageHandler("RDT",((Q,re)=>T._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(Q,re.source).removeTile(re)})))),this.actor.registerMessageHandler("GCEZ",((Q,re)=>T._(this,void 0,void 0,(function*(){return this._getWorkerSource(Q,re.type,re.source).getClusterExpansionZoom(re)})))),this.actor.registerMessageHandler("GCC",((Q,re)=>T._(this,void 0,void 0,(function*(){return this._getWorkerSource(Q,re.type,re.source).getClusterChildren(re)})))),this.actor.registerMessageHandler("GCL",((Q,re)=>T._(this,void 0,void 0,(function*(){return this._getWorkerSource(Q,re.type,re.source).getClusterLeaves(re)})))),this.actor.registerMessageHandler("LD",((Q,re)=>this._getWorkerSource(Q,re.type,re.source).loadData(re))),this.actor.registerMessageHandler("GD",((Q,re)=>this._getWorkerSource(Q,re.type,re.source).getData())),this.actor.registerMessageHandler("LT",((Q,re)=>this._getWorkerSource(Q,re.type,re.source).loadTile(re))),this.actor.registerMessageHandler("RT",((Q,re)=>this._getWorkerSource(Q,re.type,re.source).reloadTile(re))),this.actor.registerMessageHandler("AT",((Q,re)=>this._getWorkerSource(Q,re.type,re.source).abortTile(re))),this.actor.registerMessageHandler("RMT",((Q,re)=>this._getWorkerSource(Q,re.type,re.source).removeTile(re))),this.actor.registerMessageHandler("RS",((Q,re)=>T._(this,void 0,void 0,(function*(){if(!this.workerSources[Q]||!this.workerSources[Q][re.type]||!this.workerSources[Q][re.type][re.source])return;const de=this.workerSources[Q][re.type][re.source];delete this.workerSources[Q][re.type][re.source],de.removeSource!==void 0&&de.removeSource(re)})))),this.actor.registerMessageHandler("RM",(Q=>T._(this,void 0,void 0,(function*(){delete this.layerIndexes[Q],delete this.availableImages[Q],delete this.workerSources[Q],delete this.demWorkerSources[Q]})))),this.actor.registerMessageHandler("SR",((Q,re)=>T._(this,void 0,void 0,(function*(){this.referrer=re})))),this.actor.registerMessageHandler("SRPS",((Q,re)=>this._syncRTLPluginState(Q,re))),this.actor.registerMessageHandler("IS",((Q,re)=>T._(this,void 0,void 0,(function*(){this.self.importScripts(re)})))),this.actor.registerMessageHandler("SI",((Q,re)=>this._setImages(Q,re))),this.actor.registerMessageHandler("UL",((Q,re)=>T._(this,void 0,void 0,(function*(){this._getLayerIndex(Q).update(re.layers,re.removedIds)})))),this.actor.registerMessageHandler("SL",((Q,re)=>T._(this,void 0,void 0,(function*(){this._getLayerIndex(Q).replace(re)}))))}_setImages(W,Q){return T._(this,void 0,void 0,(function*(){this.availableImages[W]=Q;for(const re in this.workerSources[W]){const de=this.workerSources[W][re];for(const we in de)de[we].availableImages=Q}}))}_syncRTLPluginState(W,Q){return T._(this,void 0,void 0,(function*(){return yield T.cX.syncState(Q,this.self.importScripts)}))}_getAvailableImages(W){let Q=this.availableImages[W];return Q||(Q=[]),Q}_getLayerIndex(W){let Q=this.layerIndexes[W];return Q||(Q=this.layerIndexes[W]=new o),Q}_getWorkerSource(W,Q,re){if(this.workerSources[W]||(this.workerSources[W]={}),this.workerSources[W][Q]||(this.workerSources[W][Q]={}),!this.workerSources[W][Q][re]){const de={sendAsync:(we,Pe)=>(we.targetMapId=W,this.actor.sendAsync(we,Pe))};switch(Q){case"vector":this.workerSources[W][Q][re]=new Y(de,this._getLayerIndex(W),this._getAvailableImages(W));break;case"geojson":this.workerSources[W][Q][re]=new Yn(de,this._getLayerIndex(W),this._getAvailableImages(W));break;default:this.workerSources[W][Q][re]=new this.externalWorkerSourceTypes[Q](de,this._getLayerIndex(W),this._getAvailableImages(W))}}return this.workerSources[W][Q][re]}_getDEMWorkerSource(W,Q){return this.demWorkerSources[W]||(this.demWorkerSources[W]={}),this.demWorkerSources[W][Q]||(this.demWorkerSources[W][Q]=new ee),this.demWorkerSources[W][Q]}}return T.i(self)&&(self.worker=new oa(self)),oa})),C("index",["exports","./shared"],(function(T,o){var L="5.7.0";function N(){var m=new o.A(4);return o.A!=Float32Array&&(m[1]=0,m[2]=0),m[0]=1,m[3]=1,m}let Z,Y;const ee={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(m,e,a){const c=requestAnimationFrame((y=>{f(),e(y)})),{unsubscribe:f}=o.s(m.signal,"abort",(()=>{f(),cancelAnimationFrame(c),a(o.c())}),!1)},frameAsync(m){return new Promise(((e,a)=>{this.frame(m,e,a)}))},getImageData(m,e=0){return this.getImageCanvasContext(m).getImageData(-e,-e,m.width+2*e,m.height+2*e)},getImageCanvasContext(m){const e=window.document.createElement("canvas"),a=e.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("failed to create canvas 2d context");return e.width=m.width,e.height=m.height,a.drawImage(m,0,0,m.width,m.height),a},resolveURL:m=>(Z||(Z=document.createElement("a")),Z.href=m,Z.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Y==null&&(Y=matchMedia("(prefers-reduced-motion: reduce)")),Y.matches)}};class U{static testProp(e){if(!U.docStyle)return e[0];for(let a=0;a<e.length;a++)if(e[a]in U.docStyle)return e[a];return e[0]}static create(e,a,c){const f=window.document.createElement(e);return a!==void 0&&(f.className=a),c&&c.appendChild(f),f}static createNS(e,a){return window.document.createElementNS(e,a)}static disableDrag(){U.docStyle&&U.selectProp&&(U.userSelect=U.docStyle[U.selectProp],U.docStyle[U.selectProp]="none")}static enableDrag(){U.docStyle&&U.selectProp&&(U.docStyle[U.selectProp]=U.userSelect)}static setTransform(e,a){e.style[U.transformProp]=a}static addEventListener(e,a,c,f={}){e.addEventListener(a,c,"passive"in f?f:f.capture)}static removeEventListener(e,a,c,f={}){e.removeEventListener(a,c,"passive"in f?f:f.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",U.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",U.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",U.suppressClickInternal,!0)}),0)}static getScale(e){const a=e.getBoundingClientRect();return{x:a.width/e.offsetWidth||1,y:a.height/e.offsetHeight||1,boundingClientRect:a}}static getPoint(e,a,c){const f=a.boundingClientRect;return new o.P((c.clientX-f.left)/a.x-e.clientLeft,(c.clientY-f.top)/a.y-e.clientTop)}static mousePos(e,a){const c=U.getScale(e);return U.getPoint(e,c,a)}static touchPos(e,a){const c=[],f=U.getScale(e);for(let y=0;y<a.length;y++)c.push(U.getPoint(e,f,a[y]));return c}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const a=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),c=a.querySelectorAll("script");for(const f of c)f.remove();return U.clean(a),a.innerHTML}static isPossiblyDangerous(e,a){const c=a.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!c.includes("javascript:")&&!c.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const a=e.children;for(const c of a)U.removeAttributes(c),U.clean(c)}static removeAttributes(e){for(const{name:a,value:c}of e.attributes)U.isPossiblyDangerous(a,c)&&e.removeAttribute(a)}}U.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,U.selectProp=U.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),U.transformProp=U.testProp(["transform","WebkitTransform"]);const le={supported:!1,testSupport:function(m){!Ce&&me&&(Se?Ee(m):ie=m)}};let ie,me,Ce=!1,Se=!1;function Ee(m){const e=m.createTexture();m.bindTexture(m.TEXTURE_2D,e);try{if(m.texImage2D(m.TEXTURE_2D,0,m.RGBA,m.RGBA,m.UNSIGNED_BYTE,me),m.isContextLost())return;le.supported=!0}catch{}m.deleteTexture(e),Ce=!0}var ke;typeof document<"u"&&(me=document.createElement("img"),me.onload=()=>{ie&&Ee(ie),ie=null,Se=!0},me.onerror=()=>{Ce=!0,ie=null},me.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(m){let e,a,c,f;m.resetRequestQueue=()=>{e=[],a=0,c=0,f={}},m.addThrottleControl=P=>{const k=c++;return f[k]=P,k},m.removeThrottleControl=P=>{delete f[P],w()},m.getImage=(P,k,O=!0)=>new Promise(((F,j)=>{le.supported&&(P.headers||(P.headers={}),P.headers.accept="image/webp,*/*"),o.e(P,{type:"image"}),e.push({abortController:k,requestParameters:P,supportImageRefresh:O,state:"queued",onError:G=>{j(G)},onSuccess:G=>{F(G)}}),w()}));const y=P=>o._(this,void 0,void 0,(function*(){P.state="running";const{requestParameters:k,supportImageRefresh:O,onError:F,onSuccess:j,abortController:G}=P,X=O===!1&&!o.i(self)&&!o.g(k.url)&&(!k.headers||Object.keys(k.headers).reduce(((oe,ue)=>oe&&ue==="accept"),!0));a++;const se=X?A(k,G):o.m(k,G);try{const oe=yield se;delete P.abortController,P.state="completed",oe.data instanceof HTMLImageElement||o.b(oe.data)?j(oe):oe.data&&j({data:yield(ae=oe.data,typeof createImageBitmap=="function"?o.f(ae):o.h(ae)),cacheControl:oe.cacheControl,expires:oe.expires})}catch(oe){delete P.abortController,F(oe)}finally{a--,w()}var ae})),w=()=>{const P=(()=>{for(const k of Object.keys(f))if(f[k]())return!0;return!1})()?o.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:o.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let k=a;k<P&&e.length>0;k++){const O=e.shift();O.abortController.signal.aborted?k--:y(O)}},A=(P,k)=>new Promise(((O,F)=>{const j=new Image,G=P.url,X=P.credentials;X&&X==="include"?j.crossOrigin="use-credentials":(X&&X==="same-origin"||!o.d(G))&&(j.crossOrigin="anonymous"),k.signal.addEventListener("abort",(()=>{j.src="",F(o.c())})),j.fetchPriority="high",j.onload=()=>{j.onerror=j.onload=null,O({data:j})},j.onerror=()=>{j.onerror=j.onload=null,k.signal.aborted||F(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},j.src=G}))})(ke||(ke={})),ke.resetRequestQueue();class Ve{constructor(e){this._transformRequestFn=e??null}transformRequest(e,a){return this._transformRequestFn&&this._transformRequestFn(e,a)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function ct(m){const e=[];if(typeof m=="string")e.push({id:"default",url:m});else if(m&&m.length>0){const a=[];for(const{id:c,url:f}of m){const y=`${c}${f}`;a.indexOf(y)===-1&&(a.push(y),e.push({id:c,url:f}))}}return e}function tt(m,e,a){try{const c=new URL(m);return c.pathname+=`${e}${a}`,c.toString()}catch{throw new Error(`Invalid sprite URL "${m}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function Qe(m){const{userImage:e}=m;return!!(e&&e.render&&e.render())&&(m.data.replace(new Uint8Array(e.data.buffer)),!0)}class at extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:a,promiseResolve:c}of this.requestors)c(this._getImagesForIds(a));this.requestors=[]}}getImage(e){const a=this.images[e];if(a&&!a.data&&a.spriteData){const c=a.spriteData;a.data=new o.R({width:c.width,height:c.height},c.context.getImageData(c.x,c.y,c.width,c.height).data),a.spriteData=null}return a}addImage(e,a){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,a)&&(this.images[e]=a)}_validate(e,a){let c=!0;const f=a.data||a.spriteData;return this._validateStretch(a.stretchX,f&&f.width)||(this.fire(new o.k(new Error(`Image "${e}" has invalid "stretchX" value`))),c=!1),this._validateStretch(a.stretchY,f&&f.height)||(this.fire(new o.k(new Error(`Image "${e}" has invalid "stretchY" value`))),c=!1),this._validateContent(a.content,a)||(this.fire(new o.k(new Error(`Image "${e}" has invalid "content" value`))),c=!1),c}_validateStretch(e,a){if(!e)return!0;let c=0;for(const f of e){if(f[0]<c||f[1]<f[0]||a<f[1])return!1;c=f[1]}return!0}_validateContent(e,a){if(!e)return!0;if(e.length!==4)return!1;const c=a.spriteData,f=c&&c.width||a.data.width,y=c&&c.height||a.data.height;return!(e[0]<0||f<e[0]||e[1]<0||y<e[1]||e[2]<0||f<e[2]||e[3]<0||y<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,a,c=!0){const f=this.getImage(e);if(c&&(f.data.width!==a.data.width||f.data.height!==a.data.height))throw new Error(`size mismatch between old image (${f.data.width}x${f.data.height}) and new image (${a.data.width}x${a.data.height}).`);a.version=f.version+1,this.images[e]=a,this.updatedImages[e]=!0}removeImage(e){const a=this.images[e];delete this.images[e],delete this.patterns[e],a.userImage&&a.userImage.onRemove&&a.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise(((a,c)=>{let f=!0;if(!this.isLoaded())for(const y of e)this.images[y]||(f=!1);this.isLoaded()||f?a(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:a})}))}_getImagesForIds(e){const a={};for(const c of e){let f=this.getImage(c);f||(this.fire(new o.l("styleimagemissing",{id:c})),f=this.getImage(c)),f?a[c]={data:f.data.clone(),pixelRatio:f.pixelRatio,sdf:f.sdf,version:f.version,stretchX:f.stretchX,stretchY:f.stretchY,content:f.content,textFitWidth:f.textFitWidth,textFitHeight:f.textFitHeight,hasRenderCallback:!!(f.userImage&&f.userImage.render)}:o.w(`Image "${c}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return a}getPixelSize(){const{width:e,height:a}=this.atlasImage;return{width:e,height:a}}getPattern(e){const a=this.patterns[e],c=this.getImage(e);if(!c)return null;if(a&&a.position.version===c.version)return a.position;if(a)a.position.version=c.version;else{const f={w:c.data.width+2,h:c.data.height+2,x:0,y:0},y=new o.I(f,c);this.patterns[e]={bin:f,position:y}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const a=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.T(e,this.atlasImage,a.RGBA),this.atlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const y in this.patterns)e.push(this.patterns[y].bin);const{w:a,h:c}=o.p(e),f=this.atlasImage;f.resize({width:a||1,height:c||1});for(const y in this.patterns){const{bin:w}=this.patterns[y],A=w.x+1,P=w.y+1,k=this.getImage(y).data,O=k.width,F=k.height;o.R.copy(k,f,{x:0,y:0},{x:A,y:P},{width:O,height:F}),o.R.copy(k,f,{x:0,y:F-1},{x:A,y:P-1},{width:O,height:1}),o.R.copy(k,f,{x:0,y:0},{x:A,y:P+F},{width:O,height:1}),o.R.copy(k,f,{x:O-1,y:0},{x:A-1,y:P},{width:1,height:F}),o.R.copy(k,f,{x:0,y:0},{x:A+O,y:P},{width:1,height:F})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const a of e){if(this.callbackDispatchedThisFrame[a])continue;this.callbackDispatchedThisFrame[a]=!0;const c=this.getImage(a);c||o.w(`Image with ID: "${a}" was not found`),Qe(c)&&this.updateImage(a,c)}}}const ht=1e20;function Ct(m,e,a,c,f,y,w,A,P){for(let k=e;k<e+c;k++)Rt(m,a*y+k,y,f,w,A,P);for(let k=a;k<a+f;k++)Rt(m,k*y+e,1,c,w,A,P)}function Rt(m,e,a,c,f,y,w){y[0]=0,w[0]=-ht,w[1]=ht,f[0]=m[e];for(let A=1,P=0,k=0;A<c;A++){f[A]=m[e+A*a];const O=A*A;do{const F=y[P];k=(f[A]-f[F]+O-F*F)/(A-F)/2}while(k<=w[P]&&--P>-1);P++,y[P]=A,w[P]=k,w[P+1]=ht}for(let A=0,P=0;A<c;A++){for(;w[P+1]<A;)P++;const k=y[P],O=A-k;m[e+A*a]=f[k]+O*O}}class Lt{constructor(e,a,c){this.requestManager=e,this.localIdeographFontFamily=a,this.entries={},this.lang=c}setURL(e){this.url=e}getGlyphs(e){return o._(this,void 0,void 0,(function*(){const a=[];for(const y in e)for(const w of e[y])a.push(this._getAndCacheGlyphsPromise(y,w));const c=yield Promise.all(a),f={};for(const{stack:y,id:w,glyph:A}of c)f[y]||(f[y]={}),f[y][w]=A&&{id:A.id,bitmap:A.bitmap.clone(),metrics:A.metrics};return f}))}_getAndCacheGlyphsPromise(e,a){return o._(this,void 0,void 0,(function*(){let c=this.entries[e];c||(c=this.entries[e]={glyphs:{},requests:{},ranges:{}});let f=c.glyphs[a];if(f!==void 0)return{stack:e,id:a,glyph:f};if(f=this._tinySDF(c,e,a),f)return c.glyphs[a]=f,{stack:e,id:a,glyph:f};const y=Math.floor(a/256);if(256*y>65535)throw new Error("glyphs > 65535 not supported");if(c.ranges[y])return{stack:e,id:a,glyph:f};if(!this.url)throw new Error("glyphsUrl is not set");if(!c.requests[y]){const A=Lt.loadGlyphRange(e,y,this.url,this.requestManager);c.requests[y]=A}const w=yield c.requests[y];for(const A in w)this._doesCharSupportLocalGlyph(+A)||(c.glyphs[+A]=w[+A]);return c.ranges[y]=!0,{stack:e,id:a,glyph:w[a]||null}}))}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))||o.u["CJK Unified Ideographs"](e)||o.u["Hangul Syllables"](e)||o.u.Hiragana(e)||o.u.Katakana(e)||o.u["CJK Symbols and Punctuation"](e)||o.u["Halfwidth and Fullwidth Forms"](e))}_tinySDF(e,a,c){const f=this.localIdeographFontFamily;if(!f||!this._doesCharSupportLocalGlyph(c))return;let y=e.tinySDF;if(!y){let A="400";/bold/i.test(a)?A="900":/medium/i.test(a)?A="500":/light/i.test(a)&&(A="200"),y=e.tinySDF=new Lt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,lang:this.lang,fontFamily:f,fontWeight:A})}const w=y.draw(String.fromCharCode(c));return{id:c,bitmap:new o.q({width:w.width||60,height:w.height||60},w.data),metrics:{width:w.glyphWidth/2||24,height:w.glyphHeight/2||24,left:w.glyphLeft/2+.5||0,top:w.glyphTop/2-27.5||-8,advance:w.glyphAdvance/2||24,isDoubleResolution:!0}}}}Lt.loadGlyphRange=function(m,e,a,c){return o._(this,void 0,void 0,(function*(){const f=256*e,y=f+255,w=c.transformRequest(a.replace("{fontstack}",m).replace("{range}",`${f}-${y}`),"Glyphs"),A=yield o.n(w,new AbortController);if(!A||!A.data)throw new Error(`Could not load glyph range. range: ${e}, ${f}-${y}`);const P={};for(const k of o.o(A.data))P[k.id]=k;return P}))},Lt.TinySDF=class{constructor({fontSize:m=24,buffer:e=3,radius:a=8,cutoff:c=.25,fontFamily:f="sans-serif",fontWeight:y="normal",fontStyle:w="normal",lang:A=null}={}){this.buffer=e,this.cutoff=c,this.radius=a,this.lang=A;const P=this.size=m+4*e,k=this._createCanvas(P),O=this.ctx=k.getContext("2d",{willReadFrequently:!0});O.font=`${w} ${y} ${m}px ${f}`,O.textBaseline="alphabetic",O.textAlign="left",O.fillStyle="black",this.gridOuter=new Float64Array(P*P),this.gridInner=new Float64Array(P*P),this.f=new Float64Array(P),this.z=new Float64Array(P+1),this.v=new Uint16Array(P)}_createCanvas(m){const e=document.createElement("canvas");return e.width=e.height=m,e}draw(m){const{width:e,actualBoundingBoxAscent:a,actualBoundingBoxDescent:c,actualBoundingBoxLeft:f,actualBoundingBoxRight:y}=this.ctx.measureText(m),w=Math.ceil(a),A=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(y-f))),P=Math.min(this.size-this.buffer,w+Math.ceil(c)),k=A+2*this.buffer,O=P+2*this.buffer,F=Math.max(k*O,0),j=new Uint8ClampedArray(F),G={data:j,width:k,height:O,glyphWidth:A,glyphHeight:P,glyphTop:w,glyphLeft:0,glyphAdvance:e};if(A===0||P===0)return G;const{ctx:X,buffer:se,gridInner:ae,gridOuter:oe}=this;this.lang&&(X.lang=this.lang),X.clearRect(se,se,A,P),X.fillText(m,se,se+w);const ue=X.getImageData(se,se,A,P);oe.fill(ht,0,F),ae.fill(0,0,F);for(let ge=0;ge<P;ge++)for(let he=0;he<A;he++){const ye=ue.data[4*(ge*A+he)+3]/255;if(ye===0)continue;const Te=(ge+se)*k+he+se;if(ye===1)oe[Te]=0,ae[Te]=ht;else{const fe=.5-ye;oe[Te]=fe>0?fe*fe:0,ae[Te]=fe<0?fe*fe:0}}Ct(oe,0,0,k,O,k,this.f,this.v,this.z),Ct(ae,se,se,A,P,k,this.f,this.v,this.z);for(let ge=0;ge<F;ge++){const he=Math.sqrt(oe[ge])-Math.sqrt(ae[ge]);j[ge]=Math.round(255-255*(he/this.radius+this.cutoff))}return G}};class Gt{constructor(){this.specification=o.v.light.position}possiblyEvaluate(e,a){return o.B(e.expression.evaluate(a))}interpolate(e,a,c){return{x:o.C.number(e.x,a.x,c),y:o.C.number(e.y,a.y,c),z:o.C.number(e.z,a.z,c)}}}let Ht;class Oe extends o.E{constructor(e){super(),Ht=Ht||new o.r({anchor:new o.D(o.v.light.anchor),position:new Gt,color:new o.D(o.v.light.color),intensity:new o.D(o.v.light.intensity)}),this._transitionable=new o.t(Ht),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,a={}){if(!this._validate(o.x,e,a))for(const c in e){const f=e[c];c.endsWith("-transition")?this._transitionable.setTransition(c.slice(0,-11),f):this._transitionable.setValue(c,f)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,a,c){return(!c||c.validate!==!1)&&o.y(this,e.call(o.z,{value:a,style:{glyphs:!0,sprite:!0},styleSpec:o.v}))}}const it=new o.r({"sky-color":new o.D(o.v.sky["sky-color"]),"horizon-color":new o.D(o.v.sky["horizon-color"]),"fog-color":new o.D(o.v.sky["fog-color"]),"fog-ground-blend":new o.D(o.v.sky["fog-ground-blend"]),"horizon-fog-blend":new o.D(o.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new o.D(o.v.sky["sky-horizon-blend"]),"atmosphere-blend":new o.D(o.v.sky["atmosphere-blend"])});class Xe extends o.E{constructor(e){super(),this._transitionable=new o.t(it),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.F(0))}setSky(e,a={}){if(!this._validate(o.G,e,a)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const c in e){const f=e[c];c.endsWith("-transition")?this._transitionable.setTransition(c.slice(0,-11),f):this._transitionable.setValue(c,f)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,a,c={}){return(c==null?void 0:c.validate)!==!1&&o.y(this,e.call(o.z,o.e({value:a,style:{glyphs:!0,sprite:!0},styleSpec:o.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class St{constructor(e,a){this.width=e,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,a){const c=e.join(",")+String(a);return this.dashEntry[c]||(this.dashEntry[c]=this.addDash(e,a)),this.dashEntry[c]}getDashRanges(e,a,c){const f=[];let y=e.length%2==1?-e[e.length-1]*c:0,w=e[0]*c,A=!0;f.push({left:y,right:w,isDash:A,zeroLength:e[0]===0});let P=e[0];for(let k=1;k<e.length;k++){A=!A;const O=e[k];y=P*c,P+=O,w=P*c,f.push({left:y,right:w,isDash:A,zeroLength:O===0})}return f}addRoundDash(e,a,c){const f=a/2;for(let y=-c;y<=c;y++){const w=this.width*(this.nextRow+c+y);let A=0,P=e[A];for(let k=0;k<this.width;k++){k/P.right>1&&(P=e[++A]);const O=Math.abs(k-P.left),F=Math.abs(k-P.right),j=Math.min(O,F);let G;const X=y/c*(f+1);if(P.isDash){const se=f-Math.abs(X);G=Math.sqrt(j*j+se*se)}else G=f-Math.sqrt(j*j+X*X);this.data[w+k]=Math.max(0,Math.min(255,G+128))}}}addRegularDash(e){for(let A=e.length-1;A>=0;--A){const P=e[A],k=e[A+1];P.zeroLength?e.splice(A,1):k&&k.isDash===P.isDash&&(k.left=P.left,e.splice(A,1))}const a=e[0],c=e[e.length-1];a.isDash===c.isDash&&(a.left=c.left-this.width,c.right=a.right+this.width);const f=this.width*this.nextRow;let y=0,w=e[y];for(let A=0;A<this.width;A++){A/w.right>1&&(w=e[++y]);const P=Math.abs(A-w.left),k=Math.abs(A-w.right),O=Math.min(P,k);this.data[f+A]=Math.max(0,Math.min(255,(w.isDash?O:-O)+128))}}addDash(e,a){const c=a?7:0,f=2*c+1;if(this.nextRow+f>this.height)return o.w("LineAtlas out of space"),null;let y=0;for(let A=0;A<e.length;A++)y+=e[A];if(y!==0){const A=this.width/y,P=this.getDashRanges(e,this.width,A);a?this.addRoundDash(P,A,c):this.addRegularDash(P)}const w={y:(this.nextRow+c+.5)/this.height,height:2*c/this.height,width:y};return this.nextRow+=f,this.dirty=!0,w}bind(e){const a=e.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))}}const be="maplibre_preloaded_worker_pool";class Ke{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<Ke.workerCount;)this.workers.push(new Worker(o.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach((a=>{a.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[be]}numActive(){return Object.keys(this.active).length}}const wt=Math.floor(ee.hardwareConcurrency/2);let ft,Et;function Kt(){return ft||(ft=new Ke),ft}Ke.workerCount=o.H(globalThis)?Math.max(Math.min(wt,3),1):1;class kt{constructor(e,a){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=a;const c=this.workerPool.acquire(a);for(let f=0;f<c.length;f++){const y=new o.J(c[f],a);y.name=`Worker ${f}`,this.actors.push(y)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,a){const c=[];for(const f of this.actors)c.push(f.sendAsync({type:e,data:a}));return Promise.all(c)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach((a=>{a.remove()})),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,a){for(const c of this.actors)c.registerMessageHandler(e,a)}}function At(){return Et||(Et=new kt(Kt(),o.K),Et.registerMessageHandler("GR",((m,e,a)=>o.m(e,a)))),Et}function Nt(m,e){const a=o.L();return o.M(a,a,[1,1,0]),o.N(a,a,[.5*m.width,.5*m.height,1]),m.calculatePosMatrix?o.O(a,a,m.calculatePosMatrix(e.toUnwrapped())):a}function bi(m,e,a,c,f,y,w){var A;const P=(function(j,G,X){if(j)for(const se of j){const ae=G[se];if(ae&&ae.source===X&&ae.type==="fill-extrusion")return!0}else for(const se in G){const ae=G[se];if(ae.source===X&&ae.type==="fill-extrusion")return!0}return!1})((A=f==null?void 0:f.layers)!==null&&A!==void 0?A:null,e,m.id),k=y.maxPitchScaleFactor(),O=m.tilesIn(c,k,P);O.sort(wi);const F=[];for(const j of O)F.push({wrappedTileID:j.tileID.wrapped().key,queryResults:j.tile.queryRenderedFeatures(e,a,m._state,j.queryGeometry,j.cameraQueryGeometry,j.scale,f,y,k,Nt(m.transform,j.tileID),w?(G,X)=>w(j.tileID,G,X):void 0)});return(function(j,G){for(const X in j)for(const se of j[X])gi(se,G);return j})((function(j){const G={},X={};for(const se of j){const ae=se.queryResults,oe=se.wrappedTileID,ue=X[oe]=X[oe]||{};for(const ge in ae){const he=ae[ge],ye=ue[ge]=ue[ge]||{},Te=G[ge]=G[ge]||[];for(const fe of he)ye[fe.featureIndex]||(ye[fe.featureIndex]=!0,Te.push(fe))}}return G})(F),m)}function wi(m,e){const a=m.tileID,c=e.tileID;return a.overscaledZ-c.overscaledZ||a.canonical.y-c.canonical.y||a.wrap-c.wrap||a.canonical.x-c.canonical.x}function gi(m,e){const a=m.feature,c=e.getFeatureState(a.layer["source-layer"],a.id);a.source=a.layer.source,a.layer["source-layer"]&&(a.sourceLayer=a.layer["source-layer"]),a.state=c}function ni(m,e,a){return o._(this,void 0,void 0,(function*(){let c=m;if(m.url?c=(yield o.j(e.transformRequest(m.url,"Source"),a)).data:yield ee.frameAsync(a),!c)return null;const f=o.Q(o.e(c,m),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in c&&c.vector_layers&&(f.vectorLayerIds=c.vector_layers.map((y=>y.id))),f}))}class Ti{constructor(e,a){e&&(a?this.setSouthWest(e).setNorthEast(a):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof o.S?new o.S(e.lng,e.lat):o.S.convert(e),this}setSouthWest(e){return this._sw=e instanceof o.S?new o.S(e.lng,e.lat):o.S.convert(e),this}extend(e){const a=this._sw,c=this._ne;let f,y;if(e instanceof o.S)f=e,y=e;else{if(!(e instanceof Ti))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Ti.convert(e)):this.extend(o.S.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(o.S.convert(e)):this;if(f=e._sw,y=e._ne,!f||!y)return this}return a||c?(a.lng=Math.min(f.lng,a.lng),a.lat=Math.min(f.lat,a.lat),c.lng=Math.max(y.lng,c.lng),c.lat=Math.max(y.lat,c.lat)):(this._sw=new o.S(f.lng,f.lat),this._ne=new o.S(y.lng,y.lat)),this}getCenter(){return new o.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new o.S(this.getWest(),this.getNorth())}getSouthEast(){return new o.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:a,lat:c}=o.S.convert(e);let f=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&f}static convert(e){return e instanceof Ti?e:e&&new Ti(e)}static fromLngLat(e,a=0){const c=360*a/40075017,f=c/Math.cos(Math.PI/180*e.lat);return new Ti(new o.S(e.lng-f,e.lat-c),new o.S(e.lng+f,e.lat+c))}adjustAntiMeridian(){const e=new o.S(this._sw.lng,this._sw.lat),a=new o.S(this._ne.lng,this._ne.lat);return new Ti(e,e.lng>a.lng?new o.S(a.lng+360,a.lat):a)}}class ki{constructor(e,a,c){this.bounds=Ti.convert(this.validateBounds(e)),this.minzoom=a||0,this.maxzoom=c||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const a=Math.pow(2,e.z),c=Math.floor(o.V(this.bounds.getWest())*a),f=Math.floor(o.U(this.bounds.getNorth())*a),y=Math.ceil(o.V(this.bounds.getEast())*a),w=Math.ceil(o.U(this.bounds.getSouth())*a);return e.x>=c&&e.x<y&&e.y>=f&&e.y<w}}class fr extends o.E{constructor(e,a,c,f){if(super(),this.id=e,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.e(this,o.Q(a,["url","scheme","tileSize","promoteId"])),this._options=o.e({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(f)}load(){return o._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield ni(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(o.e(this,e),e.bounds&&(this.tileBounds=new ki(e.bounds,this.minzoom,this.maxzoom)),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new o.k(e))}}))}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty((()=>{this._options.tiles=e})),this}setUrl(e){return this.setSourceProperty((()=>{this.url=e,this._options.url=e})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return o.e({},this._options)}loadTile(e){return o._(this,void 0,void 0,(function*(){const a=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),c={request:this.map._requestManager.transformRequest(a,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};c.request.collectResourceTiming=this._collectResourceTiming;let f="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise(((y,w)=>{e.reloadPromise={resolve:y,reject:w}}))}else e.actor=this.dispatcher.getActor(),f="LT";e.abortController=new AbortController;try{const y=yield e.actor.sendAsync({type:f,data:c},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,y)}catch(y){if(delete e.abortController,e.aborted)return;if(y&&y.status!==404)throw y;this._afterTileLoadWorkerResponse(e,null)}}))}_afterTileLoadWorkerResponse(e,a){if(a&&a.resourceTiming&&(e.resourceTiming=a.resourceTiming),a&&this.map._refreshExpiredTiles&&e.setExpiryData(a),e.loadVectorData(a,this.map.painter),e.reloadPromise){const c=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(c.resolve).catch(c.reject)}}abortTile(e){return o._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))}))}unloadTile(e){return o._(this,void 0,void 0,(function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class Mr extends o.E{constructor(e,a,c,f){super(),this.id=e,this.dispatcher=c,this.setEventedParent(f),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.e({type:"raster"},a),o.e(this,o.Q(a,["url","scheme","tileSize"]))}load(){return o._(this,arguments,void 0,(function*(e=!1){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const a=yield ni(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,a&&(o.e(this,a),a.bounds&&(this.tileBounds=new ki(a.bounds,this.minzoom,this.maxzoom)),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(a){this._tileJSONRequest=null,this.fire(new o.k(a))}}))}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty((()=>{this._options.tiles=e})),this}setUrl(e){return this.setSourceProperty((()=>{this.url=e,this._options.url=e})),this}serialize(){return o.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return o._(this,void 0,void 0,(function*(){const a=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const c=yield ke.getImage(this.map._requestManager.transformRequest(a,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(c&&c.data){this.map._refreshExpiredTiles&&(c.cacheControl||c.expires)&&e.setExpiryData({cacheControl:c.cacheControl,expires:c.expires});const f=this.map.painter.context,y=f.gl,w=c.data;e.texture=this.map.painter.getTileTexture(w.width),e.texture?e.texture.update(w,{useMipmap:!0}):(e.texture=new o.T(f,w,y.RGBA,{useMipmap:!0}),e.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE,y.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(c){if(delete e.abortController,e.aborted)e.state="unloaded";else if(c)throw e.state="errored",c}}))}abortTile(e){return o._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)}))}unloadTile(e){return o._(this,void 0,void 0,(function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)}))}hasTransition(){return!1}}class zn extends Mr{constructor(e,a,c,f){super(e,a,c,f),this.type="raster-dem",this.maxzoom=22,this._options=o.e({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox",this.redFactor=a.redFactor,this.greenFactor=a.greenFactor,this.blueFactor=a.blueFactor,this.baseShift=a.baseShift}loadTile(e){return o._(this,void 0,void 0,(function*(){const a=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),c=this.map._requestManager.transformRequest(a,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const f=yield ke.getImage(c,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(f&&f.data){const y=f.data;this.map._refreshExpiredTiles&&(f.cacheControl||f.expires)&&e.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const w=o.b(y)&&o.W()?y:yield this.readImageNow(y),A={type:this.type,uid:e.uid,source:this.id,rawImageData:w,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const P=yield e.actor.sendAsync({type:"LDT",data:A});e.dem=P,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(f){if(delete e.abortController,e.aborted)e.state="unloaded";else if(f)throw e.state="errored",f}}))}readImageNow(e){return o._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&o.X()){const a=e.width+2,c=e.height+2;try{return new o.R({width:a,height:c},yield o.Y(e,-1,-1,a,c))}catch{}}return ee.getImageData(e,1)}))}_getNeighboringTiles(e){const a=e.canonical,c=Math.pow(2,a.z),f=(a.x-1+c)%c,y=a.x===0?e.wrap-1:e.wrap,w=(a.x+1+c)%c,A=a.x+1===c?e.wrap+1:e.wrap,P={};return P[new o.Z(e.overscaledZ,y,a.z,f,a.y).key]={backfilled:!1},P[new o.Z(e.overscaledZ,A,a.z,w,a.y).key]={backfilled:!1},a.y>0&&(P[new o.Z(e.overscaledZ,y,a.z,f,a.y-1).key]={backfilled:!1},P[new o.Z(e.overscaledZ,e.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},P[new o.Z(e.overscaledZ,A,a.z,w,a.y-1).key]={backfilled:!1}),a.y+1<c&&(P[new o.Z(e.overscaledZ,y,a.z,f,a.y+1).key]={backfilled:!1},P[new o.Z(e.overscaledZ,e.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},P[new o.Z(e.overscaledZ,A,a.z,w,a.y+1).key]={backfilled:!1}),P}unloadTile(e){return o._(this,void 0,void 0,(function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))}))}}class wa extends o.E{constructor(e,a,c,f){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:a.data},this.actor=c.getActor(),this.setEventedParent(f),this._data=a.data,this._options=o.e({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId,a.clusterMaxZoom!==void 0&&this.maxzoom<=a.clusterMaxZoom&&o.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${a.clusterMaxZoom}".`),this.workerOptions=o.e({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(a.buffer!==void 0?a.buffer:128),tolerance:this._pixelsToTileUnits(a.tolerance!==void 0?a.tolerance:.375),extent:o.$,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(a.clusterMaxZoom),minPoints:Math.max(2,a.clusterMinPoints||2),extent:o.$,radius:this._pixelsToTileUnits(a.clusterRadius||50),log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(o.$/this.tileSize)}_getClusterMaxZoom(e){const a=e?Math.round(e):this.maxzoom-1;return Number.isInteger(e)||e===void 0||o.w(`Integer expected for option 'clusterMaxZoom': provided value "${e}" rounded to "${a}"`),a}load(){return o._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._pendingWorkerUpdate={data:e},this._updateWorkerData(),this}updateData(e){return this._pendingWorkerUpdate.diff=o.a0(this._pendingWorkerUpdate.diff,e),this._updateWorkerData(),this}getData(){return o._(this,void 0,void 0,(function*(){const e=o.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})}))}getCoordinatesFromGeometry(e){return e.type==="GeometryCollection"?e.geometries.map((a=>a.coordinates)).flat(1/0):e.coordinates.flat(1/0)}getBounds(){return o._(this,void 0,void 0,(function*(){const e=new Ti,a=yield this.getData();let c;switch(a.type){case"FeatureCollection":c=a.features.map((f=>this.getCoordinatesFromGeometry(f.geometry))).flat(1/0);break;case"Feature":c=this.getCoordinatesFromGeometry(a.geometry);break;default:c=this.getCoordinatesFromGeometry(a)}if(c.length==0)return e;for(let f=0;f<c.length-1;f+=2)e.extend([c[f],c[f+1]]);return e}))}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(e.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,a,c){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:a,offset:c}})}_updateWorkerData(){return o._(this,void 0,void 0,(function*(){if(this._isUpdatingWorker)return;const{data:e,diff:a}=this._pendingWorkerUpdate;if(!e&&!a)return void o.w(`No data or diff provided to GeoJSONSource ${this.id}.`);const c=o.e({type:this.type},this.workerOptions);e?(typeof e=="string"?(c.request=this.map._requestManager.transformRequest(ee.resolveURL(e),"Source"),c.request.collectResourceTiming=this._collectResourceTiming):c.data=JSON.stringify(e),this._pendingWorkerUpdate.data=void 0):a&&(c.dataDiff=a,this._pendingWorkerUpdate.diff=void 0),this._isUpdatingWorker=!0,this.fire(new o.l("dataloading",{dataType:"source"}));try{const f=yield this.actor.sendAsync({type:"LD",data:c});if(this._isUpdatingWorker=!1,this._removed||f.abandoned)return void this.fire(new o.l("dataabort",{dataType:"source"}));this._data=f.data;let y=null;f.resourceTiming&&f.resourceTiming[this.id]&&(y=f.resourceTiming[this.id].slice(0));const w={dataType:"source"};this._collectResourceTiming&&y&&y.length>0&&o.e(w,{resourceTiming:y}),this.fire(new o.l("data",Object.assign(Object.assign({},w),{sourceDataType:"metadata"}))),this.fire(new o.l("data",Object.assign(Object.assign({},w),{sourceDataType:"content"})))}catch(f){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new o.l("dataabort",{dataType:"source"}));this.fire(new o.k(f))}finally{(this._pendingWorkerUpdate.data||this._pendingWorkerUpdate.diff)&&this._updateWorkerData()}}))}loaded(){return!this._isUpdatingWorker&&this._pendingWorkerUpdate.data===void 0&&this._pendingWorkerUpdate.diff===void 0}loadTile(e){return o._(this,void 0,void 0,(function*(){const a=e.actor?"RT":"LT";e.actor=this.actor;const c={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};e.abortController=new AbortController;const f=yield this.actor.sendAsync({type:a,data:c},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(f,this.map.painter,a==="RT")}))}abortTile(e){return o._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0}))}unloadTile(e){return o._(this,void 0,void 0,(function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return o.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Ar extends o.E{constructor(e,a,c,f){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=c,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(f),this.options=a}load(e){return o._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const a=yield ke.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,a&&a.data&&(this.image=a.data,e&&(this.coordinates=e),this._finishLoading())}catch(a){this._request=null,this._loaded=!0,this.fire(new o.k(a))}}))}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const a=e.map(o.a1.fromLngLat);var c;return this.tileID=(function(f){const y=o.a2.fromPoints(f),w=y.width(),A=y.height(),P=Math.max(w,A),k=Math.max(0,Math.floor(-Math.log(P)/Math.LN2)),O=Math.pow(2,k);return new o.a4(k,Math.floor((y.minX+y.maxX)/2*O),Math.floor((y.minY+y.maxY)/2*O))})(a),this.terrainTileRanges=this._getOverlappingTileRanges(a),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=a.map((f=>this.tileID.getTilePoint(f)._round())),this.flippedWindingOrder=((c=this.tileCoords)[1].x-c[0].x)*(c[2].y-c[0].y)-(c[1].y-c[0].y)*(c[2].x-c[0].x)<0,this.fire(new o.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,a=e.gl;this.texture||(this.texture=new o.T(e,this.image,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let c=!1;for(const f in this.tiles){const y=this.tiles[f];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,c=!0)}c&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return o._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(e){const{minX:a,minY:c,maxX:f,maxY:y}=o.a2.fromPoints(e),w={};for(let A=0;A<=o.a3;A++){const P=Math.pow(2,A),k=Math.floor(a*P),O=Math.floor(c*P),F=Math.floor(f*P),j=Math.floor(y*P);w[A]={minTileX:k,minTileY:O,maxTileX:F,maxTileY:j}}return w}}class jo extends Ar{constructor(e,a,c,f){super(e,a,c,f),this.roundZoom=!0,this.type="video",this.options=a}load(){return o._(this,void 0,void 0,(function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const a of e.urls)this.urls.push(this.map._requestManager.transformRequest(a,"Source").url);try{const a=yield o.a5(this.urls);if(this._loaded=!0,!a)return;this.video=a,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(a){this.fire(new o.k(a))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const a=this.video.seekable;e<a.start(0)||e>a.end(0)?this.fire(new o.k(new o.a6(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,a=e.gl;this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new o.T(e,this.video,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let c=!1;for(const f in this.tiles){const y=this.tiles[f];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,c=!0)}c&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Za extends Ar{constructor(e,a,c,f){super(e,a,c,f),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some((y=>!Array.isArray(y)||y.length!==2||y.some((w=>typeof w!="number"))))||this.fire(new o.k(new o.a6(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.k(new o.a6(`sources.${e}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new o.k(new o.a6(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new o.k(new o.a6(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.k(new o.a6(`sources.${e}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){return o._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const a=this.map.painter.context,c=a.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.T(a,this.canvas,c.RGBA,{premultiply:!0});let f=!1;for(const y in this.tiles){const w=this.tiles[y];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,f=!0)}f&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const io={},As=m=>{switch(m){case"geojson":return wa;case"image":return Ar;case"raster":return Mr;case"raster-dem":return zn;case"vector":return fr;case"video":return jo;case"canvas":return Za}return io[m]},Fo="RTLPluginLoaded";class no extends o.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=At()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch((a=>{throw this.status="error",a}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return o._(this,arguments,void 0,(function*(a,c=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=ee.resolveURL(a),!this.url)throw new Error(`requested url ${a} is invalid`);if(this.status==="unavailable"){if(!c)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return o._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new o.l(Fo))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Sa=null;function Yn(){return Sa||(Sa=new no),Sa}class oa{constructor(e,a){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=o.a7(),this.uses=0,this.tileSize=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const a=e+this.timeAdded;a<this.fadeEndTime||(this.fadeEndTime=a)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,a,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=(function(f,y){const w={};if(!y)return w;for(const A of f){const P=A.layerIds.map((k=>y.getLayer(k))).filter(Boolean);if(P.length!==0){A.layers=P,A.stateDependentLayerIds&&(A.stateDependentLayers=A.stateDependentLayerIds.map((k=>P.filter((O=>O.id===k))[0])));for(const k of P)w[k.id]=A}}return w})(e.buckets,a==null?void 0:a.style),this.hasSymbolBuckets=!1;for(const f in this.buckets){const y=this.buckets[f];if(y instanceof o.a9){if(this.hasSymbolBuckets=!0,!c)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const f in this.buckets){const y=this.buckets[f];if(y instanceof o.a9&&y.hasRTLText){this.hasRTLText=!0,Yn().lazyLoad();break}}this.queryPadding=0;for(const f in this.buckets){const y=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(f).queryRadius(y))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new o.a8}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const c in this.buckets){const f=this.buckets[c];f.uploadPending()&&f.upload(e)}const a=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new o.T(e,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new o.T(e,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,a,c,f,y,w,A,P,k,O,F){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:f,cameraQueryGeometry:y,scale:w,tileSize:this.tileSize,pixelPosMatrix:O,transform:P,params:A,queryPadding:this.queryPadding*k,getElevation:F},e,a,c):{}}querySourceFeatures(e,a){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const f=c.loadVTLayers(),y=a&&a.sourceLayer?a.sourceLayer:"",w=f._geojsonTileLayer||f[y];if(!w)return;const A=o.aa(a&&a.filter),{z:P,x:k,y:O}=this.tileID.canonical,F={z:P,x:k,y:O};for(let j=0;j<w.length;j++){const G=w.feature(j);if(A.needGeometry){const ae=o.ab(G,!0);if(!A.filter(new o.F(this.tileID.overscaledZ),ae,this.tileID.canonical))continue}else if(!A.filter(new o.F(this.tileID.overscaledZ),G))continue;const X=c.getId(G,y),se=new o.ac(G,P,k,O,X);se.tile=F,e.push(se)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const a=this.expirationTime;if(e.cacheControl){const c=o.ad(e.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const c=Date.now();let f=!1;if(this.expirationTime>c)f=!1;else if(a)if(this.expirationTime<a)f=!0;else{const y=this.expirationTime-a;y?this.expirationTime=c+Math.max(y,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const c=this.latestFeatureIndex.loadVTLayers();for(const f in this.buckets){if(!a.style.hasLayer(f))continue;const y=this.buckets[f],w=y.layers[0].sourceLayer||"_geojsonTileLayer",A=c[w],P=e[w];if(!A||!P||Object.keys(P).length===0)continue;y.update(P,A,this.imageAtlas&&this.imageAtlas.patternPositions||{});const k=a&&a.style&&a.style.getLayer(f);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(y)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ee.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=ee.now()+e}setDependencies(e,a){const c={};for(const f of a)c[f]=!0;this.dependencies[e]=c}hasDependency(e,a){for(const c of e){const f=this.dependencies[c];if(f){for(const y of a)if(f[y])return!0}}return!1}}class Me{constructor(e,a){this.max=e,this.onRemove=a,this.reset()}reset(){for(const e in this.data)for(const a of this.data[e])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(e,a,c){const f=e.wrapped().key;this.data[f]===void 0&&(this.data[f]=[]);const y={value:a,timeout:void 0};if(c!==void 0&&(y.timeout=setTimeout((()=>{this.remove(e,y)}),c)),this.data[f].push(y),this.order.push(f),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const a=this.data[e].shift();return a.timeout&&clearTimeout(a.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),a.value}getByKey(e){const a=this.data[e];return a?a[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,a){if(!this.has(e))return this;const c=e.wrapped().key,f=a===void 0?0:this.data[c].indexOf(a),y=this.data[c][f];return this.data[c].splice(f,1),y.timeout&&clearTimeout(y.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(y.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(e){const a=[];for(const c in this.data)for(const f of this.data[c])e(f.value)||a.push(f);for(const c of a)this.remove(c.value.tileID,c)}}class W{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,a,c){const f=String(a);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][f]=this.stateChanges[e][f]||{},o.e(this.stateChanges[e][f],c),this.deletedStates[e]===null){this.deletedStates[e]={};for(const y in this.state[e])y!==f&&(this.deletedStates[e][y]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][f]===null){this.deletedStates[e][f]={};for(const y in this.state[e][f])c[y]||(this.deletedStates[e][f][y]=null)}else for(const y in c)this.deletedStates[e]&&this.deletedStates[e][f]&&this.deletedStates[e][f][y]===null&&delete this.deletedStates[e][f][y]}removeFeatureState(e,a,c){if(this.deletedStates[e]===null)return;const f=String(a);if(this.deletedStates[e]=this.deletedStates[e]||{},c&&a!==void 0)this.deletedStates[e][f]!==null&&(this.deletedStates[e][f]=this.deletedStates[e][f]||{},this.deletedStates[e][f][c]=null);else if(a!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][f])for(c in this.deletedStates[e][f]={},this.stateChanges[e][f])this.deletedStates[e][f][c]=null;else this.deletedStates[e][f]=null;else this.deletedStates[e]=null}getState(e,a){const c=String(a),f=o.e({},(this.state[e]||{})[c],(this.stateChanges[e]||{})[c]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const y=this.deletedStates[e][a];if(y===null)return{};for(const w in y)delete f[w]}return f}initializeTileState(e,a){e.setFeatureState(this.state,a)}coalesceChanges(e,a){const c={};for(const f in this.stateChanges){this.state[f]=this.state[f]||{};const y={};for(const w in this.stateChanges[f])this.state[f][w]||(this.state[f][w]={}),o.e(this.state[f][w],this.stateChanges[f][w]),y[w]=this.state[f][w];c[f]=y}for(const f in this.deletedStates){this.state[f]=this.state[f]||{};const y={};if(this.deletedStates[f]===null)for(const w in this.state[f])y[w]={},this.state[f][w]={};else for(const w in this.deletedStates[f]){if(this.deletedStates[f][w]===null)this.state[f][w]={};else for(const A of Object.keys(this.deletedStates[f][w]))delete this.state[f][w][A];y[w]=this.state[f][w]}c[f]=c[f]||{},o.e(c[f],y)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const f in e)e[f].setFeatureState(c,a)}}const Q=89.25;function re(m,e){const a=o.ah(e.lat,-o.ai,o.ai);return new o.P(o.V(e.lng)*m,o.U(a)*m)}function de(m,e){return new o.a1(e.x/m,e.y/m).toLngLat()}function we(m){return m.cameraToCenterDistance*Math.min(.85*Math.tan(o.ae(90-m.pitch)),Math.tan(o.ae(Q-m.pitch)))}function Pe(m,e){const a=m.canonical,c=e/o.af(a.z),f=a.x+Math.pow(2,a.z)*m.wrap,y=o.ag(new Float64Array(16));return o.M(y,y,[f*c,a.y*c,0]),o.N(y,y,[c/o.$,c/o.$,1]),y}function je(m,e,a,c,f){const y=o.a1.fromLngLat(m,e),w=f*o.aj(1,m.lat),A=w*Math.cos(o.ae(a)),P=Math.sqrt(w*w-A*A),k=P*Math.sin(o.ae(-c)),O=P*Math.cos(o.ae(-c));return new o.a1(y.x+k,y.y+O,y.z+A)}function ze(m,e,a){const c=e.intersectsFrustum(m);if(!a||c===0)return c;const f=e.intersectsPlane(a);return f===0?0:c===2&&f===2?2:1}function Je(m,e,a){let c=0;const f=(a-e)/10;for(let y=0;y<10;y++)c+=f*Math.pow(Math.cos(e+(y+.5)/10*(a-e)),m);return c}function dt(m,e){return function(a,c,f,y,w){const A=2*((m-1)/o.ak(Math.cos(o.ae(Q-w))/Math.cos(o.ae(Q)))-1),P=Math.acos(f/y),k=2*Je(A-1,0,o.ae(w/2)),O=Math.min(o.ae(Q),P+o.ae(w/2)),F=Je(A-1,Math.min(O,P-o.ae(w/2)),O),j=Math.atan(c/f),G=Math.hypot(c,f);let X=a;return X+=o.ak(y/G/Math.max(.5,Math.cos(o.ae(w/2)))),X+=A*o.ak(Math.cos(j))/2,X-=o.ak(Math.max(1,F/k/e))/2,X}}const nt=dt(9.314,3);function It(m,e){const a=(e.roundZoom?Math.round:Math.floor)(m.zoom+o.ak(m.tileSize/e.tileSize));return Math.max(0,a)}function Ie(m,e){const a=m.getCameraFrustum(),c=m.getClippingPlane(),f=m.screenPointToMercatorCoordinate(m.getCameraPoint()),y=o.a1.fromLngLat(m.center,m.elevation);f.z=y.z+Math.cos(m.pitchInRadians)*m.cameraToCenterDistance/m.worldSize;const w=m.getCoveringTilesDetailsProvider(),A=w.allowVariableZoom(m,e),P=It(m,e),k=e.minzoom||0,O=e.maxzoom!==void 0?e.maxzoom:m.maxZoom,F=Math.min(Math.max(0,P),O),j=Math.pow(2,F),G=[j*f.x,j*f.y,0],X=[j*y.x,j*y.y,0],se=Math.hypot(y.x-f.x,y.y-f.y),ae=Math.abs(y.z-f.z),oe=Math.hypot(se,ae),ue=ye=>({zoom:0,x:0,y:0,wrap:ye,fullyVisible:!1}),ge=[],he=[];if(m.renderWorldCopies&&w.allowWorldCopies())for(let ye=1;ye<=3;ye++)ge.push(ue(-ye)),ge.push(ue(ye));for(ge.push(ue(0));ge.length>0;){const ye=ge.pop(),Te=ye.x,fe=ye.y;let Re=ye.fullyVisible;const $e={x:Te,y:fe,z:ye.zoom},Ne=w.getTileBoundingVolume($e,ye.wrap,m.elevation,e);if(!Re){const _t=ze(a,Ne,c);if(_t===0)continue;Re=_t===2}const Fe=w.distanceToTile2d(f.x,f.y,$e,Ne);let Ze=P;A&&(Ze=(e.calculateTileZoom||nt)(m.zoom+o.ak(m.tileSize/e.tileSize),Fe,ae,oe,m.fov)),Ze=(e.roundZoom?Math.round:Math.floor)(Ze),Ze=Math.max(0,Ze);const mt=Math.min(Ze,O);if(ye.wrap=w.getWrap(y,$e,ye.wrap),ye.zoom>=mt){if(ye.zoom<k)continue;const _t=F-ye.zoom,st=G[0]-.5-(Te<<_t),Dt=G[1]-.5-(fe<<_t),hi=e.reparseOverscaled?Math.max(ye.zoom,Ze):ye.zoom;he.push({tileID:new o.Z(ye.zoom===O?hi:ye.zoom,ye.wrap,ye.zoom,Te,fe),distanceSq:o.al([X[0]-.5-Te,X[1]-.5-fe]),tileDistanceToCamera:Math.sqrt(st*st+Dt*Dt)})}else for(let _t=0;_t<4;_t++)ge.push({zoom:ye.zoom+1,x:(Te<<1)+_t%2,y:(fe<<1)+(_t>>1),wrap:ye.wrap,fullyVisible:Re})}return he.sort(((ye,Te)=>ye.distanceSq-Te.distanceSq)).map((ye=>ye.tileID))}const ei=o.a2.fromPoints([new o.P(0,0),new o.P(o.$,o.$)]);class _i extends o.E{constructor(e,a,c){super(),this.id=e,this.dispatcher=c,this.on("data",(f=>this._dataHandler(f))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((f,y,w,A)=>{const P=new(As(y.type))(f,y,w,A);if(P.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${P.id}`);return P})(e,a,c,this),this._tiles={},this._cache=new Me(0,(f=>this._unloadTile(f))),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new W,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const a=this._tiles[e];if(a.state!=="loaded"&&a.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,a,c){return o._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,a,c)}catch(f){e.state="errored",f.status!==404?this._source.fire(new o.k(f,{tile:e})):this.update(this.transform,this.terrain)}}))}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new o.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const a in this._tiles){const c=this._tiles[a];c.upload(e),c.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((e=>e.tileID)).sort(jt).map((e=>e.key))}getRenderableIds(e){const a=[];for(const c in this._tiles)this._isIdRenderable(c,e)&&a.push(this._tiles[c]);return e?a.sort(((c,f)=>{const y=c.tileID,w=f.tileID,A=new o.P(y.canonical.x,y.canonical.y)._rotate(-this.transform.bearingInRadians),P=new o.P(w.canonical.x,w.canonical.y)._rotate(-this.transform.bearingInRadians);return y.overscaledZ-w.overscaledZ||P.y-A.y||P.x-A.x})).map((c=>c.tileID.key)):a.map((c=>c.tileID)).sort(jt).map((c=>c.key))}hasRenderableParent(e){const a=this.findLoadedParent(e,0);return!!a&&this._isIdRenderable(a.tileID.key)}_isIdRenderable(e,a){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(a||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const a in this._tiles)e?this._reloadTile(a,"expired"):this._tiles[a].state!=="errored"&&this._reloadTile(a,"reloading")}}_reloadTile(e,a){return o._(this,void 0,void 0,(function*(){const c=this._tiles[e];c&&(c.state!=="loading"&&(c.state=a),yield this._loadTile(c,e,a))}))}_tileLoaded(e,a,c){e.timeAdded=ee.now(),c==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(a,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new o.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const a=this.getRenderableIds();for(let f=0;f<a.length;f++){const y=a[f];if(e.neighboringTiles&&e.neighboringTiles[y]){const w=this.getTileByID(y);c(e,w),c(w,e)}}function c(f,y){f.needsHillshadePrepare=!0,f.needsTerrainPrepare=!0;let w=y.tileID.canonical.x-f.tileID.canonical.x;const A=y.tileID.canonical.y-f.tileID.canonical.y,P=Math.pow(2,f.tileID.canonical.z),k=y.tileID.key;w===0&&A===0||Math.abs(A)>1||(Math.abs(w)>1&&(Math.abs(w+P)===1?w+=P:Math.abs(w-P)===1&&(w-=P)),y.dem&&f.dem&&(f.dem.backfillBorder(y.dem,w,A),f.neighboringTiles&&f.neighboringTiles[k]&&(f.neighboringTiles[k].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,a,c,f){for(const y in this._tiles){let w=this._tiles[y];if(f[y]||!w.hasData()||w.tileID.overscaledZ<=a||w.tileID.overscaledZ>c)continue;let A=w.tileID;for(;w&&w.tileID.overscaledZ>a+1;){const k=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[k.key],w&&w.hasData()&&(A=k)}let P=A;for(;P.overscaledZ>a;)if(P=P.scaledTo(P.overscaledZ-1),e[P.key]||e[P.canonical.key]){f[A.key]=A;break}}}findLoadedParent(e,a){if(e.key in this._loadedParentTiles){const c=this._loadedParentTiles[e.key];return c&&c.tileID.overscaledZ>=a?c:null}for(let c=e.overscaledZ-1;c>=a;c--){const f=e.scaledTo(c),y=this._getLoadedTile(f);if(y)return y}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const a=this._tiles[e.key];return a&&a.hasData()?a:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const a=Math.ceil(e.width/this._source.tileSize)+1,c=Math.ceil(e.height/this._source.tileSize)+1,f=Math.floor(a*c*(this._maxTileCacheZoomLevels===null?o.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,f):f;this._cache.setMaxSize(y)}handleWrapJump(e){const a=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,a){const c={};for(const f in this._tiles){const y=this._tiles[f];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+a),c[y.tileID.key]=y}this._tiles=c;for(const f in this._timers)clearTimeout(this._timers[f]),delete this._timers[f];for(const f in this._tiles)this._setTileReloadTimer(f,this._tiles[f])}}_updateCoveredAndRetainedTiles(e,a,c,f,y,w){const A={},P={},k=Object.keys(e),O=ee.now();for(const F of k){const j=e[F],G=this._tiles[F];if(!G||G.fadeEndTime!==0&&G.fadeEndTime<=O)continue;const X=this.findLoadedParent(j,a),se=this.findLoadedSibling(j),ae=X||se||null;ae&&(this._addTile(ae.tileID),A[ae.tileID.key]=ae.tileID),P[F]=j}this._retainLoadedChildren(P,f,c,e);for(const F in A)e[F]||(this._coveredTiles[F]=!0,e[F]=A[F]);if(w){const F={},j={};for(const G of y)this._tiles[G.key].hasData()?F[G.key]=G:j[G.key]=G;for(const G in j){const X=j[G].children(this._source.maxzoom);this._tiles[X[0].key]&&this._tiles[X[1].key]&&this._tiles[X[2].key]&&this._tiles[X[3].key]&&(F[X[0].key]=e[X[0].key]=X[0],F[X[1].key]=e[X[1].key]=X[1],F[X[2].key]=e[X[2].key]=X[2],F[X[3].key]=e[X[3].key]=X[3],delete j[G])}for(const G in j){const X=j[G],se=this.findLoadedParent(X,this._source.minzoom),ae=this.findLoadedSibling(X),oe=se||ae||null;if(oe){F[oe.tileID.key]=e[oe.tileID.key]=oe.tileID;for(const ue in F)F[ue].isChildOf(oe.tileID)&&delete F[ue]}}for(const G in this._tiles)F[G]||(this._coveredTiles[G]=!0)}}update(e,a){if(!this._sourceLoaded||this._paused)return;let c;this.transform=e,this.terrain=a,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?c=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((O=>new o.Z(O.canonical.z,O.wrap,O.canonical.z,O.canonical.x,O.canonical.y))):(c=Ie(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:a,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(c=c.filter((O=>this._source.hasTile(O))))):c=[];const f=It(e,this._source),y=Math.max(f-_i.maxOverzooming,this._source.minzoom),w=Math.max(f+_i.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const O={};for(const F of c)if(F.canonical.z>this._source.minzoom){const j=F.scaledTo(F.canonical.z-1);O[j.key]=j;const G=F.scaledTo(Math.max(this._source.minzoom,Math.min(F.canonical.z,5)));O[G.key]=G}c=c.concat(Object.values(O))}const A=c.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,A&&this.fire(new o.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const P=this._updateRetainedTiles(c,f);si(this._source.type)&&this._updateCoveredAndRetainedTiles(P,y,w,f,c,a);for(const O in P)this._tiles[O].clearFadeHold();const k=o.am(this._tiles,P);for(const O of k){const F=this._tiles[O];F.hasSymbolBuckets&&!F.holdingForFade()?F.setHoldDuration(this.map._fadeDuration):F.hasSymbolBuckets&&!F.symbolFadeFinished()||this._removeTile(O)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,a){var c;const f={},y={},w=Math.max(a-_i.maxOverzooming,this._source.minzoom),A=Math.max(a+_i.maxUnderzooming,this._source.minzoom),P={};for(const k of e){const O=this._addTile(k);f[k.key]=k,O.hasData()||a<this._source.maxzoom&&(P[k.key]=k)}this._retainLoadedChildren(P,a,A,f);for(const k of e){let O=this._tiles[k.key];if(O.hasData())continue;if(a+1>this._source.maxzoom){const j=k.children(this._source.maxzoom)[0],G=this.getTile(j);if(G&&G.hasData()){f[j.key]=j;continue}}else{const j=k.children(this._source.maxzoom);if(f[j[0].key]&&f[j[1].key]&&f[j[2].key]&&f[j[3].key])continue}let F=O.wasRequested();for(let j=k.overscaledZ-1;j>=w;--j){const G=k.scaledTo(j);if(y[G.key])break;if(y[G.key]=!0,O=this.getTile(G),!O&&F&&(O=this._addTile(G)),O){const X=O.hasData();if((X||!(!((c=this.map)===null||c===void 0)&&c.cancelPendingTileRequestsWhileZooming)||F)&&(f[G.key]=G),F=O.wasRequested(),X)break}}}return f}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const a=[];let c,f=this._tiles[e].tileID;for(;f.overscaledZ>0;){if(f.key in this._loadedParentTiles){c=this._loadedParentTiles[f.key];break}a.push(f.key);const y=f.scaledTo(f.overscaledZ-1);if(c=this._getLoadedTile(y),c)break;f=y}for(const y of a)this._loadedParentTiles[y]=c}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const a=this._tiles[e].tileID,c=this._getLoadedTile(a);this._loadedSiblingTiles[a.key]=c}}_addTile(e){let a=this._tiles[e.key];if(a)return a;a=this._cache.getAndRemove(e),a&&(this._setTileReloadTimer(e.key,a),a.tileID=e,this._state.initializeTileState(a,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,a)));const c=a;return a||(a=new oa(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(a,e.key,a.state)),a.uses++,this._tiles[e.key]=a,c||this._source.fire(new o.l("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a}_setTileReloadTimer(e,a){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const c=a.getExpiryTimeout();c&&(this._timers[e]=setTimeout((()=>{this._reloadTile(e,"expired"),delete this._timers[e]}),c))}refreshTiles(e){for(const a in this._tiles)(this._isIdRenderable(a)||this._tiles[a].state=="errored")&&e.some((c=>c.equals(this._tiles[a].tileID.canonical)))&&this._reloadTile(a,"expired")}_removeTile(e){const a=this._tiles[e];a&&(a.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}_dataHandler(e){const a=e.sourceDataType;e.dataType==="source"&&a==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&a==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,a,c){const f=[],y=this.transform;if(!y)return f;const w=y.getCoveringTilesDetailsProvider().allowWorldCopies(),A=c?y.getCameraQueryGeometry(e):e,P=G=>y.screenPointToMercatorCoordinate(G,this.terrain),k=this.transformBbox(e,P,!w),O=this.transformBbox(A,P,!w),F=this.getIds(),j=o.a2.fromPoints(O);for(let G=0;G<F.length;G++){const X=this._tiles[F[G]];if(X.holdingForFade())continue;const se=w?[X.tileID]:[X.tileID.unwrapTo(-1),X.tileID.unwrapTo(0)],ae=Math.pow(2,y.zoom-X.tileID.overscaledZ),oe=a*X.queryPadding*o.$/X.tileSize/ae;for(const ue of se){const ge=j.map((he=>ue.getTilePoint(new o.a1(he.x,he.y))));if(ge.expandBy(oe),ge.intersects(ei)){const he=k.map((Te=>ue.getTilePoint(Te))),ye=O.map((Te=>ue.getTilePoint(Te)));f.push({tile:X,tileID:w?ue:ue.unwrapTo(0),queryGeometry:he,cameraQueryGeometry:ye,scale:ae})}}}return f}transformBbox(e,a,c){let f=e.map(a);if(c){const y=o.a2.fromPoints(e);y.shrinkBy(.001*Math.min(y.width(),y.height()));const w=y.map(a);o.a2.fromPoints(f).covers(w)||(f=f.map((A=>A.x>.5?new o.a1(A.x-1,A.y,A.z):A)))}return f}getVisibleCoordinates(e){const a=this.getRenderableIds(e).map((c=>this._tiles[c].tileID));return this.transform&&this.transform.populateCache(a),a}hasTransition(){if(this._source.hasTransition())return!0;if(si(this._source.type)){const e=ee.now();for(const a in this._tiles)if(this._tiles[a].fadeEndTime>=e)return!0}return!1}setFeatureState(e,a,c){this._state.updateState(e=e||"_geojsonTileLayer",a,c)}removeFeatureState(e,a,c){this._state.removeFeatureState(e=e||"_geojsonTileLayer",a,c)}getFeatureState(e,a){return this._state.getState(e=e||"_geojsonTileLayer",a)}setDependencies(e,a,c){const f=this._tiles[e];f&&f.setDependencies(a,c)}reloadTilesForDependencies(e,a){for(const c in this._tiles)this._tiles[c].hasDependency(e,a)&&this._reloadTile(c,"reloading");this._cache.filter((c=>!c.hasDependency(e,a)))}}function jt(m,e){const a=Math.abs(2*m.wrap)-+(m.wrap<0),c=Math.abs(2*e.wrap)-+(e.wrap<0);return m.overscaledZ-e.overscaledZ||c-a||e.canonical.y-m.canonical.y||e.canonical.x-m.canonical.x}function si(m){return m==="raster"||m==="image"||m==="video"}_i.maxOverzooming=10,_i.maxUnderzooming=3;class Yi{constructor(e,a){this.reset(e,a)}reset(e,a){this.points=e||[],this._distances=[0];for(let c=1;c<this.points.length;c++)this._distances[c]=this._distances[c-1]+this.points[c].dist(this.points[c-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=o.ah(e,0,1);let a=1,c=this._distances[a];const f=e*this.paddedLength+this.padding;for(;c<f&&a<this._distances.length;)c=this._distances[++a];const y=a-1,w=this._distances[y],A=c-w,P=A>0?(f-w)/A:0;return this.points[y].mult(1-P).add(this.points[a].mult(P))}}function Wn(m,e){let a=!0;return m==="always"||m!=="never"&&e!=="never"||(a=!1),a}class ir{constructor(e,a,c){const f=this.boxCells=[],y=this.circleCells=[];this.xCellCount=Math.ceil(e/c),this.yCellCount=Math.ceil(a/c);for(let w=0;w<this.xCellCount*this.yCellCount;w++)f.push([]),y.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=a,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,a,c,f,y){this._forEachCell(a,c,f,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(a),this.bboxes.push(c),this.bboxes.push(f),this.bboxes.push(y)}insertCircle(e,a,c,f){this._forEachCell(a-f,c-f,a+f,c+f,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(a),this.circles.push(c),this.circles.push(f)}_insertBoxCell(e,a,c,f,y,w){this.boxCells[y].push(w)}_insertCircleCell(e,a,c,f,y,w){this.circleCells[y].push(w)}_query(e,a,c,f,y,w,A){if(c<0||e>this.width||f<0||a>this.height)return[];const P=[];if(e<=0&&a<=0&&this.width<=c&&this.height<=f){if(y)return[{key:null,x1:e,y1:a,x2:c,y2:f}];for(let k=0;k<this.boxKeys.length;k++)P.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(let k=0;k<this.circleKeys.length;k++){const O=this.circles[3*k],F=this.circles[3*k+1],j=this.circles[3*k+2];P.push({key:this.circleKeys[k],x1:O-j,y1:F-j,x2:O+j,y2:F+j})}}else this._forEachCell(e,a,c,f,this._queryCell,P,{hitTest:y,overlapMode:w,seenUids:{box:{},circle:{}}},A);return P}query(e,a,c,f){return this._query(e,a,c,f,!1,null)}hitTest(e,a,c,f,y,w){return this._query(e,a,c,f,!0,y,w).length>0}hitTestCircle(e,a,c,f,y){const w=e-c,A=e+c,P=a-c,k=a+c;if(A<0||w>this.width||k<0||P>this.height)return!1;const O=[];return this._forEachCell(w,P,A,k,this._queryCellCircle,O,{hitTest:!0,overlapMode:f,circle:{x:e,y:a,radius:c},seenUids:{box:{},circle:{}}},y),O.length>0}_queryCell(e,a,c,f,y,w,A,P){const{seenUids:k,hitTest:O,overlapMode:F}=A,j=this.boxCells[y];if(j!==null){const X=this.bboxes;for(const se of j)if(!k.box[se]){k.box[se]=!0;const ae=4*se,oe=this.boxKeys[se];if(e<=X[ae+2]&&a<=X[ae+3]&&c>=X[ae+0]&&f>=X[ae+1]&&(!P||P(oe))&&(!O||!Wn(F,oe.overlapMode))&&(w.push({key:oe,x1:X[ae],y1:X[ae+1],x2:X[ae+2],y2:X[ae+3]}),O))return!0}}const G=this.circleCells[y];if(G!==null){const X=this.circles;for(const se of G)if(!k.circle[se]){k.circle[se]=!0;const ae=3*se,oe=this.circleKeys[se];if(this._circleAndRectCollide(X[ae],X[ae+1],X[ae+2],e,a,c,f)&&(!P||P(oe))&&(!O||!Wn(F,oe.overlapMode))){const ue=X[ae],ge=X[ae+1],he=X[ae+2];if(w.push({key:oe,x1:ue-he,y1:ge-he,x2:ue+he,y2:ge+he}),O)return!0}}}return!1}_queryCellCircle(e,a,c,f,y,w,A,P){const{circle:k,seenUids:O,overlapMode:F}=A,j=this.boxCells[y];if(j!==null){const X=this.bboxes;for(const se of j)if(!O.box[se]){O.box[se]=!0;const ae=4*se,oe=this.boxKeys[se];if(this._circleAndRectCollide(k.x,k.y,k.radius,X[ae+0],X[ae+1],X[ae+2],X[ae+3])&&(!P||P(oe))&&!Wn(F,oe.overlapMode))return w.push(!0),!0}}const G=this.circleCells[y];if(G!==null){const X=this.circles;for(const se of G)if(!O.circle[se]){O.circle[se]=!0;const ae=3*se,oe=this.circleKeys[se];if(this._circlesCollide(X[ae],X[ae+1],X[ae+2],k.x,k.y,k.radius)&&(!P||P(oe))&&!Wn(F,oe.overlapMode))return w.push(!0),!0}}}_forEachCell(e,a,c,f,y,w,A,P){const k=this._convertToXCellCoord(e),O=this._convertToYCellCoord(a),F=this._convertToXCellCoord(c),j=this._convertToYCellCoord(f);for(let G=k;G<=F;G++)for(let X=O;X<=j;X++)if(y.call(this,e,a,c,f,this.xCellCount*X+G,w,A,P))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,a,c,f,y,w){const A=f-e,P=y-a,k=c+w;return k*k>A*A+P*P}_circleAndRectCollide(e,a,c,f,y,w,A){const P=(w-f)/2,k=Math.abs(e-(f+P));if(k>P+c)return!1;const O=(A-y)/2,F=Math.abs(a-(y+O));if(F>O+c)return!1;if(k<=P||F<=O)return!0;const j=k-P,G=F-O;return j*j+G*G<=c*c}}function en(m,e,a){const c=o.L();if(!m){const{vecSouth:F,vecEast:j}=ti(e),G=N();G[0]=j[0],G[1]=j[1],G[2]=F[0],G[3]=F[1],f=G,(O=(w=(y=G)[0])*(k=y[3])-(P=y[2])*(A=y[1]))&&(f[0]=k*(O=1/O),f[1]=-A*O,f[2]=-P*O,f[3]=w*O),c[0]=G[0],c[1]=G[1],c[4]=G[2],c[5]=G[3]}var f,y,w,A,P,k,O;return o.N(c,c,[1/a,1/a,1]),c}function Wt(m,e,a,c){if(m){const f=o.L();if(!e){const{vecSouth:y,vecEast:w}=ti(a);f[0]=w[0],f[1]=w[1],f[4]=y[0],f[5]=y[1]}return o.N(f,f,[c,c,1]),f}return a.pixelsToClipSpaceMatrix}function ti(m){const e=Math.cos(m.rollInRadians),a=Math.sin(m.rollInRadians),c=Math.cos(m.pitchInRadians),f=Math.cos(m.bearingInRadians),y=Math.sin(m.bearingInRadians),w=o.ar();w[0]=-f*c*a-y*e,w[1]=-y*c*a+f*e;const A=o.as(w);A<1e-9?o.at(w):o.au(w,w,1/A);const P=o.ar();P[0]=f*c*e-y*a,P[1]=y*c*e+f*a;const k=o.as(P);return k<1e-9?o.at(P):o.au(P,P,1/k),{vecEast:P,vecSouth:w}}function fn(m,e,a,c){let f;c?(f=[m,e,c(m,e),1],o.aw(f,f,a)):(f=[m,e,0,1],Uo(f,f,a));const y=f[3];return{point:new o.P(f[0]/y,f[1]/y),signedDistanceFromCamera:y,isOccluded:!1}}function pt(m,e){return .5+m/e*.5}function Pr(m,e){return m.x>=-e[0]&&m.x<=e[0]&&m.y>=-e[1]&&m.y<=e[1]}function Cn(m,e,a,c,f,y,w,A,P,k,O,F,j){const G=a?m.textSizeData:m.iconSizeData,X=o.an(G,e.transform.zoom),se=[256/e.width*2+1,256/e.height*2+1],ae=a?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;ae.clear();const oe=m.lineVertexArray,ue=a?m.text.placedSymbolArray:m.icon.placedSymbolArray,ge=e.transform.width/e.transform.height;let he=!1;for(let ye=0;ye<ue.length;ye++){const Te=ue.get(ye);if(Te.hidden||Te.writingMode===o.ao.vertical&&!he){us(Te.numGlyphs,ae);continue}he=!1;const fe=new o.P(Te.anchorX,Te.anchorY),Re={getElevation:j,pitchedLabelPlaneMatrix:c,lineVertexArray:oe,pitchWithMap:y,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:fe,unwrappedTileID:P,width:k,height:O,translation:F},$e=pn(Te.anchorX,Te.anchorY,Re);if(!Pr($e.point,se)){us(Te.numGlyphs,ae);continue}const Ne=pt(e.transform.cameraToCenterDistance,$e.signedDistanceFromCamera),Fe=o.ap(G,X,Te),Ze=y?Fe*e.transform.getPitchedTextCorrection(Te.anchorX,Te.anchorY,P)/Ne:Fe*Ne,mt=Tt({projectionContext:Re,pitchedLabelPlaneMatrixInverse:f,symbol:Te,fontSize:Ze,flip:!1,keepUpright:w,glyphOffsetArray:m.glyphOffsetArray,dynamicLayoutVertexArray:ae,aspectRatio:ge,rotateToLine:A});he=mt.useVertical,(mt.notEnoughRoom||he||mt.needsFlipping&&Tt({projectionContext:Re,pitchedLabelPlaneMatrixInverse:f,symbol:Te,fontSize:Ze,flip:!0,keepUpright:w,glyphOffsetArray:m.glyphOffsetArray,dynamicLayoutVertexArray:ae,aspectRatio:ge,rotateToLine:A}).notEnoughRoom)&&us(Te.numGlyphs,ae)}a?m.text.dynamicLayoutVertexBuffer.updateData(ae):m.icon.dynamicLayoutVertexBuffer.updateData(ae)}function Ps(m,e,a,c,f,y,w,A){const P=y.glyphStartIndex+y.numGlyphs,k=y.lineStartIndex,O=y.lineStartIndex+y.lineLength,F=e.getoffsetX(y.glyphStartIndex),j=e.getoffsetX(P-1),G=ta(m*F,a,c,f,y.segment,k,O,A,w);if(!G)return null;const X=ta(m*j,a,c,f,y.segment,k,O,A,w);return X?A.projectionCache.anyProjectionOccluded?null:{first:G,last:X}:null}function cs(m,e,a,c){return m===o.ao.horizontal&&Math.abs(a.y-e.y)>Math.abs(a.x-e.x)*c?{useVertical:!0}:(m===o.ao.vertical?e.y<a.y:e.x>a.x)?{needsFlipping:!0}:null}function Tt(m){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:a,symbol:c,fontSize:f,flip:y,keepUpright:w,glyphOffsetArray:A,dynamicLayoutVertexArray:P,aspectRatio:k,rotateToLine:O}=m,F=f/24,j=c.lineOffsetX*F,G=c.lineOffsetY*F;let X;if(c.numGlyphs>1){const se=c.glyphStartIndex+c.numGlyphs,ae=c.lineStartIndex,oe=c.lineStartIndex+c.lineLength,ue=Ps(F,A,j,G,y,c,O,e);if(!ue)return{notEnoughRoom:!0};const ge=Ta(ue.first.point.x,ue.first.point.y,e,a),he=Ta(ue.last.point.x,ue.last.point.y,e,a);if(w&&!y){const ye=cs(c.writingMode,ge,he,k);if(ye)return ye}X=[ue.first];for(let ye=c.glyphStartIndex+1;ye<se-1;ye++){const Te=ta(F*A.getoffsetX(ye),j,G,y,c.segment,ae,oe,e,O);if(!Te)return{notEnoughRoom:!0};X.push(Te)}X.push(ue.last)}else{if(w&&!y){const ae=Zn(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,oe=c.lineStartIndex+c.segment+1,ue=new o.P(e.lineVertexArray.getx(oe),e.lineVertexArray.gety(oe)),ge=Zn(ue.x,ue.y,e),he=ge.signedDistanceFromCamera>0?ge.point:ci(e.tileAnchorPoint,ue,ae,1,e),ye=Ta(ae.x,ae.y,e,a),Te=Ta(he.x,he.y,e,a),fe=cs(c.writingMode,ye,Te,k);if(fe)return fe}const se=ta(F*A.getoffsetX(c.glyphStartIndex),j,G,y,c.segment,c.lineStartIndex,c.lineStartIndex+c.lineLength,e,O);if(!se||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};X=[se]}for(const se of X)o.av(P,se.point,se.angle);return{}}function ci(m,e,a,c,f){const y=m.add(m.sub(e)._unit()),w=Zn(y.x,y.y,f).point,A=a.sub(w);return a.add(A._mult(c/A.mag()))}function ri(m,e,a){const c=e.projectionCache;if(c.projections[m])return c.projections[m];const f=new o.P(e.lineVertexArray.getx(m),e.lineVertexArray.gety(m)),y=Zn(f.x,f.y,e);if(y.signedDistanceFromCamera>0)return c.projections[m]=y.point,c.anyProjectionOccluded=c.anyProjectionOccluded||y.isOccluded,y.point;const w=m-a.direction;return ci(a.distanceFromAnchor===0?e.tileAnchorPoint:new o.P(e.lineVertexArray.getx(w),e.lineVertexArray.gety(w)),f,a.previousVertex,a.absOffsetX-a.distanceFromAnchor+1,e)}function Zn(m,e,a){const c=m+a.translation[0],f=e+a.translation[1];let y;return a.pitchWithMap?(y=fn(c,f,a.pitchedLabelPlaneMatrix,a.getElevation),y.isOccluded=!1):(y=a.transform.projectTileCoordinates(c,f,a.unwrappedTileID,a.getElevation),y.point.x=(.5*y.point.x+.5)*a.width,y.point.y=(.5*-y.point.y+.5)*a.height),y}function Ta(m,e,a,c){if(a.pitchWithMap){const f=[m,e,0,1];return o.aw(f,f,c),a.transform.projectTileCoordinates(f[0]/f[3],f[1]/f[3],a.unwrappedTileID,a.getElevation).point}return{x:m/a.width*2-1,y:1-e/a.height*2}}function pn(m,e,a){return a.transform.projectTileCoordinates(m,e,a.unwrappedTileID,a.getElevation)}function ui(m,e,a){return m._unit()._perp()._mult(e*a)}function Mc(m,e,a,c,f,y,w,A,P){if(A.projectionCache.offsets[m])return A.projectionCache.offsets[m];const k=a.add(e);if(m+P.direction<c||m+P.direction>=f)return A.projectionCache.offsets[m]=k,k;const O=ri(m+P.direction,A,P),F=ui(O.sub(a),w,P.direction),j=a.add(F),G=O.add(F);return A.projectionCache.offsets[m]=o.ax(y,k,j,G)||k,A.projectionCache.offsets[m]}function ta(m,e,a,c,f,y,w,A,P){const k=c?m-e:m+e;let O=k>0?1:-1,F=0;c&&(O*=-1,F=Math.PI),O<0&&(F+=Math.PI);let j,G=O>0?y+f:y+f+1;A.projectionCache.cachedAnchorPoint?j=A.projectionCache.cachedAnchorPoint:(j=Zn(A.tileAnchorPoint.x,A.tileAnchorPoint.y,A).point,A.projectionCache.cachedAnchorPoint=j);let X,se,ae=j,oe=j,ue=0,ge=0;const he=Math.abs(k),ye=[];let Te;for(;ue+ge<=he;){if(G+=O,G<y||G>=w)return null;ue+=ge,oe=ae,se=X;const $e={absOffsetX:he,direction:O,distanceFromAnchor:ue,previousVertex:oe};if(ae=ri(G,A,$e),a===0)ye.push(oe),Te=ae.sub(oe);else{let Ne;const Fe=ae.sub(oe);Ne=Fe.mag()===0?ui(ri(G+O,A,$e).sub(ae),a,O):ui(Fe,a,O),se||(se=oe.add(Ne)),X=Mc(G,Ne,ae,y,w,se,a,A,$e),ye.push(se),Te=X.sub(se)}ge=Te.mag()}const fe=Te._mult((he-ue)/ge)._add(se||oe),Re=F+Math.atan2(ae.y-oe.y,ae.x-oe.x);return ye.push(fe),{point:fe,angle:P?Re:0,path:ye}}const Rs=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function us(m,e){for(let a=0;a<m;a++){const c=e.length;e.resize(c+4),e.float32.set(Rs,3*c)}}function Uo(m,e,a){const c=e[0],f=e[1];return m[0]=a[0]*c+a[4]*f+a[12],m[1]=a[1]*c+a[5]*f+a[13],m[3]=a[3]*c+a[7]*f+a[15],m}const En=100;class zu{constructor(e,a=new ir(e.width+200,e.height+200,25),c=new ir(e.width+200,e.height+200,25)){this.transform=e,this.grid=a,this.ignoredGrid=c,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+En,this.screenBottomBoundary=e.height+En,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,a,c,f,y,w,A,P,k,O,F,j){const G=this.projectAndGetPerspectiveRatio(e.anchorPointX+P[0],e.anchorPointY+P[1],y,O,j),X=c*G.perspectiveRatio;let se;if(w||A)se=this._projectCollisionBox(e,X,f,y,w,A,P,G,O,F,j);else{const Te=G.x+(F?F.x*X:0),fe=G.y+(F?F.y*X:0);se={allPointsOccluded:!1,box:[Te+e.x1*X,fe+e.y1*X,Te+e.x2*X,fe+e.y2*X]}}const[ae,oe,ue,ge]=se.box,he=w?se.allPointsOccluded:G.isOccluded;let ye=he;return ye||(ye=G.perspectiveRatio<this.perspectiveRatioCutoff),ye||(ye=!this.isInsideGrid(ae,oe,ue,ge)),ye||a!=="always"&&this.grid.hitTest(ae,oe,ue,ge,a,k)?{box:[ae,oe,ue,ge],placeable:!1,offscreen:!1,occluded:he}:{box:[ae,oe,ue,ge],placeable:!0,offscreen:this.isOffscreen(ae,oe,ue,ge),occluded:he}}placeCollisionCircles(e,a,c,f,y,w,A,P,k,O,F,j,G,X){const se=[],ae=new o.P(a.anchorX,a.anchorY),oe=this.getPerspectiveRatio(ae.x,ae.y,w,X),ue=(k?y*this.transform.getPitchedTextCorrection(a.anchorX,a.anchorY,w)/oe:y*oe)/o.aB,ge={getElevation:X,pitchedLabelPlaneMatrix:A,lineVertexArray:c,pitchWithMap:k,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:ae,unwrappedTileID:w,width:this.transform.width,height:this.transform.height,translation:G},he=Ps(ue,f,a.lineOffsetX*ue,a.lineOffsetY*ue,!1,a,!1,ge);let ye=!1,Te=!1,fe=!0;if(he){const Re=.5*F*oe+j,$e=new o.P(-100,-100),Ne=new o.P(this.screenRightBoundary,this.screenBottomBoundary),Fe=new Yi,Ze=he.first,mt=he.last;let _t=[];for(let hi=Ze.path.length-1;hi>=1;hi--)_t.push(Ze.path[hi]);for(let hi=1;hi<mt.path.length;hi++)_t.push(mt.path[hi]);const st=2.5*Re;if(k){const hi=this.projectPathToScreenSpace(_t,ge);_t=hi.some((Ri=>Ri.signedDistanceFromCamera<=0))?[]:hi.map((Ri=>Ri.point))}let Dt=[];if(_t.length>0){const hi=_t[0].clone(),Ri=_t[0].clone();for(let qi=1;qi<_t.length;qi++)hi.x=Math.min(hi.x,_t[qi].x),hi.y=Math.min(hi.y,_t[qi].y),Ri.x=Math.max(Ri.x,_t[qi].x),Ri.y=Math.max(Ri.y,_t[qi].y);Dt=hi.x>=$e.x&&Ri.x<=Ne.x&&hi.y>=$e.y&&Ri.y<=Ne.y?[_t]:Ri.x<$e.x||hi.x>Ne.x||Ri.y<$e.y||hi.y>Ne.y?[]:o.ay([_t],$e.x,$e.y,Ne.x,Ne.y)}for(const hi of Dt){Fe.reset(hi,.25*Re);let Ri=0;Ri=Fe.length<=.5*Re?1:Math.ceil(Fe.paddedLength/st)+1;for(let qi=0;qi<Ri;qi++){const Fi=qi/Math.max(Ri-1,1),bn=Fe.lerp(Fi),gn=bn.x+En,oi=bn.y+En;se.push(gn,oi,Re,0);const $i=gn-Re,Ln=oi-Re,Jn=gn+Re,ar=oi+Re;if(fe=fe&&this.isOffscreen($i,Ln,Jn,ar),Te=Te||this.isInsideGrid($i,Ln,Jn,ar),e!=="always"&&this.grid.hitTestCircle(gn,oi,Re,e,O)&&(ye=!0,!P))return{circles:[],offscreen:!1,collisionDetected:ye}}}}return{circles:!P&&ye||!Te||oe<this.perspectiveRatioCutoff?[]:se,offscreen:fe,collisionDetected:ye}}projectPathToScreenSpace(e,a){const c=(function(f,y){const w=o.L();return o.aq(w,y.pitchedLabelPlaneMatrix),f.map((A=>{const P=fn(A.x,A.y,w,y.getElevation),k=y.transform.projectTileCoordinates(P.point.x,P.point.y,y.unwrappedTileID,y.getElevation);return k.point.x=(.5*k.point.x+.5)*y.width,k.point.y=(.5*-k.point.y+.5)*y.height,k}))})(e,a);return(function(f){let y=0,w=0,A=0,P=0;for(let k=0;k<f.length;k++)f[k].isOccluded?(A=k+1,P=0):(P++,P>w&&(w=P,y=A));return f.slice(y,y+w)})(c)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const a=[],c=new o.a2;for(const F of e){const j=new o.P(F.x+En,F.y+En);c.extend(j),a.push(j)}const{minX:f,minY:y,maxX:w,maxY:A}=c,P=this.grid.query(f,y,w,A).concat(this.ignoredGrid.query(f,y,w,A)),k={},O={};for(const F of P){const j=F.key;if(k[j.bucketInstanceId]===void 0&&(k[j.bucketInstanceId]={}),k[j.bucketInstanceId][j.featureIndex])continue;const G=[new o.P(F.x1,F.y1),new o.P(F.x2,F.y1),new o.P(F.x2,F.y2),new o.P(F.x1,F.y2)];o.az(a,G)&&(k[j.bucketInstanceId][j.featureIndex]=!0,O[j.bucketInstanceId]===void 0&&(O[j.bucketInstanceId]=[]),O[j.bucketInstanceId].push(j.featureIndex))}return O}insertCollisionBox(e,a,c,f,y,w){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:y,collisionGroupID:w,overlapMode:a},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,a,c,f,y,w){const A=c?this.ignoredGrid:this.grid,P={bucketInstanceId:f,featureIndex:y,collisionGroupID:w,overlapMode:a};for(let k=0;k<e.length;k+=4)A.insertCircle(P,e[k],e[k+1],e[k+2])}projectAndGetPerspectiveRatio(e,a,c,f,y){if(y){let w;f?(w=[e,a,f(e,a),1],o.aw(w,w,y)):(w=[e,a,0,1],Uo(w,w,y));const A=w[3];return{x:(w[0]/A+1)/2*this.transform.width+En,y:(-w[1]/A+1)/2*this.transform.height+En,perspectiveRatio:.5+this.transform.cameraToCenterDistance/A*.5,isOccluded:!1,signedDistanceFromCamera:A}}{const w=this.transform.projectTileCoordinates(e,a,c,f);return{x:(w.point.x+1)/2*this.transform.width+En,y:(1-w.point.y)/2*this.transform.height+En,perspectiveRatio:.5+this.transform.cameraToCenterDistance/w.signedDistanceFromCamera*.5,isOccluded:w.isOccluded,signedDistanceFromCamera:w.signedDistanceFromCamera}}}getPerspectiveRatio(e,a,c,f){const y=this.transform.projectTileCoordinates(e,a,c,f);return .5+this.transform.cameraToCenterDistance/y.signedDistanceFromCamera*.5}isOffscreen(e,a,c,f){return c<En||e>=this.screenRightBoundary||f<En||a>this.screenBottomBoundary}isInsideGrid(e,a,c,f){return c>=0&&e<this.gridRightBoundary&&f>=0&&a<this.gridBottomBoundary}getViewportMatrix(){const e=o.ag([]);return o.M(e,e,[-100,-100,0]),e}_projectCollisionBox(e,a,c,f,y,w,A,P,k,O,F){let j=1,G=0,X=0,se=1;const ae=e.anchorPointX+A[0],oe=e.anchorPointY+A[1];if(w&&!y){const _t=this.projectAndGetPerspectiveRatio(ae+1,oe,f,k,F),st=_t.x-P.x,Dt=Math.atan((_t.y-P.y)/st)+(st<0?Math.PI:0),hi=Math.sin(Dt),Ri=Math.cos(Dt);j=Ri,G=hi,X=-hi,se=Ri}else if(!w&&y){const _t=ti(this.transform);j=_t.vecEast[0],G=_t.vecEast[1],X=_t.vecSouth[0],se=_t.vecSouth[1]}let ue=P.x,ge=P.y,he=a;y&&(ue=ae,ge=oe,he=Math.pow(2,-(this.transform.zoom-c.overscaledZ)),he*=this.transform.getPitchedTextCorrection(ae,oe,f),O||(he*=o.ah(.5+P.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),O&&(ue+=j*O.x*he+X*O.y*he,ge+=G*O.x*he+se*O.y*he);const ye=e.x1*he,Te=e.x2*he,fe=(ye+Te)/2,Re=e.y1*he,$e=e.y2*he,Ne=(Re+$e)/2,Fe=[{offsetX:ye,offsetY:Re},{offsetX:fe,offsetY:Re},{offsetX:Te,offsetY:Re},{offsetX:Te,offsetY:Ne},{offsetX:Te,offsetY:$e},{offsetX:fe,offsetY:$e},{offsetX:ye,offsetY:$e},{offsetX:ye,offsetY:Ne}];let Ze=[];for(const{offsetX:_t,offsetY:st}of Fe)Ze.push(new o.P(ue+j*_t+X*st,ge+G*_t+se*st));let mt=!1;if(y){const _t=Ze.map((st=>this.projectAndGetPerspectiveRatio(st.x,st.y,f,k,F)));mt=_t.some((st=>!st.isOccluded)),Ze=_t.map((st=>new o.P(st.x,st.y)))}else mt=!0;return{box:o.aA(Ze),allPointsOccluded:!mt}}}class pr{constructor(e,a,c,f){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?a:-a))):f&&c?1:0,this.placed=c}isHidden(){return this.opacity===0&&!this.placed}}class Ni{constructor(e,a,c,f,y){this.text=new pr(e?e.text:null,a,c,y),this.icon=new pr(e?e.icon:null,a,f,y)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class hs{constructor(e,a,c){this.text=e,this.icon=a,this.skipFade=c}}class Vo{constructor(e,a,c,f,y){this.bucketInstanceId=e,this.featureIndex=a,this.sourceLayerIndex=c,this.bucketIndex=f,this.tileID=y}}class Iu{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const a=++this.maxGroupID;this.collisionGroups[e]={ID:a,predicate:c=>c.collisionGroupID===a}}return this.collisionGroups[e]}}function la(m,e,a,c,f){const{horizontalAlign:y,verticalAlign:w}=o.aH(m);return new o.P(-(y-.5)*e+c[0]*f,-(w-.5)*a+c[1]*f)}class ds{constructor(e,a,c,f,y){this.transform=e.clone(),this.terrain=a,this.collisionIndex=new zu(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new Iu(f),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const a=this.terrain;return a?(c,f)=>a.getElevation(e,c,f):null}getBucketParts(e,a,c,f){const y=c.getBucket(a),w=c.latestFeatureIndex;if(!y||!w||a.id!==y.layerIds[0])return;const A=c.collisionBoxArray,P=y.layers[0].layout,k=y.layers[0].paint,O=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),F=c.tileSize/o.$,j=c.tileID.toUnwrapped(),G=P.get("text-rotation-alignment")==="map",X=o.aC(c,1,this.transform.zoom),se=o.aD(this.collisionIndex.transform,c,k.get("text-translate"),k.get("text-translate-anchor")),ae=o.aD(this.collisionIndex.transform,c,k.get("icon-translate"),k.get("icon-translate-anchor")),oe=en(G,this.transform,X);this.retainedQueryData[y.bucketInstanceId]=new Vo(y.bucketInstanceId,w,y.sourceLayerIndex,y.index,c.tileID);const ue={bucket:y,layout:P,translationText:se,translationIcon:ae,unwrappedTileID:j,pitchedLabelPlaneMatrix:oe,scale:O,textPixelRatio:F,holdingForFade:c.holdingForFade(),collisionBoxArray:A,partiallyEvaluatedTextSize:o.an(y.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(y.sourceID)};if(f)for(const ge of y.sortKeyRanges){const{sortKey:he,symbolInstanceStart:ye,symbolInstanceEnd:Te}=ge;e.push({sortKey:he,symbolInstanceStart:ye,symbolInstanceEnd:Te,parameters:ue})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:y.symbolInstances.length,parameters:ue})}attemptAnchorPlacement(e,a,c,f,y,w,A,P,k,O,F,j,G,X,se,ae,oe,ue,ge,he){const ye=o.aE[e.textAnchor],Te=[e.textOffset0,e.textOffset1],fe=la(ye,c,f,Te,y),Re=this.collisionIndex.placeCollisionBox(a,j,P,k,O,A,w,ae,F.predicate,ge,fe,he);if((!ue||this.collisionIndex.placeCollisionBox(ue,j,P,k,O,A,w,oe,F.predicate,ge,fe,he).placeable)&&Re.placeable){let $e;if(this.prevPlacement&&this.prevPlacement.variableOffsets[G.crossTileID]&&this.prevPlacement.placements[G.crossTileID]&&this.prevPlacement.placements[G.crossTileID].text&&($e=this.prevPlacement.variableOffsets[G.crossTileID].anchor),G.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[G.crossTileID]={textOffset:Te,width:c,height:f,anchor:ye,textBoxScale:y,prevAnchor:$e},this.markUsedJustification(X,ye,G,se),X.allowVerticalPlacement&&(this.markUsedOrientation(X,se,G),this.placedOrientations[G.crossTileID]=se),{shift:fe,placedGlyphBoxes:Re}}}placeLayerBucketPart(e,a,c){const{bucket:f,layout:y,translationText:w,translationIcon:A,unwrappedTileID:P,pitchedLabelPlaneMatrix:k,textPixelRatio:O,holdingForFade:F,collisionBoxArray:j,partiallyEvaluatedTextSize:G,collisionGroup:X}=e.parameters,se=y.get("text-optional"),ae=y.get("icon-optional"),oe=o.aF(y,"text-overlap","text-allow-overlap"),ue=oe==="always",ge=o.aF(y,"icon-overlap","icon-allow-overlap"),he=ge==="always",ye=y.get("text-rotation-alignment")==="map",Te=y.get("text-pitch-alignment")==="map",fe=y.get("icon-text-fit")!=="none",Re=y.get("symbol-z-order")==="viewport-y",$e=ue&&(he||!f.hasIconData()||ae),Ne=he&&(ue||!f.hasTextData()||se);!f.collisionArrays&&j&&f.deserializeCollisionBoxes(j);const Fe=this.retainedQueryData[f.bucketInstanceId].tileID,Ze=this._getTerrainElevationFunc(Fe),mt=this.transform.getFastPathSimpleProjectionMatrix(Fe),_t=(st,Dt,hi)=>{var Ri,qi;if(a[st.crossTileID])return;if(F)return void(this.placements[st.crossTileID]=new hs(!1,!1,!1));let Fi=!1,bn=!1,gn=!0,oi=null,$i={box:null,placeable:!1,offscreen:null,occluded:!1},Ln={placeable:!1},Jn=null,ar=null,Xr=null,Ja=0,$s=0,Ia=0;Dt.textFeatureIndex?Ja=Dt.textFeatureIndex:st.useRuntimeCollisionCircles&&(Ja=st.featureIndex),Dt.verticalTextFeatureIndex&&($s=Dt.verticalTextFeatureIndex);const So=Dt.textBox;if(So){const xr=_n=>{let An=o.ao.horizontal;if(f.allowVerticalPlacement&&!_n&&this.prevPlacement){const Yr=this.prevPlacement.placedOrientations[st.crossTileID];Yr&&(this.placedOrientations[st.crossTileID]=Yr,An=Yr,this.markUsedOrientation(f,An,st))}return An},Da=(_n,An)=>{if(f.allowVerticalPlacement&&st.numVerticalGlyphVertices>0&&Dt.verticalTextBox){for(const Yr of f.writingModes)if(Yr===o.ao.vertical?($i=An(),Ln=$i):$i=_n(),$i&&$i.placeable)break}else $i=_n()},jr=st.textAnchorOffsetStartIndex,Eo=st.textAnchorOffsetEndIndex;if(Eo===jr){const _n=(An,Yr)=>{const wn=this.collisionIndex.placeCollisionBox(An,oe,O,Fe,P,Te,ye,w,X.predicate,Ze,void 0,mt);return wn&&wn.placeable&&(this.markUsedOrientation(f,Yr,st),this.placedOrientations[st.crossTileID]=Yr),wn};Da((()=>_n(So,o.ao.horizontal)),(()=>{const An=Dt.verticalTextBox;return f.allowVerticalPlacement&&st.numVerticalGlyphVertices>0&&An?_n(An,o.ao.vertical):{box:null,offscreen:null}})),xr($i&&$i.placeable)}else{let _n=o.aE[(qi=(Ri=this.prevPlacement)===null||Ri===void 0?void 0:Ri.variableOffsets[st.crossTileID])===null||qi===void 0?void 0:qi.anchor];const An=(wn,Mo,ml)=>{const ws=wn.x2-wn.x1,Fr=wn.y2-wn.y1,Xs=st.textBoxScale,_a=fe&&ge==="never"?Mo:null;let On=null,Ys=oe==="never"?1:2,Ku="never";_n&&Ys++;for(let es=0;es<Ys;es++){for(let ka=jr;ka<Eo;ka++){const ln=f.textAnchorOffsets.get(ka);if(_n&&ln.textAnchor!==_n)continue;const La=this.attemptAnchorPlacement(ln,wn,ws,Fr,Xs,ye,Te,O,Fe,P,X,Ku,st,f,ml,w,A,_a,Ze);if(La&&(On=La.placedGlyphBoxes,On&&On.placeable))return Fi=!0,oi=La.shift,On}_n?_n=null:Ku=oe}return c&&!On&&(On={box:this.collisionIndex.placeCollisionBox(So,"always",O,Fe,P,Te,ye,w,X.predicate,Ze,void 0,mt).box,offscreen:!1,placeable:!1,occluded:!1}),On};Da((()=>An(So,Dt.iconBox,o.ao.horizontal)),(()=>{const wn=Dt.verticalTextBox;return f.allowVerticalPlacement&&(!$i||!$i.placeable)&&st.numVerticalGlyphVertices>0&&wn?An(wn,Dt.verticalIconBox,o.ao.vertical):{box:null,occluded:!0,offscreen:null}})),$i&&(Fi=$i.placeable,gn=$i.offscreen);const Yr=xr($i&&$i.placeable);if(!Fi&&this.prevPlacement){const wn=this.prevPlacement.variableOffsets[st.crossTileID];wn&&(this.variableOffsets[st.crossTileID]=wn,this.markUsedJustification(f,wn.anchor,st,Yr))}}}if(Jn=$i,Fi=Jn&&Jn.placeable,gn=Jn&&Jn.offscreen,st.useRuntimeCollisionCircles){const xr=f.text.placedSymbolArray.get(st.centerJustifiedTextSymbolIndex),Da=o.ap(f.textSizeData,G,xr),jr=y.get("text-padding");ar=this.collisionIndex.placeCollisionCircles(oe,xr,f.lineVertexArray,f.glyphOffsetArray,Da,P,k,c,Te,X.predicate,st.collisionCircleDiameter,jr,w,Ze),ar.circles.length&&ar.collisionDetected&&!c&&o.w("Collisions detected, but collision boxes are not shown"),Fi=ue||ar.circles.length>0&&!ar.collisionDetected,gn=gn&&ar.offscreen}if(Dt.iconFeatureIndex&&(Ia=Dt.iconFeatureIndex),Dt.iconBox){const xr=Da=>this.collisionIndex.placeCollisionBox(Da,ge,O,Fe,P,Te,ye,A,X.predicate,Ze,fe&&oi?oi:void 0,mt);Ln&&Ln.placeable&&Dt.verticalIconBox?(Xr=xr(Dt.verticalIconBox),bn=Xr.placeable):(Xr=xr(Dt.iconBox),bn=Xr.placeable),gn=gn&&Xr.offscreen}const Hs=se||st.numHorizontalGlyphVertices===0&&st.numVerticalGlyphVertices===0,To=ae||st.numIconVertices===0;Hs||To?To?Hs||(bn=bn&&Fi):Fi=bn&&Fi:bn=Fi=bn&&Fi;const Co=bn&&Xr.placeable;if(Fi&&Jn.placeable&&this.collisionIndex.insertCollisionBox(Jn.box,oe,y.get("text-ignore-placement"),f.bucketInstanceId,Ln&&Ln.placeable&&$s?$s:Ja,X.ID),Co&&this.collisionIndex.insertCollisionBox(Xr.box,ge,y.get("icon-ignore-placement"),f.bucketInstanceId,Ia,X.ID),ar&&Fi&&this.collisionIndex.insertCollisionCircles(ar.circles,oe,y.get("text-ignore-placement"),f.bucketInstanceId,Ja,X.ID),c&&this.storeCollisionData(f.bucketInstanceId,hi,Dt,Jn,Xr,ar),st.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(f.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[st.crossTileID]=new hs((Fi||$e)&&!(Jn!=null&&Jn.occluded),(bn||Ne)&&!(Xr!=null&&Xr.occluded),gn||f.justReloaded),a[st.crossTileID]=!0};if(Re){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const st=f.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Dt=st.length-1;Dt>=0;--Dt){const hi=st[Dt];_t(f.symbolInstances.get(hi),f.collisionArrays[hi],hi)}}else for(let st=e.symbolInstanceStart;st<e.symbolInstanceEnd;st++)_t(f.symbolInstances.get(st),f.collisionArrays[st],st);f.justReloaded=!1}storeCollisionData(e,a,c,f,y,w){if(c.textBox||c.iconBox){let A,P;this.collisionBoxArrays.has(e)?A=this.collisionBoxArrays.get(e):(A=new Map,this.collisionBoxArrays.set(e,A)),A.has(a)?P=A.get(a):(P={text:null,icon:null},A.set(a,P)),c.textBox&&(P.text=f.box),c.iconBox&&(P.icon=y.box)}if(w){let A=this.collisionCircleArrays[e];A===void 0&&(A=this.collisionCircleArrays[e]=[]);for(let P=0;P<w.circles.length;P+=4)A.push(w.circles[P+0]-En),A.push(w.circles[P+1]-En),A.push(w.circles[P+2]),A.push(w.collisionDetected?1:0)}}markUsedJustification(e,a,c,f){let y;y=f===o.ao.vertical?c.verticalPlacedTextSymbolIndex:{left:c.leftJustifiedTextSymbolIndex,center:c.centerJustifiedTextSymbolIndex,right:c.rightJustifiedTextSymbolIndex}[o.aG(a)];const w=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex,c.verticalPlacedTextSymbolIndex];for(const A of w)A>=0&&(e.text.placedSymbolArray.get(A).crossTileID=y>=0&&A!==y?0:c.crossTileID)}markUsedOrientation(e,a,c){const f=a===o.ao.horizontal||a===o.ao.horizontalOnly?a:0,y=a===o.ao.vertical?a:0,w=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex];for(const A of w)e.text.placedSymbolArray.get(A).placedOrientation=f;c.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).placedOrientation=y)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const a=this.prevPlacement;let c=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;const f=a?a.symbolFadeChange(e):1,y=a?a.opacities:{},w=a?a.variableOffsets:{},A=a?a.placedOrientations:{};for(const P in this.placements){const k=this.placements[P],O=y[P];O?(this.opacities[P]=new Ni(O,f,k.text,k.icon),c=c||k.text!==O.text.placed||k.icon!==O.icon.placed):(this.opacities[P]=new Ni(null,f,k.text,k.icon,k.skipFade),c=c||k.text||k.icon)}for(const P in y){const k=y[P];if(!this.opacities[P]){const O=new Ni(k,f,!1,!1);O.isHidden()||(this.opacities[P]=O,c=c||k.text.placed||k.icon.placed)}}for(const P in w)this.variableOffsets[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.variableOffsets[P]=w[P]);for(const P in A)this.placedOrientations[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.placedOrientations[P]=A[P]);if(a&&a.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");c?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:e)}updateLayerOpacities(e,a){const c={};for(const f of a){const y=f.getBucket(e);y&&f.latestFeatureIndex&&e.id===y.layerIds[0]&&this.updateBucketOpacities(y,f.tileID,c,f.collisionBoxArray)}}updateBucketOpacities(e,a,c,f){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const y=e.layers[0],w=y.layout,A=new Ni(null,0,!1,!1,!0),P=w.get("text-allow-overlap"),k=w.get("icon-allow-overlap"),O=y._unevaluatedLayout.hasValue("text-variable-anchor")||y._unevaluatedLayout.hasValue("text-variable-anchor-offset"),F=w.get("text-rotation-alignment")==="map",j=w.get("text-pitch-alignment")==="map",G=w.get("icon-text-fit")!=="none",X=new Ni(null,0,P&&(k||!e.hasIconData()||w.get("icon-optional")),k&&(P||!e.hasTextData()||w.get("text-optional")),!0);!e.collisionArrays&&f&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(f);const se=(oe,ue,ge)=>{for(let he=0;he<ue/4;he++)oe.opacityVertexArray.emplaceBack(ge);oe.hasVisibleVertices=oe.hasVisibleVertices||ge!==zl},ae=this.collisionBoxArrays.get(e.bucketInstanceId);for(let oe=0;oe<e.symbolInstances.length;oe++){const ue=e.symbolInstances.get(oe),{numHorizontalGlyphVertices:ge,numVerticalGlyphVertices:he,crossTileID:ye}=ue;let Te=this.opacities[ye];c[ye]?Te=A:Te||(Te=X,this.opacities[ye]=Te),c[ye]=!0;const fe=ue.numIconVertices>0,Re=this.placedOrientations[ue.crossTileID],$e=Re===o.ao.vertical,Ne=Re===o.ao.horizontal||Re===o.ao.horizontalOnly;if(ge>0||he>0){const Ze=Rl(Te.text);se(e.text,ge,$e?zl:Ze),se(e.text,he,Ne?zl:Ze);const mt=Te.text.isHidden();[ue.rightJustifiedTextSymbolIndex,ue.centerJustifiedTextSymbolIndex,ue.leftJustifiedTextSymbolIndex].forEach((Dt=>{Dt>=0&&(e.text.placedSymbolArray.get(Dt).hidden=mt||$e?1:0)})),ue.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(ue.verticalPlacedTextSymbolIndex).hidden=mt||Ne?1:0);const _t=this.variableOffsets[ue.crossTileID];_t&&this.markUsedJustification(e,_t.anchor,ue,Re);const st=this.placedOrientations[ue.crossTileID];st&&(this.markUsedJustification(e,"left",ue,st),this.markUsedOrientation(e,st,ue))}if(fe){const Ze=Rl(Te.icon),mt=!(G&&ue.verticalPlacedIconSymbolIndex&&$e);ue.placedIconSymbolIndex>=0&&(se(e.icon,ue.numIconVertices,mt?Ze:zl),e.icon.placedSymbolArray.get(ue.placedIconSymbolIndex).hidden=Te.icon.isHidden()),ue.verticalPlacedIconSymbolIndex>=0&&(se(e.icon,ue.numVerticalIconVertices,mt?zl:Ze),e.icon.placedSymbolArray.get(ue.verticalPlacedIconSymbolIndex).hidden=Te.icon.isHidden())}const Fe=ae&&ae.has(oe)?ae.get(oe):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const Ze=e.collisionArrays[oe];if(Ze){let mt=new o.P(0,0);if(Ze.textBox||Ze.verticalTextBox){let _t=!0;if(O){const st=this.variableOffsets[ye];st?(mt=la(st.anchor,st.width,st.height,st.textOffset,st.textBoxScale),F&&mt._rotate(j?-this.transform.bearingInRadians:this.transform.bearingInRadians)):_t=!1}if(Ze.textBox||Ze.verticalTextBox){let st;Ze.textBox&&(st=$e),Ze.verticalTextBox&&(st=Ne),Ac(e.textCollisionBox.collisionVertexArray,Te.text.placed,!_t||st,Fe.text,mt.x,mt.y)}}if(Ze.iconBox||Ze.verticalIconBox){const _t=!!(!Ne&&Ze.verticalIconBox);let st;Ze.iconBox&&(st=_t),Ze.verticalIconBox&&(st=!_t),Ac(e.iconCollisionBox.collisionVertexArray,Te.icon.placed,st,Fe.icon,G?mt.x:0,G?mt.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,a){const c=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*c>e}setStale(){this.stale=!0}}function Ac(m,e,a,c,f,y){c&&c.length!==0||(c=[0,0,0,0]);const w=c[0]-En,A=c[1]-En,P=c[2]-En,k=c[3]-En;m.emplaceBack(e?1:0,a?1:0,f||0,y||0,w,A),m.emplaceBack(e?1:0,a?1:0,f||0,y||0,P,A),m.emplaceBack(e?1:0,a?1:0,f||0,y||0,P,k),m.emplaceBack(e?1:0,a?1:0,f||0,y||0,w,k)}const Yd=Math.pow(2,25),Bh=Math.pow(2,24),mr=Math.pow(2,17),Nh=Math.pow(2,16),Sp=Math.pow(2,9),Du=Math.pow(2,8),Wd=Math.pow(2,1);function Rl(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;const e=m.placed?1:0,a=Math.floor(127*m.opacity);return a*Yd+e*Bh+a*mr+e*Nh+a*Sp+e*Du+a*Wd+e}const zl=0;class ia{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,a,c,f,y){const w=this._bucketParts;for(;this._currentTileIndex<e.length;)if(a.getBucketParts(w,f,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort(((A,P)=>A.sortKey-P.sortKey)));this._currentPartIndex<w.length;)if(a.placeLayerBucketPart(w[this._currentPartIndex],this._seenCrossTileIDs,c),this._currentPartIndex++,y())return!0;return!1}}class Pc{constructor(e,a,c,f,y,w,A,P){this.placement=new ds(e,a,w,A,P),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(e,a,c){const f=ee.now(),y=()=>!this._forceFullPlacement&&ee.now()-f>2;for(;this._currentPlacementIndex>=0;){const w=a[e[this._currentPlacementIndex]],A=this.placement.collisionIndex.transform.zoom;if(w.type==="symbol"&&(!w.minzoom||w.minzoom<=A)&&(!w.maxzoom||w.maxzoom>A)){if(this._inProgressLayer||(this._inProgressLayer=new ia(w)),this._inProgressLayer.continuePlacement(c[w.source],this.placement,this._showCollisionBoxes,w,y))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const Go=512/o.$/2;class Rc{constructor(e,a,c){this.tileID=e,this.bucketInstanceId=c,this._symbolsByKey={};const f=new Map;for(let y=0;y<a.length;y++){const w=a.get(y),A=w.key,P=f.get(A);P?P.push(w):f.set(A,[w])}for(const[y,w]of f){const A={positions:w.map((P=>({x:Math.floor(P.anchorX*Go),y:Math.floor(P.anchorY*Go)}))),crossTileIDs:w.map((P=>P.crossTileID))};if(A.positions.length>128){const P=new o.aI(A.positions.length,16,Uint16Array);for(const{x:k,y:O}of A.positions)P.add(k,O);P.finish(),delete A.positions,A.index=P}this._symbolsByKey[y]=A}}getScaledCoordinates(e,a){const{x:c,y:f,z:y}=this.tileID.canonical,{x:w,y:A,z:P}=a.canonical,k=Go/Math.pow(2,P-y),O=(A*o.$+e.anchorY)*k,F=f*o.$*Go;return{x:Math.floor((w*o.$+e.anchorX)*k-c*o.$*Go),y:Math.floor(O-F)}}findMatches(e,a,c){const f=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z);for(let y=0;y<e.length;y++){const w=e.get(y);if(w.crossTileID)continue;const A=this._symbolsByKey[w.key];if(!A)continue;const P=this.getScaledCoordinates(w,a);if(A.index){const k=A.index.range(P.x-f,P.y-f,P.x+f,P.y+f).sort();for(const O of k){const F=A.crossTileIDs[O];if(!c[F]){c[F]=!0,w.crossTileID=F;break}}}else if(A.positions)for(let k=0;k<A.positions.length;k++){const O=A.positions[k],F=A.crossTileIDs[k];if(Math.abs(O.x-P.x)<=f&&Math.abs(O.y-P.y)<=f&&!c[F]){c[F]=!0,w.crossTileID=F;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:e})=>e))}}class ro{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Kd{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const a=Math.round((e-this.lng)/360);if(a!==0)for(const c in this.indexes){const f=this.indexes[c],y={};for(const w in f){const A=f[w];A.tileID=A.tileID.unwrapTo(A.tileID.wrap+a),y[A.tileID.key]=A}this.indexes[c]=y}this.lng=e}addBucket(e,a,c){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let y=0;y<a.symbolInstances.length;y++)a.symbolInstances.get(y).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const f=this.usedCrossTileIDs[e.overscaledZ];for(const y in this.indexes){const w=this.indexes[y];if(Number(y)>e.overscaledZ)for(const A in w){const P=w[A];P.tileID.isChildOf(e)&&P.findMatches(a.symbolInstances,e,f)}else{const A=w[e.scaledTo(Number(y)).key];A&&A.findMatches(a.symbolInstances,e,f)}}for(let y=0;y<a.symbolInstances.length;y++){const w=a.symbolInstances.get(y);w.crossTileID||(w.crossTileID=c.generate(),f[w.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Rc(e,a.symbolInstances,a.bucketInstanceId),!0}removeBucketCrossTileIDs(e,a){for(const c of a.getCrossTileIDsLists())for(const f of c)delete this.usedCrossTileIDs[e][f]}removeStaleBuckets(e){let a=!1;for(const c in this.indexes){const f=this.indexes[c];for(const y in f)e[f[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,f[y]),delete f[y],a=!0)}return a}}class Zo{constructor(){this.layerIndexes={},this.crossTileIDs=new ro,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,a,c){let f=this.layerIndexes[e.id];f===void 0&&(f=this.layerIndexes[e.id]=new Kd);let y=!1;const w={};f.handleWrapJump(c);for(const A of a){const P=A.getBucket(e);P&&e.id===P.layerIds[0]&&(P.bucketInstanceId||(P.bucketInstanceId=++this.maxBucketInstanceId),f.addBucket(A.tileID,P,this.crossTileIDs)&&(y=!0),w[P.bucketInstanceId]=!0)}return f.removeStaleBuckets(w)&&(y=!0),y}pruneUnusedLayers(e){const a={};e.forEach((c=>{a[c]=!0}));for(const c in this.layerIndexes)a[c]||delete this.layerIndexes[c]}}var fs="void main() {fragColor=vec4(1.0);}";const qa={prelude:yi(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:yi("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:yi("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:yi(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:yi(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:yi(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:yi(fs,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:yi(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:yi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:yi("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:yi("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:yi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:yi("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:yi(fs,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:yi(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:yi(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:yi(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:yi(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:yi(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:yi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:yi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:yi(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:yi(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:yi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:yi(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:yi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:yi(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:yi(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:yi(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:yi(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:yi("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:yi("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:yi("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:yi("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:yi(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:yi("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function yi(m,e){const a=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=e.match(/in ([\w]+) ([\w]+)/g),f=m.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),y=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=y?y.concat(f):f,A={};return{fragmentSource:m=m.replace(a,((P,k,O,F,j)=>(A[j]=!0,k==="define"?`
#ifndef HAS_UNIFORM_u_${j}
in ${O} ${F} ${j};
#else
uniform ${O} ${F} u_${j};
#endif
`:`
#ifdef HAS_UNIFORM_u_${j}
    ${O} ${F} ${j} = u_${j};
#endif
`))),vertexSource:e=e.replace(a,((P,k,O,F,j)=>{const G=F==="float"?"vec2":"vec4",X=j.match(/color/)?"color":G;return A[j]?k==="define"?`
#ifndef HAS_UNIFORM_u_${j}
uniform lowp float u_${j}_t;
in ${O} ${G} a_${j};
out ${O} ${F} ${j};
#else
uniform ${O} ${F} u_${j};
#endif
`:X==="vec4"?`
#ifndef HAS_UNIFORM_u_${j}
    ${j} = a_${j};
#else
    ${O} ${F} ${j} = u_${j};
#endif
`:`
#ifndef HAS_UNIFORM_u_${j}
    ${j} = unpack_mix_${X}(a_${j}, u_${j}_t);
#else
    ${O} ${F} ${j} = u_${j};
#endif
`:k==="define"?`
#ifndef HAS_UNIFORM_u_${j}
uniform lowp float u_${j}_t;
in ${O} ${G} a_${j};
#else
uniform ${O} ${F} u_${j};
#endif
`:X==="vec4"?`
#ifndef HAS_UNIFORM_u_${j}
    ${O} ${F} ${j} = a_${j};
#else
    ${O} ${F} ${j} = u_${j};
#endif
`:`
#ifndef HAS_UNIFORM_u_${j}
    ${O} ${F} ${j} = unpack_mix_${X}(a_${j}, u_${j}_t);
#else
    ${O} ${F} ${j} = u_${j};
#endif
`})),staticAttributes:c,staticUniforms:w}}class ao{constructor(e,a,c){this.vertexBuffer=e,this.indexBuffer=a,this.segments=c}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var ps=o.aJ([{name:"a_pos",type:"Int16",components:2}]);const zs="#define PROJECTION_MERCATOR",qo="mercator";class pi{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return qo}get shaderDefine(){return zs}get shaderPreludeCode(){return qa.projectionMercator}get vertexShaderPreludeCode(){return qa.projectionMercator.vertexSource}get subdivisionGranularity(){return o.aK.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,a,c,f,y){if(this._cachedMesh)return this._cachedMesh;const w=new o.aL;w.emplaceBack(0,0),w.emplaceBack(o.$,0),w.emplaceBack(0,o.$),w.emplaceBack(o.$,o.$);const A=e.createVertexBuffer(w,ps.members),P=o.aM.simpleSegment(0,0,4,2),k=new o.aN;k.emplaceBack(1,0,2),k.emplaceBack(1,2,3);const O=e.createIndexBuffer(k);return this._cachedMesh=new ao(A,O,P),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}class Is{constructor(e=0,a=0,c=0,f=0){if(isNaN(e)||e<0||isNaN(a)||a<0||isNaN(c)||c<0||isNaN(f)||f<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=a,this.left=c,this.right=f}interpolate(e,a,c){return a.top!=null&&e.top!=null&&(this.top=o.C.number(e.top,a.top,c)),a.bottom!=null&&e.bottom!=null&&(this.bottom=o.C.number(e.bottom,a.bottom,c)),a.left!=null&&e.left!=null&&(this.left=o.C.number(e.left,a.left,c)),a.right!=null&&e.right!=null&&(this.right=o.C.number(e.right,a.right,c)),this}getCenter(e,a){const c=o.ah((this.left+e-this.right)/2,0,e),f=o.ah((this.top+a-this.bottom)/2,0,a);return new o.P(c,f)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new Is(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Il(m,e){if(!m.renderWorldCopies||m.lngRange)return;const a=e.lng-m.center.lng;e.lng+=a>180?-360:a<-180?360:0}function Ds(m){return Math.max(0,Math.floor(m))}class Kn{constructor(e,a,c,f,y,w){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=w===void 0||!!w,this._minZoom=a||0,this._maxZoom=c||22,this._minPitch=f??0,this._maxPitch=y??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new o.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Ds(this._zoom),this._scale=o.af(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Is,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,a,c){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=Ds(this._zoom),this._scale=o.af(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new Is(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!c&&e.autoCalculateNearFarZ,a&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const a=o.aO(e,-180,180)*Math.PI/180;var c,f,y,w,A,P,k,O,F;this._bearingInRadians!==a&&(this._unmodified=!1,this._bearingInRadians=a,this._calcMatrices(),this._rotationMatrix=N(),c=this._rotationMatrix,y=-this._bearingInRadians,w=(f=this._rotationMatrix)[0],A=f[1],P=f[2],k=f[3],O=Math.sin(y),F=Math.cos(y),c[0]=w*F+P*O,c[1]=A*F+k*O,c[2]=w*-O+P*F,c[3]=A*-O+k*F)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const a=o.ah(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==a&&(this._unmodified=!1,this._pitchInRadians=a,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const a=e/180*Math.PI;this._rollInRadians!==a&&(this._unmodified=!1,this._rollInRadians=a,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return o.aP(this._fovInRadians)}setFov(e){e=o.ah(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=o.ae(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const a=this.getConstrained(this._center,e).zoom;this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this._tileZoom=Math.max(0,Math.floor(a)),this._scale=o.af(a),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,a){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=a,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,a,c){this._unmodified=!1,this._edgeInsets.interpolate(e,a,c),this._constrain(),this._calcMatrices()}resize(e,a,c=!0){this._width=e,this._height=a,c&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Ti([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-o.ai,o.ai])}getConstrained(e,a){return this._callbacks.getConstrained(e,a)}getCameraQueryGeometry(e,a){if(a.length===1)return[a[0],e];{const{minX:c,minY:f,maxX:y,maxY:w}=o.a2.fromPoints(a).extend(e);return[new o.P(c,f),new o.P(y,f),new o.P(y,w),new o.P(c,w),new o.P(c,f)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:a,zoom:c}=this.getConstrained(this.center,this.zoom);this.setCenter(a),this.setZoom(c),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=o.ag(new Float64Array(16));o.N(e,e,[this._width/2,-this._height/2,1]),o.M(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=o.ag(new Float64Array(16)),o.N(e,e,[1,-1,1]),o.M(e,e,[-1,-1,0]),o.N(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,a,c,f){const y=c!==void 0?c:this.bearing,w=f=f!==void 0?f:this.pitch,A=o.a1.fromLngLat(e,a),P=-Math.cos(o.ae(w)),k=Math.sin(o.ae(w)),O=k*Math.sin(o.ae(y)),F=-k*Math.cos(o.ae(y));let j=this.elevation;const G=a-j;let X;P*G>=0||Math.abs(P)<.1?(X=1e4,j=a+X*P):X=-G/P;let se,ae,oe=o.aQ(1,A.y),ue=0;do{if(ue+=1,ue>10)break;ae=X/oe,se=new o.a1(A.x+O*ae,A.y+F*ae),oe=1/se.meterInMercatorCoordinateUnits()}while(Math.abs(X-ae*oe)>1e-12);return{center:se.toLngLat(),elevation:j,zoom:o.ak(this.height/2/Math.tan(this.fovInRadians/2)/ae/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const a=o.aj(1,this.center.lat)*this.worldSize,c=this.cameraToCenterDistance/a,f=o.a1.fromLngLat(this.center,this.elevation),y=je(this.center,this.elevation,this.pitch,this.bearing,c);this._elevation=e;const w=this.calculateCenterFromCameraLngLatAlt(y.toLngLat(),o.aQ(y.z,f.y),this.bearing,this.pitch);this._elevation=w.elevation,this._center=w.center,this.setZoom(w.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=o.aj(1,this.center.lat)*this.worldSize;return je(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const a=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/a,e.canonical.y/a,1/a/o.$,1/a/o.$]}}class nr{constructor(e,a){this.min=e,this.max=a,this.center=o.aR([],o.aS([],this.min,this.max),.5)}quadrant(e){const a=[e%2==0,e<2],c=o.aT(this.min),f=o.aT(this.max);for(let y=0;y<a.length;y++)c[y]=a[y]?this.min[y]:this.center[y],f[y]=a[y]?this.center[y]:this.max[y];return f[2]=this.max[2],new nr(c,f)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let a=!0;for(let c=0;c<e.planes.length;c++){const f=this.intersectsPlane(e.planes[c]);if(f===0)return 0;f===1&&(a=!1)}return a?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let a=e[3],c=e[3];for(let f=0;f<3;f++)e[f]>0?(a+=e[f]*this.min[f],c+=e[f]*this.max[f]):(c+=e[f]*this.min[f],a+=e[f]*this.max[f]);return a>=0?2:c<0?0:1}}class gr{distanceToTile2d(e,a,c,f){const y=f.distanceX([e,a]),w=f.distanceY([e,a]);return Math.hypot(y,w)}getWrap(e,a,c){return c}getTileBoundingVolume(e,a,c,f){var y,w;let A=0,P=0;if(f!=null&&f.terrain){const O=new o.Z(e.z,a,e.z,e.x,e.y),F=f.terrain.getMinMaxElevation(O);A=(y=F.minElevation)!==null&&y!==void 0?y:Math.min(0,c),P=(w=F.maxElevation)!==null&&w!==void 0?w:Math.max(0,c)}const k=1<<e.z;return new nr([a+e.x/k,e.y/k,A],[a+(e.x+1)/k,(e.y+1)/k,P])}allowVariableZoom(e,a){const c=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,f=o.ah(78.5-c/2,0,60);return!!a.terrain||e.pitch>f}allowWorldCopies(){return!0}prepareNextFrame(){}}class qn{constructor(e,a,c){this.points=e,this.planes=a,this.aabb=c}static fromInvProjectionMatrix(e,a=1,c=0,f,y){const w=y?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],A=Math.pow(2,c),P=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((j=>(function(G,X,se,ae){const oe=o.aw([],G,X),ue=1/oe[3]/se*ae;return o.aY(oe,oe,[ue,ue,1/oe[3],ue])})(j,e,a,A)));f&&(function(j,G,X,se){const ae=se?4:0,oe=se?0:4;let ue=0;const ge=[],he=[];for(let fe=0;fe<4;fe++){const Re=o.aU([],j[fe+oe],j[fe+ae]),$e=o.aZ(Re);o.aR(Re,Re,1/$e),ge.push($e),he.push(Re)}for(let fe=0;fe<4;fe++){const Re=o.a_(j[fe+ae],he[fe],X);ue=Re!==null&&Re>=0?Math.max(ue,Re):Math.max(ue,ge[fe])}const ye=(function(fe,Re){const $e=o.aU([],fe[Re[0]],fe[Re[1]]),Ne=o.aU([],fe[Re[2]],fe[Re[1]]),Fe=[0,0,0,0];return o.aV(Fe,o.aW([],$e,Ne)),Fe[3]=-o.aX(Fe,fe[Re[0]]),Fe})(j,G),Te=(function(fe,Re){const $e=o.a$(fe),Ne=o.b0([],fe,1/$e),Fe=o.aU([],Re,o.aR([],Ne,o.aX(Re,Ne))),Ze=o.a$(Fe);if(Ze>0){const mt=Math.sqrt(1-Ne[3]*Ne[3]),_t=o.aR([],Ne,-Ne[3]),st=o.aS([],_t,o.aR([],Fe,mt/Ze));return o.b1(Re,st)}return null})(X,ye);if(Te!==null){const fe=Te/o.aX(he[0],ye);ue=Math.min(ue,fe)}for(let fe=0;fe<4;fe++){const Re=Math.min(ue,ge[fe]);j[fe+oe]=[j[fe+ae][0]+he[fe][0]*Re,j[fe+ae][1]+he[fe][1]*Re,j[fe+ae][2]+he[fe][2]*Re,1]}})(P,w[0],f,y);const k=w.map((j=>{const G=o.aU([],P[j[0]],P[j[1]]),X=o.aU([],P[j[2]],P[j[1]]),se=o.aV([],o.aW([],G,X)),ae=-o.aX(se,P[j[1]]);return se.concat(ae)})),O=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],F=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const j of P)for(let G=0;G<3;G++)O[G]=Math.min(O[G],j[G]),F[G]=Math.max(F[G],j[G]);return new qn(P,k,new nr(O,F))}}class Li{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,a,c){return this._helper.interpolatePadding(e,a,c)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,a,c=!0){this._helper.resize(e,a,c)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,a){this._helper.overrideNearFarZ(e,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,a){}constructor(e,a,c,f,y){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new Kn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(w,A)=>this.getConstrained(w,A)},e,a,c,f,y),this._coveringTilesDetailsProvider=new gr}clone(){const e=new Li;return e.apply(this),e}apply(e,a,c){this._helper.apply(e,a,c)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const a=[new o.b2(0,e)];if(this._helper._renderWorldCopies){const c=this.screenPointToMercatorCoordinate(new o.P(0,0)),f=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,0)),y=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,this._helper._height)),w=this.screenPointToMercatorCoordinate(new o.P(0,this._helper._height)),A=Math.floor(Math.min(c.x,f.x,y.x,w.x)),P=Math.floor(Math.max(c.x,f.x,y.x,w.x)),k=1;for(let O=A-k;O<=P+k;O++)O!==0&&a.push(new o.b2(O,e))}return a}getCameraFrustum(){return qn.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const a=this.screenPointToLocation(this.centerPoint,e),c=e?e.getElevationForLngLatZoom(a,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(c)}setLocationAtPoint(e,a){const c=o.aj(this.elevation,this.center.lat),f=this.screenPointToMercatorCoordinateAtZ(a,c),y=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,c),w=o.a1.fromLngLat(e),A=new o.a1(w.x-(f.x-y.x),w.y-(f.y-y.y));this.setCenter(A==null?void 0:A.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,a){return a?this.coordinatePoint(o.a1.fromLngLat(e),a.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(o.a1.fromLngLat(e))}screenPointToLocation(e,a){var c;return(c=this.screenPointToMercatorCoordinate(e,a))===null||c===void 0?void 0:c.toLngLat()}screenPointToMercatorCoordinate(e,a){if(a){const c=a.pointCoordinate(e);if(c!=null)return c}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,a){const c=a||0,f=[e.x,e.y,0,1],y=[e.x,e.y,1,1];o.aw(f,f,this._pixelMatrixInverse),o.aw(y,y,this._pixelMatrixInverse);const w=f[3],A=y[3],P=f[1]/w,k=y[1]/A,O=f[2]/w,F=y[2]/A,j=O===F?0:(c-O)/(F-O);return new o.a1(o.C.number(f[0]/w,y[0]/A,j)/this.worldSize,o.C.number(P,k,j)/this.worldSize,c)}coordinatePoint(e,a=0,c=this._pixelMatrix){const f=[e.x*this.worldSize,e.y*this.worldSize,a,1];return o.aw(f,f,c),new o.P(f[0]/f[3],f[1]/f[3])}getBounds(){const e=Math.max(0,this._helper._height/2-we(this));return new Ti().extend(this.screenPointToLocation(new o.P(0,e))).extend(this.screenPointToLocation(new o.P(this._helper._width,e))).extend(this.screenPointToLocation(new o.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new o.P(0,this._helper._height)))}isPointOnMapSurface(e,a){return a?a.pointCoordinate(e)!=null:e.y>this.height/2-we(this)}calculatePosMatrix(e,a=!1,c){var f;const y=(f=e.key)!==null&&f!==void 0?f:o.b3(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),w=a?this._alignedPosMatrixCache:this._posMatrixCache;if(w.has(y)){const k=w.get(y);return c?k.f32:k.f64}const A=Pe(e,this.worldSize);o.O(A,a?this._alignedProjMatrix:this._viewProjMatrix,A);const P={f64:A,f32:new Float32Array(A)};return w.set(y,P),c?P.f32:P.f64}calculateFogMatrix(e){const a=e.key,c=this._fogMatrixCacheF32;if(c.has(a))return c.get(a);const f=Pe(e,this.worldSize);return o.O(f,this._fogMatrix,f),c.set(a,new Float32Array(f)),c.get(a)}getConstrained(e,a){a=o.ah(+a,this.minZoom,this.maxZoom);const c={center:new o.S(e.lng,e.lat),zoom:a};let f=this._helper._lngRange;if(!this._helper._renderWorldCopies&&f===null){const ge=179.9999999999;f=[-ge,ge]}const y=this.tileSize*o.af(c.zoom);let w=0,A=y,P=0,k=y,O=0,F=0;const{x:j,y:G}=this.size;if(this._helper._latRange){const ge=this._helper._latRange;w=o.U(ge[1])*y,A=o.U(ge[0])*y,A-w<G&&(O=G/(A-w))}f&&(P=o.aO(o.V(f[0])*y,0,y),k=o.aO(o.V(f[1])*y,0,y),k<P&&(k+=y),k-P<j&&(F=j/(k-P)));const{x:X,y:se}=re(y,e);let ae,oe;const ue=Math.max(F||0,O||0);if(ue){const ge=new o.P(F?(k+P)/2:X,O?(A+w)/2:se);return c.center=de(y,ge).wrap(),c.zoom+=o.ak(ue),c}if(this._helper._latRange){const ge=G/2;se-ge<w&&(oe=w+ge),se+ge>A&&(oe=A-ge)}if(f){const ge=(P+k)/2;let he=X;this._helper._renderWorldCopies&&(he=o.aO(X,ge-y/2,ge+y/2));const ye=j/2;he-ye<P&&(ae=P+ye),he+ye>k&&(ae=k-ye)}if(ae!==void 0||oe!==void 0){const ge=new o.P(ae??X,oe??se);c.center=de(y,ge).wrap()}return c}calculateCenterFromCameraLngLatAlt(e,a,c,f){return this._helper.calculateCenterFromCameraLngLatAlt(e,a,c,f)}_calculateNearFarZIfNeeded(e,a,c){if(!this._helper.autoCalculateNearFarZ)return;const f=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),y=e-f*this._helper._pixelPerMeter/Math.cos(a),w=f<0?y:e,A=Math.PI/2+this.pitchInRadians,P=o.ae(this.fov)*(Math.abs(Math.cos(o.ae(this.roll)))*this.height+Math.abs(Math.sin(o.ae(this.roll)))*this.width)/this.height*(.5+c.y/this.height),k=Math.sin(P)*w/Math.sin(o.ah(Math.PI-A-P,.01,Math.PI-.01)),O=we(this),F=Math.atan(O/this._helper.cameraToCenterDistance),j=o.ae(.75),G=F>j?2*F*(.5+c.y/(2*O)):j,X=Math.sin(G)*w/Math.sin(o.ah(Math.PI-A-G,.01,Math.PI-.01)),se=Math.min(k,X);this._helper._farZ=1.01*(Math.cos(Math.PI/2-a)*se+w),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,a=re(this.worldSize,this.center),c=a.x,f=a.y;this._helper._pixelPerMeter=o.aj(1,this.center.lat)*this.worldSize;const y=o.ae(Math.min(this.pitch,Q)),w=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(y));let A;this._calculateNearFarZIfNeeded(w,y,e),A=new Float64Array(16),o.b4(A,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),o.aq(this._invProjMatrix,A),A[8]=2*-e.x/this._helper._width,A[9]=2*e.y/this._helper._height,this._projectionMatrix=o.b5(A),o.N(A,A,[1,-1,1]),o.M(A,A,[0,0,-this._helper.cameraToCenterDistance]),o.b6(A,A,-this.rollInRadians),o.b7(A,A,this.pitchInRadians),o.b6(A,A,-this.bearingInRadians),o.M(A,A,[-c,-f,0]),this._mercatorMatrix=o.N([],A,[this.worldSize,this.worldSize,this.worldSize]),o.N(A,A,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=o.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,A),o.M(A,A,[0,0,-this.elevation]),this._viewProjMatrix=A,this._invViewProjMatrix=o.aq([],A);const P=[0,0,-1,1];o.aw(P,P,this._invViewProjMatrix),this._cameraPosition=[P[0]/P[3],P[1]/P[3],P[2]/P[3]],this._fogMatrix=new Float64Array(16),o.b4(this._fogMatrix,this.fovInRadians,this.width/this.height,w,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,o.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),o.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),o.b6(this._fogMatrix,this._fogMatrix,-this.rollInRadians),o.b7(this._fogMatrix,this._fogMatrix,this.pitchInRadians),o.b6(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),o.M(this._fogMatrix,this._fogMatrix,[-c,-f,0]),o.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),o.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=o.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,A);const k=this._helper._width%2/2,O=this._helper._height%2/2,F=Math.cos(this.bearingInRadians),j=Math.sin(-this.bearingInRadians),G=c-Math.round(c)+F*k+j*O,X=f-Math.round(f)+F*O+j*k,se=new Float64Array(A);if(o.M(se,se,[G>.5?G-1:G,X>.5?X-1:X,0]),this._alignedProjMatrix=se,A=o.aq(new Float64Array(16),this._pixelMatrix),!A)throw new Error("failed to invert matrix");this._pixelMatrixInverse=A,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new o.P(0,0)),a=[e.x*this.worldSize,e.y*this.worldSize,0,1];return o.aw(a,a,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=o.aj(1,this.center.lat)*this.worldSize;return je(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,a){const c=o.a1.fromLngLat(e),f=[c.x*this.worldSize,c.y*this.worldSize,a,1];return o.aw(f,f,this._viewProjMatrix),f[2]/f[3]}getProjectionData(e){const{overscaledTileID:a,aligned:c,applyTerrainMatrix:f}=e,y=this._helper.getMercatorTileCoordinates(a),w=a?this.calculatePosMatrix(a,c,!0):null;let A;return A=a&&a.terrainRttPosMatrix32f&&f?a.terrainRttPosMatrix32f:w||o.b8(),{mainMatrix:A,tileMercatorCoords:y,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:A}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,a,c){return 1}transformLightDirection(e){return o.aT(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,a,c,f){const y=this.calculatePosMatrix(c);let w;f?(w=[e,a,f(e,a),1],o.aw(w,w,y)):(w=[e,a,0,1],Uo(w,w,y));const A=w[3];return{point:new o.P(w[0]/A,w[1]/A),signedDistanceFromCamera:A,isOccluded:!1}}populateCache(e){for(const a of e)this.calculatePosMatrix(a)}getMatrixForModel(e,a){const c=o.a1.fromLngLat(e,a),f=c.meterInMercatorCoordinateUnits(),y=o.b9();return o.M(y,y,[c.x,c.y,c.z]),o.b6(y,y,Math.PI),o.b7(y,y,Math.PI/2),o.N(y,y,[-f,f,f]),y}getProjectionDataForCustomLayer(e=!0){const a=new o.Z(0,0,0,0,0),c=this.getProjectionData({overscaledTileID:a,applyGlobeMatrix:e}),f=Pe(a,this.worldSize);o.O(f,this._viewProjMatrix,f),c.tileMercatorCoords=[0,0,1,1];const y=[o.$,o.$,this.worldSize/this._helper.pixelsPerMeter],w=o.ba();return o.N(w,f,y),c.fallbackMatrix=w,c.mainMatrix=w,c}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function ms(){o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function _r(m){if(m.useSlerp)if(m.k<1){const e=o.bb(m.startEulerAngles.roll,m.startEulerAngles.pitch,m.startEulerAngles.bearing),a=o.bb(m.endEulerAngles.roll,m.endEulerAngles.pitch,m.endEulerAngles.bearing),c=new Float64Array(4);o.bc(c,e,a,m.k);const f=o.bd(c);m.tr.setRoll(f.roll),m.tr.setPitch(f.pitch),m.tr.setBearing(f.bearing)}else m.tr.setRoll(m.endEulerAngles.roll),m.tr.setPitch(m.endEulerAngles.pitch),m.tr.setBearing(m.endEulerAngles.bearing);else m.tr.setRoll(o.C.number(m.startEulerAngles.roll,m.endEulerAngles.roll,m.k)),m.tr.setPitch(o.C.number(m.startEulerAngles.pitch,m.endEulerAngles.pitch,m.k)),m.tr.setBearing(o.C.number(m.startEulerAngles.bearing,m.endEulerAngles.bearing,m.k))}function yr(m,e,a,c,f){const y=f.padding,w=re(f.worldSize,a.getNorthWest()),A=re(f.worldSize,a.getNorthEast()),P=re(f.worldSize,a.getSouthEast()),k=re(f.worldSize,a.getSouthWest()),O=o.ae(-c),F=w.rotate(O),j=A.rotate(O),G=P.rotate(O),X=k.rotate(O),se=new o.P(Math.max(F.x,j.x,X.x,G.x),Math.max(F.y,j.y,X.y,G.y)),ae=new o.P(Math.min(F.x,j.x,X.x,G.x),Math.min(F.y,j.y,X.y,G.y)),oe=se.sub(ae),ue=(f.width-(y.left+y.right+e.left+e.right))/oe.x,ge=(f.height-(y.top+y.bottom+e.top+e.bottom))/oe.y;if(ge<0||ue<0)return void ms();const he=Math.min(o.ak(f.scale*Math.min(ue,ge)),m.maxZoom),ye=o.P.convert(m.offset),Te=new o.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(o.ae(c)),fe=ye.add(Te).mult(f.scale/o.af(he));return{center:de(f.worldSize,w.add(P).div(2).sub(fe)),zoom:he,bearing:c}}class Mn{get useGlobeControls(){return!1}handlePanInertia(e,a){return{easingOffset:e,easingCenter:a.center}}handleMapControlsRollPitchBearingZoom(e,a){e.bearingDelta&&a.setBearing(a.bearing+e.bearingDelta),e.pitchDelta&&a.setPitch(a.pitch+e.pitchDelta),e.rollDelta&&a.setRoll(a.roll+e.rollDelta),e.zoomDelta&&a.setZoom(a.zoom+e.zoomDelta)}handleMapControlsPan(e,a,c){e.around.distSqr(a.centerPoint)<.01||a.setLocationAtPoint(c,e.around)}cameraForBoxAndBearing(e,a,c,f,y){return yr(e,a,c,f,y)}handleJumpToCenterZoom(e,a){e.zoom!==(a.zoom!==void 0?+a.zoom:e.zoom)&&e.setZoom(+a.zoom),a.center!==void 0&&e.setCenter(o.S.convert(a.center))}handleEaseTo(e,a){const c=e.zoom,f=e.padding,y={roll:e.roll,pitch:e.pitch,bearing:e.bearing},w={roll:a.roll===void 0?e.roll:a.roll,pitch:a.pitch===void 0?e.pitch:a.pitch,bearing:a.bearing===void 0?e.bearing:a.bearing},A=a.zoom!==void 0,P=!e.isPaddingEqual(a.padding);let k=!1;const O=A?+a.zoom:e.zoom;let F=e.centerPoint.add(a.offsetAsPoint);const j=e.screenPointToLocation(F),{center:G,zoom:X}=e.getConstrained(o.S.convert(a.center||j),O??c);Il(e,G);const se=re(e.worldSize,j),ae=re(e.worldSize,G).sub(se),oe=o.af(X-c);return k=X!==c,{easeFunc:ue=>{if(k&&e.setZoom(o.C.number(c,X,ue)),o.be(y,w)||_r({startEulerAngles:y,endEulerAngles:w,tr:e,k:ue,useSlerp:y.roll!=w.roll}),P&&(e.interpolatePadding(f,a.padding,ue),F=e.centerPoint.add(a.offsetAsPoint)),a.around)e.setLocationAtPoint(a.around,a.aroundPoint);else{const ge=o.af(e.zoom-c),he=X>c?Math.min(2,oe):Math.max(.5,oe),ye=Math.pow(he,1-ue),Te=de(e.worldSize,se.add(ae.mult(ue*ye)).mult(ge));e.setLocationAtPoint(e.renderWorldCopies?Te.wrap():Te,F)}},isZooming:k,elevationCenter:G}}handleFlyTo(e,a){const c=a.zoom!==void 0,f=e.zoom,y=e.getConstrained(o.S.convert(a.center||a.locationAtOffset),c?+a.zoom:f),w=y.center,A=y.zoom;Il(e,w);const P=re(e.worldSize,a.locationAtOffset),k=re(e.worldSize,w).sub(P),O=k.mag(),F=o.af(A-f);let j;if(a.minZoom!==void 0){const G=Math.min(+a.minZoom,f,A),X=e.getConstrained(w,G).zoom;j=o.af(X-f)}return{easeFunc:(G,X,se,ae)=>{e.setZoom(G===1?A:f+o.ak(X));const oe=G===1?w:de(e.worldSize,P.add(k.mult(se)).mult(X));e.setLocationAtPoint(e.renderWorldCopies?oe.wrap():oe,ae)},scaleOfZoom:F,targetCenter:w,scaleOfMinZoom:j,pixelPathLength:O}}}class tn{constructor(e,a,c){this.blendFunction=e,this.blendColor=a,this.mask=c}}tn.Replace=[1,0],tn.disabled=new tn(tn.Replace,o.bf.transparent,[!1,!1,!1,!1]),tn.unblended=new tn(tn.Replace,o.bf.transparent,[!0,!0,!0,!0]),tn.alphaBlended=new tn([1,771],o.bf.transparent,[!0,!0,!0,!0]);const gs=2305;class Yt{constructor(e,a,c){this.enable=e,this.mode=a,this.frontFace=c}}Yt.disabled=new Yt(!1,1029,gs),Yt.backCCW=new Yt(!0,1029,gs),Yt.frontCCW=new Yt(!0,1028,gs);class ii{constructor(e,a,c){this.func=e,this.mask=a,this.range=c}}ii.ReadOnly=!1,ii.ReadWrite=!0,ii.disabled=new ii(519,ii.ReadOnly,[0,1]);const Ca=7680;class Ci{constructor(e,a,c,f,y,w){this.test=e,this.ref=a,this.mask=c,this.fail=f,this.depthFail=y,this.pass=w}}Ci.disabled=new Ci({func:519,mask:0},0,0,Ca,Ca,Ca);const sn=new WeakMap;function Rr(m){var e;if(sn.has(m))return sn.get(m);{const a=(e=m.getParameter(m.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return sn.set(m,a),a}}class ca{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const a=e.context,c=a.gl;this._texFormat=c.RGBA,this._texType=c.UNSIGNED_BYTE;const f=new o.aL;f.emplaceBack(-1,-1),f.emplaceBack(2,-1),f.emplaceBack(-1,2);const y=new o.aN;y.emplaceBack(0,1,2),this._fullscreenTriangle=new ao(a.createVertexBuffer(f,ps.members),a.createIndexBuffer(y),o.aM.simpleSegment(0,0,f.length,y.length)),this._resultBuffer=new Uint8Array(4),a.activeTexture.set(c.TEXTURE1);const w=c.createTexture();c.bindTexture(c.TEXTURE_2D,w),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST),c.texImage2D(c.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=a.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(w),Rr(c)&&(this._pbo=c.createBuffer(),c.bindBuffer(c.PIXEL_PACK_BUFFER,this._pbo),c.bufferData(c.PIXEL_PACK_BUFFER,4,c.STREAM_READ),c.bindBuffer(c.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,a){const c=this._updateCount;return this._readbackQueue?c>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():c>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,a),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,a=e.gl;e.activeTexture.set(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,a){const c=this._cachedRenderContext.context,f=c.gl;if(this._bindFramebuffer(),c.viewport.set([0,0,this._texWidth,this._texHeight]),c.clear({color:o.bf.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(c,f.TRIANGLES,ii.disabled,Ci.disabled,tn.unblended,Yt.disabled,((y,w)=>({u_input:y,u_output_expected:w}))(e,a),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Rr(f)){f.bindBuffer(f.PIXEL_PACK_BUFFER,this._pbo),f.readBuffer(f.COLOR_ATTACHMENT0),f.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),f.bindBuffer(f.PIXEL_PACK_BUFFER,null);const y=f.fenceSync(f.SYNC_GPU_COMMANDS_COMPLETE,0);f.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:y}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Rr(e)){const a=e.clientWaitSync(this._readbackQueue.sync,0,0);if(a===e.WAIT_FAILED)return o.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(a===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=ca._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let a=0;return a+=e[0]/256,a+=e[1]/65536,a+=e[2]/16777216,e[3]<127&&(a=-a),a/128}}const so=o.$/128;function jh(m,e){const a=m.granularity!==void 0?Math.max(m.granularity,1):1,c=a+(m.generateBorders?2:0),f=a+(m.extendToNorthPole||m.generateBorders?1:0)+(m.extendToSouthPole||m.generateBorders?1:0),y=c+1,w=f+1,A=m.generateBorders?-1:0,P=m.generateBorders||m.extendToNorthPole?-1:0,k=a+(m.generateBorders?1:0),O=a+(m.generateBorders||m.extendToSouthPole?1:0),F=y*w,j=c*f*6,G=y*w>65536;if(G&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const X=G||e==="32bit",se=new Int16Array(2*F);let ae=0;for(let ge=P;ge<=O;ge++)for(let he=A;he<=k;he++){let ye=he/a*o.$;he===-1&&(ye=-so),he===a+1&&(ye=o.$+so);let Te=ge/a*o.$;ge===-1&&(Te=m.extendToNorthPole?o.bh:-so),ge===a+1&&(Te=m.extendToSouthPole?o.bi:o.$+so),se[ae++]=ye,se[ae++]=Te}const oe=X?new Uint32Array(j):new Uint16Array(j);let ue=0;for(let ge=0;ge<f;ge++)for(let he=0;he<c;he++){const ye=he+1+ge*y,Te=he+(ge+1)*y,fe=he+1+(ge+1)*y;oe[ue++]=he+ge*y,oe[ue++]=Te,oe[ue++]=ye,oe[ue++]=ye,oe[ue++]=Te,oe[ue++]=fe}return{vertices:se.buffer.slice(0),indices:oe.buffer.slice(0),uses32bitIndices:X}}const oo=new o.aK({fill:new o.bj(128,2),line:new o.bj(512,0),tile:new o.bj(128,32),stencil:new o.bj(128,1),circle:3});class $o{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return qa.projectionGlobe}get vertexShaderPreludeCode(){return qa.projectionMercator.vertexSource}get subdivisionGranularity(){return oo}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new ca(e));const a=o.U(this._errorQueryLatitudeDegrees),c=2*Math.atan(Math.exp(Math.PI-a*Math.PI*2))-.5*Math.PI,f=this._errorMeasurement.updateErrorLoop(a,c),y=ee.now();f!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=f,this._errorMeasurementLastChangeTime=y);const w=Math.min(Math.max((y-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=o.bk(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,o.bl(w))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,a,c,f,y){const w=(y==="stencil"?oo.stencil:oo.tile).getGranularityForZoomLevel(a.z);return this._getMesh(e,{granularity:w,generateBorders:c,extendToNorthPole:a.y===0&&f,extendToSouthPole:a.y===(1<<a.z)-1&&f})}_getMesh(e,a){const c=this._getMeshKey(a);if(c in this._tileMeshCache)return this._tileMeshCache[c];const f=(function(y,w){const A=jh(w,"16bit"),P=o.aL.deserialize({arrayBuffer:A.vertices,length:A.vertices.byteLength/2/2}),k=o.aN.deserialize({arrayBuffer:A.indices,length:A.indices.byteLength/2/3});return new ao(y.createVertexBuffer(P,ps.members),y.createIndexBuffer(k),o.aM.simpleSegment(0,0,P.length,k.length))})(e,a);return this._tileMeshCache[c]=f,f}recalculate(e){}hasTransition(){const e=ee.now();let a=!1;return a=a||(e-this._errorMeasurementLastChangeTime)/1e3<.7,a=a||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,a}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const lo=new o.r({type:new o.D(o.v.projection.type)});class Ho extends o.E{constructor(e){super(),this._transitionable=new o.t(lo),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.F(0)),this._mercatorProjection=new pi,this._verticalPerspectiveProjection=new $o}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof o.bm){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,a,c,f,y){return this.currentProjection.getMeshFromTileID(e,a,c,f,y)}setProjection(e){this._transitionable.setValue("type",(e==null?void 0:e.type)||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function zc(m){const e=Dl(m.worldSize,m.center.lat);return 2*Math.PI*e}function $a(m,e,a,c,f){const y=1/(1<<f),w=e/o.$*y+c*y,A=o.bo((m/o.$*y+a*y)*Math.PI*2+Math.PI,2*Math.PI),P=2*Math.atan(Math.exp(Math.PI-w*Math.PI*2))-.5*Math.PI,k=Math.cos(P),O=new Float64Array(3);return O[0]=Math.sin(A)*k,O[1]=Math.sin(P),O[2]=Math.cos(A)*k,O}function lr(m){return(function(e,a){const c=Math.cos(a),f=new Float64Array(3);return f[0]=Math.sin(e)*c,f[1]=Math.sin(a),f[2]=Math.cos(e)*c,f})(m.lng*Math.PI/180,m.lat*Math.PI/180)}function Dl(m,e){return m/(2*Math.PI)/Math.cos(e*Math.PI/180)}function Xo(m){const e=Math.asin(m[1])/Math.PI*180,a=Math.sqrt(m[0]*m[0]+m[2]*m[2]);if(a>1e-6){const c=m[0]/a,f=Math.acos(m[2]/a),y=(c>0?f:-f)/Math.PI*180;return new o.S(o.aO(y,-180,180),e)}return new o.S(0,e)}function Yo(m){return Math.cos(m*Math.PI/180)}function In(m,e){const a=Yo(m),c=Yo(e);return o.ak(c/a)}function Qd(m,e){const a=m.rotate(e.bearingInRadians),c=e.zoom+In(e.center.lat,0),f=o.bk(1/Yo(e.center.lat),1/Yo(Math.min(Math.abs(e.center.lat),60)),o.bn(c,7,3,0,1)),y=360/zc({worldSize:e.worldSize,center:{lat:e.center.lat}});return new o.S(e.center.lng-a.x*y*f,o.ah(e.center.lat+a.y*y,-o.ai,o.ai))}function Ic(m){const e=.5*m,a=Math.sin(e),c=Math.cos(e);return Math.log(a+c)-Math.log(c-a)}function Fh(m,e,a,c){const f=m.lat+a*c;if(Math.abs(a)>1){const y=(Math.sign(m.lat+a)!==Math.sign(m.lat)?-Math.abs(m.lat):Math.abs(m.lat))*Math.PI/180,w=Math.abs(m.lat+a)*Math.PI/180,A=Ic(y+c*(w-y)),P=Ic(y),k=Ic(w);return new o.S(m.lng+e*((A-P)/(k-P)),f)}return new o.S(m.lng+e*c,f)}class Jd{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=e}swapBuffers(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(e,a,c,f){const y=`${e.z}_${e.x}_${e.y}_${f!=null&&f.terrain?"t":""}`,w=this._cache.get(y);if(w)return w;const A=this._cachePrevious.get(y);if(A)return this._cache.set(y,A),A;const P=this._boundingVolumeFactory(e,a,c,f);return this._cache.set(y,P),this._hadAnyChanges=!0,P}}class kl{constructor(e,a,c,f){this.min=c,this.max=f,this.points=e,this.planes=a}static fromAabb(e,a){const c=[];for(let f=0;f<8;f++)c.push([1&~f?e[0]:a[0],(f>>1&1)==1?a[1]:e[1],(f>>2&1)==1?a[2]:e[2]]);return new kl(c,[[-1,0,0,a[0]],[1,0,0,-e[0]],[0,-1,0,a[1]],[0,1,0,-e[1]],[0,0,-1,a[2]],[0,0,1,-e[2]]],e,a)}static fromCenterSizeAngles(e,a,c){const f=o.br([],c[0],c[1],c[2]),y=o.bs([],[a[0],0,0],f),w=o.bs([],[0,a[1],0],f),A=o.bs([],[0,0,a[2]],f),P=[...e],k=[...e];for(let F=0;F<8;F++)for(let j=0;j<3;j++){const G=e[j]+y[j]*(1&~F?-1:1)+w[j]*((F>>1&1)==1?1:-1)+A[j]*((F>>2&1)==1?1:-1);P[j]=Math.min(P[j],G),k[j]=Math.max(k[j],G)}const O=[];for(let F=0;F<8;F++){const j=[...e];o.aS(j,j,o.aR([],y,1&~F?-1:1)),o.aS(j,j,o.aR([],w,(F>>1&1)==1?1:-1)),o.aS(j,j,o.aR([],A,(F>>2&1)==1?1:-1)),O.push(j)}return new kl(O,[[...y,-o.aX(y,O[0])],[...w,-o.aX(w,O[0])],[...A,-o.aX(A,O[0])],[-y[0],-y[1],-y[2],-o.aX(y,O[7])],[-w[0],-w[1],-w[2],-o.aX(w,O[7])],[-A[0],-A[1],-A[2],-o.aX(A,O[7])]],P,k)}intersectsFrustum(e){let a=!0;const c=this.points.length,f=this.planes.length,y=e.planes.length,w=e.points.length;for(let A=0;A<y;A++){const P=e.planes[A];let k=0;for(let O=0;O<c;O++){const F=this.points[O];P[0]*F[0]+P[1]*F[1]+P[2]*F[2]+P[3]>=0&&k++}if(k===0)return 0;k<c&&(a=!1)}if(a)return 2;for(let A=0;A<f;A++){const P=this.planes[A];let k=0;for(let O=0;O<w;O++){const F=e.points[O];P[0]*F[0]+P[1]*F[1]+P[2]*F[2]+P[3]>=0&&k++}if(k===0)return 0}return 1}intersectsPlane(e){const a=this.points.length;let c=0;for(let f=0;f<a;f++){const y=this.points[f];e[0]*y[0]+e[1]*y[1]+e[2]*y[2]+e[3]>=0&&c++}return c===a?2:c===0?0:1}}function vr(m,e,a){const c=m-e;return c<0?-c:Math.max(0,c-a)}function Dc(m,e,a,c,f){const y=m-a;let w;return w=y<0?Math.min(-y,1+y-f):y>1?Math.min(Math.max(y-f,0),1-y):0,Math.max(w,vr(e,c,f))}class _s{constructor(){this._boundingVolumeCache=new Jd(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(e,a,c,f){const y=1<<c.z,w=1/y,A=c.x/y,P=c.y/y;let k=2;return k=Math.min(k,Dc(e,a,A,P,w)),k=Math.min(k,Dc(e,a,A+.5,-P-w,w)),k=Math.min(k,Dc(e,a,A+.5,2-P-w,w)),k}getWrap(e,a,c){const f=1<<a.z,y=1/f,w=a.x/f,A=vr(e.x,w,y),P=vr(e.x,w-1,y),k=vr(e.x,w+1,y),O=Math.min(A,P,k);return O===k?1:O===P?-1:0}allowVariableZoom(e,a){return It(e,a)>4}allowWorldCopies(){return!1}getTileBoundingVolume(e,a,c,f){return this._boundingVolumeCache.getTileBoundingVolume(e,a,c,f)}_computeTileBoundingVolume(e,a,c,f){var y,w;let A=0,P=0;if(f!=null&&f.terrain){const k=new o.Z(e.z,a,e.z,e.x,e.y),O=f.terrain.getMinMaxElevation(k);A=(y=O.minElevation)!==null&&y!==void 0?y:Math.min(0,c),P=(w=O.maxElevation)!==null&&w!==void 0?w:Math.max(0,c)}if(A/=o.bu,P/=o.bu,A+=1,P+=1,e.z<=0)return kl.fromAabb([-P,-P,-P],[P,P,P]);if(e.z===1)return kl.fromAabb([e.x===0?-P:0,e.y===0?0:-P,-P],[e.x===0?0:P,e.y===0?P:0,P]);{const k=[$a(0,0,e.x,e.y,e.z),$a(o.$,0,e.x,e.y,e.z),$a(o.$,o.$,e.x,e.y,e.z),$a(0,o.$,e.x,e.y,e.z)],O=[];for(const Fe of k)O.push(o.aR([],Fe,P));if(P!==A)for(const Fe of k)O.push(o.aR([],Fe,A));e.y===0&&O.push([0,1,0]),e.y===(1<<e.z)-1&&O.push([0,-1,0]);const F=[1,1,1],j=[-1,-1,-1];for(const Fe of O)for(let Ze=0;Ze<3;Ze++)F[Ze]=Math.min(F[Ze],Fe[Ze]),j[Ze]=Math.max(j[Ze],Fe[Ze]);const G=$a(o.$/2,o.$/2,e.x,e.y,e.z),X=o.aW([],[0,1,0],G);o.aV(X,X);const se=o.aW([],G,X);o.aV(se,se);const ae=o.aW([],k[2],k[1]);o.aV(ae,ae);const oe=o.aW([],k[0],k[3]);o.aV(oe,oe),O.push(o.aR([],G,P)),e.y>=(1<<e.z)/2&&O.push(o.aR([],$a(o.$/2,0,e.x,e.y,e.z),P)),e.y<(1<<e.z)/2&&O.push(o.aR([],$a(o.$/2,o.$,e.x,e.y,e.z),P));const ue=Wo(G,O),ge=Wo(se,O),he=[-G[0],-G[1],-G[2],ue.max],ye=[G[0],G[1],G[2],-ue.min],Te=[-se[0],-se[1],-se[2],ge.max],fe=[se[0],se[1],se[2],-ge.min],Re=[...ae,0],$e=[...oe,0],Ne=[];return e.y===0?Ne.push(o.bt($e,Re,he),o.bt($e,Re,ye)):Ne.push(o.bt(Te,Re,he),o.bt(Te,Re,ye),o.bt(Te,$e,he),o.bt(Te,$e,ye)),e.y===(1<<e.z)-1?Ne.push(o.bt($e,Re,he),o.bt($e,Re,ye)):Ne.push(o.bt(fe,Re,he),o.bt(fe,Re,ye),o.bt(fe,$e,he),o.bt(fe,$e,ye)),new kl(Ne,[he,ye,Te,fe,Re,$e],F,j)}}}function Wo(m,e){let a=1/0,c=-1/0;for(const f of e){const y=o.aX(m,f);a=Math.min(a,y),c=Math.max(c,y)}return{min:a,max:c}}class kc{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,a,c){return this._helper.interpolatePadding(e,a,c)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,a){this._helper.resize(e,a)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,a){this._helper.overrideNearFarZ(e,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=o.bv(),this._projectionMatrix=o.b9(),this._globeViewProjMatrix32f=o.b8(),this._globeViewProjMatrixNoCorrection=o.b9(),this._globeViewProjMatrixNoCorrectionInverted=o.b9(),this._globeProjMatrixInverted=o.b9(),this._cameraPosition=o.bp(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new Kn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,a)=>this.getConstrained(e,a)}),this._coveringTilesDetailsProvider=new _s}clone(){const e=new kc;return e.apply(this),e}apply(e,a){this._globeLatitudeErrorCorrectionRadians=a||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=o.bp();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:a,applyGlobeMatrix:c}=e,f=this._helper.getMercatorTileCoordinates(a);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:f,clippingPlane:this._cachedClippingPlane,projectionTransition:c?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const a=this.pitchInRadians,c=this.cameraToCenterDistance/e,f=Math.sin(a)*c,y=Math.cos(a)*c+1,w=1/Math.sqrt(f*f+y*y)*1;let A=-f,P=y;const k=Math.sqrt(A*A+P*P);A/=k,P/=k;const O=[0,A,P];o.bw(O,O,[0,0,0],-this.bearingInRadians),o.bx(O,O,[0,0,0],-1*this.center.lat*Math.PI/180),o.by(O,O,[0,0,0],this.center.lng*Math.PI/180);const F=1/o.aZ(O);return o.aR(O,O,F),[...O,-w*F]}isLocationOccluded(e){return!this.isSurfacePointVisible(lr(e))}transformLightDirection(e){const a=this._helper._center.lng*Math.PI/180,c=this._helper._center.lat*Math.PI/180,f=Math.cos(c),y=[Math.sin(a)*f,Math.sin(c),Math.cos(a)*f],w=[y[2],0,-y[0]],A=[0,0,0];o.aW(A,w,y),o.aV(w,w),o.aV(A,A);const P=[0,0,0];return o.aV(P,[w[0]*e[0]+A[0]*e[1]+y[0]*e[2],w[1]*e[0]+A[1]*e[1]+y[1]*e[2],w[2]*e[0]+A[2]*e[1]+y[2]*e[2]]),P}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,a,c){const f=(function(A,P,k){const O=1/(1<<k.z);return new o.a1(A/o.$*O+k.x*O,P/o.$*O+k.y*O)})(e,a,c.canonical),y=(w=f.y,[o.bo(f.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-w*Math.PI*2))-.5*Math.PI]);var w;return this.getCircleRadiusCorrection()/Math.cos(y[1])}projectTileCoordinates(e,a,c,f){const y=c.canonical,w=$a(e,a,y.x,y.y,y.z),A=1+(f?f(e,a):0)/o.bu,P=[w[0]*A,w[1]*A,w[2]*A,1];o.aw(P,P,this._globeViewProjMatrixNoCorrection);const k=this._cachedClippingPlane,O=k[0]*w[0]+k[1]*w[1]+k[2]*w[2]+k[3]<0;return{point:new o.P(P[0]/P[3],P[1]/P[3]),signedDistanceFromCamera:P[3],isOccluded:O}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=Dl(this.worldSize,this.center.lat),a=o.ba(),c=o.ba();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),o.b4(a,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const f=this.centerOffset;a[8]=2*-f.x/this._helper._width,a[9]=2*f.y/this._helper._height,this._projectionMatrix=o.b5(a),this._globeProjMatrixInverted=o.ba(),o.aq(this._globeProjMatrixInverted,a),o.M(a,a,[0,0,-this.cameraToCenterDistance]),o.b6(a,a,this.rollInRadians),o.b7(a,a,-this.pitchInRadians),o.b6(a,a,this.bearingInRadians),o.M(a,a,[0,0,-e]);const y=o.bp();y[0]=e,y[1]=e,y[2]=e,o.b7(c,a,this.center.lat*Math.PI/180),o.bz(c,c,-this.center.lng*Math.PI/180),o.N(c,c,y),this._globeViewProjMatrixNoCorrection=c,o.b7(a,a,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),o.bz(a,a,-this.center.lng*Math.PI/180),o.N(a,a,y),this._globeViewProjMatrix32f=new Float32Array(a),this._globeViewProjMatrixNoCorrectionInverted=o.ba(),o.aq(this._globeViewProjMatrixNoCorrectionInverted,c);const w=o.bp();this._cameraPosition=o.bp(),this._cameraPosition[2]=this.cameraToCenterDistance/e,o.bw(this._cameraPosition,this._cameraPosition,w,-this.rollInRadians),o.bx(this._cameraPosition,this._cameraPosition,w,this.pitchInRadians),o.bw(this._cameraPosition,this._cameraPosition,w,-this.bearingInRadians),o.aS(this._cameraPosition,this._cameraPosition,[0,0,1]),o.bx(this._cameraPosition,this._cameraPosition,w,-this.center.lat*Math.PI/180),o.by(this._cameraPosition,this._cameraPosition,w,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const A=o.b5(this._globeViewProjMatrixNoCorrectionInverted);o.N(A,A,[1,1,-1]),this._cachedFrustum=qn.fromInvProjectionMatrix(A,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(e){o.w("calculateFogMatrix is not supported on globe projection.");const a=o.ba();return o.ag(a),a}getVisibleUnwrappedCoordinates(e){return[new o.b2(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&o.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,a){if(!this._globeViewProjMatrixNoCorrection)return 1;const c=lr(e);o.aR(c,c,1+a/o.bu);const f=o.bv();return o.aw(f,[c[0],c[1],c[2],1],this._globeViewProjMatrixNoCorrection),f[2]/f[3]}populateCache(e){}getBounds(){const e=.5*this.width,a=.5*this.height,c=[new o.P(0,0),new o.P(e,0),new o.P(this.width,0),new o.P(this.width,a),new o.P(this.width,this.height),new o.P(e,this.height),new o.P(0,this.height),new o.P(0,a)],f=[];for(const F of c)f.push(this.unprojectScreenPoint(F));let y=0,w=0,A=0,P=0;const k=this.center;for(const F of f){const j=o.bA(k.lng,F.lng),G=o.bA(k.lat,F.lat);j<w&&(w=j),j>y&&(y=j),G<P&&(P=G),G>A&&(A=G)}const O=[k.lng+w,k.lat+P,k.lng+y,k.lat+A];return this.isSurfacePointOnScreen([0,1,0])&&(O[3]=90,O[0]=-180,O[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(O[1]=-90,O[0]=-180,O[2]=180),new Ti(O)}getConstrained(e,a){const c=o.ah(e.lat,-o.ai,o.ai),f=o.ah(+a,this.minZoom+In(0,c),this.maxZoom);return{center:new o.S(e.lng,c),zoom:f}}calculateCenterFromCameraLngLatAlt(e,a,c,f){return this._helper.calculateCenterFromCameraLngLatAlt(e,a,c,f)}setLocationAtPoint(e,a){const c=lr(this.unprojectScreenPoint(a)),f=lr(e),y=o.bp();o.bB(y);const w=o.bp();o.by(w,c,y,-this.center.lng*Math.PI/180),o.bx(w,w,y,this.center.lat*Math.PI/180);const A=f[0]*f[0]+f[2]*f[2],P=w[0]*w[0];if(A<P)return;const k=Math.sqrt(A-P),O=-k,F=o.bC(f[0],f[2],w[0],k),j=o.bC(f[0],f[2],w[0],O),G=o.bp();o.by(G,f,y,-F);const X=o.bC(G[1],G[2],w[1],w[2]),se=o.bp();o.by(se,f,y,-j);const ae=o.bC(se[1],se[2],w[1],w[2]),oe=.5*Math.PI,ue=X>=-oe&&X<=oe,ge=ae>=-oe&&ae<=oe;let he,ye;if(ue&&ge){const $e=this.center.lng*Math.PI/180,Ne=this.center.lat*Math.PI/180;o.bD(F,$e)+o.bD(X,Ne)<o.bD(j,$e)+o.bD(ae,Ne)?(he=F,ye=X):(he=j,ye=ae)}else if(ue)he=F,ye=X;else{if(!ge)return;he=j,ye=ae}const Te=he/Math.PI*180,fe=ye/Math.PI*180,Re=this.center.lat;this.setCenter(new o.S(Te,o.ah(fe,-90,90))),this.setZoom(this.zoom+In(Re,this.center.lat))}locationToScreenPoint(e,a){const c=lr(e);if(a){const f=a.getElevationForLngLatZoom(e,this._helper._tileZoom);o.aR(c,c,1+f/o.bu)}return this._projectSurfacePointToScreen(c)}_projectSurfacePointToScreen(e){const a=o.bv();return o.aw(a,[...e,1],this._globeViewProjMatrixNoCorrection),a[0]/=a[3],a[1]/=a[3],new o.P((.5*a[0]+.5)*this.width,(.5*-a[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,a){if(a){const c=a.pointCoordinate(e);if(c)return c}return o.a1.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,a){var c;return(c=this.screenPointToMercatorCoordinate(e,a))===null||c===void 0?void 0:c.toLngLat()}isPointOnMapSurface(e,a){const c=this._cameraPosition,f=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(c,f)}getRayDirectionFromPixel(e){const a=o.bv();a[0]=e.x/this.width*2-1,a[1]=-1*(e.y/this.height*2-1),a[2]=1,a[3]=1,o.aw(a,a,this._globeViewProjMatrixNoCorrectionInverted),a[0]/=a[3],a[1]/=a[3],a[2]/=a[3];const c=o.bp();c[0]=a[0]-this._cameraPosition[0],c[1]=a[1]-this._cameraPosition[1],c[2]=a[2]-this._cameraPosition[2];const f=o.bp();return o.aV(f,c),f}isSurfacePointVisible(e){const a=this._cachedClippingPlane;return a[0]*e[0]+a[1]*e[1]+a[2]*e[2]+a[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const a=o.bv();return o.aw(a,[...e,1],this._globeViewProjMatrixNoCorrection),a[0]/=a[3],a[1]/=a[3],a[2]/=a[3],a[0]>-1&&a[0]<1&&a[1]>-1&&a[1]<1&&a[2]>-1&&a[2]<1}rayPlanetIntersection(e,a){const c=o.aX(e,a),f=o.bp(),y=o.bp();o.aR(y,a,c),o.aU(f,e,y);const w=1-o.aX(f,f);if(w<0)return null;const A=o.aX(e,e)-1,P=-c+(c<0?1:-1)*Math.sqrt(w),k=A/P,O=P;return{tMin:Math.min(k,O),tMax:Math.max(k,O)}}unprojectScreenPoint(e){const a=this._cameraPosition,c=this.getRayDirectionFromPixel(e),f=this.rayPlanetIntersection(a,c);if(f){const O=o.bp();o.aS(O,a,[c[0]*f.tMin,c[1]*f.tMin,c[2]*f.tMin]);const F=o.bp();return o.aV(F,O),Xo(F)}const y=this._cachedClippingPlane,w=y[0]*c[0]+y[1]*c[1]+y[2]*c[2],A=-o.b1(y,a)/w,P=o.bp();if(A>0)o.aS(P,a,[c[0]*A,c[1]*A,c[2]*A]);else{const O=o.bp();o.aS(O,a,[2*c[0],2*c[1],2*c[2]]);const F=o.b1(this._cachedClippingPlane,O);o.aU(P,O,[this._cachedClippingPlane[0]*F,this._cachedClippingPlane[1]*F,this._cachedClippingPlane[2]*F])}const k=(function(O){const F=o.bp();return F[0]=O[0]*-O[3],F[1]=O[1]*-O[3],F[2]=O[2]*-O[3],{center:F,radius:Math.sqrt(1-O[3]*O[3])}})(y);return Xo((function(O,F,j){const G=o.bp();o.aU(G,j,O);const X=o.bp();return o.bq(X,O,G,F/o.a$(G)),X})(k.center,k.radius,P))}getMatrixForModel(e,a){const c=o.S.convert(e),f=1/o.bu,y=o.b9();return o.bz(y,y,c.lng/180*Math.PI),o.b7(y,y,-c.lat/180*Math.PI),o.M(y,y,[0,0,1+a/o.bu]),o.b7(y,y,.5*Math.PI),o.N(y,y,[f,f,f]),y}getProjectionDataForCustomLayer(e=!0){const a=this.getProjectionData({overscaledTileID:new o.Z(0,0,0,0,0),applyGlobeMatrix:e});return a.tileMercatorCoords=[0,0,1,1],a}getFastPathSimpleProjectionMatrix(e){}}class Lc{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,a,c){return this._helper.interpolatePadding(e,a,c)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,a,c=!0){this._helper.resize(e,a,c)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,a){this._helper.overrideNearFarZ(e,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,a){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=a,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new Kn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,a)=>this.getConstrained(e,a)}),this._globeness=1,this._mercatorTransform=new Li,this._verticalPerspectiveTransform=new kc}clone(){const e=new Lc;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const a=this._mercatorTransform.getProjectionData(e),c=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?c.mainMatrix:a.mainMatrix,clippingPlane:c.clippingPlane,tileMercatorCoords:c.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:a.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return o.bk(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return o.bk(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,a,c){const f=this._mercatorTransform.getPitchedTextCorrection(e,a,c),y=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,a,c);return o.bk(f,y,this._globeness)}projectTileCoordinates(e,a,c,f){return this.currentTransform.projectTileCoordinates(e,a,c,f)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,a){return this.currentTransform.lngLatToCameraDepth(e,a)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,a){return this.currentTransform.getConstrained(e,a)}calculateCenterFromCameraLngLatAlt(e,a,c,f){return this._helper.calculateCenterFromCameraLngLatAlt(e,a,c,f)}setLocationAtPoint(e,a){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,a),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,a),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,a){return this.currentTransform.locationToScreenPoint(e,a)}screenPointToMercatorCoordinate(e,a){return this.currentTransform.screenPointToMercatorCoordinate(e,a)}screenPointToLocation(e,a){return this.currentTransform.screenPointToLocation(e,a)}isPointOnMapSurface(e,a){return this.currentTransform.isPointOnMapSurface(e,a)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,a){return this.currentTransform.getMatrixForModel(e,a)}getProjectionDataForCustomLayer(e=!0){const a=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return a;const c=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return c.fallbackMatrix=a.mainMatrix,c}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class zr{get useGlobeControls(){return!0}handlePanInertia(e,a){const c=Qd(e,a);return Math.abs(c.lng-a.center.lng)>180&&(c.lng=a.center.lng+179.5*Math.sign(c.lng-a.center.lng)),{easingCenter:c,easingOffset:new o.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,a){const c=e.around,f=a.screenPointToLocation(c);e.bearingDelta&&a.setBearing(a.bearing+e.bearingDelta),e.pitchDelta&&a.setPitch(a.pitch+e.pitchDelta),e.rollDelta&&a.setRoll(a.roll+e.rollDelta);const y=a.zoom;e.zoomDelta&&a.setZoom(a.zoom+e.zoomDelta);const w=a.zoom-y;if(w===0)return;const A=o.bA(a.center.lng,f.lng),P=A/(Math.abs(A/180)+1),k=o.bA(a.center.lat,f.lat),O=a.getRayDirectionFromPixel(c),F=a.cameraPosition,j=-1*o.aX(F,O),G=o.bp();o.aS(G,F,[O[0]*j,O[1]*j,O[2]*j]);const X=o.aZ(G)-1,se=Math.exp(.5*-Math.max(X-.3,0)),ae=Dl(a.worldSize,a.center.lat)/Math.min(a.width,a.height),oe=o.bn(ae,.9,.5,1,.25),ue=(1-o.af(-w))*Math.min(se,oe),ge=a.center.lat,he=a.zoom,ye=new o.S(a.center.lng+P*ue,o.ah(a.center.lat+k*ue,-o.ai,o.ai));a.setLocationAtPoint(f,c);const Te=a.center,fe=o.bn(Math.abs(A),45,85,0,1),Re=o.bn(ae,.75,.35,0,1),$e=Math.pow(Math.max(fe,Re),.25),Ne=o.bA(Te.lng,ye.lng),Fe=o.bA(Te.lat,ye.lat);a.setCenter(new o.S(Te.lng+Ne*$e,Te.lat+Fe*$e).wrap()),a.setZoom(he+In(ge,a.center.lat))}handleMapControlsPan(e,a,c){if(!e.panDelta)return;const f=a.center.lat,y=a.zoom;a.setCenter(Qd(e.panDelta,a).wrap()),a.setZoom(y+In(f,a.center.lat))}cameraForBoxAndBearing(e,a,c,f,y){const w=yr(e,a,c,f,y),A=a.left/y.width*2-1,P=(y.width-a.right)/y.width*2-1,k=a.top/y.height*-2+1,O=(y.height-a.bottom)/y.height*-2+1,F=o.bA(c.getWest(),c.getEast())<0,j=F?c.getEast():c.getWest(),G=F?c.getWest():c.getEast(),X=Math.max(c.getNorth(),c.getSouth()),se=Math.min(c.getNorth(),c.getSouth()),ae=j+.5*o.bA(j,G),oe=X+.5*o.bA(X,se),ue=y.clone();ue.setCenter(w.center),ue.setBearing(w.bearing),ue.setPitch(0),ue.setRoll(0),ue.setZoom(w.zoom);const ge=ue.modelViewProjectionMatrix,he=[lr(c.getNorthWest()),lr(c.getNorthEast()),lr(c.getSouthWest()),lr(c.getSouthEast()),lr(new o.S(G,oe)),lr(new o.S(j,oe)),lr(new o.S(ae,X)),lr(new o.S(ae,se))],ye=lr(w.center);let Te=Number.POSITIVE_INFINITY;for(const fe of he)A<0&&(Te=zr.getLesserNonNegativeNonNull(Te,zr.solveVectorScale(fe,ye,ge,"x",A))),P>0&&(Te=zr.getLesserNonNegativeNonNull(Te,zr.solveVectorScale(fe,ye,ge,"x",P))),k>0&&(Te=zr.getLesserNonNegativeNonNull(Te,zr.solveVectorScale(fe,ye,ge,"y",k))),O<0&&(Te=zr.getLesserNonNegativeNonNull(Te,zr.solveVectorScale(fe,ye,ge,"y",O)));if(Number.isFinite(Te)&&Te!==0)return w.zoom=ue.zoom+o.ak(Te),w;ms()}handleJumpToCenterZoom(e,a){const c=e.center.lat,f=e.getConstrained(a.center?o.S.convert(a.center):e.center,e.zoom).center;e.setCenter(f.wrap());const y=a.zoom!==void 0?+a.zoom:e.zoom+In(c,f.lat);e.zoom!==y&&e.setZoom(y)}handleEaseTo(e,a){const c=e.zoom,f=e.center,y=e.padding,w={roll:e.roll,pitch:e.pitch,bearing:e.bearing},A={roll:a.roll===void 0?e.roll:a.roll,pitch:a.pitch===void 0?e.pitch:a.pitch,bearing:a.bearing===void 0?e.bearing:a.bearing},P=a.zoom!==void 0,k=!e.isPaddingEqual(a.padding);let O=!1;const F=a.center?o.S.convert(a.center):f,j=e.getConstrained(F,c).center;Il(e,j);const G=e.clone();G.setCenter(j),G.setZoom(P?+a.zoom:c+In(f.lat,F.lat)),G.setBearing(a.bearing);const X=new o.P(o.ah(e.centerPoint.x+a.offsetAsPoint.x,0,e.width),o.ah(e.centerPoint.y+a.offsetAsPoint.y,0,e.height));G.setLocationAtPoint(j,X);const se=(a.offset&&a.offsetAsPoint.mag())>0?G.center:j,ae=P?+a.zoom:c+In(f.lat,se.lat),oe=c+In(f.lat,0),ue=ae+In(se.lat,0),ge=o.bA(f.lng,se.lng),he=o.bA(f.lat,se.lat),ye=o.af(ue-oe);return O=ae!==c,{easeFunc:Te=>{if(o.be(w,A)||_r({startEulerAngles:w,endEulerAngles:A,tr:e,k:Te,useSlerp:w.roll!=A.roll}),k&&e.interpolatePadding(y,a.padding,Te),a.around)o.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(a.around,a.aroundPoint);else{const fe=ue>oe?Math.min(2,ye):Math.max(.5,ye),Re=Math.pow(fe,1-Te),$e=Fh(f,ge,he,Te*Re);e.setCenter($e.wrap())}if(O){const fe=o.C.number(oe,ue,Te)+In(0,e.center.lat);e.setZoom(fe)}},isZooming:O,elevationCenter:se}}handleFlyTo(e,a){const c=a.zoom!==void 0,f=e.center,y=e.zoom,w=e.padding,A=!e.isPaddingEqual(a.padding),P=e.getConstrained(o.S.convert(a.center||a.locationAtOffset),y).center,k=c?+a.zoom:e.zoom+In(e.center.lat,P.lat),O=e.clone();O.setCenter(P),O.setZoom(k),O.setBearing(a.bearing);const F=new o.P(o.ah(e.centerPoint.x+a.offsetAsPoint.x,0,e.width),o.ah(e.centerPoint.y+a.offsetAsPoint.y,0,e.height));O.setLocationAtPoint(P,F);const j=O.center;Il(e,j);const G=(function(he,ye,Te){const fe=lr(ye),Re=lr(Te),$e=o.aX(fe,Re),Ne=Math.acos($e),Fe=zc(he);return Ne/(2*Math.PI)*Fe})(e,f,j),X=y+In(f.lat,0),se=k+In(j.lat,0),ae=o.af(se-X);let oe;if(typeof a.minZoom=="number"){const he=+a.minZoom+In(j.lat,0),ye=Math.min(he,X,se)+In(0,j.lat),Te=e.getConstrained(j,ye).zoom+In(j.lat,0);oe=o.af(Te-X)}const ue=o.bA(f.lng,j.lng),ge=o.bA(f.lat,j.lat);return{easeFunc:(he,ye,Te,fe)=>{const Re=Fh(f,ue,ge,Te);A&&e.interpolatePadding(w,a.padding,he);const $e=he===1?j:Re;e.setCenter($e.wrap());const Ne=X+o.ak(ye);e.setZoom(he===1?k:Ne+In(0,$e.lat))},scaleOfZoom:ae,targetCenter:j,scaleOfMinZoom:oe,pixelPathLength:G}}static solveVectorScale(e,a,c,f,y){const w=f==="x"?[c[0],c[4],c[8],c[12]]:[c[1],c[5],c[9],c[13]],A=[c[3],c[7],c[11],c[15]],P=e[0]*w[0]+e[1]*w[1]+e[2]*w[2],k=e[0]*A[0]+e[1]*A[1]+e[2]*A[2],O=a[0]*w[0]+a[1]*w[1]+a[2]*w[2],F=a[0]*A[0]+a[1]*A[1]+a[2]*A[2];return O+y*k===P+y*F||A[3]*(P-O)+w[3]*(F-k)+P*F==O*k?null:(O+w[3]-y*F-y*A[3])/(O-P-y*F+y*k)}static getLesserNonNegativeNonNull(e,a){return a!==null&&a>=0&&a<e?a:e}}class Uh{constructor(e){this._globe=e,this._mercatorCameraHelper=new Mn,this._verticalPerspectiveCameraHelper=new zr}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,a){return this.currentHelper.handlePanInertia(e,a)}handleMapControlsRollPitchBearingZoom(e,a){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,a)}handleMapControlsPan(e,a,c){this.currentHelper.handleMapControlsPan(e,a,c)}cameraForBoxAndBearing(e,a,c,f,y){return this.currentHelper.cameraForBoxAndBearing(e,a,c,f,y)}handleJumpToCenterZoom(e,a){this.currentHelper.handleJumpToCenterZoom(e,a)}handleEaseTo(e,a){return this.currentHelper.handleEaseTo(e,a)}handleFlyTo(e,a){return this.currentHelper.handleFlyTo(e,a)}}const ku=(m,e)=>o.y(m,e&&e.filter((a=>a.identifier!=="source.canvas"))),Tp=o.bE();class Vh extends o.E{constructor(e,a={}){var c,f;super(),this._rtlPluginLoaded=()=>{for(const w in this.sourceCaches){const A=this.sourceCaches[w].getSource().type;A!=="vector"&&A!=="geojson"||this.sourceCaches[w].reload()}},this.map=e,this.dispatcher=new kt(Kt(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",((w,A)=>this.getGlyphs(w,A))),this.dispatcher.registerMessageHandler("GI",((w,A)=>this.getImages(w,A))),this.imageManager=new at,this.imageManager.setEventedParent(this);const y=((c=e._container)===null||c===void 0?void 0:c.lang)||typeof document<"u"&&((f=document.documentElement)===null||f===void 0?void 0:f.lang)||void 0;this.glyphManager=new Lt(e._requestManager,a.localIdeographFontFamily,y),this.lineAtlas=new St(256,512),this.crossTileSymbolIndex=new Zo,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.bF,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",o.bG()),Yn().on(Fo,this._rtlPluginLoaded),this.on("data",(w=>{if(w.dataType!=="source"||w.sourceDataType!=="metadata")return;const A=this.sourceCaches[w.sourceId];if(!A)return;const P=A.getSource();if(P&&P.vectorLayerIds)for(const k in this._layers){const O=this._layers[k];O.source===P.id&&this._validateLayer(O)}}))}setGlobalStateProperty(e,a){var c,f,y;this._checkLoaded();const w=a===null?(y=(f=(c=this.stylesheet.state)===null||c===void 0?void 0:c[e])===null||f===void 0?void 0:f.default)!==null&&y!==void 0?y:null:a;if(o.bH(w,this._globalState[e]))return this;this._globalState[e]=w,this._applyGlobalStateChanges([e])}getGlobalState(){return this._globalState}setGlobalState(e){this._checkLoaded();const a=[];for(const c in e)!o.bH(this._globalState[c],e[c].default)&&(a.push(c),this._globalState[c]=e[c].default);this._applyGlobalStateChanges(a)}_applyGlobalStateChanges(e){if(e.length===0)return;const a=new Set;for(const c in this._layers){const f=this._layers[c],y=f.getLayoutAffectingGlobalStateRefs(),w=f.getPaintAffectingGlobalStateRefs();for(const A of e)if(y.has(A)&&a.add(f.source),w.has(A))for(const{name:P,value:k}of w.get(A))this._updatePaintProperty(f,P,k)}for(const c in this.sourceCaches)a.has(c)&&(this._reloadSource(c),this._changed=!0)}loadURL(e,a={},c){this.fire(new o.l("dataloading",{dataType:"style"})),a.validate=typeof a.validate!="boolean"||a.validate;const f=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const y=this._loadStyleRequest;o.j(f,this._loadStyleRequest).then((w=>{this._loadStyleRequest=null,this._load(w.data,a,c)})).catch((w=>{this._loadStyleRequest=null,w&&!y.signal.aborted&&this.fire(new o.k(w))}))}loadJSON(e,a={},c){this.fire(new o.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,ee.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,a.validate=a.validate!==!1,this._load(e,a,c)})).catch((()=>{}))}loadEmpty(){this.fire(new o.l("dataloading",{dataType:"style"})),this._load(Tp,{validate:!1})}_load(e,a,c){var f,y,w;let A=a.transformStyle?a.transformStyle(c,e):e;if(!a.validate||!ku(this,o.z(A))){A=Object.assign({},A),this._loaded=!0,this.stylesheet=A;for(const P in A.sources)this.addSource(P,A.sources[P],{validate:!1});A.sprite?this._loadSprite(A.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(A.glyphs),this._createLayers(),this.light=new Oe(this.stylesheet.light),this._setProjectionInternal(((f=this.stylesheet.projection)===null||f===void 0?void 0:f.type)||"mercator"),this.sky=new Xe(this.stylesheet.sky),this.map.setTerrain((y=this.stylesheet.terrain)!==null&&y!==void 0?y:null),this.setGlobalState((w=this.stylesheet.state)!==null&&w!==void 0?w:null),this.fire(new o.l("data",{dataType:"style"})),this.fire(new o.l("style.load"))}}_createLayers(){const e=o.bI(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map((a=>a.id)),this._layers={},this._serializedLayers=null;for(const a of e){const c=o.bJ(a);c.setEventedParent(this,{layer:{id:a.id}}),this._layers[a.id]=c}}_loadSprite(e,a=!1,c=void 0){let f;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,(function(y,w,A,P){return o._(this,void 0,void 0,(function*(){const k=ct(y),O=A>1?"@2x":"",F={},j={};for(const{id:G,url:X}of k){const se=w.transformRequest(tt(X,O,".json"),"SpriteJSON");F[G]=o.j(se,P);const ae=w.transformRequest(tt(X,O,".png"),"SpriteImage");j[G]=ke.getImage(ae,P)}return yield Promise.all([...Object.values(F),...Object.values(j)]),(function(G,X){return o._(this,void 0,void 0,(function*(){const se={};for(const ae in G){se[ae]={};const oe=ee.getImageCanvasContext((yield X[ae]).data),ue=(yield G[ae]).data;for(const ge in ue){const{width:he,height:ye,x:Te,y:fe,sdf:Re,pixelRatio:$e,stretchX:Ne,stretchY:Fe,content:Ze,textFitWidth:mt,textFitHeight:_t}=ue[ge];se[ae][ge]={data:null,pixelRatio:$e,sdf:Re,stretchX:Ne,stretchY:Fe,content:Ze,textFitWidth:mt,textFitHeight:_t,spriteData:{width:he,height:ye,x:Te,y:fe,context:oe}}}}return se}))})(F,j)}))})(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((y=>{if(this._spriteRequest=null,y)for(const w in y){this._spritesImagesIds[w]=[];const A=this._spritesImagesIds[w]?this._spritesImagesIds[w].filter((P=>!(P in y))):[];for(const P of A)this.imageManager.removeImage(P),this._changedImages[P]=!0;for(const P in y[w]){const k=w==="default"?P:`${w}:${P}`;this._spritesImagesIds[w].push(k),k in this.imageManager.images?this.imageManager.updateImage(k,y[w][P],!1):this.imageManager.addImage(k,y[w][P]),a&&(this._changedImages[k]=!0)}}})).catch((y=>{this._spriteRequest=null,f=y,this.fire(new o.k(f))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),a&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"})),c&&c(f)}))}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}_validateLayer(e){const a=this.sourceCaches[e.source];if(!a)return;const c=e.sourceLayer;if(!c)return;const f=a.getSource();(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(c)===-1)&&this.fire(new o.k(new Error(`Source layer "${c}" does not exist on source "${f.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,a=!1){const c=this._serializedAllLayers();if(!e||e.length===0)return Object.values(a?o.bK(c):c);const f=[];for(const y of e)if(c[y]){const w=a?o.bK(c[y]):c[y];f.push(w)}return f}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const a=Object.keys(this._layers);for(const c of a){const f=this._layers[c];f.type!=="custom"&&(e[c]=f.serialize())}return e}hasTransitions(){var e,a,c;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((a=this.sky)===null||a===void 0)&&a.hasTransition()||!((c=this.projection)===null||c===void 0)&&c.hasTransition())return!0;for(const f in this.sourceCaches)if(this.sourceCaches[f].hasTransition())return!0;for(const f in this._layers)if(this._layers[f].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const a=this._changed;if(a){const f=Object.keys(this._updatedLayers),y=Object.keys(this._removedLayers);(f.length||y.length)&&this._updateWorkerLayers(f,y);for(const w in this._updatedSources){const A=this._updatedSources[w];if(A==="reload")this._reloadSource(w);else{if(A!=="clear")throw new Error(`Invalid action ${A}`);this._clearSource(w)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const w in this._updatedPaintProps)this._layers[w].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const c={};for(const f in this.sourceCaches){const y=this.sourceCaches[f];c[f]=y.used,y.used=!1}for(const f of this._order){const y=this._layers[f];y.recalculate(e,this._availableImages),!y.isHidden(e.zoom)&&y.source&&(this.sourceCaches[y.source].used=!0)}for(const f in c){const y=this.sourceCaches[f];!!c[f]!=!!y.used&&y.fire(new o.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:f}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,a&&this.fire(new o.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const a in this.sourceCaches)this.sourceCaches[a].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,a){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:a})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,a={}){var c;this._checkLoaded();const f=this.serialize();if(e=a.transformStyle?a.transformStyle(f,e):e,((c=a.validate)===null||c===void 0||c)&&ku(this,o.z(e)))return!1;(e=o.bK(e)).layers=o.bI(e.layers);const y=o.bL(f,e),w=this._getOperationsToPerform(y);if(w.unimplemented.length>0)throw new Error(`Unimplemented: ${w.unimplemented.join(", ")}.`);if(w.operations.length===0)return!1;for(const A of w.operations)A();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const a=[],c=[];for(const f of e)switch(f.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":a.push((()=>this.addLayer.apply(this,f.args)));break;case"removeLayer":a.push((()=>this.removeLayer.apply(this,f.args)));break;case"setPaintProperty":a.push((()=>this.setPaintProperty.apply(this,f.args)));break;case"setLayoutProperty":a.push((()=>this.setLayoutProperty.apply(this,f.args)));break;case"setFilter":a.push((()=>this.setFilter.apply(this,f.args)));break;case"addSource":a.push((()=>this.addSource.apply(this,f.args)));break;case"removeSource":a.push((()=>this.removeSource.apply(this,f.args)));break;case"setLayerZoomRange":a.push((()=>this.setLayerZoomRange.apply(this,f.args)));break;case"setLight":a.push((()=>this.setLight.apply(this,f.args)));break;case"setGeoJSONSourceData":a.push((()=>this.setGeoJSONSourceData.apply(this,f.args)));break;case"setGlyphs":a.push((()=>this.setGlyphs.apply(this,f.args)));break;case"setSprite":a.push((()=>this.setSprite.apply(this,f.args)));break;case"setTerrain":a.push((()=>this.map.setTerrain.apply(this,f.args)));break;case"setSky":a.push((()=>this.setSky.apply(this,f.args)));break;case"setProjection":this.setProjection.apply(this,f.args);break;case"setGlobalState":a.push((()=>this.setGlobalState.apply(this,f.args)));break;case"setTransition":a.push((()=>{}));break;default:c.push(f.command)}return{operations:a,unimplemented:c}}addImage(e,a){if(this.getImage(e))return this.fire(new o.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,a),this._afterImageUpdated(e)}updateImage(e,a){this.imageManager.updateImage(e,a)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new o.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,a,c={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!a.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(a).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(a.type)>=0&&this._validate(o.z.source,`sources.${e}`,a,null,c))return;this.map&&this.map._collectResourceTiming&&(a.collectResourceTiming=!0);const f=this.sourceCaches[e]=new _i(e,a,this.dispatcher);f.style=this,f.setEventedParent(this,(()=>({isSourceLoaded:f.loaded(),source:f.serialize(),sourceId:e}))),f.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const c in this._layers)if(this._layers[c].source===e)return this.fire(new o.k(new Error(`Source "${e}" cannot be removed while layer "${c}" is using it.`)));const a=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],a.fire(new o.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),a.setEventedParent(null),a.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,a){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const c=this.sourceCaches[e].getSource();if(c.type!=="geojson")throw new Error(`geojsonSource.type is ${c.type}, which is !== 'geojson`);c.setData(a),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,a,c={}){this._checkLoaded();const f=e.id;if(this.getLayer(f))return void this.fire(new o.k(new Error(`Layer "${f}" already exists on this map.`)));let y;if(e.type==="custom"){if(ku(this,o.bM(e)))return;y=o.bJ(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(f,e.source),e=o.bK(e),e=o.e(e,{source:f})),this._validate(o.z.layer,`layers.${f}`,e,{arrayIndex:-1},c))return;y=o.bJ(e),this._validateLayer(y),y.setEventedParent(this,{layer:{id:f}})}const w=a?this._order.indexOf(a):this._order.length;if(a&&w===-1)this.fire(new o.k(new Error(`Cannot add layer "${f}" before non-existing layer "${a}".`)));else{if(this._order.splice(w,0,f),this._layerOrderChanged=!0,this._layers[f]=y,this._removedLayers[f]&&y.source&&y.type!=="custom"){const A=this._removedLayers[f];delete this._removedLayers[f],A.type!==y.type?this._updatedSources[y.source]="clear":(this._updatedSources[y.source]="reload",this.sourceCaches[y.source].pause())}this._updateLayer(y),y.onAdd&&y.onAdd(this.map)}}moveLayer(e,a){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new o.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===a)return;const c=this._order.indexOf(e);this._order.splice(c,1);const f=a?this._order.indexOf(a):this._order.length;a&&f===-1?this.fire(new o.k(new Error(`Cannot move layer "${e}" before non-existing layer "${a}".`))):(this._order.splice(f,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const a=this._layers[e];if(!a)return void this.fire(new o.k(new Error(`Cannot remove non-existing layer "${e}".`)));a.setEventedParent(null);const c=this._order.indexOf(e);this._order.splice(c,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=a,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],a.onRemove&&a.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,a,c){this._checkLoaded();const f=this.getLayer(e);f?f.minzoom===a&&f.maxzoom===c||(a!=null&&(f.minzoom=a),c!=null&&(f.maxzoom=c),this._updateLayer(f)):this.fire(new o.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,a,c={}){this._checkLoaded();const f=this.getLayer(e);if(f){if(!o.bH(f.filter,a))return a==null?(f.setFilter(void 0),void this._updateLayer(f)):void(this._validate(o.z.filter,`layers.${f.id}.filter`,a,null,c)||(f.setFilter(o.bK(a)),this._updateLayer(f)))}else this.fire(new o.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return o.bK(this.getLayer(e).filter)}setLayoutProperty(e,a,c,f={}){this._checkLoaded();const y=this.getLayer(e);y?o.bH(y.getLayoutProperty(a),c)||(y.setLayoutProperty(a,c,f),this._updateLayer(y)):this.fire(new o.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,a){const c=this.getLayer(e);if(c)return c.getLayoutProperty(a);this.fire(new o.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,a,c,f={}){this._checkLoaded();const y=this.getLayer(e);y?o.bH(y.getPaintProperty(a),c)||this._updatePaintProperty(y,a,c,f):this.fire(new o.k(new Error(`Cannot style non-existing layer "${e}".`)))}_updatePaintProperty(e,a,c,f={}){e.setPaintProperty(a,c,f)&&this._updateLayer(e),this._changed=!0,this._updatedPaintProps[e.id]=!0,this._serializedLayers=null}getPaintProperty(e,a){return this.getLayer(e).getPaintProperty(a)}setFeatureState(e,a){this._checkLoaded();const c=e.source,f=e.sourceLayer,y=this.sourceCaches[c];if(y===void 0)return void this.fire(new o.k(new Error(`The source '${c}' does not exist in the map's style.`)));const w=y.getSource().type;w==="geojson"&&f?this.fire(new o.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):w!=="vector"||f?(e.id===void 0&&this.fire(new o.k(new Error("The feature id parameter must be provided."))),y.setFeatureState(f,e.id,a)):this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,a){this._checkLoaded();const c=e.source,f=this.sourceCaches[c];if(f===void 0)return void this.fire(new o.k(new Error(`The source '${c}' does not exist in the map's style.`)));const y=f.getSource().type,w=y==="vector"?e.sourceLayer:void 0;y!=="vector"||w?a&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new o.k(new Error("A feature id is required to remove its specific state property."))):f.removeFeatureState(w,e.id,a):this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const a=e.source,c=e.sourceLayer,f=this.sourceCaches[a];if(f!==void 0)return f.getSource().type!=="vector"||c?(e.id===void 0&&this.fire(new o.k(new Error("The feature id parameter must be provided."))),f.getFeatureState(c,e.id)):void this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new o.k(new Error(`The source '${a}' does not exist in the map's style.`)))}getTransition(){return o.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=o.bN(this.sourceCaches,(y=>y.serialize())),a=this._serializeByIds(this._order,!0),c=this.map.getTerrain()||void 0,f=this.stylesheet;return o.bO({version:f.version,name:f.name,metadata:f.metadata,light:f.light,sky:f.sky,center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,sprite:f.sprite,glyphs:f.glyphs,transition:f.transition,projection:f.projection,sources:e,layers:a,terrain:c},(y=>y!==void 0))}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const a=w=>this._layers[w].type==="fill-extrusion",c={},f=[];for(let w=this._order.length-1;w>=0;w--){const A=this._order[w];if(a(A)){c[A]=w;for(const P of e){const k=P[A];if(k)for(const O of k)f.push(O)}}}f.sort(((w,A)=>A.intersectionZ-w.intersectionZ));const y=[];for(let w=this._order.length-1;w>=0;w--){const A=this._order[w];if(a(A))for(let P=f.length-1;P>=0;P--){const k=f[P].feature;if(c[k.layer.id]<w)break;y.push(k),f.pop()}else for(const P of e){const k=P[A];if(k)for(const O of k)y.push(O.feature)}}return y}queryRenderedFeatures(e,a,c){a&&a.filter&&this._validate(o.z.filter,"queryRenderedFeatures.filter",a.filter,null,a);const f={};if(a&&a.layers){if(!(Array.isArray(a.layers)||a.layers instanceof Set))return this.fire(new o.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const k of a.layers){const O=this._layers[k];if(!O)return this.fire(new o.k(new Error(`The layer '${k}' does not exist in the map's style and cannot be queried for features.`))),[];f[O.source]=!0}}const y=[];a.availableImages=this._availableImages;const w=this._serializedAllLayers(),A=a.layers instanceof Set?a.layers:Array.isArray(a.layers)?new Set(a.layers):null,P=Object.assign(Object.assign({},a),{layers:A});for(const k in this.sourceCaches)a.layers&&!f[k]||y.push(bi(this.sourceCaches[k],this._layers,w,e,P,c,this.map.terrain?(O,F,j)=>this.map.terrain.getElevation(O,F,j):void 0));return this.placement&&y.push((function(k,O,F,j,G,X,se){const ae={},oe=X.queryRenderedSymbols(j),ue=[];for(const ge of Object.keys(oe).map(Number))ue.push(se[ge]);ue.sort(wi);for(const ge of ue){const he=ge.featureIndex.lookupSymbolFeatures(oe[ge.bucketInstanceId],O,ge.bucketIndex,ge.sourceLayerIndex,G.filter,G.layers,G.availableImages,k);for(const ye in he){const Te=ae[ye]=ae[ye]||[],fe=he[ye];fe.sort(((Re,$e)=>{const Ne=ge.featureSortOrder;if(Ne){const Fe=Ne.indexOf(Re.featureIndex);return Ne.indexOf($e.featureIndex)-Fe}return $e.featureIndex-Re.featureIndex}));for(const Re of fe)Te.push(Re)}}return(function(ge,he,ye){for(const Te in ge)for(const fe of ge[Te])gi(fe,ye[he[Te].source]);return ge})(ae,k,F)})(this._layers,w,this.sourceCaches,e,P,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(y)}querySourceFeatures(e,a){a&&a.filter&&this._validate(o.z.filter,"querySourceFeatures.filter",a.filter,null,a);const c=this.sourceCaches[e];return c?(function(f,y){const w=f.getRenderableIds().map((k=>f.getTileByID(k))),A=[],P={};for(let k=0;k<w.length;k++){const O=w[k],F=O.tileID.canonical.key;P[F]||(P[F]=!0,O.querySourceFeatures(A,y))}return A})(c,a):[]}getLight(){return this.light.getLight()}setLight(e,a={}){this._checkLoaded();const c=this.light.getLight();let f=!1;for(const w in e)if(!o.bH(e[w],c[w])){f=!0;break}if(!f)return;const y={now:ee.now(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,a),this.light.updateTransitions(y)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,a={}){this._checkLoaded();const c=this.getSky();let f=!1;if(!e&&!c)return;if(e&&!c)f=!0;else if(!e&&c)f=!0;else for(const w in e)if(!o.bH(e[w],c[w])){f=!0;break}if(!f)return;const y={now:ee.now(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,a),this.sky.updateTransitions(y)}_setProjectionInternal(e){const a=(function(c){if(Array.isArray(c)){const f=new Ho({type:c});return{projection:f,transform:new Lc,cameraHelper:new Uh(f)}}switch(c){case"mercator":return{projection:new pi,transform:new Li,cameraHelper:new Mn};case"globe":{const f=new Ho({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:f,transform:new Lc,cameraHelper:new Uh(f)}}case"vertical-perspective":return{projection:new $o,transform:new kc,cameraHelper:new zr};default:return o.w(`Unknown projection name: ${c}. Falling back to mercator projection.`),{projection:new pi,transform:new Li,cameraHelper:new Mn}}})(e);this.projection=a.projection,this.map.migrateProjection(a.transform,a.cameraHelper);for(const c in this.sourceCaches)this.sourceCaches[c].reload()}_validate(e,a,c,f,y={}){return(!y||y.validate!==!1)&&ku(this,e.call(o.z,o.e({key:a,style:this.serialize(),value:c,styleSpec:o.v},f)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Yn().off(Fo,this._rtlPluginLoaded);for(const a in this._layers)this._layers[a].setEventedParent(null);for(const a in this.sourceCaches){const c=this.sourceCaches[a];c.setEventedParent(null),c.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const a in this.sourceCaches)this.sourceCaches[a].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,a,c,f,y=!1){let w=!1,A=!1;const P={};for(const k of this._order){const O=this._layers[k];if(O.type!=="symbol")continue;if(!P[O.source]){const j=this.sourceCaches[O.source];P[O.source]=j.getRenderableIds(!0).map((G=>j.getTileByID(G))).sort(((G,X)=>X.tileID.overscaledZ-G.tileID.overscaledZ||(G.tileID.isLessThan(X.tileID)?-1:1)))}const F=this.crossTileSymbolIndex.addLayer(O,P[O.source],e.center.lng);w=w||F}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((y=y||this._layerOrderChanged||c===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(ee.now(),e.zoom))&&(this.pauseablePlacement=new Pc(e,this.map.terrain,this._order,y,a,c,f,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,P),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(ee.now()),A=!0),w&&this.pauseablePlacement.placement.setStale()),A||w)for(const k of this._order){const O=this._layers[k];O.type==="symbol"&&this.placement.updateLayerOpacities(O,P[O.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(ee.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,a){return o._(this,void 0,void 0,(function*(){const c=yield this.imageManager.getImages(a.icons);this._updateTilesForChangedImages();const f=this.sourceCaches[a.source];return f&&f.setDependencies(a.tileID.key,a.type,a.icons),c}))}getGlyphs(e,a){return o._(this,void 0,void 0,(function*(){const c=yield this.glyphManager.getGlyphs(a.stacks),f=this.sourceCaches[a.source];return f&&f.setDependencies(a.tileID.key,a.type,[""]),c}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,a={}){this._checkLoaded(),e&&this._validate(o.z.glyphs,"glyphs",e,null,a)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,a,c={},f){this._checkLoaded();const y=[{id:e,url:a}],w=[...ct(this.stylesheet.sprite),...y];this._validate(o.z.sprite,"sprite",w,null,c)||(this.stylesheet.sprite=w,this._loadSprite(y,!0,f))}removeSprite(e){this._checkLoaded();const a=ct(this.stylesheet.sprite);if(a.find((c=>c.id===e))){if(this._spritesImagesIds[e])for(const c of this._spritesImagesIds[e])this.imageManager.removeImage(c),this._changedImages[c]=!0;a.splice(a.findIndex((c=>c.id===e)),1),this.stylesheet.sprite=a.length>0?a:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}else this.fire(new o.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return ct(this.stylesheet.sprite)}setSprite(e,a={},c){this._checkLoaded(),e&&this._validate(o.z.sprite,"sprite",e,null,a)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,c):(this._unloadSprite(),c&&c(null)))}}var Cp=o.aJ([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Ep{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,a,c,f,y,w,A,P,k){this.context=e;let O=this.boundPaintVertexBuffers.length!==f.length;for(let F=0;!O&&F<f.length;F++)this.boundPaintVertexBuffers[F]!==f[F]&&(O=!0);!this.vao||this.boundProgram!==a||this.boundLayoutVertexBuffer!==c||O||this.boundIndexBuffer!==y||this.boundVertexOffset!==w||this.boundDynamicVertexBuffer!==A||this.boundDynamicVertexBuffer2!==P||this.boundDynamicVertexBuffer3!==k?this.freshBind(a,c,f,y,w,A,P,k):(e.bindVertexArray.set(this.vao),A&&A.bind(),y&&y.dynamicDraw&&y.bind(),P&&P.bind(),k&&k.bind())}freshBind(e,a,c,f,y,w,A,P){const k=e.numAttributes,O=this.context,F=O.gl;this.vao&&this.destroy(),this.vao=O.createVertexArray(),O.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=f,this.boundVertexOffset=y,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=A,this.boundDynamicVertexBuffer3=P,a.enableAttributes(F,e);for(const j of c)j.enableAttributes(F,e);w&&w.enableAttributes(F,e),A&&A.enableAttributes(F,e),P&&P.enableAttributes(F,e),a.bind(),a.setVertexAttribPointers(F,e,y);for(const j of c)j.bind(),j.setVertexAttribPointers(F,e,y);w&&(w.bind(),w.setVertexAttribPointers(F,e,y)),f&&f.bind(),A&&(A.bind(),A.setVertexAttribPointers(F,e,y)),P&&(P.bind(),P.setVertexAttribPointers(F,e,y)),O.currentNumAttributes=k}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Lu=(m,e,a,c,f)=>({u_texture:0,u_ele_delta:m,u_fog_matrix:e,u_fog_color:a?a.properties.get("fog-color"):o.bf.white,u_fog_ground_blend:a?a.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:f?0:a?a.calculateFogBlendOpacity(c):0,u_horizon_color:a?a.properties.get("horizon-color"):o.bf.white,u_horizon_fog_blend:a?a.properties.get("horizon-fog-blend"):1,u_is_globe_mode:f?1:0}),Gh={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Ko(m){const e=[];for(let a=0;a<m.length;a++){if(m[a]===null)continue;const c=m[a].split(" ");e.push(c.pop())}return e}class Zh{constructor(e,a,c,f,y,w,A,P,k=[]){const O=e.gl;this.program=O.createProgram();const F=Ko(a.staticAttributes),j=c?c.getBinderAttributes():[],G=F.concat(j),X=qa.prelude.staticUniforms?Ko(qa.prelude.staticUniforms):[],se=A.staticUniforms?Ko(A.staticUniforms):[],ae=a.staticUniforms?Ko(a.staticUniforms):[],oe=c?c.getBinderUniforms():[],ue=X.concat(se).concat(ae).concat(oe),ge=[];for(const Ne of ue)ge.indexOf(Ne)<0&&ge.push(Ne);const he=c?c.defines():[];Rr(O)&&he.unshift("#version 300 es"),y&&he.push("#define OVERDRAW_INSPECTOR;"),w&&he.push("#define TERRAIN3D;"),P&&he.push(P),k&&he.push(...k);let ye=he.concat(qa.prelude.fragmentSource,A.fragmentSource,a.fragmentSource).join(`
`),Te=he.concat(qa.prelude.vertexSource,A.vertexSource,a.vertexSource).join(`
`);Rr(O)||(ye=(function(Ne){return Ne.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")})(ye),Te=(function(Ne){return Ne.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")})(Te));const fe=O.createShader(O.FRAGMENT_SHADER);if(O.isContextLost())return void(this.failedToCreate=!0);if(O.shaderSource(fe,ye),O.compileShader(fe),!O.getShaderParameter(fe,O.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${O.getShaderInfoLog(fe)}`);O.attachShader(this.program,fe);const Re=O.createShader(O.VERTEX_SHADER);if(O.isContextLost())return void(this.failedToCreate=!0);if(O.shaderSource(Re,Te),O.compileShader(Re),!O.getShaderParameter(Re,O.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${O.getShaderInfoLog(Re)}`);O.attachShader(this.program,Re),this.attributes={};const $e={};this.numAttributes=G.length;for(let Ne=0;Ne<this.numAttributes;Ne++)G[Ne]&&(O.bindAttribLocation(this.program,Ne,G[Ne]),this.attributes[G[Ne]]=Ne);if(O.linkProgram(this.program),!O.getProgramParameter(this.program,O.LINK_STATUS))throw new Error(`Program failed to link: ${O.getProgramInfoLog(this.program)}`);O.deleteShader(Re),O.deleteShader(fe);for(let Ne=0;Ne<ge.length;Ne++){const Fe=ge[Ne];if(Fe&&!$e[Fe]){const Ze=O.getUniformLocation(this.program,Fe);Ze&&($e[Fe]=Ze)}}this.fixedUniforms=f(e,$e),this.terrainUniforms=((Ne,Fe)=>({u_depth:new o.bP(Ne,Fe.u_depth),u_terrain:new o.bP(Ne,Fe.u_terrain),u_terrain_dim:new o.bg(Ne,Fe.u_terrain_dim),u_terrain_matrix:new o.bR(Ne,Fe.u_terrain_matrix),u_terrain_unpack:new o.bS(Ne,Fe.u_terrain_unpack),u_terrain_exaggeration:new o.bg(Ne,Fe.u_terrain_exaggeration)}))(e,$e),this.projectionUniforms=((Ne,Fe)=>({u_projection_matrix:new o.bR(Ne,Fe.u_projection_matrix),u_projection_tile_mercator_coords:new o.bS(Ne,Fe.u_projection_tile_mercator_coords),u_projection_clipping_plane:new o.bS(Ne,Fe.u_projection_clipping_plane),u_projection_transition:new o.bg(Ne,Fe.u_projection_transition),u_projection_fallback_matrix:new o.bR(Ne,Fe.u_projection_fallback_matrix)}))(e,$e),this.binderUniforms=c?c.getUniforms(e,$e):[]}draw(e,a,c,f,y,w,A,P,k,O,F,j,G,X,se,ae,oe,ue,ge){const he=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(c),e.setStencilMode(f),e.setColorMode(y),e.setCullFace(w),P){e.activeTexture.set(he.TEXTURE2),he.bindTexture(he.TEXTURE_2D,P.depthTexture),e.activeTexture.set(he.TEXTURE3),he.bindTexture(he.TEXTURE_2D,P.texture);for(const Te in this.terrainUniforms)this.terrainUniforms[Te].set(P[Te])}if(k)for(const Te in k)this.projectionUniforms[Gh[Te]].set(k[Te]);if(A)for(const Te in this.fixedUniforms)this.fixedUniforms[Te].set(A[Te]);ae&&ae.setUniforms(e,this.binderUniforms,X,{zoom:se});let ye=0;switch(a){case he.LINES:ye=2;break;case he.TRIANGLES:ye=3;break;case he.LINE_STRIP:ye=1}for(const Te of G.get()){const fe=Te.vaos||(Te.vaos={});(fe[O]||(fe[O]=new Ep)).bind(e,this,F,ae?ae.getPaintVertexBuffers():[],j,Te.vertexOffset,oe,ue,ge),he.drawElements(a,Te.primitiveLength*ye,he.UNSIGNED_SHORT,Te.primitiveOffset*ye*2)}}}function Ll(m,e,a){const c=1/o.aC(a,1,e.transform.tileZoom),f=Math.pow(2,a.tileID.overscaledZ),y=a.tileSize*Math.pow(2,e.transform.tileZoom)/f,w=y*(a.tileID.canonical.x+a.tileID.wrap*f),A=y*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[c,m.fromScale,m.toScale],u_fade:m.t,u_pixel_coord_upper:[w>>16,A>>16],u_pixel_coord_lower:[65535&w,65535&A]}}const Gr=(m,e,a,c)=>{const f=m.style.light,y=f.properties.get("position"),w=[y.x,y.y,y.z],A=o.bV();f.properties.get("anchor")==="viewport"&&o.bW(A,m.transform.bearingInRadians),o.bX(w,w,A);const P=m.transform.transformLightDirection(w),k=f.properties.get("color");return{u_lightpos:w,u_lightpos_globe:P,u_lightintensity:f.properties.get("intensity"),u_lightcolor:[k.r,k.g,k.b],u_vertical_gradient:+e,u_opacity:a,u_fill_translate:c}},Mp=(m,e,a,c,f,y,w)=>o.e(Gr(m,e,a,c),Ll(y,m,w),{u_height_factor:-Math.pow(2,f.overscaledZ)/w.tileSize/8}),Oc=(m,e,a,c)=>o.e(Ll(e,m,a),{u_fill_translate:c}),Ol=(m,e)=>({u_world:m,u_fill_translate:e}),Bl=(m,e,a,c,f)=>o.e(Oc(m,e,a,f),{u_world:c}),ef=(m,e,a,c,f)=>{const y=m.transform;let w,A,P=0;if(a.paint.get("circle-pitch-alignment")==="map"){const k=o.aC(e,1,y.zoom);w=!0,A=[k,k],P=k/(o.$*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*f}else w=!1,A=y.pixelsToGLUnits;return{u_camera_to_center_distance:y.cameraToCenterDistance,u_scale_with_map:+(a.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+w,u_device_pixel_ratio:m.pixelRatio,u_extrude_scale:A,u_globe_extrude_scale:P,u_translate:c}},Bc=m=>({u_pixel_extrude_scale:[1/m.width,1/m.height]}),Nl=m=>({u_viewport_size:[m.width,m.height]}),Qo=(m,e=1)=>({u_color:m,u_overlay:0,u_overlay_scale:e}),tf=(m,e,a,c)=>{const f=o.aC(m,1,e)/(o.$*Math.pow(2,m.tileID.overscaledZ))*2*Math.PI*c;return{u_extrude_scale:o.aC(m,1,e),u_intensity:a,u_globe_extrude_scale:f}},qh=(m,e,a,c)=>{const f=o.L();o.bY(f,0,m.width,m.height,0,0,1);const y=m.context.gl;return{u_matrix:f,u_world:[y.drawingBufferWidth,y.drawingBufferHeight],u_image:a,u_color_ramp:c,u_opacity:e.paint.get("heatmap-opacity")}},nf=(m,e,a)=>{const c=a.paint.get("hillshade-accent-color");let f;switch(a.paint.get("hillshade-method")){case"basic":f=4;break;case"combined":f=1;break;case"igor":f=2;break;case"multidirectional":f=3;break;default:f=0}const y=a.getIlluminationProperties();for(let w=0;w<y.directionRadians.length;w++)a.paint.get("hillshade-illumination-anchor")==="viewport"&&(y.directionRadians[w]+=m.transform.bearingInRadians);return{u_image:0,u_latrange:Jo(0,e.tileID),u_exaggeration:a.paint.get("hillshade-exaggeration"),u_altitudes:y.altitudeRadians,u_azimuths:y.directionRadians,u_accent:c,u_method:f,u_highlights:y.highlightColor,u_shadows:y.shadowColor}},$h=(m,e)=>{const a=e.stride,c=o.L();return o.bY(c,0,o.$,-o.$,0,0,1),o.M(c,c,[0,-o.$,0]),{u_matrix:c,u_image:1,u_dimension:[a,a],u_zoom:m.overscaledZ,u_unpack:e.getUnpackVector()}};function Jo(m,e){const a=Math.pow(2,e.canonical.z),c=e.canonical.y;return[new o.a1(0,c/a).toLngLat().lat,new o.a1(0,(c+1)/a).toLngLat().lat]}const jl=(m,e,a=0)=>({u_image:0,u_unpack:e.getUnpackVector(),u_dimension:[e.stride,e.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:a,u_opacity:m.paint.get("color-relief-opacity")}),Ou=(m,e,a,c)=>{const f=m.transform;return{u_translation:Fc(m,e,a),u_ratio:c/o.aC(e,1,f.zoom),u_device_pixel_ratio:m.pixelRatio,u_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},Nc=(m,e,a,c,f)=>o.e(Ou(m,e,a,c),{u_image:0,u_image_height:f}),Hh=(m,e,a,c,f)=>{const y=m.transform,w=jc(e,y);return{u_translation:Fc(m,e,a),u_texsize:e.imageAtlasTexture.size,u_ratio:c/o.aC(e,1,y.zoom),u_device_pixel_ratio:m.pixelRatio,u_image:0,u_scale:[w,f.fromScale,f.toScale],u_fade:f.t,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},co=(m,e,a,c,f,y)=>{const w=m.lineAtlas,A=jc(e,m.transform),P=a.layout.get("line-cap")==="round",k=w.getDash(f.from,P),O=w.getDash(f.to,P),F=k.width*y.fromScale,j=O.width*y.toScale;return o.e(Ou(m,e,a,c),{u_patternscale_a:[A/F,-k.height/2],u_patternscale_b:[A/j,-O.height/2],u_sdfgamma:w.width/(256*Math.min(F,j)*m.pixelRatio)/2,u_image:0,u_tex_y_a:k.y,u_tex_y_b:O.y,u_mix:y.t})};function jc(m,e){return 1/o.aC(m,1,e.tileZoom)}function Fc(m,e,a){return o.aD(m.transform,e,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const Fl=(m,e,a,c,f)=>{return{u_tl_parent:m,u_scale_parent:e,u_buffer_scale:1,u_fade_t:a.mix,u_opacity:a.opacity*c.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:c.paint.get("raster-brightness-min"),u_brightness_high:c.paint.get("raster-brightness-max"),u_saturation_factor:(w=c.paint.get("raster-saturation"),w>0?1-1/(1.001-w):-w),u_contrast_factor:(y=c.paint.get("raster-contrast"),y>0?1/(1-y):1+y),u_spin_weights:rf(c.paint.get("raster-hue-rotate")),u_coords_top:[f[0].x,f[0].y,f[1].x,f[1].y],u_coords_bottom:[f[3].x,f[3].y,f[2].x,f[2].y]};var y,w};function rf(m){m*=Math.PI/180;const e=Math.sin(m),a=Math.cos(m);return[(2*a+1)/3,(-Math.sqrt(3)*e-a+1)/3,(Math.sqrt(3)*e-a+1)/3]}const Ul=(m,e,a,c,f,y,w,A,P,k,O,F,j)=>{const G=w.transform;return{u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:G.cameraToCenterDistance,u_pitch:G.pitch/360*2*Math.PI,u_rotate_symbol:+a,u_aspect_ratio:G.width/G.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_label_plane_matrix:A,u_coord_matrix:P,u_is_text:+O,u_pitch_with_map:+c,u_is_along_line:f,u_is_variable_anchor:y,u_texsize:F,u_texture:0,u_translation:k,u_pitched_scale:j}},af=(m,e,a,c,f,y,w,A,P,k,O,F,j,G)=>{const X=w.transform;return o.e(Ul(m,e,a,c,f,y,w,A,P,k,O,F,G),{u_gamma_scale:c?Math.cos(X.pitch*Math.PI/180)*X.cameraToCenterDistance:1,u_device_pixel_ratio:w.pixelRatio,u_is_halo:1})},Ap=(m,e,a,c,f,y,w,A,P,k,O,F,j)=>o.e(af(m,e,a,c,f,y,w,A,P,k,!0,O,0,j),{u_texsize_icon:F,u_texture_icon:1}),sf=(m,e)=>({u_opacity:m,u_color:e}),of=(m,e,a,c,f)=>o.e((function(y,w,A,P){const k=A.imageManager.getPattern(y.from.toString()),O=A.imageManager.getPattern(y.to.toString()),{width:F,height:j}=A.imageManager.getPixelSize(),G=Math.pow(2,P.tileID.overscaledZ),X=P.tileSize*Math.pow(2,A.transform.tileZoom)/G,se=X*(P.tileID.canonical.x+P.tileID.wrap*G),ae=X*P.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:k.tl,u_pattern_br_a:k.br,u_pattern_tl_b:O.tl,u_pattern_br_b:O.br,u_texsize:[F,j],u_mix:w.t,u_pattern_size_a:k.displaySize,u_pattern_size_b:O.displaySize,u_scale_a:w.fromScale,u_scale_b:w.toScale,u_tile_units_to_pixels:1/o.aC(P,1,A.transform.tileZoom),u_pixel_coord_upper:[se>>16,ae>>16],u_pixel_coord_lower:[65535&se,65535&ae]}})(a,f,e,c),{u_opacity:m}),Xh=(m,e)=>{},Zr={fillExtrusion:(m,e)=>({u_lightpos:new o.bT(m,e.u_lightpos),u_lightpos_globe:new o.bT(m,e.u_lightpos_globe),u_lightintensity:new o.bg(m,e.u_lightintensity),u_lightcolor:new o.bT(m,e.u_lightcolor),u_vertical_gradient:new o.bg(m,e.u_vertical_gradient),u_opacity:new o.bg(m,e.u_opacity),u_fill_translate:new o.bU(m,e.u_fill_translate)}),fillExtrusionPattern:(m,e)=>({u_lightpos:new o.bT(m,e.u_lightpos),u_lightpos_globe:new o.bT(m,e.u_lightpos_globe),u_lightintensity:new o.bg(m,e.u_lightintensity),u_lightcolor:new o.bT(m,e.u_lightcolor),u_vertical_gradient:new o.bg(m,e.u_vertical_gradient),u_height_factor:new o.bg(m,e.u_height_factor),u_opacity:new o.bg(m,e.u_opacity),u_fill_translate:new o.bU(m,e.u_fill_translate),u_image:new o.bP(m,e.u_image),u_texsize:new o.bU(m,e.u_texsize),u_pixel_coord_upper:new o.bU(m,e.u_pixel_coord_upper),u_pixel_coord_lower:new o.bU(m,e.u_pixel_coord_lower),u_scale:new o.bT(m,e.u_scale),u_fade:new o.bg(m,e.u_fade)}),fill:(m,e)=>({u_fill_translate:new o.bU(m,e.u_fill_translate)}),fillPattern:(m,e)=>({u_image:new o.bP(m,e.u_image),u_texsize:new o.bU(m,e.u_texsize),u_pixel_coord_upper:new o.bU(m,e.u_pixel_coord_upper),u_pixel_coord_lower:new o.bU(m,e.u_pixel_coord_lower),u_scale:new o.bT(m,e.u_scale),u_fade:new o.bg(m,e.u_fade),u_fill_translate:new o.bU(m,e.u_fill_translate)}),fillOutline:(m,e)=>({u_world:new o.bU(m,e.u_world),u_fill_translate:new o.bU(m,e.u_fill_translate)}),fillOutlinePattern:(m,e)=>({u_world:new o.bU(m,e.u_world),u_image:new o.bP(m,e.u_image),u_texsize:new o.bU(m,e.u_texsize),u_pixel_coord_upper:new o.bU(m,e.u_pixel_coord_upper),u_pixel_coord_lower:new o.bU(m,e.u_pixel_coord_lower),u_scale:new o.bT(m,e.u_scale),u_fade:new o.bg(m,e.u_fade),u_fill_translate:new o.bU(m,e.u_fill_translate)}),circle:(m,e)=>({u_camera_to_center_distance:new o.bg(m,e.u_camera_to_center_distance),u_scale_with_map:new o.bP(m,e.u_scale_with_map),u_pitch_with_map:new o.bP(m,e.u_pitch_with_map),u_extrude_scale:new o.bU(m,e.u_extrude_scale),u_device_pixel_ratio:new o.bg(m,e.u_device_pixel_ratio),u_globe_extrude_scale:new o.bg(m,e.u_globe_extrude_scale),u_translate:new o.bU(m,e.u_translate)}),collisionBox:(m,e)=>({u_pixel_extrude_scale:new o.bU(m,e.u_pixel_extrude_scale)}),collisionCircle:(m,e)=>({u_viewport_size:new o.bU(m,e.u_viewport_size)}),debug:(m,e)=>({u_color:new o.bQ(m,e.u_color),u_overlay:new o.bP(m,e.u_overlay),u_overlay_scale:new o.bg(m,e.u_overlay_scale)}),depth:Xh,clippingMask:Xh,heatmap:(m,e)=>({u_extrude_scale:new o.bg(m,e.u_extrude_scale),u_intensity:new o.bg(m,e.u_intensity),u_globe_extrude_scale:new o.bg(m,e.u_globe_extrude_scale)}),heatmapTexture:(m,e)=>({u_matrix:new o.bR(m,e.u_matrix),u_world:new o.bU(m,e.u_world),u_image:new o.bP(m,e.u_image),u_color_ramp:new o.bP(m,e.u_color_ramp),u_opacity:new o.bg(m,e.u_opacity)}),hillshade:(m,e)=>({u_image:new o.bP(m,e.u_image),u_latrange:new o.bU(m,e.u_latrange),u_exaggeration:new o.bg(m,e.u_exaggeration),u_altitudes:new o.b_(m,e.u_altitudes),u_azimuths:new o.b_(m,e.u_azimuths),u_accent:new o.bQ(m,e.u_accent),u_method:new o.bP(m,e.u_method),u_shadows:new o.bZ(m,e.u_shadows),u_highlights:new o.bZ(m,e.u_highlights)}),hillshadePrepare:(m,e)=>({u_matrix:new o.bR(m,e.u_matrix),u_image:new o.bP(m,e.u_image),u_dimension:new o.bU(m,e.u_dimension),u_zoom:new o.bg(m,e.u_zoom),u_unpack:new o.bS(m,e.u_unpack)}),colorRelief:(m,e)=>({u_image:new o.bP(m,e.u_image),u_unpack:new o.bS(m,e.u_unpack),u_dimension:new o.bU(m,e.u_dimension),u_elevation_stops:new o.bP(m,e.u_elevation_stops),u_color_stops:new o.bP(m,e.u_color_stops),u_color_ramp_size:new o.bP(m,e.u_color_ramp_size),u_opacity:new o.bg(m,e.u_opacity)}),line:(m,e)=>({u_translation:new o.bU(m,e.u_translation),u_ratio:new o.bg(m,e.u_ratio),u_device_pixel_ratio:new o.bg(m,e.u_device_pixel_ratio),u_units_to_pixels:new o.bU(m,e.u_units_to_pixels)}),lineGradient:(m,e)=>({u_translation:new o.bU(m,e.u_translation),u_ratio:new o.bg(m,e.u_ratio),u_device_pixel_ratio:new o.bg(m,e.u_device_pixel_ratio),u_units_to_pixels:new o.bU(m,e.u_units_to_pixels),u_image:new o.bP(m,e.u_image),u_image_height:new o.bg(m,e.u_image_height)}),linePattern:(m,e)=>({u_translation:new o.bU(m,e.u_translation),u_texsize:new o.bU(m,e.u_texsize),u_ratio:new o.bg(m,e.u_ratio),u_device_pixel_ratio:new o.bg(m,e.u_device_pixel_ratio),u_image:new o.bP(m,e.u_image),u_units_to_pixels:new o.bU(m,e.u_units_to_pixels),u_scale:new o.bT(m,e.u_scale),u_fade:new o.bg(m,e.u_fade)}),lineSDF:(m,e)=>({u_translation:new o.bU(m,e.u_translation),u_ratio:new o.bg(m,e.u_ratio),u_device_pixel_ratio:new o.bg(m,e.u_device_pixel_ratio),u_units_to_pixels:new o.bU(m,e.u_units_to_pixels),u_patternscale_a:new o.bU(m,e.u_patternscale_a),u_patternscale_b:new o.bU(m,e.u_patternscale_b),u_sdfgamma:new o.bg(m,e.u_sdfgamma),u_image:new o.bP(m,e.u_image),u_tex_y_a:new o.bg(m,e.u_tex_y_a),u_tex_y_b:new o.bg(m,e.u_tex_y_b),u_mix:new o.bg(m,e.u_mix)}),raster:(m,e)=>({u_tl_parent:new o.bU(m,e.u_tl_parent),u_scale_parent:new o.bg(m,e.u_scale_parent),u_buffer_scale:new o.bg(m,e.u_buffer_scale),u_fade_t:new o.bg(m,e.u_fade_t),u_opacity:new o.bg(m,e.u_opacity),u_image0:new o.bP(m,e.u_image0),u_image1:new o.bP(m,e.u_image1),u_brightness_low:new o.bg(m,e.u_brightness_low),u_brightness_high:new o.bg(m,e.u_brightness_high),u_saturation_factor:new o.bg(m,e.u_saturation_factor),u_contrast_factor:new o.bg(m,e.u_contrast_factor),u_spin_weights:new o.bT(m,e.u_spin_weights),u_coords_top:new o.bS(m,e.u_coords_top),u_coords_bottom:new o.bS(m,e.u_coords_bottom)}),symbolIcon:(m,e)=>({u_is_size_zoom_constant:new o.bP(m,e.u_is_size_zoom_constant),u_is_size_feature_constant:new o.bP(m,e.u_is_size_feature_constant),u_size_t:new o.bg(m,e.u_size_t),u_size:new o.bg(m,e.u_size),u_camera_to_center_distance:new o.bg(m,e.u_camera_to_center_distance),u_pitch:new o.bg(m,e.u_pitch),u_rotate_symbol:new o.bP(m,e.u_rotate_symbol),u_aspect_ratio:new o.bg(m,e.u_aspect_ratio),u_fade_change:new o.bg(m,e.u_fade_change),u_label_plane_matrix:new o.bR(m,e.u_label_plane_matrix),u_coord_matrix:new o.bR(m,e.u_coord_matrix),u_is_text:new o.bP(m,e.u_is_text),u_pitch_with_map:new o.bP(m,e.u_pitch_with_map),u_is_along_line:new o.bP(m,e.u_is_along_line),u_is_variable_anchor:new o.bP(m,e.u_is_variable_anchor),u_texsize:new o.bU(m,e.u_texsize),u_texture:new o.bP(m,e.u_texture),u_translation:new o.bU(m,e.u_translation),u_pitched_scale:new o.bg(m,e.u_pitched_scale)}),symbolSDF:(m,e)=>({u_is_size_zoom_constant:new o.bP(m,e.u_is_size_zoom_constant),u_is_size_feature_constant:new o.bP(m,e.u_is_size_feature_constant),u_size_t:new o.bg(m,e.u_size_t),u_size:new o.bg(m,e.u_size),u_camera_to_center_distance:new o.bg(m,e.u_camera_to_center_distance),u_pitch:new o.bg(m,e.u_pitch),u_rotate_symbol:new o.bP(m,e.u_rotate_symbol),u_aspect_ratio:new o.bg(m,e.u_aspect_ratio),u_fade_change:new o.bg(m,e.u_fade_change),u_label_plane_matrix:new o.bR(m,e.u_label_plane_matrix),u_coord_matrix:new o.bR(m,e.u_coord_matrix),u_is_text:new o.bP(m,e.u_is_text),u_pitch_with_map:new o.bP(m,e.u_pitch_with_map),u_is_along_line:new o.bP(m,e.u_is_along_line),u_is_variable_anchor:new o.bP(m,e.u_is_variable_anchor),u_texsize:new o.bU(m,e.u_texsize),u_texture:new o.bP(m,e.u_texture),u_gamma_scale:new o.bg(m,e.u_gamma_scale),u_device_pixel_ratio:new o.bg(m,e.u_device_pixel_ratio),u_is_halo:new o.bP(m,e.u_is_halo),u_translation:new o.bU(m,e.u_translation),u_pitched_scale:new o.bg(m,e.u_pitched_scale)}),symbolTextAndIcon:(m,e)=>({u_is_size_zoom_constant:new o.bP(m,e.u_is_size_zoom_constant),u_is_size_feature_constant:new o.bP(m,e.u_is_size_feature_constant),u_size_t:new o.bg(m,e.u_size_t),u_size:new o.bg(m,e.u_size),u_camera_to_center_distance:new o.bg(m,e.u_camera_to_center_distance),u_pitch:new o.bg(m,e.u_pitch),u_rotate_symbol:new o.bP(m,e.u_rotate_symbol),u_aspect_ratio:new o.bg(m,e.u_aspect_ratio),u_fade_change:new o.bg(m,e.u_fade_change),u_label_plane_matrix:new o.bR(m,e.u_label_plane_matrix),u_coord_matrix:new o.bR(m,e.u_coord_matrix),u_is_text:new o.bP(m,e.u_is_text),u_pitch_with_map:new o.bP(m,e.u_pitch_with_map),u_is_along_line:new o.bP(m,e.u_is_along_line),u_is_variable_anchor:new o.bP(m,e.u_is_variable_anchor),u_texsize:new o.bU(m,e.u_texsize),u_texsize_icon:new o.bU(m,e.u_texsize_icon),u_texture:new o.bP(m,e.u_texture),u_texture_icon:new o.bP(m,e.u_texture_icon),u_gamma_scale:new o.bg(m,e.u_gamma_scale),u_device_pixel_ratio:new o.bg(m,e.u_device_pixel_ratio),u_is_halo:new o.bP(m,e.u_is_halo),u_translation:new o.bU(m,e.u_translation),u_pitched_scale:new o.bg(m,e.u_pitched_scale)}),background:(m,e)=>({u_opacity:new o.bg(m,e.u_opacity),u_color:new o.bQ(m,e.u_color)}),backgroundPattern:(m,e)=>({u_opacity:new o.bg(m,e.u_opacity),u_image:new o.bP(m,e.u_image),u_pattern_tl_a:new o.bU(m,e.u_pattern_tl_a),u_pattern_br_a:new o.bU(m,e.u_pattern_br_a),u_pattern_tl_b:new o.bU(m,e.u_pattern_tl_b),u_pattern_br_b:new o.bU(m,e.u_pattern_br_b),u_texsize:new o.bU(m,e.u_texsize),u_mix:new o.bg(m,e.u_mix),u_pattern_size_a:new o.bU(m,e.u_pattern_size_a),u_pattern_size_b:new o.bU(m,e.u_pattern_size_b),u_scale_a:new o.bg(m,e.u_scale_a),u_scale_b:new o.bg(m,e.u_scale_b),u_pixel_coord_upper:new o.bU(m,e.u_pixel_coord_upper),u_pixel_coord_lower:new o.bU(m,e.u_pixel_coord_lower),u_tile_units_to_pixels:new o.bg(m,e.u_tile_units_to_pixels)}),terrain:(m,e)=>({u_texture:new o.bP(m,e.u_texture),u_ele_delta:new o.bg(m,e.u_ele_delta),u_fog_matrix:new o.bR(m,e.u_fog_matrix),u_fog_color:new o.bQ(m,e.u_fog_color),u_fog_ground_blend:new o.bg(m,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new o.bg(m,e.u_fog_ground_blend_opacity),u_horizon_color:new o.bQ(m,e.u_horizon_color),u_horizon_fog_blend:new o.bg(m,e.u_horizon_fog_blend),u_is_globe_mode:new o.bg(m,e.u_is_globe_mode)}),terrainDepth:(m,e)=>({u_ele_delta:new o.bg(m,e.u_ele_delta)}),terrainCoords:(m,e)=>({u_texture:new o.bP(m,e.u_texture),u_terrain_coords_id:new o.bg(m,e.u_terrain_coords_id),u_ele_delta:new o.bg(m,e.u_ele_delta)}),projectionErrorMeasurement:(m,e)=>({u_input:new o.bg(m,e.u_input),u_output_expected:new o.bg(m,e.u_output_expected)}),atmosphere:(m,e)=>({u_sun_pos:new o.bT(m,e.u_sun_pos),u_atmosphere_blend:new o.bg(m,e.u_atmosphere_blend),u_globe_position:new o.bT(m,e.u_globe_position),u_globe_radius:new o.bg(m,e.u_globe_radius),u_inv_proj_matrix:new o.bR(m,e.u_inv_proj_matrix)}),sky:(m,e)=>({u_sky_color:new o.bQ(m,e.u_sky_color),u_horizon_color:new o.bQ(m,e.u_horizon_color),u_horizon:new o.bU(m,e.u_horizon),u_horizon_normal:new o.bU(m,e.u_horizon_normal),u_sky_horizon_blend:new o.bg(m,e.u_sky_horizon_blend),u_sky_blend:new o.bg(m,e.u_sky_blend)})};class Vl{constructor(e,a,c){this.context=e;const f=e.gl;this.buffer=f.createBuffer(),this.dynamicDraw=!!c,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),f.bufferData(f.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const a=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Uc={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ys{constructor(e,a,c,f){this.length=a.length,this.attributes=c,this.itemSize=a.bytesPerElement,this.dynamicDraw=f,this.context=e;const y=e.gl;this.buffer=y.createBuffer(),e.bindVertexBuffer.set(this.buffer),y.bufferData(y.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,a){for(let c=0;c<this.attributes.length;c++){const f=a.attributes[this.attributes[c].name];f!==void 0&&e.enableVertexAttribArray(f)}}setVertexAttribPointers(e,a,c){for(let f=0;f<this.attributes.length;f++){const y=this.attributes[f],w=a.attributes[y.name];w!==void 0&&e.vertexAttribPointer(w,y.components,e[Uc[y.type]],!1,this.itemSize,y.offset+this.itemSize*(c||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Pi{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Bu extends Pi{getDefault(){return o.bf.transparent}set(e){const a=this.current;(e.r!==a.r||e.g!==a.g||e.b!==a.b||e.a!==a.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Vc extends Pi{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class lf extends Pi{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class uo extends Pi{getDefault(){return[!0,!0,!0,!0]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||e[2]!==a[2]||e[3]!==a[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class ks extends Pi{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class el extends Pi{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class Yh extends Pi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const a=this.current;(e.func!==a.func||e.ref!==a.ref||e.mask!==a.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class cf extends Pi{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||e[2]!==a[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class tl extends Pi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;e?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=e,this.dirty=!1}}class Gl extends Pi{getDefault(){return[0,1]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class Nu extends Pi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;e?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=e,this.dirty=!1}}class uf extends Pi{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class ho extends Pi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;e?a.enable(a.BLEND):a.disable(a.BLEND),this.current=e,this.dirty=!1}}class Gc extends Pi{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class Zc extends Pi{getDefault(){return o.bf.transparent}set(e){const a=this.current;(e.r!==a.r||e.g!==a.g||e.b!==a.b||e.a!==a.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class qc extends Pi{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class Wh extends Pi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;e?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=e,this.dirty=!1}}class il extends Pi{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class $c extends Pi{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class nl extends Pi{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class ua extends Pi{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class ju extends Pi{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||e[2]!==a[2]||e[3]!==a[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Ea extends Pi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class Fu extends Pi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class cr extends Pi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.bindTexture(a.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class qr extends Pi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Ls extends Pi{getDefault(){return null}set(e){const a=this.gl;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class rl extends Pi{getDefault(){return null}set(e){var a;if(e===this.current&&!this.dirty)return;const c=this.gl;Rr(c)?c.bindVertexArray(e):(a=c.getExtension("OES_vertex_array_object"))===null||a===void 0||a.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class al extends Pi{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class Hc extends Pi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class fo extends Pi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class ha extends Pi{constructor(e,a){super(e),this.context=e,this.parent=a}getDefault(){return null}}class Kh extends ha{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class Zl extends ha{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class fi extends ha{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const Xc="Framebuffer is not complete";class da{constructor(e,a,c,f,y){this.context=e,this.width=a,this.height=c;const w=e.gl,A=this.framebuffer=w.createFramebuffer();if(this.colorAttachment=new Kh(e,A),f)this.depthAttachment=y?new fi(e,A):new Zl(e,A);else if(y)throw new Error("Stencil cannot be set without depth");if(w.checkFramebufferStatus(w.FRAMEBUFFER)!==w.FRAMEBUFFER_COMPLETE)throw new Error(Xc)}destroy(){const e=this.context.gl,a=this.colorAttachment.get();if(a&&e.deleteTexture(a),this.depthAttachment){const c=this.depthAttachment.get();c&&e.deleteRenderbuffer(c)}e.deleteFramebuffer(this.framebuffer)}}class Uu{constructor(e){var a,c;if(this.gl=e,this.clearColor=new Bu(this),this.clearDepth=new Vc(this),this.clearStencil=new lf(this),this.colorMask=new uo(this),this.depthMask=new ks(this),this.stencilMask=new el(this),this.stencilFunc=new Yh(this),this.stencilOp=new cf(this),this.stencilTest=new tl(this),this.depthRange=new Gl(this),this.depthTest=new Nu(this),this.depthFunc=new uf(this),this.blend=new ho(this),this.blendFunc=new Gc(this),this.blendColor=new Zc(this),this.blendEquation=new qc(this),this.cullFace=new Wh(this),this.cullFaceSide=new il(this),this.frontFace=new $c(this),this.program=new nl(this),this.activeTexture=new ua(this),this.viewport=new ju(this),this.bindFramebuffer=new Ea(this),this.bindRenderbuffer=new Fu(this),this.bindTexture=new cr(this),this.bindVertexBuffer=new qr(this),this.bindElementBuffer=new Ls(this),this.bindVertexArray=new rl(this),this.pixelStoreUnpack=new al(this),this.pixelStoreUnpackPremultiplyAlpha=new Hc(this),this.pixelStoreUnpackFlipY=new fo(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),Rr(e)){this.HALF_FLOAT=e.HALF_FLOAT;const f=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(a=e.RGBA16F)!==null&&a!==void 0?a:f==null?void 0:f.RGBA16F_EXT,this.RGB16F=(c=e.RGB16F)!==null&&c!==void 0?c:f==null?void 0:f.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const f=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=f==null?void 0:f.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,a){return new Vl(this,e,a)}createVertexBuffer(e,a,c){return new ys(this,e,a,c)}createRenderbuffer(e,a,c){const f=this.gl,y=f.createRenderbuffer();return this.bindRenderbuffer.set(y),f.renderbufferStorage(f.RENDERBUFFER,e,a,c),this.bindRenderbuffer.set(null),y}createFramebuffer(e,a,c,f){return new da(this,e,a,c,f)}clear({color:e,depth:a,stencil:c}){const f=this.gl;let y=0;e&&(y|=f.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),a!==void 0&&(y|=f.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),c!==void 0&&(y|=f.STENCIL_BUFFER_BIT,this.clearStencil.set(c),this.stencilMask.set(255)),f.clear(y)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){o.bH(e.blendFunction,tn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return Rr(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var a;return Rr(this.gl)?this.gl.deleteVertexArray(e):(a=this.gl.getExtension("OES_vertex_array_object"))===null||a===void 0?void 0:a.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let Ir;function Qh(m,e,a,c,f){const y=m.context,w=m.transform,A=y.gl,P=m.useProgram("collisionBox"),k=[];let O=0,F=0;for(let oe=0;oe<c.length;oe++){const ue=c[oe],ge=e.getTile(ue).getBucket(a);if(!ge)continue;const he=f?ge.textCollisionBox:ge.iconCollisionBox,ye=ge.collisionCircleArray;ye.length>0&&(k.push({circleArray:ye,circleOffset:F,coord:ue}),O+=ye.length/4,F=O),he&&P.draw(y,A.LINES,ii.disabled,Ci.disabled,m.colorModeForRenderPass(),Yt.disabled,Bc(m.transform),m.style.map.terrain&&m.style.map.terrain.getTerrainData(ue),w.getProjectionData({overscaledTileID:ue,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),a.id,he.layoutVertexBuffer,he.indexBuffer,he.segments,null,m.transform.zoom,null,null,he.collisionVertexBuffer)}if(!f||!k.length)return;const j=m.useProgram("collisionCircle"),G=new o.b$;G.resize(4*O),G._trim();let X=0;for(const oe of k)for(let ue=0;ue<oe.circleArray.length/4;ue++){const ge=4*ue,he=oe.circleArray[ge+0],ye=oe.circleArray[ge+1],Te=oe.circleArray[ge+2],fe=oe.circleArray[ge+3];G.emplace(X++,he,ye,Te,fe,0),G.emplace(X++,he,ye,Te,fe,1),G.emplace(X++,he,ye,Te,fe,2),G.emplace(X++,he,ye,Te,fe,3)}(!Ir||Ir.length<2*O)&&(Ir=(function(oe){const ue=2*oe,ge=new o.c1;ge.resize(ue),ge._trim();for(let he=0;he<ue;he++){const ye=6*he;ge.uint16[ye+0]=4*he+0,ge.uint16[ye+1]=4*he+1,ge.uint16[ye+2]=4*he+2,ge.uint16[ye+3]=4*he+2,ge.uint16[ye+4]=4*he+3,ge.uint16[ye+5]=4*he+0}return ge})(O));const se=y.createIndexBuffer(Ir,!0),ae=y.createVertexBuffer(G,o.c0.members,!0);for(const oe of k){const ue=Nl(m.transform);j.draw(y,A.TRIANGLES,ii.disabled,Ci.disabled,m.colorModeForRenderPass(),Yt.disabled,ue,m.style.map.terrain&&m.style.map.terrain.getTerrainData(oe.coord),null,a.id,ae,se,o.aM.simpleSegment(0,2*oe.circleOffset,oe.circleArray.length,oe.circleArray.length/2),null,m.transform.zoom,null,null,null)}ae.destroy(),se.destroy()}const Vu=o.ag(new Float32Array(16));function po(m,e,a,c,f,y){const{horizontalAlign:w,verticalAlign:A}=o.aH(m);return new o.P((-(w-.5)*e/f+c[0])*y,(-(A-.5)*a/f+c[1])*y)}function Jh(m,e,a,c,f,y){const w=e.tileAnchorPoint.add(new o.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let A=c.mult(y);a||(A=A.rotate(-f));const P=w.add(A);return fn(P.x,P.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(a){const A=Zn(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(m),P=Math.atan(A.y/A.x)+(A.x<0?Math.PI:0);return m.add(c.rotate(P))}return m.add(c)}function Yc(m,e,a,c,f,y,w,A,P,k,O,F){const j=m.text.placedSymbolArray,G=m.text.dynamicLayoutVertexArray,X=m.icon.dynamicLayoutVertexArray,se={};G.clear();for(let ae=0;ae<j.length;ae++){const oe=j.get(ae),ue=oe.hidden||!oe.crossTileID||m.allowVerticalPlacement&&!oe.placedOrientation?null:c[oe.crossTileID];if(ue){const ge=new o.P(oe.anchorX,oe.anchorY),he={getElevation:F,width:f.width,height:f.height,pitchedLabelPlaneMatrix:y,pitchWithMap:a,transform:f,tileAnchorPoint:ge,translation:k,unwrappedTileID:O},ye=a?pn(ge.x,ge.y,he):Zn(ge.x,ge.y,he),Te=pt(f.cameraToCenterDistance,ye.signedDistanceFromCamera);let fe=o.ap(m.textSizeData,A,oe)*Te/o.aB;a&&(fe*=m.tilePixelRatio/w);const{width:Re,height:$e,anchor:Ne,textOffset:Fe,textBoxScale:Ze}=ue,mt=po(Ne,Re,$e,Fe,Ze,fe),_t=f.getPitchedTextCorrection(ge.x+k[0],ge.y+k[1],O),st=Jh(ye.point,he,e,mt,-f.bearingInRadians,_t),Dt=m.allowVerticalPlacement&&oe.placedOrientation===o.ao.vertical?Math.PI/2:0;for(let hi=0;hi<oe.numGlyphs;hi++)o.av(G,st,Dt);P&&oe.associatedIconIndex>=0&&(se[oe.associatedIconIndex]={shiftedAnchor:st,angle:Dt})}else us(oe.numGlyphs,G)}if(P){X.clear();const ae=m.icon.placedSymbolArray;for(let oe=0;oe<ae.length;oe++){const ue=ae.get(oe);if(ue.hidden)us(ue.numGlyphs,X);else{const ge=se[oe];if(ge)for(let he=0;he<ue.numGlyphs;he++)o.av(X,ge.shiftedAnchor,ge.angle);else us(ue.numGlyphs,X)}}m.icon.dynamicLayoutVertexBuffer.updateData(X)}m.text.dynamicLayoutVertexBuffer.updateData(G)}function Os(m,e,a){return a.iconsInText&&e?"symbolTextAndIcon":m?"symbolSDF":"symbolIcon"}function vs(m,e,a,c,f,y,w,A,P,k,O,F,j){const G=m.context,X=G.gl,se=m.transform,ae=A==="map",oe=P==="map",ue=A!=="viewport"&&a.layout.get("symbol-placement")!=="point",ge=ae&&!oe&&!ue,he=!a.layout.get("symbol-sort-key").isConstant();let ye=!1;const Te=m.getDepthModeForSublayer(0,ii.ReadOnly),fe=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Re=[],$e=se.getCircleRadiusCorrection();for(const Ne of c){const Fe=e.getTile(Ne),Ze=Fe.getBucket(a);if(!Ze)continue;const mt=f?Ze.text:Ze.icon;if(!mt||!mt.segments.get().length||!mt.hasVisibleVertices)continue;const _t=mt.programConfigurations.get(a.id),st=f||Ze.sdfIcons,Dt=f?Ze.textSizeData:Ze.iconSizeData,hi=oe||se.pitch!==0,Ri=m.useProgram(Os(st,f,Ze),_t),qi=o.an(Dt,se.zoom),Fi=m.style.map.terrain&&m.style.map.terrain.getTerrainData(Ne);let bn,gn,oi,$i,Ln=[0,0],Jn=null;if(f)gn=Fe.glyphAtlasTexture,oi=X.LINEAR,bn=Fe.glyphAtlasTexture.size,Ze.iconsInText&&(Ln=Fe.imageAtlasTexture.size,Jn=Fe.imageAtlasTexture,$i=hi||m.options.rotating||m.options.zooming||Dt.kind==="composite"||Dt.kind==="camera"?X.LINEAR:X.NEAREST);else{const _n=a.layout.get("icon-size").constantOr(0)!==1||Ze.iconsNeedLinear;gn=Fe.imageAtlasTexture,oi=st||m.options.rotating||m.options.zooming||_n||hi?X.LINEAR:X.NEAREST,bn=Fe.imageAtlasTexture.size}const ar=o.aC(Fe,1,m.transform.zoom),Xr=en(ae,m.transform,ar),Ja=o.L();o.aq(Ja,Xr);const $s=Wt(oe,ae,m.transform,ar),Ia=o.aD(se,Fe,y,w),So=se.getProjectionData({overscaledTileID:Ne,applyGlobeMatrix:!j,applyTerrainMatrix:!0}),Hs=fe&&Ze.hasTextData(),To=a.layout.get("icon-text-fit")!=="none"&&Hs&&Ze.hasIconData();if(ue){const _n=m.style.map.terrain?(Yr,wn)=>m.style.map.terrain.getElevation(Ne,Yr,wn):null,An=a.layout.get("text-rotation-alignment")==="map";Cn(Ze,m,f,Xr,Ja,oe,k,An,Ne.toUnwrapped(),se.width,se.height,Ia,_n)}const Co=f&&fe||To,xr=ue||Co?Vu:oe?Xr:m.transform.clipSpaceToPixelsMatrix,Da=st&&a.paint.get(f?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let jr;jr=st?Ze.iconsInText?Ap(Dt.kind,qi,ge,oe,ue,Co,m,xr,$s,Ia,bn,Ln,$e):af(Dt.kind,qi,ge,oe,ue,Co,m,xr,$s,Ia,f,bn,0,$e):Ul(Dt.kind,qi,ge,oe,ue,Co,m,xr,$s,Ia,f,bn,$e);const Eo={program:Ri,buffers:mt,uniformValues:jr,projectionData:So,atlasTexture:gn,atlasTextureIcon:Jn,atlasInterpolation:oi,atlasInterpolationIcon:$i,isSDF:st,hasHalo:Da};if(he&&Ze.canOverlap){ye=!0;const _n=mt.segments.get();for(const An of _n)Re.push({segments:new o.aM([An]),sortKey:An.sortKey,state:Eo,terrainData:Fi})}else Re.push({segments:mt.segments,sortKey:0,state:Eo,terrainData:Fi})}ye&&Re.sort(((Ne,Fe)=>Ne.sortKey-Fe.sortKey));for(const Ne of Re){const Fe=Ne.state;if(G.activeTexture.set(X.TEXTURE0),Fe.atlasTexture.bind(Fe.atlasInterpolation,X.CLAMP_TO_EDGE),Fe.atlasTextureIcon&&(G.activeTexture.set(X.TEXTURE1),Fe.atlasTextureIcon&&Fe.atlasTextureIcon.bind(Fe.atlasInterpolationIcon,X.CLAMP_TO_EDGE)),Fe.isSDF){const Ze=Fe.uniformValues;Fe.hasHalo&&(Ze.u_is_halo=1,mo(Fe.buffers,Ne.segments,a,m,Fe.program,Te,O,F,Ze,Fe.projectionData,Ne.terrainData)),Ze.u_is_halo=0}mo(Fe.buffers,Ne.segments,a,m,Fe.program,Te,O,F,Fe.uniformValues,Fe.projectionData,Ne.terrainData)}}function mo(m,e,a,c,f,y,w,A,P,k,O){const F=c.context;f.draw(F,F.gl.TRIANGLES,y,w,A,Yt.backCCW,P,O,k,a.id,m.layoutVertexBuffer,m.indexBuffer,e,a.paint,c.transform.zoom,m.programConfigurations.get(a.id),m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer)}function ql(m,e,a,c,f){const y=m.context,w=y.gl,A=Ci.disabled,P=new tn([w.ONE,w.ONE],o.bf.transparent,[!0,!0,!0,!0]),k=e.getBucket(a);if(!k)return;const O=c.key;let F=a.heatmapFbos.get(O);F||(F=Dr(y,e.tileSize,e.tileSize),a.heatmapFbos.set(O,F)),y.bindFramebuffer.set(F.framebuffer),y.viewport.set([0,0,e.tileSize,e.tileSize]),y.clear({color:o.bf.transparent});const j=k.programConfigurations.get(a.id),G=m.useProgram("heatmap",j,!f),X=m.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),se=m.style.map.terrain.getTerrainData(c);G.draw(y,w.TRIANGLES,ii.disabled,A,P,Yt.disabled,tf(e,m.transform.zoom,a.paint.get("heatmap-intensity"),1),se,X,a.id,k.layoutVertexBuffer,k.indexBuffer,k.segments,a.paint,m.transform.zoom,j)}function fa(m,e,a,c,f){const y=m.context,w=y.gl,A=m.transform;y.setColorMode(m.colorModeForRenderPass());const P=Ha(y,e),k=a.key,O=e.heatmapFbos.get(k);if(!O)return;y.activeTexture.set(w.TEXTURE0),w.bindTexture(w.TEXTURE_2D,O.colorAttachment.get()),y.activeTexture.set(w.TEXTURE1),P.bind(w.LINEAR,w.CLAMP_TO_EDGE);const F=A.getProjectionData({overscaledTileID:a,applyTerrainMatrix:f,applyGlobeMatrix:!c});m.useProgram("heatmapTexture").draw(y,w.TRIANGLES,ii.disabled,Ci.disabled,m.colorModeForRenderPass(),Yt.disabled,qh(m,e,0,1),null,F,e.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments,e.paint,A.zoom),O.destroy(),e.heatmapFbos.delete(k)}function Dr(m,e,a){var c,f;const y=m.gl,w=y.createTexture();y.bindTexture(y.TEXTURE_2D,w),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,y.LINEAR),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,y.LINEAR);const A=(c=m.HALF_FLOAT)!==null&&c!==void 0?c:y.UNSIGNED_BYTE,P=(f=m.RGBA16F)!==null&&f!==void 0?f:y.RGBA;y.texImage2D(y.TEXTURE_2D,0,P,e,a,0,y.RGBA,A,null);const k=m.createFramebuffer(e,a,!1,!1);return k.colorAttachment.set(w),k}function Ha(m,e){return e.colorRampTexture||(e.colorRampTexture=new o.T(m,e.colorRamp,m.gl.RGBA)),e.colorRampTexture}function pa(m,e,a,c,f){if(!a||!c||!c.imageAtlas)return;const y=c.imageAtlas.patternPositions;let w=y[a.to.toString()],A=y[a.from.toString()];if(!w&&A&&(w=A),!A&&w&&(A=w),!w||!A){const P=f.getPaintProperty(e);w=y[P],A=y[P]}w&&A&&m.setConstantPatternPositions(w,A)}function Ma(m,e,a,c,f,y,w,A){const P=m.context.gl,k="fill-pattern",O=a.paint.get(k),F=O&&O.constantOr(1),j=a.getCrossfadeParameters();let G,X,se,ae,oe;const ue=m.transform,ge=a.paint.get("fill-translate"),he=a.paint.get("fill-translate-anchor");w?(X=F&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",G=P.LINES):(X=F?"fillPattern":"fill",G=P.TRIANGLES);const ye=O.constantOr(null);for(const Te of c){const fe=e.getTile(Te);if(F&&!fe.patternsLoaded())continue;const Re=fe.getBucket(a);if(!Re)continue;const $e=Re.programConfigurations.get(a.id),Ne=m.useProgram(X,$e),Fe=m.style.map.terrain&&m.style.map.terrain.getTerrainData(Te);F&&(m.context.activeTexture.set(P.TEXTURE0),fe.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),$e.updatePaintBuffers(j)),pa($e,k,ye,fe,a);const Ze=ue.getProjectionData({overscaledTileID:Te,applyGlobeMatrix:!A,applyTerrainMatrix:!0}),mt=o.aD(ue,fe,ge,he);if(w){ae=Re.indexBuffer2,oe=Re.segments2;const st=[P.drawingBufferWidth,P.drawingBufferHeight];se=X==="fillOutlinePattern"&&F?Bl(m,j,fe,st,mt):Ol(st,mt)}else ae=Re.indexBuffer,oe=Re.segments,se=F?Oc(m,j,fe,mt):{u_fill_translate:mt};const _t=m.stencilModeForClipping(Te);Ne.draw(m.context,G,f,_t,y,Yt.backCCW,se,Fe,Ze,a.id,Re.layoutVertexBuffer,ae,oe,a.paint,m.transform.zoom,$e)}}function Bs(m,e,a,c,f,y,w,A){const P=m.context,k=P.gl,O="fill-extrusion-pattern",F=a.paint.get(O),j=F.constantOr(1),G=a.getCrossfadeParameters(),X=a.paint.get("fill-extrusion-opacity"),se=F.constantOr(null),ae=m.transform;for(const oe of c){const ue=e.getTile(oe),ge=ue.getBucket(a);if(!ge)continue;const he=m.style.map.terrain&&m.style.map.terrain.getTerrainData(oe),ye=ge.programConfigurations.get(a.id),Te=m.useProgram(j?"fillExtrusionPattern":"fillExtrusion",ye);j&&(m.context.activeTexture.set(k.TEXTURE0),ue.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),ye.updatePaintBuffers(G));const fe=ae.getProjectionData({overscaledTileID:oe,applyGlobeMatrix:!A,applyTerrainMatrix:!0});pa(ye,O,se,ue,a);const Re=o.aD(ae,ue,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),$e=a.paint.get("fill-extrusion-vertical-gradient"),Ne=j?Mp(m,$e,X,Re,oe,G,ue):Gr(m,$e,X,Re);Te.draw(P,P.gl.TRIANGLES,f,y,w,Yt.backCCW,Ne,he,fe,a.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segments,a.paint,m.transform.zoom,ye,m.style.map.terrain&&ge.centroidVertexBuffer)}}function go(m,e,a,c,f,y,w,A,P){var k;const O=m.style.projection,F=m.context,j=m.transform,G=F.gl,X=[`#define NUM_ILLUMINATION_SOURCES ${a.paint.get("hillshade-highlight-color").values.length}`],se=m.useProgram("hillshade",null,!1,X),ae=!m.options.moving;for(const oe of c){const ue=e.getTile(oe),ge=ue.fbo;if(!ge)continue;const he=O.getMeshFromTileID(F,oe.canonical,A,!0,"raster"),ye=(k=m.style.map.terrain)===null||k===void 0?void 0:k.getTerrainData(oe);F.activeTexture.set(G.TEXTURE0),G.bindTexture(G.TEXTURE_2D,ge.colorAttachment.get());const Te=j.getProjectionData({overscaledTileID:oe,aligned:ae,applyGlobeMatrix:!P,applyTerrainMatrix:!0});se.draw(F,G.TRIANGLES,y,f[oe.overscaledZ],w,Yt.backCCW,nf(m,ue,a),ye,Te,a.id,he.vertexBuffer,he.indexBuffer,he.segments)}}function Wc(m,e,a,c,f,y,w,A,P){var k;const O=m.style.projection,F=m.context,j=m.transform,G=F.gl,X=m.useProgram("colorRelief"),se=!m.options.moving;let ae=!0,oe=0;for(const ue of c){const ge=e.getTile(ue),he=ge.dem;if(ae){const Ne=G.getParameter(G.MAX_TEXTURE_SIZE),{elevationTexture:Fe,colorTexture:Ze}=a.getColorRampTextures(F,Ne,he.getUnpackVector());F.activeTexture.set(G.TEXTURE1),Fe.bind(G.NEAREST,G.CLAMP_TO_EDGE),F.activeTexture.set(G.TEXTURE4),Ze.bind(G.LINEAR,G.CLAMP_TO_EDGE),ae=!1,oe=Fe.size[0]}if(!he||!he.data)continue;const ye=he.stride,Te=he.getPixels();if(F.activeTexture.set(G.TEXTURE0),F.pixelStoreUnpackPremultiplyAlpha.set(!1),ge.demTexture=ge.demTexture||m.getTileTexture(ye),ge.demTexture){const Ne=ge.demTexture;Ne.update(Te,{premultiply:!1}),Ne.bind(G.LINEAR,G.CLAMP_TO_EDGE)}else ge.demTexture=new o.T(F,Te,G.RGBA,{premultiply:!1}),ge.demTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE);const fe=O.getMeshFromTileID(F,ue.canonical,A,!0,"raster"),Re=(k=m.style.map.terrain)===null||k===void 0?void 0:k.getTerrainData(ue),$e=j.getProjectionData({overscaledTileID:ue,aligned:se,applyGlobeMatrix:!P,applyTerrainMatrix:!0});X.draw(F,G.TRIANGLES,y,f[ue.overscaledZ],w,Yt.backCCW,jl(a,ge.dem,oe),Re,$e,a.id,fe.vertexBuffer,fe.indexBuffer,fe.segments)}}const $l=[new o.P(0,0),new o.P(o.$,0),new o.P(o.$,o.$),new o.P(0,o.$)];function $n(m,e,a,c,f,y,w,A,P=!1,k=!1){const O=c[c.length-1].overscaledZ,F=m.context,j=F.gl,G=m.useProgram("raster"),X=m.transform,se=m.style.projection,ae=m.colorModeForRenderPass(),oe=!m.options.moving;for(const ue of c){const ge=m.getDepthModeForSublayer(ue.overscaledZ-O,a.paint.get("raster-opacity")===1?ii.ReadWrite:ii.ReadOnly,j.LESS),he=e.getTile(ue);he.registerFadeDuration(a.paint.get("raster-fade-duration"));const ye=e.findLoadedParent(ue,0),Te=e.findLoadedSibling(ue),fe=vn(he,ye||Te||null,e,a,m.transform,m.style.map.terrain);let Re,$e;const Ne=a.paint.get("raster-resampling")==="nearest"?j.NEAREST:j.LINEAR;F.activeTexture.set(j.TEXTURE0),he.texture.bind(Ne,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),F.activeTexture.set(j.TEXTURE1),ye?(ye.texture.bind(Ne,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),Re=Math.pow(2,ye.tileID.overscaledZ-he.tileID.overscaledZ),$e=[he.tileID.canonical.x*Re%1,he.tileID.canonical.y*Re%1]):he.texture.bind(Ne,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),he.texture.useMipmap&&F.extTextureFilterAnisotropic&&m.transform.pitch>20&&j.texParameterf(j.TEXTURE_2D,F.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,F.extTextureFilterAnisotropicMax);const Fe=m.style.map.terrain&&m.style.map.terrain.getTerrainData(ue),Ze=X.getProjectionData({overscaledTileID:ue,aligned:oe,applyGlobeMatrix:!k,applyTerrainMatrix:!0}),mt=Fl($e||[0,0],Re||1,fe,a,A),_t=se.getMeshFromTileID(F,ue.canonical,y,w,"raster");G.draw(F,j.TRIANGLES,ge,f?f[ue.overscaledZ]:Ci.disabled,ae,P?Yt.frontCCW:Yt.backCCW,mt,Fe,Ze,a.id,_t.vertexBuffer,_t.indexBuffer,_t.segments)}}function vn(m,e,a,c,f,y){const w=c.paint.get("raster-fade-duration");if(!y&&w>0){const A=ee.now(),P=(A-m.timeAdded)/w,k=e?(A-e.timeAdded)/w:-1,O=a.getSource(),F=It(f,{tileSize:O.tileSize,roundZoom:O.roundZoom}),j=!e||Math.abs(e.tileID.overscaledZ-F)>Math.abs(m.tileID.overscaledZ-F),G=j&&m.refreshedUponExpiration?1:o.ah(j?P:1-k,0,1);return m.refreshedUponExpiration&&P>=1&&(m.refreshedUponExpiration=!1),e?{opacity:1,mix:1-G}:{opacity:G,mix:0}}return{opacity:1,mix:0}}const Oi=new o.bf(1,0,0,1),_o=new o.bf(0,1,0,1),ma=new o.bf(0,0,1,1),Kc=new o.bf(1,0,1,1),sl=new o.bf(0,1,1,1);function Gu(m,e,a,c){na(m,0,e+a/2,m.transform.width,a,c)}function xn(m,e,a,c){na(m,e-a/2,0,a,m.transform.height,c)}function na(m,e,a,c,f,y){const w=m.context,A=w.gl;A.enable(A.SCISSOR_TEST),A.scissor(e*m.pixelRatio,a*m.pixelRatio,c*m.pixelRatio,f*m.pixelRatio),w.clear({color:y}),A.disable(A.SCISSOR_TEST)}function kr(m,e,a){const c=m.context,f=c.gl,y=m.useProgram("debug"),w=ii.disabled,A=Ci.disabled,P=m.colorModeForRenderPass(),k="$debug",O=m.style.map.terrain&&m.style.map.terrain.getTerrainData(a);c.activeTexture.set(f.TEXTURE0);const F=e.getTileByID(a.key).latestRawTileData,j=Math.floor((F&&F.byteLength||0)/1024),G=e.getTile(a).tileSize,X=512/Math.min(G,512)*(a.overscaledZ/m.transform.zoom)*.5;let se=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(se+=` => ${a.overscaledZ}`),(function(oe,ue){oe.initDebugOverlayCanvas();const ge=oe.debugOverlayCanvas,he=oe.context.gl,ye=oe.debugOverlayCanvas.getContext("2d");ye.clearRect(0,0,ge.width,ge.height),ye.shadowColor="white",ye.shadowBlur=2,ye.lineWidth=1.5,ye.strokeStyle="white",ye.textBaseline="top",ye.font="bold 36px Open Sans, sans-serif",ye.fillText(ue,5,5),ye.strokeText(ue,5,5),oe.debugOverlayTexture.update(ge),oe.debugOverlayTexture.bind(he.LINEAR,he.CLAMP_TO_EDGE)})(m,`${se} ${j}kB`);const ae=m.transform.getProjectionData({overscaledTileID:a,applyGlobeMatrix:!0,applyTerrainMatrix:!0});y.draw(c,f.TRIANGLES,w,A,tn.alphaBlended,Yt.disabled,Qo(o.bf.transparent,X),null,ae,k,m.debugBuffer,m.quadTriangleIndexBuffer,m.debugSegments),y.draw(c,f.LINE_STRIP,w,A,P,Yt.disabled,Qo(o.bf.red),O,ae,k,m.debugBuffer,m.tileBorderIndexBuffer,m.debugSegments)}function Qc(m,e,a,c){const{isRenderingGlobe:f}=c,y=m.context,w=y.gl,A=m.transform,P=m.colorModeForRenderPass(),k=m.getDepthModeFor3D(),O=m.useProgram("terrain");y.bindFramebuffer.set(null),y.viewport.set([0,0,m.width,m.height]);for(const F of a){const j=e.getTerrainMesh(F.tileID),G=m.renderToTexture.getTexture(F),X=e.getTerrainData(F.tileID);y.activeTexture.set(w.TEXTURE0),w.bindTexture(w.TEXTURE_2D,G.texture);const se=e.getMeshFrameDelta(A.zoom),ae=A.calculateFogMatrix(F.tileID.toUnwrapped()),oe=Lu(se,ae,m.style.sky,A.pitch,f),ue=A.getProjectionData({overscaledTileID:F.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});O.draw(y,w.TRIANGLES,k,Ci.disabled,P,Yt.backCCW,oe,X,ue,"terrain",j.vertexBuffer,j.indexBuffer,j.segments)}}function Ns(m,e){if(!e.mesh){const a=new o.aL;a.emplaceBack(-1,-1),a.emplaceBack(1,-1),a.emplaceBack(1,1),a.emplaceBack(-1,1);const c=new o.aN;c.emplaceBack(0,1,2),c.emplaceBack(0,2,3),e.mesh=new ao(m.createVertexBuffer(a,ps.members),m.createIndexBuffer(c),o.aM.simpleSegment(0,0,a.length,c.length))}return e.mesh}class Zu{constructor(e,a){this.context=new Uu(e),this.transform=a,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.ag(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=_i.maxUnderzooming+_i.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Zo}resize(e,a,c){if(this.width=Math.floor(e*c),this.height=Math.floor(a*c),this.pixelRatio=c,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const f of this.style._order)this.style._layers[f].resize()}setup(){const e=this.context,a=new o.aL;a.emplaceBack(0,0),a.emplaceBack(o.$,0),a.emplaceBack(0,o.$),a.emplaceBack(o.$,o.$),this.tileExtentBuffer=e.createVertexBuffer(a,ps.members),this.tileExtentSegments=o.aM.simpleSegment(0,0,4,2);const c=new o.aL;c.emplaceBack(0,0),c.emplaceBack(o.$,0),c.emplaceBack(0,o.$),c.emplaceBack(o.$,o.$),this.debugBuffer=e.createVertexBuffer(c,ps.members),this.debugSegments=o.aM.simpleSegment(0,0,4,5);const f=new o.c6;f.emplaceBack(0,0,0,0),f.emplaceBack(o.$,0,o.$,0),f.emplaceBack(0,o.$,0,o.$),f.emplaceBack(o.$,o.$,o.$,o.$),this.rasterBoundsBuffer=e.createVertexBuffer(f,Cp.members),this.rasterBoundsSegments=o.aM.simpleSegment(0,0,4,2);const y=new o.aL;y.emplaceBack(0,0),y.emplaceBack(o.$,0),y.emplaceBack(0,o.$),y.emplaceBack(o.$,o.$),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(y,ps.members),this.rasterBoundsSegmentsPosOnly=o.aM.simpleSegment(0,0,4,5);const w=new o.aL;w.emplaceBack(0,0),w.emplaceBack(1,0),w.emplaceBack(0,1),w.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(w,ps.members),this.viewportSegments=o.aM.simpleSegment(0,0,4,2);const A=new o.c7;A.emplaceBack(0),A.emplaceBack(1),A.emplaceBack(3),A.emplaceBack(2),A.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(A);const P=new o.aN;P.emplaceBack(1,0,2),P.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(P);const k=this.context.gl;this.stencilClearMode=new Ci({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO),this.tileExtentMesh=new ao(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,a=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const c=o.L();o.bY(c,0,this.width,this.height,0,0,1),o.N(c,c,[a.drawingBufferWidth,a.drawingBufferHeight,0]);const f={mainMatrix:c,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:c};this.useProgram("clippingMask",null,!0).draw(e,a.TRIANGLES,ii.disabled,this.stencilClearMode,tn.disabled,Yt.disabled,null,null,f,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,a,c){if(this.currentStencilSource===e.source||!e.isTileClipped()||!a||!a.length)return;this.currentStencilSource=e.source,this.nextStencilID+a.length>256&&this.clearStencil();const f=this.context;f.setColorMode(tn.disabled),f.setDepthMode(ii.disabled);const y={};for(const w of a)y[w.key]=this.nextStencilID++;this._renderTileMasks(y,a,c,!0),this._renderTileMasks(y,a,c,!1),this._tileClippingMaskIDs=y}_renderTileMasks(e,a,c,f){const y=this.context,w=y.gl,A=this.style.projection,P=this.transform,k=this.useProgram("clippingMask");for(const O of a){const F=e[O.key],j=this.style.map.terrain&&this.style.map.terrain.getTerrainData(O),G=A.getMeshFromTileID(this.context,O.canonical,f,!0,"stencil"),X=P.getProjectionData({overscaledTileID:O,applyGlobeMatrix:!c,applyTerrainMatrix:!0});k.draw(y,w.TRIANGLES,ii.disabled,new Ci({func:w.ALWAYS,mask:0},F,255,w.KEEP,w.KEEP,w.REPLACE),tn.disabled,c?Yt.disabled:Yt.backCCW,null,j,X,"$clipping",G.vertexBuffer,G.indexBuffer,G.segments)}}_renderTilesDepthBuffer(){const e=this.context,a=e.gl,c=this.style.projection,f=this.transform,y=this.useProgram("depth"),w=this.getDepthModeFor3D(),A=Ie(f,{tileSize:f.tileSize});for(const P of A){const k=this.style.map.terrain&&this.style.map.terrain.getTerrainData(P),O=c.getMeshFromTileID(this.context,P.canonical,!0,!0,"raster"),F=f.getProjectionData({overscaledTileID:P,applyGlobeMatrix:!0,applyTerrainMatrix:!0});y.draw(e,a.TRIANGLES,w,Ci.disabled,tn.disabled,Yt.backCCW,null,k,F,"$clipping",O.vertexBuffer,O.indexBuffer,O.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,a=this.context.gl;return new Ci({func:a.NOTEQUAL,mask:255},e,255,a.KEEP,a.KEEP,a.REPLACE)}stencilModeForClipping(e){const a=this.context.gl;return new Ci({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,a.KEEP,a.KEEP,a.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const a=this.context.gl,c=e.sort(((w,A)=>A.overscaledZ-w.overscaledZ)),f=c[c.length-1].overscaledZ,y=c[0].overscaledZ-f+1;if(y>1){this.currentStencilSource=void 0,this.nextStencilID+y>256&&this.clearStencil();const w={};for(let A=0;A<y;A++)w[A+f]=new Ci({func:a.GEQUAL,mask:255},A+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=y,[w,c]}return[{[f]:Ci.disabled},c]}stencilConfigForOverlapTwoPass(e){const a=this.context.gl,c=e.sort(((w,A)=>A.overscaledZ-w.overscaledZ)),f=c[c.length-1].overscaledZ,y=c[0].overscaledZ-f+1;if(this.clearStencil(),y>1){const w={},A={};for(let P=0;P<y;P++)w[P+f]=new Ci({func:a.GREATER,mask:255},y+1+P,255,a.KEEP,a.KEEP,a.REPLACE),A[P+f]=new Ci({func:a.GREATER,mask:255},1+P,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID=2*y+1,[w,A,c]}return this.nextStencilID=3,[{[f]:new Ci({func:a.GREATER,mask:255},2,255,a.KEEP,a.KEEP,a.REPLACE)},{[f]:new Ci({func:a.GREATER,mask:255},1,255,a.KEEP,a.KEEP,a.REPLACE)},c]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new tn([e.CONSTANT_COLOR,e.ONE],new o.bf(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?tn.unblended:tn.alphaBlended}getDepthModeForSublayer(e,a,c){if(!this.opaquePassEnabledForLayer())return ii.disabled;const f=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new ii(c||this.context.gl.LEQUAL,a,[f,f])}getDepthModeFor3D(){return new ii(this.context.gl.LEQUAL,ii.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,a){var c,f;this.style=e,this.options=a,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(ee.now()),this.imageManager.beginFrame();const y=this.style._order,w=this.style.sourceCaches,A={},P={},k={},O={isRenderingToTexture:!1,isRenderingGlobe:((c=e.projection)===null||c===void 0?void 0:c.transitionState)>0};for(const j in w){const G=w[j];G.used&&G.prepare(this.context),A[j]=G.getVisibleCoordinates(!1),P[j]=A[j].slice().reverse(),k[j]=G.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let j=0;j<y.length;j++)if(this.style._layers[y[j]].is3D()){this.opaquePassCutoff=j;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const j of y){const G=this.style._layers[j];if(!G.hasOffscreenPass()||G.isHidden(this.transform.zoom))continue;const X=P[G.source];(G.type==="custom"||X.length)&&this.renderLayer(this,w[G.source],G,X,O)}if((f=this.style.projection)===null||f===void 0||f.updateGPUdependent({context:this.context,useProgram:j=>this.useProgram(j)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?o.bf.black:o.bf.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(j,G){const X=j.context,se=X.gl,ae=((Te,fe,Re)=>{const $e=Math.cos(fe.rollInRadians),Ne=Math.sin(fe.rollInRadians),Fe=we(fe),Ze=fe.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:Te.properties.get("sky-color"),u_horizon_color:Te.properties.get("horizon-color"),u_horizon:[(fe.width/2-Fe*Ne)*Re,(fe.height/2+Fe*$e)*Re],u_horizon_normal:[-Ne,$e],u_sky_horizon_blend:Te.properties.get("sky-horizon-blend")*fe.height/2*Re,u_sky_blend:Ze}})(G,j.style.map.transform,j.pixelRatio),oe=new ii(se.LEQUAL,ii.ReadWrite,[0,1]),ue=Ci.disabled,ge=j.colorModeForRenderPass(),he=j.useProgram("sky"),ye=Ns(X,G);he.draw(X,se.TRIANGLES,oe,ue,ge,Yt.disabled,ae,null,void 0,"sky",ye.vertexBuffer,ye.indexBuffer,ye.segments)})(this,this.style.sky),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=y.length-1;this.currentLayer>=0;this.currentLayer--){const j=this.style._layers[y[this.currentLayer]],G=w[j.source],X=A[j.source];this._renderTileClippingMasks(j,X,!1),this.renderLayer(this,G,j,X,O)}this.renderPass="translucent";let F=!1;for(this.currentLayer=0;this.currentLayer<y.length;this.currentLayer++){const j=this.style._layers[y[this.currentLayer]],G=w[j.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(j,O))continue;this.opaquePassEnabledForLayer()||F||(F=!0,O.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const X=(j.type==="symbol"?k:P)[j.source];this._renderTileClippingMasks(j,A[j.source],!!this.renderToTexture),this.renderLayer(this,G,j,X,O)}if(O.isRenderingGlobe&&(function(j,G,X){const se=j.context,ae=se.gl,oe=j.useProgram("atmosphere"),ue=new ii(ae.LEQUAL,ii.ReadOnly,[0,1]),ge=j.transform,he=(function(Ze,mt){const _t=Ze.properties.get("position"),st=[-_t.x,-_t.y,-_t.z],Dt=o.ag(new Float64Array(16));return Ze.properties.get("anchor")==="map"&&(o.b6(Dt,Dt,mt.rollInRadians),o.b7(Dt,Dt,-mt.pitchInRadians),o.b6(Dt,Dt,mt.bearingInRadians),o.b7(Dt,Dt,mt.center.lat*Math.PI/180),o.bz(Dt,Dt,-mt.center.lng*Math.PI/180)),o.c5(st,st,Dt),st})(X,j.transform),ye=ge.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Te=G.properties.get("atmosphere-blend")*ye.projectionTransition;if(Te===0)return;const fe=Dl(ge.worldSize,ge.center.lat),Re=ge.inverseProjectionMatrix,$e=new Float64Array(4);$e[3]=1,o.aw($e,$e,ge.modelViewProjectionMatrix),$e[0]/=$e[3],$e[1]/=$e[3],$e[2]/=$e[3],$e[3]=1,o.aw($e,$e,Re),$e[0]/=$e[3],$e[1]/=$e[3],$e[2]/=$e[3],$e[3]=1;const Ne=((Ze,mt,_t,st,Dt)=>({u_sun_pos:Ze,u_atmosphere_blend:mt,u_globe_position:_t,u_globe_radius:st,u_inv_proj_matrix:Dt}))(he,Te,[$e[0],$e[1],$e[2]],fe,Re),Fe=Ns(se,G);oe.draw(se,ae.TRIANGLES,ue,Ci.disabled,tn.alphaBlended,Yt.disabled,Ne,null,null,"atmosphere",Fe.vertexBuffer,Fe.indexBuffer,Fe.segments)})(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const j=(function(G,X){let se=null;const ae=Object.values(G._layers).flatMap((he=>he.source&&!he.isHidden(X)?[G.sourceCaches[he.source]]:[])),oe=ae.filter((he=>he.getSource().type==="vector")),ue=ae.filter((he=>he.getSource().type!=="vector")),ge=he=>{(!se||se.getSource().maxzoom<he.getSource().maxzoom)&&(se=he)};return oe.forEach((he=>ge(he))),se||ue.forEach((he=>ge(he))),se})(this.style,this.transform.zoom);j&&(function(G,X,se){for(let ae=0;ae<se.length;ae++)kr(G,X,se[ae])})(this,j,j.getVisibleCoordinates())}this.options.showPadding&&(function(j){const G=j.transform.padding;Gu(j,j.transform.height-(G.top||0),3,Oi),Gu(j,G.bottom||0,3,_o),xn(j,G.left||0,3,ma),xn(j,j.transform.width-(G.right||0),3,Kc);const X=j.transform.centerPoint;(function(se,ae,oe,ue){na(se,ae-1,oe-10,2,20,ue),na(se,ae-10,oe-1,20,2,ue)})(j,X.x,j.transform.height-X.y,sl)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const a=this.terrainFacilitator.matrix,c=this.transform.modelViewProjectionMatrix;let f=this.terrainFacilitator.dirty;f||(f=e?!o.c8(a,c):!o.c9(a,c)),f||(f=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),f&&(o.ca(a,c),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(y,w){const A=y.context,P=A.gl,k=y.transform,O=tn.unblended,F=new ii(P.LEQUAL,ii.ReadWrite,[0,1]),j=w.sourceCache.getRenderableTiles(),G=y.useProgram("terrainDepth");A.bindFramebuffer.set(w.getFramebuffer("depth").framebuffer),A.viewport.set([0,0,y.width/devicePixelRatio,y.height/devicePixelRatio]),A.clear({color:o.bf.transparent,depth:1});for(const X of j){const se=w.getTerrainMesh(X.tileID),ae=w.getTerrainData(X.tileID),oe=k.getProjectionData({overscaledTileID:X.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),ue={u_ele_delta:w.getMeshFrameDelta(k.zoom)};G.draw(A,P.TRIANGLES,F,Ci.disabled,O,Yt.backCCW,ue,ae,oe,"terrain",se.vertexBuffer,se.indexBuffer,se.segments)}A.bindFramebuffer.set(null),A.viewport.set([0,0,y.width,y.height])})(this,this.style.map.terrain),(function(y,w){const A=y.context,P=A.gl,k=y.transform,O=tn.unblended,F=new ii(P.LEQUAL,ii.ReadWrite,[0,1]),j=w.getCoordsTexture(),G=w.sourceCache.getRenderableTiles(),X=y.useProgram("terrainCoords");A.bindFramebuffer.set(w.getFramebuffer("coords").framebuffer),A.viewport.set([0,0,y.width/devicePixelRatio,y.height/devicePixelRatio]),A.clear({color:o.bf.transparent,depth:1}),w.coordsIndex=[];for(const se of G){const ae=w.getTerrainMesh(se.tileID),oe=w.getTerrainData(se.tileID);A.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,j.texture);const ue={u_terrain_coords_id:(255-w.coordsIndex.length)/255,u_texture:0,u_ele_delta:w.getMeshFrameDelta(k.zoom)},ge=k.getProjectionData({overscaledTileID:se.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});X.draw(A,P.TRIANGLES,F,Ci.disabled,O,Yt.backCCW,ue,oe,ge,"terrain",ae.vertexBuffer,ae.indexBuffer,ae.segments),w.coordsIndex.push(se.tileID.key)}A.bindFramebuffer.set(null),A.viewport.set([0,0,y.width,y.height])})(this,this.style.map.terrain))}renderLayer(e,a,c,f,y){c.isHidden(this.transform.zoom)||(c.type==="background"||c.type==="custom"||(f||[]).length)&&(this.id=c.id,o.cb(c)?(function(w,A,P,k,O,F){if(w.renderPass!=="translucent")return;const{isRenderingToTexture:j}=F,G=Ci.disabled,X=w.colorModeForRenderPass();(P._unevaluatedLayout.hasValue("text-variable-anchor")||P._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(se,ae,oe,ue,ge,he,ye,Te,fe){const Re=ae.transform,$e=ae.style.map.terrain,Ne=ge==="map",Fe=he==="map";for(const Ze of se){const mt=ue.getTile(Ze),_t=mt.getBucket(oe);if(!_t||!_t.text||!_t.text.segments.get().length)continue;const st=o.an(_t.textSizeData,Re.zoom),Dt=o.aC(mt,1,ae.transform.zoom),hi=en(Ne,ae.transform,Dt),Ri=oe.layout.get("icon-text-fit")!=="none"&&_t.hasIconData();if(st){const qi=Math.pow(2,Re.zoom-mt.tileID.overscaledZ),Fi=$e?(bn,gn)=>$e.getElevation(Ze,bn,gn):null;Yc(_t,Ne,Fe,fe,Re,hi,qi,st,Ri,o.aD(Re,mt,ye,Te),Ze.toUnwrapped(),Fi)}}})(k,w,P,A,P.layout.get("text-rotation-alignment"),P.layout.get("text-pitch-alignment"),P.paint.get("text-translate"),P.paint.get("text-translate-anchor"),O),P.paint.get("icon-opacity").constantOr(1)!==0&&vs(w,A,P,k,!1,P.paint.get("icon-translate"),P.paint.get("icon-translate-anchor"),P.layout.get("icon-rotation-alignment"),P.layout.get("icon-pitch-alignment"),P.layout.get("icon-keep-upright"),G,X,j),P.paint.get("text-opacity").constantOr(1)!==0&&vs(w,A,P,k,!0,P.paint.get("text-translate"),P.paint.get("text-translate-anchor"),P.layout.get("text-rotation-alignment"),P.layout.get("text-pitch-alignment"),P.layout.get("text-keep-upright"),G,X,j),A.map.showCollisionBoxes&&(Qh(w,A,P,k,!0),Qh(w,A,P,k,!1))})(e,a,c,f,this.style.placement.variableOffsets,y):o.cc(c)?(function(w,A,P,k,O){if(w.renderPass!=="translucent")return;const{isRenderingToTexture:F}=O,j=P.paint.get("circle-opacity"),G=P.paint.get("circle-stroke-width"),X=P.paint.get("circle-stroke-opacity"),se=!P.layout.get("circle-sort-key").isConstant();if(j.constantOr(1)===0&&(G.constantOr(1)===0||X.constantOr(1)===0))return;const ae=w.context,oe=ae.gl,ue=w.transform,ge=w.getDepthModeForSublayer(0,ii.ReadOnly),he=Ci.disabled,ye=w.colorModeForRenderPass(),Te=[],fe=ue.getCircleRadiusCorrection();for(let Re=0;Re<k.length;Re++){const $e=k[Re],Ne=A.getTile($e),Fe=Ne.getBucket(P);if(!Fe)continue;const Ze=P.paint.get("circle-translate"),mt=P.paint.get("circle-translate-anchor"),_t=o.aD(ue,Ne,Ze,mt),st=Fe.programConfigurations.get(P.id),Dt=w.useProgram("circle",st),hi=Fe.layoutVertexBuffer,Ri=Fe.indexBuffer,qi=w.style.map.terrain&&w.style.map.terrain.getTerrainData($e),Fi={programConfiguration:st,program:Dt,layoutVertexBuffer:hi,indexBuffer:Ri,uniformValues:ef(w,Ne,P,_t,fe),terrainData:qi,projectionData:ue.getProjectionData({overscaledTileID:$e,applyGlobeMatrix:!F,applyTerrainMatrix:!0})};if(se){const bn=Fe.segments.get();for(const gn of bn)Te.push({segments:new o.aM([gn]),sortKey:gn.sortKey,state:Fi})}else Te.push({segments:Fe.segments,sortKey:0,state:Fi})}se&&Te.sort(((Re,$e)=>Re.sortKey-$e.sortKey));for(const Re of Te){const{programConfiguration:$e,program:Ne,layoutVertexBuffer:Fe,indexBuffer:Ze,uniformValues:mt,terrainData:_t,projectionData:st}=Re.state;Ne.draw(ae,oe.TRIANGLES,ge,he,ye,Yt.backCCW,mt,_t,st,P.id,Fe,Ze,Re.segments,P.paint,w.transform.zoom,$e)}})(e,a,c,f,y):o.cd(c)?(function(w,A,P,k,O){if(P.paint.get("heatmap-opacity")===0)return;const F=w.context,{isRenderingToTexture:j,isRenderingGlobe:G}=O;if(w.style.map.terrain){for(const X of k){const se=A.getTile(X);A.hasRenderableParent(X)||(w.renderPass==="offscreen"?ql(w,se,P,X,G):w.renderPass==="translucent"&&fa(w,P,X,j,G))}F.viewport.set([0,0,w.width,w.height])}else w.renderPass==="offscreen"?(function(X,se,ae,oe){const ue=X.context,ge=ue.gl,he=X.transform,ye=Ci.disabled,Te=new tn([ge.ONE,ge.ONE],o.bf.transparent,[!0,!0,!0,!0]);(function(fe,Re,$e){const Ne=fe.gl;fe.activeTexture.set(Ne.TEXTURE1),fe.viewport.set([0,0,Re.width/4,Re.height/4]);let Fe=$e.heatmapFbos.get(o.c2);Fe?(Ne.bindTexture(Ne.TEXTURE_2D,Fe.colorAttachment.get()),fe.bindFramebuffer.set(Fe.framebuffer)):(Fe=Dr(fe,Re.width/4,Re.height/4),$e.heatmapFbos.set(o.c2,Fe))})(ue,X,ae),ue.clear({color:o.bf.transparent});for(let fe=0;fe<oe.length;fe++){const Re=oe[fe];if(se.hasRenderableParent(Re))continue;const $e=se.getTile(Re),Ne=$e.getBucket(ae);if(!Ne)continue;const Fe=Ne.programConfigurations.get(ae.id),Ze=X.useProgram("heatmap",Fe),mt=he.getProjectionData({overscaledTileID:Re,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),_t=he.getCircleRadiusCorrection();Ze.draw(ue,ge.TRIANGLES,ii.disabled,ye,Te,Yt.backCCW,tf($e,he.zoom,ae.paint.get("heatmap-intensity"),_t),null,mt,ae.id,Ne.layoutVertexBuffer,Ne.indexBuffer,Ne.segments,ae.paint,he.zoom,Fe)}ue.viewport.set([0,0,X.width,X.height])})(w,A,P,k):w.renderPass==="translucent"&&(function(X,se){const ae=X.context,oe=ae.gl;ae.setColorMode(X.colorModeForRenderPass());const ue=se.heatmapFbos.get(o.c2);ue&&(ae.activeTexture.set(oe.TEXTURE0),oe.bindTexture(oe.TEXTURE_2D,ue.colorAttachment.get()),ae.activeTexture.set(oe.TEXTURE1),Ha(ae,se).bind(oe.LINEAR,oe.CLAMP_TO_EDGE),X.useProgram("heatmapTexture").draw(ae,oe.TRIANGLES,ii.disabled,Ci.disabled,X.colorModeForRenderPass(),Yt.disabled,qh(X,se,0,1),null,null,se.id,X.viewportBuffer,X.quadTriangleIndexBuffer,X.viewportSegments,se.paint,X.transform.zoom))})(w,P)})(e,a,c,f,y):o.ce(c)?(function(w,A,P,k,O){if(w.renderPass!=="translucent")return;const{isRenderingToTexture:F}=O,j=P.paint.get("line-opacity"),G=P.paint.get("line-width");if(j.constantOr(1)===0||G.constantOr(1)===0)return;const X=w.getDepthModeForSublayer(0,ii.ReadOnly),se=w.colorModeForRenderPass(),ae=P.paint.get("line-dasharray"),oe=P.paint.get("line-pattern"),ue=oe.constantOr(1),ge=P.paint.get("line-gradient"),he=P.getCrossfadeParameters(),ye=ue?"linePattern":ae?"lineSDF":ge?"lineGradient":"line",Te=w.context,fe=Te.gl,Re=w.transform;let $e=!0;for(const Ne of k){const Fe=A.getTile(Ne);if(ue&&!Fe.patternsLoaded())continue;const Ze=Fe.getBucket(P);if(!Ze)continue;const mt=Ze.programConfigurations.get(P.id),_t=w.context.program.get(),st=w.useProgram(ye,mt),Dt=$e||st.program!==_t,hi=w.style.map.terrain&&w.style.map.terrain.getTerrainData(Ne),Ri=oe.constantOr(null);if(Ri&&Fe.imageAtlas){const oi=Fe.imageAtlas,$i=oi.patternPositions[Ri.to.toString()],Ln=oi.patternPositions[Ri.from.toString()];$i&&Ln&&mt.setConstantPatternPositions($i,Ln)}const qi=Re.getProjectionData({overscaledTileID:Ne,applyGlobeMatrix:!F,applyTerrainMatrix:!0}),Fi=Re.getPixelScale(),bn=ue?Hh(w,Fe,P,Fi,he):ae?co(w,Fe,P,Fi,ae,he):ge?Nc(w,Fe,P,Fi,Ze.lineClipsArray.length):Ou(w,Fe,P,Fi);if(ue)Te.activeTexture.set(fe.TEXTURE0),Fe.imageAtlasTexture.bind(fe.LINEAR,fe.CLAMP_TO_EDGE),mt.updatePaintBuffers(he);else if(ae&&(Dt||w.lineAtlas.dirty))Te.activeTexture.set(fe.TEXTURE0),w.lineAtlas.bind(Te);else if(ge){const oi=Ze.gradients[P.id];let $i=oi.texture;if(P.gradientVersion!==oi.version){let Ln=256;if(P.stepInterpolant){const Jn=A.getSource().maxzoom,ar=Ne.canonical.z===Jn?Math.ceil(1<<w.transform.maxZoom-Ne.canonical.z):1;Ln=o.ah(o.c3(Ze.maxLineLength/o.$*1024*ar),256,Te.maxTextureSize)}oi.gradient=o.c4({expression:P.gradientExpression(),evaluationKey:"lineProgress",resolution:Ln,image:oi.gradient||void 0,clips:Ze.lineClipsArray}),oi.texture?oi.texture.update(oi.gradient):oi.texture=new o.T(Te,oi.gradient,fe.RGBA),oi.version=P.gradientVersion,$i=oi.texture}Te.activeTexture.set(fe.TEXTURE0),$i.bind(P.stepInterpolant?fe.NEAREST:fe.LINEAR,fe.CLAMP_TO_EDGE)}const gn=w.stencilModeForClipping(Ne);st.draw(Te,fe.TRIANGLES,X,gn,se,Yt.disabled,bn,hi,qi,P.id,Ze.layoutVertexBuffer,Ze.indexBuffer,Ze.segments,P.paint,w.transform.zoom,mt,Ze.layoutVertexBuffer2),$e=!1}})(e,a,c,f,y):o.cf(c)?(function(w,A,P,k,O){const F=P.paint.get("fill-color"),j=P.paint.get("fill-opacity");if(j.constantOr(1)===0)return;const{isRenderingToTexture:G}=O,X=w.colorModeForRenderPass(),se=P.paint.get("fill-pattern"),ae=w.opaquePassEnabledForLayer()&&!se.constantOr(1)&&F.constantOr(o.bf.transparent).a===1&&j.constantOr(0)===1?"opaque":"translucent";if(w.renderPass===ae){const oe=w.getDepthModeForSublayer(1,w.renderPass==="opaque"?ii.ReadWrite:ii.ReadOnly);Ma(w,A,P,k,oe,X,!1,G)}if(w.renderPass==="translucent"&&P.paint.get("fill-antialias")){const oe=w.getDepthModeForSublayer(P.getPaintProperty("fill-outline-color")?2:0,ii.ReadOnly);Ma(w,A,P,k,oe,X,!0,G)}})(e,a,c,f,y):o.cg(c)?(function(w,A,P,k,O){const F=P.paint.get("fill-extrusion-opacity");if(F===0)return;const{isRenderingToTexture:j}=O;if(w.renderPass==="translucent"){const G=new ii(w.context.gl.LEQUAL,ii.ReadWrite,w.depthRangeFor3D);if(F!==1||P.paint.get("fill-extrusion-pattern").constantOr(1))Bs(w,A,P,k,G,Ci.disabled,tn.disabled,j),Bs(w,A,P,k,G,w.stencilModeFor3D(),w.colorModeForRenderPass(),j);else{const X=w.colorModeForRenderPass();Bs(w,A,P,k,G,Ci.disabled,X,j)}}})(e,a,c,f,y):o.ch(c)?(function(w,A,P,k,O){if(w.renderPass!=="offscreen"&&w.renderPass!=="translucent")return;const{isRenderingToTexture:F}=O,j=w.context,G=w.style.projection.useSubdivision,X=w.getDepthModeForSublayer(0,ii.ReadOnly),se=w.colorModeForRenderPass();if(w.renderPass==="offscreen")(function(ae,oe,ue,ge,he,ye,Te){const fe=ae.context,Re=fe.gl;for(const $e of ue){const Ne=oe.getTile($e),Fe=Ne.dem;if(!Fe||!Fe.data||!Ne.needsHillshadePrepare)continue;const Ze=Fe.dim,mt=Fe.stride,_t=Fe.getPixels();if(fe.activeTexture.set(Re.TEXTURE1),fe.pixelStoreUnpackPremultiplyAlpha.set(!1),Ne.demTexture=Ne.demTexture||ae.getTileTexture(mt),Ne.demTexture){const Dt=Ne.demTexture;Dt.update(_t,{premultiply:!1}),Dt.bind(Re.NEAREST,Re.CLAMP_TO_EDGE)}else Ne.demTexture=new o.T(fe,_t,Re.RGBA,{premultiply:!1}),Ne.demTexture.bind(Re.NEAREST,Re.CLAMP_TO_EDGE);fe.activeTexture.set(Re.TEXTURE0);let st=Ne.fbo;if(!st){const Dt=new o.T(fe,{width:Ze,height:Ze,data:null},Re.RGBA);Dt.bind(Re.LINEAR,Re.CLAMP_TO_EDGE),st=Ne.fbo=fe.createFramebuffer(Ze,Ze,!0,!1),st.colorAttachment.set(Dt.texture)}fe.bindFramebuffer.set(st.framebuffer),fe.viewport.set([0,0,Ze,Ze]),ae.useProgram("hillshadePrepare").draw(fe,Re.TRIANGLES,he,ye,Te,Yt.disabled,$h(Ne.tileID,Fe),null,null,ge.id,ae.rasterBoundsBuffer,ae.quadTriangleIndexBuffer,ae.rasterBoundsSegments),Ne.needsHillshadePrepare=!1}})(w,A,k,P,X,Ci.disabled,se),j.viewport.set([0,0,w.width,w.height]);else if(w.renderPass==="translucent")if(G){const[ae,oe,ue]=w.stencilConfigForOverlapTwoPass(k);go(w,A,P,ue,ae,X,se,!1,F),go(w,A,P,ue,oe,X,se,!0,F)}else{const[ae,oe]=w.getStencilConfigForOverlapAndUpdateStencilID(k);go(w,A,P,oe,ae,X,se,!1,F)}})(e,a,c,f,y):o.ci(c)?(function(w,A,P,k,O){if(w.renderPass!=="translucent"||!k.length)return;const{isRenderingToTexture:F}=O,j=w.style.projection.useSubdivision,G=w.getDepthModeForSublayer(0,ii.ReadOnly),X=w.colorModeForRenderPass();if(j){const[se,ae,oe]=w.stencilConfigForOverlapTwoPass(k);Wc(w,A,P,oe,se,G,X,!1,F),Wc(w,A,P,oe,ae,G,X,!0,F)}else{const[se,ae]=w.getStencilConfigForOverlapAndUpdateStencilID(k);Wc(w,A,P,ae,se,G,X,!1,F)}})(e,a,c,f,y):o.cj(c)?(function(w,A,P,k,O){if(w.renderPass!=="translucent"||P.paint.get("raster-opacity")===0||!k.length)return;const{isRenderingToTexture:F}=O,j=A.getSource(),G=w.style.projection.useSubdivision;if(j instanceof Ar)$n(w,A,P,k,null,!1,!1,j.tileCoords,j.flippedWindingOrder,F);else if(G){const[X,se,ae]=w.stencilConfigForOverlapTwoPass(k);$n(w,A,P,ae,X,!1,!0,$l,!1,F),$n(w,A,P,ae,se,!0,!0,$l,!1,F)}else{const[X,se]=w.getStencilConfigForOverlapAndUpdateStencilID(k);$n(w,A,P,se,X,!1,!0,$l,!1,F)}})(e,a,c,f,y):o.ck(c)?(function(w,A,P,k,O){const F=P.paint.get("background-color"),j=P.paint.get("background-opacity");if(j===0)return;const{isRenderingToTexture:G}=O,X=w.context,se=X.gl,ae=w.style.projection,oe=w.transform,ue=oe.tileSize,ge=P.paint.get("background-pattern");if(w.isPatternMissing(ge))return;const he=!ge&&F.a===1&&j===1&&w.opaquePassEnabledForLayer()?"opaque":"translucent";if(w.renderPass!==he)return;const ye=Ci.disabled,Te=w.getDepthModeForSublayer(0,he==="opaque"?ii.ReadWrite:ii.ReadOnly),fe=w.colorModeForRenderPass(),Re=w.useProgram(ge?"backgroundPattern":"background"),$e=k||Ie(oe,{tileSize:ue,terrain:w.style.map.terrain});ge&&(X.activeTexture.set(se.TEXTURE0),w.imageManager.bind(w.context));const Ne=P.getCrossfadeParameters();for(const Fe of $e){const Ze=oe.getProjectionData({overscaledTileID:Fe,applyGlobeMatrix:!G,applyTerrainMatrix:!0}),mt=ge?of(j,w,ge,{tileID:Fe,tileSize:ue},Ne):sf(j,F),_t=w.style.map.terrain&&w.style.map.terrain.getTerrainData(Fe),st=ae.getMeshFromTileID(X,Fe.canonical,!1,!0,"raster");Re.draw(X,se.TRIANGLES,Te,ye,fe,Yt.backCCW,mt,_t,Ze,P.id,st.vertexBuffer,st.indexBuffer,st.segments)}})(e,0,c,f,y):o.cl(c)&&(function(w,A,P,k){const{isRenderingGlobe:O}=k,F=w.context,j=P.implementation,G=w.style.projection,X=w.transform,se=X.getProjectionDataForCustomLayer(O),ae={farZ:X.farZ,nearZ:X.nearZ,fov:X.fov*Math.PI/180,modelViewProjectionMatrix:X.modelViewProjectionMatrix,projectionMatrix:X.projectionMatrix,shaderData:{variantName:G.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${G.shaderPreludeCode.vertexSource}`,define:G.shaderDefine},defaultProjectionData:se},oe=j.renderingMode?j.renderingMode:"2d";if(w.renderPass==="offscreen"){const ue=j.prerender;ue&&(w.setCustomLayerDefaults(),F.setColorMode(w.colorModeForRenderPass()),ue.call(j,F.gl,ae),F.setDirty(),w.setBaseState())}else if(w.renderPass==="translucent"){w.setCustomLayerDefaults(),F.setColorMode(w.colorModeForRenderPass()),F.setStencilMode(Ci.disabled);const ue=oe==="3d"?w.getDepthModeFor3D():w.getDepthModeForSublayer(0,ii.ReadOnly);F.setDepthMode(ue),j.render(F.gl,ae),F.setDirty(),w.setBaseState(),F.bindFramebuffer.set(null)}})(e,0,c,y))}saveTileTexture(e){const a=this._tileTextures[e.size[0]];a?a.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const a=this._tileTextures[e];return a&&a.length>0?a.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const a=this.imageManager.getPattern(e.from.toString()),c=this.imageManager.getPattern(e.to.toString());return!a||!c}useProgram(e,a,c=!1,f=[]){this.cache=this.cache||{};const y=!!this.style.map.terrain,w=this.style.projection,A=c?qa.projectionMercator:w.shaderPreludeCode,P=c?zs:w.shaderDefine,k=e+(a?a.cacheKey:"")+`/${c?qo:w.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(y?"/terrain":"")+(f?`/${f.join("/")}`:"");return this.cache[k]||(this.cache[k]=new Zh(this.context,qa[e],a,Zr[e],this._showOverdrawInspector,y,A,P,f)),this.cache[k]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:a}=this.context.gl;return this.width!==e||this.height!==a}}function ga(m,e){let a,c=!1,f=null,y=null;const w=()=>{f=null,c&&(m.apply(y,a),f=setTimeout(w,e),c=!1)};return(...A)=>(c=!0,y=this,a=A,f||w(),f)}class Aa{constructor(e){this._getCurrentHash=()=>{const a=window.location.hash.replace("#","");if(this._hashName){let c;return a.split("&").map((f=>f.split("="))).forEach((f=>{f[0]===this._hashName&&(c=f)})),(c&&c[1]||"").split("/")}return a.split("/")},this._onHashChange=()=>{const a=this._getCurrentHash();if(!this._isValidHash(a))return!1;const c=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:c,pitch:+(a[4]||0)}),!0},this._updateHashUnthrottled=()=>{const a=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,a)},this._removeHash=()=>{const a=this._getCurrentHash();if(a.length===0)return;const c=a.join("/");let f=c;f.split("&").length>0&&(f=f.split("&")[0]),this._hashName&&(f=`${this._hashName}=${c}`);let y=window.location.hash.replace(f,"");y.startsWith("#&")?y=y.slice(0,1)+y.slice(2):y==="#"&&(y="");let w=window.location.href.replace(/(#.+)?$/,y);w=w.replace("&&","&"),window.history.replaceState(window.history.state,null,w)},this._updateHash=ga(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const a=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,f=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,f),w=Math.round(a.lng*y)/y,A=Math.round(a.lat*y)/y,P=this._map.getBearing(),k=this._map.getPitch();let O="";if(O+=e?`/${w}/${A}/${c}`:`${c}/${A}/${w}`,(P||k)&&(O+="/"+Math.round(10*P)/10),k&&(O+=`/${Math.round(k)}`),this._hashName){const F=this._hashName;let j=!1;const G=window.location.hash.slice(1).split("&").map((X=>{const se=X.split("=")[0];return se===F?(j=!0,`${se}=${O}`):X})).filter((X=>X));return j||G.push(`${F}=${O}`),`#${G.join("&")}`}return`#${O}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new o.S(+e[2],+e[1])}catch{return!1}const a=+e[0],c=+(e[3]||0),f=+(e[4]||0);return a>=this._map.getMinZoom()&&a<=this._map.getMaxZoom()&&c>=-180&&c<=180&&f>=this._map.getMinPitch()&&f<=this._map.getMaxPitch()}}const Lr={linearity:.3,easing:o.cm(0,0,.3,1)},Xa=o.e({deceleration:2500,maxSpeed:1400},Lr),qu=o.e({deceleration:20,maxSpeed:1400},Lr),$u=o.e({deceleration:1e3,maxSpeed:360},Lr),Hl=o.e({deceleration:1e3,maxSpeed:90},Lr),Jc=o.e({deceleration:1e3,maxSpeed:360},Lr);class yo{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:ee.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,a=ee.now();for(;e.length>0&&a-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const a={zoom:0,bearing:0,pitch:0,roll:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:y}of this._inertiaBuffer)a.zoom+=y.zoomDelta||0,a.bearing+=y.bearingDelta||0,a.pitch+=y.pitchDelta||0,a.roll+=y.rollDelta||0,y.panDelta&&a.pan._add(y.panDelta),y.around&&(a.around=y.around),y.pinchAround&&(a.pinchAround=y.pinchAround);const c=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,f={};if(a.pan.mag()){const y=js(a.pan.mag(),c,o.e({},Xa,e||{})),w=a.pan.mult(y.amount/a.pan.mag()),A=this._map.cameraHelper.handlePanInertia(w,this._map.transform);f.center=A.easingCenter,f.offset=A.easingOffset,on(f,y)}if(a.zoom){const y=js(a.zoom,c,qu);f.zoom=this._map.transform.zoom+y.amount,on(f,y)}if(a.bearing){const y=js(a.bearing,c,$u);f.bearing=this._map.transform.bearing+o.ah(y.amount,-179,179),on(f,y)}if(a.pitch){const y=js(a.pitch,c,Hl);f.pitch=this._map.transform.pitch+y.amount,on(f,y)}if(a.roll){const y=js(a.roll,c,Jc);f.roll=this._map.transform.roll+o.ah(y.amount,-179,179),on(f,y)}if(f.zoom||f.bearing){const y=a.pinchAround===void 0?a.around:a.pinchAround;f.around=y?this._map.unproject(y):this._map.getCenter()}return this.clear(),o.e(f,{noMoveStart:!0})}}function on(m,e){(!m.duration||m.duration<e.duration)&&(m.duration=e.duration,m.easing=e.easing)}function js(m,e,a){const{maxSpeed:c,linearity:f,deceleration:y}=a,w=o.ah(m*f/(e/1e3),-c,c),A=Math.abs(w)/(y*f);return{easing:a.easing,duration:1e3*A,amount:w*(A/2)}}class $r extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,a,c,f={}){c=c instanceof MouseEvent?c:new MouseEvent(e,c);const y=U.mousePos(a.getCanvas(),c),w=a.unproject(y);super(e,o.e({point:y,lngLat:w,originalEvent:c},f)),this._defaultPrevented=!1,this.target=a}}class Xl extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,a,c){const f=e==="touchend"?c.changedTouches:c.touches,y=U.touchPos(a.getCanvasContainer(),f),w=y.map((P=>a.unproject(P))),A=y.reduce(((P,k,O,F)=>P.add(k.div(F.length))),new o.P(0,0));super(e,{points:y,point:A,lngLats:w,lngLat:a.unproject(A),originalEvent:c}),this._defaultPrevented=!1}}class ed extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,a,c){super(e,{originalEvent:c}),this._defaultPrevented=!1}}class hf{constructor(e,a){this._map=e,this._clickTolerance=a.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new ed(e.type,this._map,e))}mousedown(e,a){return this._mousedownPos=a,this._firePreventable(new $r(e.type,this._map,e))}mouseup(e){this._map.fire(new $r(e.type,this._map,e))}click(e,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new $r(e.type,this._map,e))}dblclick(e){return this._firePreventable(new $r(e.type,this._map,e))}mouseover(e){this._map.fire(new $r(e.type,this._map,e))}mouseout(e){this._map.fire(new $r(e.type,this._map,e))}touchstart(e){return this._firePreventable(new Xl(e.type,this._map,e))}touchmove(e){this._map.fire(new Xl(e.type,this._map,e))}touchend(e){this._map.fire(new Xl(e.type,this._map,e))}touchcancel(e){this._map.fire(new Xl(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Qn{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new $r(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new $r("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new $r(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class vo{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(o.P.convert(e),this._map.terrain)}}class ol{constructor(e,a){this._map=e,this._tr=new vo(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=a.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,a){this.isEnabled()&&e.shiftKey&&e.button===0&&(U.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)}mousemoveWindow(e,a){if(!this._active)return;const c=a;if(this._lastPos.equals(c)||!this._box&&c.dist(this._startPos)<this._clickTolerance)return;const f=this._startPos;this._lastPos=c,this._box||(this._box=U.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const y=Math.min(f.x,c.x),w=Math.max(f.x,c.x),A=Math.min(f.y,c.y),P=Math.max(f.y,c.y);U.setTransform(this._box,`translate(${y}px,${A}px)`),this._box.style.width=w-y+"px",this._box.style.height=P-A+"px"}mouseupWindow(e,a){if(!this._active||e.button!==0)return;const c=this._startPos,f=a;if(this.reset(),U.suppressClick(),c.x!==f.x||c.y!==f.y)return this._map.fire(new o.l("boxzoomend",{originalEvent:e})),{cameraAnimation:y=>y.fitScreenCoordinates(c,f,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(U.remove(this._box),this._box=null),U.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,a){return this._map.fire(new o.l(e,{originalEvent:a}))}}function xs(m,e){if(m.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${m.length}, points ${e.length}`);const a={};for(let c=0;c<m.length;c++)a[m[c].identifier]=e[c];return a}class Hu{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,a,c){(this.centroid||c.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),c.length===this.numTouches&&(this.centroid=(function(f){const y=new o.P(0,0);for(const w of f)y._add(w);return y.div(f.length)})(a),this.touches=xs(c,a)))}touchmove(e,a,c){if(this.aborted||!this.centroid)return;const f=xs(c,a);for(const y in this.touches){const w=f[y];(!w||w.dist(this.touches[y])>30)&&(this.aborted=!0)}}touchend(e,a,c){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),c.length===0){const f=!this.aborted&&this.centroid;if(this.reset(),f)return f}}}class rr{constructor(e){this.singleTap=new Hu(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,a,c){this.singleTap.touchstart(e,a,c)}touchmove(e,a,c){this.singleTap.touchmove(e,a,c)}touchend(e,a,c){const f=this.singleTap.touchend(e,a,c);if(f){const y=e.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(f)<30;if(y&&w||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=f,this.count===this.numTaps)return this.reset(),f}}}class Or{constructor(e){this._tr=new vo(e),this._zoomIn=new rr({numTouches:1,numTaps:2}),this._zoomOut=new rr({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,a,c){this._zoomIn.touchstart(e,a,c),this._zoomOut.touchstart(e,a,c)}touchmove(e,a,c){this._zoomIn.touchmove(e,a,c),this._zoomOut.touchmove(e,a,c)}touchend(e,a,c){const f=this._zoomIn.touchend(e,a,c),y=this._zoomOut.touchend(e,a,c),w=this._tr;return f?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:w.zoom+1,around:w.unproject(f)},{originalEvent:e})}):y?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:w.zoom-1,around:w.unproject(y)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Yl{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const a=this._moveFunction(...e);if(a.bearingDelta||a.pitchDelta||a.rollDelta||a.around||a.panDelta)return this._active=!0,a}dragStart(e,a){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(a)?a[0]:a,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,a){if(!this.isEnabled())return;const c=this._lastPoint;if(!c)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const f=Array.isArray(a)?a[0]:a;return!this._moved&&f.dist(c)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=f,this._move(c,f))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&U.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Pa=0,Wl=2,df={[Pa]:1,[Wl]:2};class Ya{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const a=U.mouseButton(e);this._eventButton=a}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!(function(a,c){const f=df[c];return a.buttons===void 0||(a.buttons&f)!==f})(e,this._eventButton)}isValidEndEvent(e){return U.mouseButton(e)===this._eventButton}}class td{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class Xu{constructor(e=new Ya({checkCorrectEvent:()=>!0}),a=new td){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=a}_executeRelevantHandler(e,a,c){return e instanceof MouseEvent?a(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?c(e):void 0}startMove(e){this._executeRelevantHandler(e,(a=>this.mouseMoveStateManager.startMove(a)),(a=>this.oneFingerTouchMoveStateManager.startMove(a)))}endMove(e){this._executeRelevantHandler(e,(a=>this.mouseMoveStateManager.endMove(a)),(a=>this.oneFingerTouchMoveStateManager.endMove(a)))}isValidStartEvent(e){return this._executeRelevantHandler(e,(a=>this.mouseMoveStateManager.isValidStartEvent(a)),(a=>this.oneFingerTouchMoveStateManager.isValidStartEvent(a)))}isValidMoveEvent(e){return this._executeRelevantHandler(e,(a=>this.mouseMoveStateManager.isValidMoveEvent(a)),(a=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(a)))}isValidEndEvent(e){return this._executeRelevantHandler(e,(a=>this.mouseMoveStateManager.isValidEndEvent(a)),(a=>this.oneFingerTouchMoveStateManager.isValidEndEvent(a)))}}const Kl=m=>{m.mousedown=m.dragStart,m.mousemoveWindow=m.dragMove,m.mouseup=m.dragEnd,m.contextmenu=e=>{e.preventDefault()}};class Fs{constructor(e,a){this._clickTolerance=e.clickTolerance||1,this._map=a,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,a,c){return this._calculateTransform(e,a,c)}touchmove(e,a,c){if(this._active){if(!this._shouldBePrevented(c.length))return e.preventDefault(),this._calculateTransform(e,a,c);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,a,c){this._calculateTransform(e,a,c),this._active&&this._shouldBePrevented(c.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,a,c){c.length>0&&(this._active=!0);const f=xs(c,a),y=new o.P(0,0),w=new o.P(0,0);let A=0;for(const k in f){const O=f[k],F=this._touches[k];F&&(y._add(O),w._add(O.sub(F)),A++,f[k]=O)}if(this._touches=f,this._shouldBePrevented(A)||!w.mag())return;const P=w.div(A);return this._sum._add(P),this._sum.mag()<this._clickTolerance?void 0:{around:y.div(A),panDelta:P}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ra{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,a,c){this._firstTwoTouches||c.length<2||(this._firstTwoTouches=[c[0].identifier,c[1].identifier],this._start([a[0],a[1]]))}touchmove(e,a,c){if(!this._firstTwoTouches)return;e.preventDefault();const[f,y]=this._firstTwoTouches,w=Mt(c,a,f),A=Mt(c,a,y);if(!w||!A)return;const P=this._aroundCenter?null:w.add(A).div(2);return this._move([w,A],P,e)}touchend(e,a,c){if(!this._firstTwoTouches)return;const[f,y]=this._firstTwoTouches,w=Mt(c,a,f),A=Mt(c,a,y);w&&A||(this._active&&U.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Mt(m,e,a){for(let c=0;c<m.length;c++)if(m[c].identifier===a)return e[c]}function eu(m,e){return Math.log(m/e)/Math.LN2}class tu extends Ra{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,a){const c=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(eu(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:eu(this._distance,c),pinchAround:a}}}function Ql(m,e){return 180*m.angleWith(e)/Math.PI}class ll extends Ra{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,a,c){const f=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ql(this._vector,f),pinchAround:a}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const a=25/(Math.PI*this._minDiameter)*360,c=Ql(e,this._startVector);return Math.abs(c)<a}}function Wa(m){return Math.abs(m.y)>Math.abs(m.x)}class iu extends Ra{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,a,c){super.touchstart(e,a,c),this._currentTouchCount=c.length}_start(e){this._lastPoints=e,Wa(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,a,c){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const f=e[0].sub(this._lastPoints[0]),y=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(f,y,c.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(f.y+y.y)/2*-.5}):void 0}gestureBeginsVertically(e,a,c){if(this._valid!==void 0)return this._valid;const f=e.mag()>=2,y=a.mag()>=2;if(!f&&!y)return;if(!f||!y)return this._firstMove===void 0&&(this._firstMove=c),c-this._firstMove<100&&void 0;const w=e.y>0==a.y>0;return Wa(e)&&Wa(a)&&w}}const Si={panStep:100,bearingStep:15,pitchStep:10};class Ka{constructor(e){this._tr=new vo(e);const a=Si;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let a=0,c=0,f=0,y=0,w=0;switch(e.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:e.shiftKey?c=-1:(e.preventDefault(),y=-1);break;case 39:e.shiftKey?c=1:(e.preventDefault(),y=1);break;case 38:e.shiftKey?f=1:(e.preventDefault(),w=-1);break;case 40:e.shiftKey?f=-1:(e.preventDefault(),w=1);break;default:return}return this._rotationDisabled&&(c=0,f=0),{cameraAnimation:A=>{const P=this._tr;A.easeTo({duration:300,easeId:"keyboardHandler",easing:id,zoom:a?Math.round(P.zoom)+a*(e.shiftKey?2:1):P.zoom,bearing:P.bearing+c*this._bearingStep,pitch:P.pitch+f*this._pitchStep,offset:[-y*this._panStep,-w*this._panStep],center:P.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function id(m){return m*(2-m)}const Jl=4.000244140625,xo=1/450;class Us{constructor(e,a){this._onTimeout=c=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)},this._map=e,this._tr=new vo(e),this._triggerRenderFrame=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=xo}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let a=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const c=ee.now(),f=c-(this._lastWheelEventTime||0);this._lastWheelEventTime=c,a!==0&&a%Jl==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":f>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(f*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),e.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=e,this._delta-=a,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const a=U.mousePos(this._map.getCanvas(),e),c=this._tr;this._aroundPoint=this._aroundCenter?c.transform.locationToScreenPoint(o.S.convert(c.center)):a,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const A=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=A),typeof this._targetZoom=="number"&&(this._targetZoom+=A)}if(this._delta!==0){const A=this._type==="wheel"&&Math.abs(this._delta)>Jl?this._wheelZoomRate:this._defaultZoomRate;let P=2/(1+Math.exp(-Math.abs(this._delta*A)));this._delta<0&&P!==0&&(P=1/P);const k=typeof this._targetZoom!="number"?e.scale:o.af(this._targetZoom);this._targetZoom=e.getConstrained(e.getCameraLngLat(),o.ak(k*P)).zoom,this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const a=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,c=this._startZoom,f=this._easing;let y,w=!1;if(this._type==="wheel"&&c&&f){const A=ee.now()-this._lastWheelEventTime,P=Math.min((A+5)/200,1),k=f(P);y=o.C.number(c,a,k),P<1?this._frameId||(this._frameId=!0):w=!0}else y=a,w=!0;return this._active=!0,w&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=y,{noInertia:!0,needsRenderFrame:!w,zoomDelta:y-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let a=o.co;if(this._prevEase){const c=this._prevEase,f=(ee.now()-c.start)/c.duration,y=c.easing(f+.01)-c.easing(f),w=.27/Math.sqrt(y*y+1e-4)*.01,A=Math.sqrt(.0729-w*w);a=o.cm(w,A,.25,1)}return this._prevEase={start:ee.now(),duration:e,easing:a},a}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class cl{constructor(e,a){this._clickZoom=e,this._tapZoom=a}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class nu{constructor(e){this._tr=new vo(e),this.reset()}reset(){this._active=!1}dblclick(e,a){return e.preventDefault(),{cameraAnimation:c=>{c.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(a)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Yu{constructor(){this._tap=new rr({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,a,c){if(!this._swipePoint)if(this._tapTime){const f=a[0],y=e.timeStamp-this._tapTime<500,w=this._tapPoint.dist(f)<30;y&&w?c.length>0&&(this._swipePoint=f,this._swipeTouch=c[0].identifier):this.reset()}else this._tap.touchstart(e,a,c)}touchmove(e,a,c){if(this._tapTime){if(this._swipePoint){if(c[0].identifier!==this._swipeTouch)return;const f=a[0],y=f.y-this._swipePoint.y;return this._swipePoint=f,e.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(e,a,c)}touchend(e,a,c){if(this._tapTime)this._swipePoint&&c.length===0&&this.reset();else{const f=this._tap.touchend(e,a,c);f&&(this._tapTime=e.timeStamp,this._tapPoint=f)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ec{constructor(e,a,c){this._el=e,this._mousePan=a,this._touchPan=c}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class ul{constructor(e,a,c,f){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=a,this._mousePitch=c,this._mouseRoll=f}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class nd{constructor(e,a,c,f){this._el=e,this._touchZoom=a,this._touchRotate=c,this._tapDragZoom=f,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class rd{constructor(e,a){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=a,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=U.create("div","maplibregl-cooperative-gesture-screen",e);let a=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(a=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const c=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),f=document.createElement("div");f.className="maplibregl-desktop-message",f.textContent=a,this._container.appendChild(f);const y=document.createElement("div");y.className="maplibregl-mobile-message",y.textContent=c,this._container.appendChild(y),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(U.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,a){this._enabled&&(this._map.fire(new o.l("cooperativegestureprevented",{gestureType:e,originalEvent:a})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const Br=m=>m.zoom||m.drag||m.roll||m.pitch||m.rotate;class ji extends o.l{}function hl(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta||m.rollDelta}class ru{constructor(e,a){this.handleWindowEvent=f=>{this.handleEvent(f,`${f.type}Window`)},this.handleEvent=(f,y)=>{if(f.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const w=f.type==="renderFrame"?void 0:f,A={needsRenderFrame:!1},P={},k={};for(const{handlerName:j,handler:G,allowed:X}of this._handlers){if(!G.isEnabled())continue;let se;if(this._blockedByActive(k,X,j))G.reset();else if(G[y||f.type]){if(o.cp(f,y||f.type)){const ae=U.mousePos(this._map.getCanvas(),f);se=G[y||f.type](f,ae)}else if(o.cq(f,y||f.type)){const ae=this._getMapTouches(f.touches),oe=U.touchPos(this._map.getCanvas(),ae);se=G[y||f.type](f,oe,ae)}else o.cr(y||f.type)||(se=G[y||f.type](f));this.mergeHandlerResult(A,P,se,j,w),se&&se.needsRenderFrame&&this._triggerRenderFrame()}(se||G.isActive())&&(k[j]=G)}const O={};for(const j in this._previousActiveHandlers)k[j]||(O[j]=w);this._previousActiveHandlers=k,(Object.keys(O).length||hl(A))&&(this._changes.push([A,P,O]),this._triggerRenderFrame()),(Object.keys(k).length||hl(A))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:F}=A;F&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],F(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new yo(e),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a);const c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[window,"blur",void 0]];for(const[f,y,w]of this._listeners)U.addEventListener(f,y,f===document?this.handleWindowEvent:this.handleEvent,w)}destroy(){for(const[e,a,c]of this._listeners)U.removeEventListener(e,a,e===document?this.handleWindowEvent:this.handleEvent,c)}_addDefaultHandlers(e){const a=this._map,c=a.getCanvasContainer();this._add("mapEvent",new hf(a,e));const f=a.boxZoom=new ol(a,e);this._add("boxZoom",f),e.interactive&&e.boxZoom&&f.enable();const y=a.cooperativeGestures=new rd(a,e.cooperativeGestures);this._add("cooperativeGestures",y),e.cooperativeGestures&&y.enable();const w=new Or(a),A=new nu(a);a.doubleClickZoom=new cl(A,w),this._add("tapZoom",w),this._add("clickZoom",A),e.interactive&&e.doubleClickZoom&&a.doubleClickZoom.enable();const P=new Yu;this._add("tapDragZoom",P);const k=a.touchPitch=new iu(a);this._add("touchPitch",k),e.interactive&&e.touchPitch&&a.touchPitch.enable(e.touchPitch);const O=()=>a.project(a.getCenter()),F=(function({enable:he,clickTolerance:ye,aroundCenter:Te=!0,minPixelCenterThreshold:fe=100,rotateDegreesPerPixelMoved:Re=.8},$e){const Ne=new Ya({checkCorrectEvent:Fe=>U.mouseButton(Fe)===0&&Fe.ctrlKey||U.mouseButton(Fe)===2&&!Fe.ctrlKey});return new Yl({clickTolerance:ye,move:(Fe,Ze)=>{const mt=$e();if(Te&&Math.abs(mt.y-Fe.y)>fe)return{bearingDelta:o.cn(new o.P(Fe.x,Ze.y),Ze,mt)};let _t=(Ze.x-Fe.x)*Re;return Te&&Ze.y<mt.y&&(_t=-_t),{bearingDelta:_t}},moveStateManager:Ne,enable:he,assignEvents:Kl})})(e,O),j=(function({enable:he,clickTolerance:ye,pitchDegreesPerPixelMoved:Te=-.5}){const fe=new Ya({checkCorrectEvent:Re=>U.mouseButton(Re)===0&&Re.ctrlKey||U.mouseButton(Re)===2});return new Yl({clickTolerance:ye,move:(Re,$e)=>({pitchDelta:($e.y-Re.y)*Te}),moveStateManager:fe,enable:he,assignEvents:Kl})})(e),G=(function({enable:he,clickTolerance:ye,rollDegreesPerPixelMoved:Te=.3},fe){const Re=new Ya({checkCorrectEvent:$e=>U.mouseButton($e)===2&&$e.ctrlKey});return new Yl({clickTolerance:ye,move:($e,Ne)=>{const Fe=fe();let Ze=(Ne.x-$e.x)*Te;return Ne.y<Fe.y&&(Ze=-Ze),{rollDelta:Ze}},moveStateManager:Re,enable:he,assignEvents:Kl})})(e,O);a.dragRotate=new ul(e,F,j,G),this._add("mouseRotate",F,["mousePitch"]),this._add("mousePitch",j,["mouseRotate","mouseRoll"]),this._add("mouseRoll",G,["mousePitch"]),e.interactive&&e.dragRotate&&a.dragRotate.enable();const X=(function({enable:he,clickTolerance:ye}){const Te=new Ya({checkCorrectEvent:fe=>U.mouseButton(fe)===0&&!fe.ctrlKey});return new Yl({clickTolerance:ye,move:(fe,Re)=>({around:Re,panDelta:Re.sub(fe)}),activateOnStart:!0,moveStateManager:Te,enable:he,assignEvents:Kl})})(e),se=new Fs(e,a);a.dragPan=new ec(c,X,se),this._add("mousePan",X),this._add("touchPan",se,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&a.dragPan.enable(e.dragPan);const ae=new ll,oe=new tu;a.touchZoomRotate=new nd(c,oe,ae,P),this._add("touchRotate",ae,["touchPan","touchZoom"]),this._add("touchZoom",oe,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&a.touchZoomRotate.enable(e.touchZoomRotate);const ue=a.scrollZoom=new Us(a,(()=>this._triggerRenderFrame()));this._add("scrollZoom",ue,["mousePan"]),e.interactive&&e.scrollZoom&&a.scrollZoom.enable(e.scrollZoom);const ge=a.keyboard=new Ka(a);this._add("keyboard",ge),e.interactive&&e.keyboard&&a.keyboard.enable(),this._add("blockableMapEvent",new Qn(a))}_add(e,a,c){this._handlers.push({handlerName:e,handler:a,allowed:c}),this._handlersById[e]=a}stop(e){if(!this._updatingCamera){for(const{handler:a}of this._handlers)a.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Br(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,a,c){for(const f in e)if(f!==c&&(!a||a.indexOf(f)<0))return!0;return!1}_getMapTouches(e){const a=[];for(const c of e)this._el.contains(c.target)&&a.push(c);return a}mergeHandlerResult(e,a,c,f,y){if(!c)return;o.e(e,c);const w={handlerName:f,originalEvent:c.originalEvent||y};c.zoomDelta!==void 0&&(a.zoom=w),c.panDelta!==void 0&&(a.drag=w),c.rollDelta!==void 0&&(a.roll=w),c.pitchDelta!==void 0&&(a.pitch=w),c.bearingDelta!==void 0&&(a.rotate=w)}_applyChanges(){const e={},a={},c={};for(const[f,y,w]of this._changes)f.panDelta&&(e.panDelta=(e.panDelta||new o.P(0,0))._add(f.panDelta)),f.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+f.zoomDelta),f.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+f.bearingDelta),f.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+f.pitchDelta),f.rollDelta&&(e.rollDelta=(e.rollDelta||0)+f.rollDelta),f.around!==void 0&&(e.around=f.around),f.pinchAround!==void 0&&(e.pinchAround=f.pinchAround),f.noInertia&&(e.noInertia=f.noInertia),o.e(a,y),o.e(c,w);this._updateMapTransform(e,a,c),this._changes=[]}_updateMapTransform(e,a,c){const f=this._map,y=f._getTransformForUpdate(),w=f.terrain;if(!(hl(e)||w&&this._terrainMovement))return this._fireEvents(a,c,!0);f._stop(!0);let{panDelta:A,zoomDelta:P,bearingDelta:k,pitchDelta:O,rollDelta:F,around:j,pinchAround:G}=e;G!==void 0&&(j=G),j=j||f.transform.centerPoint,w&&!y.isPointOnMapSurface(j)&&(j=y.centerPoint);const X={panDelta:A,zoomDelta:P,rollDelta:F,pitchDelta:O,bearingDelta:k,around:j};this._map.cameraHelper.useGlobeControls&&!y.isPointOnMapSurface(j)&&(j=y.centerPoint);const se=j.distSqr(y.centerPoint)<.01?y.center:y.screenPointToLocation(A?j.sub(A):j);w?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(X,y),this._terrainMovement||!a.drag&&!a.zoom?a.drag&&this._terrainMovement?y.setCenter(y.screenPointToLocation(y.centerPoint.sub(A))):this._map.cameraHelper.handleMapControlsPan(X,y,se):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(X,y,se))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(X,y),this._map.cameraHelper.handleMapControlsPan(X,y,se)),f._applyUpdatedTransform(y),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(a,c,!0)}_fireEvents(e,a,c){const f=Br(this._eventsInProgress),y=Br(e),w={};for(const F in e){const{originalEvent:j}=e[F];this._eventsInProgress[F]||(w[`${F}start`]=j),this._eventsInProgress[F]=e[F]}!f&&y&&this._fireEvent("movestart",y.originalEvent);for(const F in w)this._fireEvent(F,w[F]);y&&this._fireEvent("move",y.originalEvent);for(const F in e){const{originalEvent:j}=e[F];this._fireEvent(F,j)}const A={};let P;for(const F in this._eventsInProgress){const{handlerName:j,originalEvent:G}=this._eventsInProgress[F];this._handlersById[j].isActive()||(delete this._eventsInProgress[F],P=a[j]||G,A[`${F}end`]=P)}for(const F in A)this._fireEvent(F,A[F]);const k=Br(this._eventsInProgress),O=(f||y)&&!k;if(O&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const F=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&F.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(F)}if(c&&O){this._updatingCamera=!0;const F=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),j=G=>G!==0&&-this._bearingSnap<G&&G<this._bearingSnap;!F||!F.essential&&ee.prefersReducedMotion?(this._map.fire(new o.l("moveend",{originalEvent:P})),j(this._map.getBearing())&&this._map.resetNorth()):(j(F.bearing||this._map.getBearing())&&(F.bearing=0),F.freezeElevation=!0,this._map.easeTo(F,{originalEvent:P})),this._updatingCamera=!1}}_fireEvent(e,a){this._map.fire(new o.l(e,a?{originalEvent:a}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((e=>{delete this._frameId,this.handleEvent(new ji("renderFrame",{timeStamp:e})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Wu extends o.E{constructor(e,a,c){super(),this._renderFrameCallback=()=>{const f=Math.min((ee.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(f)),f<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=c.bearingSnap,this.cameraHelper=a,this.on("moveend",(()=>{delete this._requestedCameraState}))}migrateProjection(e,a){e.apply(this.transform),this.transform=e,this.cameraHelper=a}getCenter(){return new o.S(this.transform.center.lng,this.transform.center.lat)}setCenter(e,a){return this.jumpTo({center:e},a)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,a){return this.jumpTo({elevation:e},a),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,a,c){return e=o.P.convert(e).mult(-1),this.panTo(this.transform.center,o.e({offset:e},a),c)}panTo(e,a,c){return this.easeTo(o.e({center:e},a),c)}getZoom(){return this.transform.zoom}setZoom(e,a){return this.jumpTo({zoom:e},a),this}zoomTo(e,a,c){return this.easeTo(o.e({zoom:e},a),c)}zoomIn(e,a){return this.zoomTo(this.getZoom()+1,e,a),this}zoomOut(e,a){return this.zoomTo(this.getZoom()-1,e,a),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,a){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new o.l("movestart",a)).fire(new o.l("move",a)).fire(new o.l("moveend",a))),this}getBearing(){return this.transform.bearing}setBearing(e,a){return this.jumpTo({bearing:e},a),this}getPadding(){return this.transform.padding}setPadding(e,a){return this.jumpTo({padding:e},a),this}rotateTo(e,a,c){return this.easeTo(o.e({bearing:e},a),c)}resetNorth(e,a){return this.rotateTo(0,o.e({duration:1e3},e),a),this}resetNorthPitch(e,a){return this.easeTo(o.e({bearing:0,pitch:0,roll:0,duration:1e3},e),a),this}snapToNorth(e,a){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,a):this}getPitch(){return this.transform.pitch}setPitch(e,a){return this.jumpTo({pitch:e},a),this}getRoll(){return this.transform.roll}setRoll(e,a){return this.jumpTo({roll:e},a),this}cameraForBounds(e,a){e=Ti.convert(e).adjustAntiMeridian();const c=a&&a.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),c,a)}_cameraForBoxAndBearing(e,a,c,f){const y={top:0,bottom:0,right:0,left:0};if(typeof(f=o.e({padding:y,offset:[0,0],maxZoom:this.transform.maxZoom},f)).padding=="number"){const k=f.padding;f.padding={top:k,bottom:k,right:k,left:k}}const w=o.e(y,f.padding);f.padding=w;const A=this.transform,P=new Ti(e,a);return this.cameraHelper.cameraForBoxAndBearing(f,w,P,c,A)}fitBounds(e,a,c){return this._fitInternal(this.cameraForBounds(e,a),a,c)}fitScreenCoordinates(e,a,c,f,y){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(o.P.convert(e)),this.transform.screenPointToLocation(o.P.convert(a)),c,f),f,y)}_fitInternal(e,a,c){return e?(delete(a=o.e(e,a)).padding,a.linear?this.easeTo(a,c):this.flyTo(a,c)):this}jumpTo(e,a){this.stop();const c=this._getTransformForUpdate();let f=!1,y=!1,w=!1;const A=c.zoom;this.cameraHelper.handleJumpToCenterZoom(c,e);const P=c.zoom!==A;return"elevation"in e&&c.elevation!==+e.elevation&&c.setElevation(+e.elevation),"bearing"in e&&c.bearing!==+e.bearing&&(f=!0,c.setBearing(+e.bearing)),"pitch"in e&&c.pitch!==+e.pitch&&(y=!0,c.setPitch(+e.pitch)),"roll"in e&&c.roll!==+e.roll&&(w=!0,c.setRoll(+e.roll)),e.padding==null||c.isPaddingEqual(e.padding)||c.setPadding(e.padding),this._applyUpdatedTransform(c),this.fire(new o.l("movestart",a)).fire(new o.l("move",a)),P&&this.fire(new o.l("zoomstart",a)).fire(new o.l("zoom",a)).fire(new o.l("zoomend",a)),f&&this.fire(new o.l("rotatestart",a)).fire(new o.l("rotate",a)).fire(new o.l("rotateend",a)),y&&this.fire(new o.l("pitchstart",a)).fire(new o.l("pitch",a)).fire(new o.l("pitchend",a)),w&&this.fire(new o.l("rollstart",a)).fire(new o.l("roll",a)).fire(new o.l("rollend",a)),this.fire(new o.l("moveend",a))}calculateCameraOptionsFromTo(e,a,c,f=0){const y=o.a1.fromLngLat(e,a),w=o.a1.fromLngLat(c,f),A=w.x-y.x,P=w.y-y.y,k=w.z-y.z,O=Math.hypot(A,P,k);if(O===0)throw new Error("Can't calculate camera options with same From and To");const F=Math.hypot(A,P),j=o.ak(this.transform.cameraToCenterDistance/O/this.transform.tileSize),G=180*Math.atan2(A,-P)/Math.PI;let X=180*Math.acos(F/O)/Math.PI;return X=k<0?90-X:90+X,{center:w.toLngLat(),elevation:f,zoom:j,pitch:X,bearing:G}}calculateCameraOptionsFromCameraLngLatAltRotation(e,a,c,f,y){const w=this.transform.calculateCenterFromCameraLngLatAlt(e,a,c,f);return{center:w.center,elevation:w.elevation,zoom:w.zoom,bearing:c,pitch:f,roll:y}}easeTo(e,a){this._stop(!1,e.easeId),((e=o.e({offset:[0,0],duration:500,easing:o.co},e)).animate===!1||!e.essential&&ee.prefersReducedMotion)&&(e.duration=0);const c=this._getTransformForUpdate(),f=this.getBearing(),y=c.pitch,w=c.roll,A="bearing"in e?this._normalizeBearing(e.bearing,f):f,P="pitch"in e?+e.pitch:y,k="roll"in e?this._normalizeBearing(e.roll,w):w,O="padding"in e?e.padding:c.padding,F=o.P.convert(e.offset);let j,G;e.around&&(j=o.S.convert(e.around),G=c.locationToScreenPoint(j));const X={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},se=this.cameraHelper.handleEaseTo(c,{bearing:A,pitch:P,roll:k,padding:O,around:j,aroundPoint:G,offsetAsPoint:F,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||f!==A,this._pitching=this._pitching||P!==y,this._rolling=this._rolling||k!==w,this._padding=!c.isPaddingEqual(O),this._zooming=this._zooming||se.isZooming,this._easeId=e.easeId,this._prepareEase(a,e.noMoveStart,X),this.terrain&&this._prepareElevation(se.elevationCenter),this._ease((ae=>{se.easeFunc(ae),this.terrain&&!e.freezeElevation&&this._updateElevation(ae),this._applyUpdatedTransform(c),this._fireMoveEvents(a)}),(ae=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(a,ae)}),e),this}_prepareEase(e,a,c={}){this._moving=!0,a||c.moving||this.fire(new o.l("movestart",e)),this._zooming&&!c.zooming&&this.fire(new o.l("zoomstart",e)),this._rotating&&!c.rotating&&this.fire(new o.l("rotatestart",e)),this._pitching&&!c.pitching&&this.fire(new o.l("pitchstart",e)),this._rolling&&!c.rolling&&this.fire(new o.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const a=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&a!==this._elevationTarget){const c=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(c-(a-(c*e+this._elevationStart))/(1-e)),this._elevationTarget=a}this.transform.setElevation(o.C.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const a=e.getCameraLngLat(),c=e.getCameraAltitude(),f=this.terrain?this.terrain.getElevationForLngLatZoom(a,e.zoom):0;if(c<f){const y=this.calculateCameraOptionsFromTo(a,f,e.center,e.elevation);return{pitch:y.pitch,zoom:y.zoom}}return{}}_applyUpdatedTransform(e){const a=[];if(a.push((f=>this._elevateCameraIfInsideTerrain(f))),this.transformCameraUpdate&&a.push((f=>this.transformCameraUpdate(f))),!a.length)return;const c=e.clone();for(const f of a){const y=c.clone(),{center:w,zoom:A,roll:P,pitch:k,bearing:O,elevation:F}=f(y);w&&y.setCenter(w),F!==void 0&&y.setElevation(F),A!==void 0&&y.setZoom(A),P!==void 0&&y.setRoll(P),k!==void 0&&y.setPitch(k),O!==void 0&&y.setBearing(O),c.apply(y)}this.transform.apply(c)}_fireMoveEvents(e){this.fire(new o.l("move",e)),this._zooming&&this.fire(new o.l("zoom",e)),this._rotating&&this.fire(new o.l("rotate",e)),this._pitching&&this.fire(new o.l("pitch",e)),this._rolling&&this.fire(new o.l("roll",e))}_afterEase(e,a){if(this._easeId&&a&&this._easeId===a)return;delete this._easeId;const c=this._zooming,f=this._rotating,y=this._pitching,w=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,c&&this.fire(new o.l("zoomend",e)),f&&this.fire(new o.l("rotateend",e)),y&&this.fire(new o.l("pitchend",e)),w&&this.fire(new o.l("rollend",e)),this.fire(new o.l("moveend",e))}flyTo(e,a){if(!e.essential&&ee.prefersReducedMotion){const Ze=o.Q(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(Ze,a)}this.stop(),e=o.e({offset:[0,0],speed:1.2,curve:1.42,easing:o.co},e);const c=this._getTransformForUpdate(),f=c.bearing,y=c.pitch,w=c.roll,A=c.padding,P="bearing"in e?this._normalizeBearing(e.bearing,f):f,k="pitch"in e?+e.pitch:y,O="roll"in e?this._normalizeBearing(e.roll,w):w,F="padding"in e?e.padding:c.padding,j=o.P.convert(e.offset);let G=c.centerPoint.add(j);const X=c.screenPointToLocation(G),se=this.cameraHelper.handleFlyTo(c,{bearing:P,pitch:k,roll:O,padding:F,locationAtOffset:X,offsetAsPoint:j,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let ae=e.curve;const oe=Math.max(c.width,c.height),ue=oe/se.scaleOfZoom,ge=se.pixelPathLength;typeof se.scaleOfMinZoom=="number"&&(ae=Math.sqrt(oe/se.scaleOfMinZoom/ge*2));const he=ae*ae;function ye(Ze){const mt=(ue*ue-oe*oe+(Ze?-1:1)*he*he*ge*ge)/(2*(Ze?ue:oe)*he*ge);return Math.log(Math.sqrt(mt*mt+1)-mt)}function Te(Ze){return(Math.exp(Ze)-Math.exp(-Ze))/2}function fe(Ze){return(Math.exp(Ze)+Math.exp(-Ze))/2}const Re=ye(!1);let $e=function(Ze){return fe(Re)/fe(Re+ae*Ze)},Ne=function(Ze){return oe*((fe(Re)*(Te(mt=Re+ae*Ze)/fe(mt))-Te(Re))/he)/ge;var mt},Fe=(ye(!0)-Re)/ae;if(Math.abs(ge)<2e-6||!isFinite(Fe)){if(Math.abs(oe-ue)<1e-6)return this.easeTo(e,a);const Ze=ue<oe?-1:1;Fe=Math.abs(Math.log(ue/oe))/ae,Ne=()=>0,$e=mt=>Math.exp(Ze*ae*mt)}return e.duration="duration"in e?+e.duration:1e3*Fe/("screenSpeed"in e?+e.screenSpeed/ae:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=f!==P,this._pitching=k!==y,this._rolling=O!==w,this._padding=!c.isPaddingEqual(F),this._prepareEase(a,!1),this.terrain&&this._prepareElevation(se.targetCenter),this._ease((Ze=>{const mt=Ze*Fe,_t=1/$e(mt),st=Ne(mt);this._rotating&&c.setBearing(o.C.number(f,P,Ze)),this._pitching&&c.setPitch(o.C.number(y,k,Ze)),this._rolling&&c.setRoll(o.C.number(w,O,Ze)),this._padding&&(c.interpolatePadding(A,F,Ze),G=c.centerPoint.add(j)),se.easeFunc(Ze,_t,st,G),this.terrain&&!e.freezeElevation&&this._updateElevation(Ze),this._applyUpdatedTransform(c),this._fireMoveEvents(a)}),(()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(a)}),e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,a){var c;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const f=this._onEaseEnd;delete this._onEaseEnd,f.call(this,a)}return e||(c=this.handlers)===null||c===void 0||c.stop(!1),this}_ease(e,a,c){c.animate===!1||c.duration===0?(e(1),a()):(this._easeStart=ee.now(),this._easeOptions=c,this._onEaseFrame=e,this._onEaseEnd=a,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,a){e=o.aO(e,-180,180);const c=Math.abs(e-a);return Math.abs(e-360-a)<c&&(e-=360),Math.abs(e+360-a)<c&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(o.S.convert(e),this.transform.tileZoom):null}}const bs={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class xi{constructor(e=bs){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=a=>{!a||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility"&&a.dataType!=="style"&&a.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=U.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=U.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=U.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){U.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,a){const c=this._map._getUIString(`AttributionControl.${a}`);e.title=c,e.setAttribute("aria-label",c)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map((f=>typeof f!="string"?"":f))):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const f=this._map.style.stylesheet;this.styleOwner=f.owner,this.styleId=f.id}const a=this._map.style.sourceCaches;for(const f in a){const y=a[f];if(y.used||y.usedForTerrain){const w=y.getSource();w.attribution&&e.indexOf(w.attribution)<0&&e.push(w.attribution)}}e=e.filter((f=>String(f).trim())),e.sort(((f,y)=>f.length-y.length)),e=e.filter(((f,y)=>{for(let w=y+1;w<e.length;w++)if(e[w].indexOf(f)>=0)return!1;return!0}));const c=e.join(" | ");c!==this._attribHTML&&(this._attribHTML=c,e.length?(this._innerContainer.innerHTML=U.sanitize(c),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Wi{constructor(e={}){this._updateCompact=()=>{const a=this._container.children;if(a.length){const c=a[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&c.classList.add("maplibregl-compact"):c.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=U.create("div","maplibregl-ctrl");const a=U.create("a","maplibregl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://maplibre.org/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){U.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Ki{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const a=++this._id;return this._queue.push({callback:e,id:a,cancelled:!1}),a}remove(e){const a=this._currentlyRunning,c=a?this._queue.concat(a):this._queue;for(const f of c)if(f.id===e)return void(f.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const a=this._currentlyRunning=this._queue;this._queue=[];for(const c of a)if(!c.cancelled&&(c.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var dl=o.aJ([{name:"a_pos3d",type:"Int16",components:3}]);class Pt extends o.E{constructor(e){super(),this._lastTilesetChange=ee.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,a){this.sourceCache.update(e,a),this._renderableTilesKeys=[];const c={};for(const f of Ie(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:a,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))c[f.key]=!0,this._renderableTilesKeys.push(f.key),this._tiles[f.key]||(f.terrainRttPosMatrix32f=new Float64Array(16),o.bY(f.terrainRttPosMatrix32f,0,o.$,o.$,0,0,1),this._tiles[f.key]=new oa(f,this.tileSize),this._lastTilesetChange=ee.now());for(const f in this._tiles)c[f]||delete this._tiles[f]}freeRtt(e){for(const a in this._tiles){const c=this._tiles[a];(!e||c.tileID.equals(e)||c.tileID.isChildOf(e)||e.isChildOf(c.tileID))&&(c.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((e=>this.getTileByID(e)))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e,a){return a?this._getTerrainCoordsForTileRanges(e,a):this._getTerrainCoordsForRegularTile(e)}_getTerrainCoordsForRegularTile(e){const a={};for(const c of this._renderableTilesKeys){const f=this._tiles[c].tileID,y=e.clone(),w=o.ba();if(f.canonical.equals(e.canonical))o.bY(w,0,o.$,o.$,0,0,1);else if(f.canonical.isChildOf(e.canonical)){const A=f.canonical.z-e.canonical.z,P=f.canonical.x-(f.canonical.x>>A<<A),k=f.canonical.y-(f.canonical.y>>A<<A),O=o.$>>A;o.bY(w,0,O,O,0,0,1),o.M(w,w,[-P*O,-k*O,0])}else{if(!e.canonical.isChildOf(f.canonical))continue;{const A=e.canonical.z-f.canonical.z,P=e.canonical.x-(e.canonical.x>>A<<A),k=e.canonical.y-(e.canonical.y>>A<<A),O=o.$>>A;o.bY(w,0,o.$,o.$,0,0,1),o.M(w,w,[P*O,k*O,0]),o.N(w,w,[1/2**A,1/2**A,0])}}y.terrainRttPosMatrix32f=new Float32Array(w),a[c]=y}return a}_getTerrainCoordsForTileRanges(e,a){const c={};for(const f of this._renderableTilesKeys){const y=this._tiles[f].tileID;if(!this._isWithinTileRanges(y,a))continue;const w=e.clone(),A=o.ba();if(y.canonical.z===e.canonical.z){const P=e.canonical.x-y.canonical.x,k=e.canonical.y-y.canonical.y;o.bY(A,0,o.$,o.$,0,0,1),o.M(A,A,[P*o.$,k*o.$,0])}else if(y.canonical.z>e.canonical.z){const P=y.canonical.z-e.canonical.z,k=y.canonical.x-(y.canonical.x>>P<<P),O=y.canonical.y-(y.canonical.y>>P<<P),F=e.canonical.x-(y.canonical.x>>P),j=e.canonical.y-(y.canonical.y>>P),G=o.$>>P;o.bY(A,0,G,G,0,0,1),o.M(A,A,[-k*G+F*o.$,-O*G+j*o.$,0])}else{const P=e.canonical.z-y.canonical.z,k=e.canonical.x-(e.canonical.x>>P<<P),O=e.canonical.y-(e.canonical.y>>P<<P),F=(e.canonical.x>>P)-y.canonical.x,j=(e.canonical.y>>P)-y.canonical.y,G=o.$<<P;o.bY(A,0,G,G,0,0,1),o.M(A,A,[k*o.$+F*G,O*o.$+j*G,0])}w.terrainRttPosMatrix32f=new Float32Array(A),c[f]=w}return c}getSourceTile(e,a){const c=this.sourceCache._source;let f=e.overscaledZ-this.deltaZoom;if(f>c.maxzoom&&(f=c.maxzoom),f<c.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(f).key);let y=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!y||!y.dem)&&a)for(;f>=c.minzoom&&(!y||!y.dem);)y=this.sourceCache.getTileByID(e.scaledTo(f--).key);return y}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}_isWithinTileRanges(e,a){return a[e.canonical.z]&&e.canonical.x>=a[e.canonical.z].minTileX&&e.canonical.x<=a[e.canonical.z].maxTileX&&e.canonical.y>=a[e.canonical.z].minTileY&&e.canonical.y<=a[e.canonical.z].maxTileY}}class Ft{constructor(e,a,c){this._meshCache={},this.painter=e,this.sourceCache=new Pt(a),this.options=c,this.exaggeration=typeof c.exaggeration=="number"?c.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,a,c,f=o.$){var y;if(!(a>=0&&a<f&&c>=0&&c<f))return 0;const w=this.getTerrainData(e),A=(y=w.tile)===null||y===void 0?void 0:y.dem;if(!A)return 0;const P=o.cs([],[a/f*o.$,c/f*o.$],w.u_terrain_matrix),k=[P[0]*A.dim,P[1]*A.dim],O=Math.floor(k[0]),F=Math.floor(k[1]),j=k[0]-O,G=k[1]-F;return A.get(O,F)*(1-j)*(1-G)+A.get(O+1,F)*j*(1-G)+A.get(O,F+1)*(1-j)*G+A.get(O+1,F+1)*j*G}getElevationForLngLatZoom(e,a){if(!o.ct(a,e.wrap()))return 0;const{tileID:c,mercatorX:f,mercatorY:y}=this._getOverscaledTileIDFromLngLatZoom(e,a);return this.getElevation(c,f%o.$,y%o.$,o.$)}getElevation(e,a,c,f=o.$){return this.getDEMElevation(e,a,c,f)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const f=this.painter.context,y=new o.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new o.T(f,y,f.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new o.T(f,new o.R({width:1,height:1}),f.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.ag([])}const a=this.sourceCache.getSourceTile(e,!0);if(a&&a.dem&&(!a.demTexture||a.needsTerrainPrepare)){const f=this.painter.context;a.demTexture=this.painter.getTileTexture(a.dem.stride),a.demTexture?a.demTexture.update(a.dem.getPixels(),{premultiply:!1}):a.demTexture=new o.T(f,a.dem.getPixels(),f.gl.RGBA,{premultiply:!1}),a.demTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),a.needsTerrainPrepare=!1}const c=a&&a+a.tileID.key+e.key;if(c&&!this._demMatrixCache[c]){const f=this.sourceCache.sourceCache._source.maxzoom;let y=e.canonical.z-a.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=f?y=e.canonical.z-f:o.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const w=e.canonical.x-(e.canonical.x>>y<<y),A=e.canonical.y-(e.canonical.y>>y<<y),P=o.cu(new Float64Array(16),[1/(o.$<<y),1/(o.$<<y),0]);o.M(P,P,[w*o.$,A*o.$,0]),this._demMatrixCache[e.key]={matrix:P,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:a&&a.dem&&a.dem.dim||1,u_terrain_matrix:c?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:a&&a.dem&&a.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(a&&a.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:a}}getFramebuffer(e){const a=this.painter,c=a.width/devicePixelRatio,f=a.height/devicePixelRatio;return!this._fbo||this._fbo.width===c&&this._fbo.height===f||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new o.T(a.context,{width:c,height:f,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new o.T(a.context,{width:c,height:f,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=a.context.createFramebuffer(c,f,!0,!1),this._fbo.depthAttachment.set(a.context.createRenderbuffer(a.context.gl.DEPTH_COMPONENT16,c,f))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const a=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let y=0,w=0;y<this._coordsTextureSize;y++)for(let A=0;A<this._coordsTextureSize;A++,w+=4)a[w+0]=255&A,a[w+1]=255&y,a[w+2]=A>>8<<4|y>>8,a[w+3]=0;const c=new o.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(a.buffer)),f=new o.T(e,c,e.gl.RGBA,{premultiply:!1});return f.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=f,f}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const a=new Uint8Array(4),c=this.painter.context,f=c.gl,y=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),w=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),A=Math.round(this.painter.height/devicePixelRatio);c.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),f.readPixels(y,A-w-1,1,1,f.RGBA,f.UNSIGNED_BYTE,a),c.bindFramebuffer.set(null);const P=a[0]+(a[2]>>4<<8),k=a[1]+((15&a[2])<<8),O=this.coordsIndex[255-a[3]],F=O&&this.sourceCache.getTileByID(O);if(!F)return null;const j=this._coordsTextureSize,G=(1<<F.tileID.canonical.z)*j;return new o.a1((F.tileID.canonical.x*j+P)/G+F.tileID.wrap,(F.tileID.canonical.y*j+k)/G,this.getElevation(F.tileID,P,k,j))}depthAtPoint(e){const a=new Uint8Array(4),c=this.painter.context,f=c.gl;return c.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),f.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,f.RGBA,f.UNSIGNED_BYTE,a),c.bindFramebuffer.set(null),(a[0]/16777216+a[1]/65536+a[2]/256+a[3])/256}getTerrainMesh(e){var a;const c=((a=this.painter.style.projection)===null||a===void 0?void 0:a.transitionState)>0,f=c&&e.canonical.y===0,y=c&&e.canonical.y===(1<<e.canonical.z)-1,w=`m_${f?"n":""}_${y?"s":""}`;if(this._meshCache[w])return this._meshCache[w];const A=this.painter.context,P=new o.cv,k=new o.aN,O=this.meshSize,F=o.$/O,j=O*O;for(let fe=0;fe<=O;fe++)for(let Re=0;Re<=O;Re++)P.emplaceBack(Re*F,fe*F,0);for(let fe=0;fe<j;fe+=O+1)for(let Re=0;Re<O;Re++)k.emplaceBack(Re+fe,O+Re+fe+1,O+Re+fe+2),k.emplaceBack(Re+fe,O+Re+fe+2,Re+fe+1);const G=P.length,X=G+(O+1),se=(O+1)*O,ae=f?o.bh:0,oe=f?0:1,ue=y?o.bi:o.$,ge=y?0:1;for(let fe=0;fe<=O;fe++)P.emplaceBack(fe*F,ae,oe);for(let fe=0;fe<=O;fe++)P.emplaceBack(fe*F,ue,ge);for(let fe=0;fe<O;fe++)k.emplaceBack(se+fe,X+fe,X+fe+1),k.emplaceBack(se+fe,X+fe+1,se+fe+1),k.emplaceBack(0+fe,G+fe+1,G+fe),k.emplaceBack(0+fe,0+fe+1,G+fe+1);const he=P.length,ye=he+2*(O+1);for(const fe of[0,1])for(let Re=0;Re<=O;Re++)for(const $e of[0,1])P.emplaceBack(fe*o.$,Re*F,$e);for(let fe=0;fe<2*O;fe+=2)k.emplaceBack(he+fe,he+fe+1,he+fe+3),k.emplaceBack(he+fe,he+fe+3,he+fe+2),k.emplaceBack(ye+fe,ye+fe+3,ye+fe+1),k.emplaceBack(ye+fe,ye+fe+2,ye+fe+3);const Te=new ao(A.createVertexBuffer(P,dl.members),A.createIndexBuffer(k),o.aM.simpleSegment(0,0,P.length,k.length));return this._meshCache[w]=Te,Te}getMeshFrameDelta(e){return 2*Math.PI*o.bu/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,a){var c;const{tileID:f}=this._getOverscaledTileIDFromLngLatZoom(e,a);return(c=this.getMinMaxElevation(f).minElevation)!==null&&c!==void 0?c:0}getMinMaxElevation(e){const a=this.getTerrainData(e).tile,c={minElevation:null,maxElevation:null};return a&&a.dem&&(c.minElevation=a.dem.min*this.exaggeration,c.maxElevation=a.dem.max*this.exaggeration),c}_getOverscaledTileIDFromLngLatZoom(e,a){const c=o.a1.fromLngLat(e.wrap()),f=(1<<a)*o.$,y=c.x*f,w=c.y*f,A=Math.floor(y/o.$),P=Math.floor(w/o.$);return{tileID:new o.Z(a,0,a,A,P),mercatorX:y,mercatorY:w}}}class fl{constructor(e,a,c){this._context=e,this._size=a,this._tileSize=c,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const a=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),c=new o.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return c.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),a.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),a.colorAttachment.set(c.texture),{id:e,fbo:a,texture:c,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((a=>e.id!==a)),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const a of this._recentlyUsed)if(!this._objects[a].inUse)return this._objects[a];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((e=>!e.inUse))===!1}}const za={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Vs{constructor(e,a){this.painter=e,this.terrain=a,this.pool=new fl(e.context,30,a.sourceCache.tileSize*a.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,a){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter((c=>!e._layers[c].isHidden(a))),this._coordsAscending={};for(const c in e.sourceCaches){this._coordsAscending[c]={};const f=e.sourceCaches[c].getVisibleCoordinates(),y=e.sourceCaches[c].getSource(),w=y instanceof Ar?y.terrainTileRanges:null;for(const A of f){const P=this.terrain.sourceCache.getTerrainCoords(A,w);for(const k in P)this._coordsAscending[c][k]||(this._coordsAscending[c][k]=[]),this._coordsAscending[c][k].push(P[k])}}this._coordsAscendingStr={};for(const c of e._order){const f=e._layers[c],y=f.source;if(za[f.type]&&!this._coordsAscendingStr[y]){this._coordsAscendingStr[y]={};for(const w in this._coordsAscending[y])this._coordsAscendingStr[y][w]=this._coordsAscending[y][w].map((A=>A.key)).sort().join()}}for(const c of this._renderableTiles)for(const f in this._coordsAscendingStr){const y=this._coordsAscendingStr[f][c.tileID.key];y&&y!==c.rttCoords[f]&&(c.rtt=[])}}renderLayer(e,a){if(e.isHidden(this.painter.transform.zoom))return!1;const c=Object.assign(Object.assign({},a),{isRenderingToTexture:!0}),f=e.type,y=this.painter,w=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(za[f]&&(this._prevType&&za[this._prevType]||this._stacks.push([]),this._prevType=f,this._stacks[this._stacks.length-1].push(e.id),!w))return!0;if(za[this._prevType]||za[f]&&w){this._prevType=f;const A=this._stacks.length-1,P=this._stacks[A]||[];for(const k of this._renderableTiles){if(this.pool.isFull()&&(Qc(this.painter,this.terrain,this._rttTiles,c),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(k),k.rtt[A]){const F=this.pool.getObjectForId(k.rtt[A].id);if(F.stamp===k.rtt[A].stamp){this.pool.useObject(F);continue}}const O=this.pool.getOrCreateFreeObject();this.pool.useObject(O),this.pool.stampObject(O),k.rtt[A]={id:O.id,stamp:O.stamp},y.context.bindFramebuffer.set(O.fbo.framebuffer),y.context.clear({color:o.bf.transparent,stencil:0}),y.currentStencilSource=void 0;for(let F=0;F<P.length;F++){const j=y.style._layers[P[F]],G=j.source?this._coordsAscending[j.source][k.tileID.key]:[k.tileID];y.context.viewport.set([0,0,O.fbo.width,O.fbo.height]),y._renderTileClippingMasks(j,G,!0),y.renderLayer(y,y.style.sourceCaches[j.source],j,G,c),j.source&&(k.rttCoords[j.source]=this._coordsAscendingStr[j.source][k.tileID.key])}}return Qc(this.painter,this.terrain,this._rttTiles,c),this._rttTiles=[],this.pool.freeAllObjects(),za[f]}return!1}}const Hr={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Dn=L,ra={hash:!1,interactive:!0,bearingSnap:7,attributionControl:bs,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:o.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},ad={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class tc{constructor(e,a,c=!1){this.mousedown=y=>{this.startMove(y,U.mousePos(this.element,y)),U.addEventListener(window,"mousemove",this.mousemove),U.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=y=>{this.move(y,U.mousePos(this.element,y))},this.mouseup=y=>{this._rotatePitchHandler.dragEnd(y),this.offTemp()},this.touchstart=y=>{y.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=U.touchPos(this.element,y.targetTouches)[0],this.startMove(y,this._startPos),U.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),U.addEventListener(window,"touchend",this.touchend))},this.touchmove=y=>{y.targetTouches.length!==1?this.reset():(this._lastPos=U.touchPos(this.element,y.targetTouches)[0],this.move(y,this._lastPos))},this.touchend=y=>{y.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=a;const f=new Xu;this._rotatePitchHandler=new Yl({clickTolerance:3,move:(y,w)=>{const A=a.getBoundingClientRect(),P=new o.P((A.bottom-A.top)/2,(A.right-A.left)/2);return{bearingDelta:o.cn(new o.P(y.x,w.y),w,P),pitchDelta:c?-.5*(w.y-y.y):void 0}},moveStateManager:f,enable:!0,assignEvents:()=>{}}),this.map=e,U.addEventListener(a,"mousedown",this.mousedown),U.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),U.addEventListener(a,"touchcancel",this.reset)}startMove(e,a){this._rotatePitchHandler.dragStart(e,a),U.disableDrag()}move(e,a){const c=this.map,{bearingDelta:f,pitchDelta:y}=this._rotatePitchHandler.dragMove(e,a)||{};f&&c.setBearing(c.getBearing()+f),y&&c.setPitch(c.getPitch()+y)}off(){const e=this.element;U.removeEventListener(e,"mousedown",this.mousedown),U.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),U.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),U.removeEventListener(window,"touchend",this.touchend),U.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){U.enableDrag(),U.removeEventListener(window,"mousemove",this.mousemove),U.removeEventListener(window,"mouseup",this.mouseup),U.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),U.removeEventListener(window,"touchend",this.touchend)}}let Zi;function kn(m,e,a,c=!1){if(c||!a.getCoveringTilesDetailsProvider().allowWorldCopies())return m==null?void 0:m.wrap();const f=new o.S(m.lng,m.lat);if(m=new o.S(m.lng,m.lat),e){const y=new o.S(m.lng-360,m.lat),w=new o.S(m.lng+360,m.lat),A=a.locationToScreenPoint(m).distSqr(e);a.locationToScreenPoint(y).distSqr(e)<A?m=y:a.locationToScreenPoint(w).distSqr(e)<A&&(m=w)}for(;Math.abs(m.lng-a.center.lng)>180;){const y=a.locationToScreenPoint(m);if(y.x>=0&&y.y>=0&&y.x<=a.width&&y.y<=a.height)break;m.lng>a.center.lng?m.lng-=360:m.lng+=360}return m.lng!==f.lng&&a.isPointOnMapSurface(a.locationToScreenPoint(m))?m:f}const ic={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function bo(m,e,a){const c=m.classList;for(const f in ic)c.remove(`maplibregl-${a}-anchor-${f}`);c.add(`maplibregl-${a}-anchor-${e}`)}class wo extends o.E{constructor(e){if(super(),this._onKeyPress=a=>{const c=a.code,f=a.charCode||a.keyCode;c!=="Space"&&c!=="Enter"&&f!==32&&f!==13||this.togglePopup()},this._onMapClick=a=>{const c=a.originalEvent.target,f=this._element;this._popup&&(c===f||f.contains(c))&&this.togglePopup()},this._update=a=>{if(!this._map)return;const c=this._map.loaded()&&!this._map.isMoving();((a==null?void 0:a.type)==="terrain"||(a==null?void 0:a.type)==="render"&&!c)&&this._map.once("render",this._update),this._lngLat=kn(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let f="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?f=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(f=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let y="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?y="rotateX(0deg)":this._pitchAlignment==="map"&&(y=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||a&&a.type!=="moveend"||(this._pos=this._pos.round()),U.setTransform(this._element,`${ic[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${y} ${f}`),ee.frameAsync(new AbortController).then((()=>{this._updateOpacity(a&&a.type==="moveend")})).catch((()=>{}))},this._onMove=a=>{if(!this._isDragging){const c=this._clickTolerance||this._map._clickTolerance;this._isDragging=a.point.dist(this._pointerdownPos)>=c}this._isDragging&&(this._pos=a.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.l("dragstart"))),this.fire(new o.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.l("dragend")),this._state="inactive"},this._addDragHandler=a=>{this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._pointerdownPos=a.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=o.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=U.create("div");const a=U.createNS("http://www.w3.org/2000/svg","svg"),c=41,f=27;a.setAttributeNS(null,"display","block"),a.setAttributeNS(null,"height",`${c}px`),a.setAttributeNS(null,"width",`${f}px`),a.setAttributeNS(null,"viewBox",`0 0 ${f} ${c}`);const y=U.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"stroke","none"),y.setAttributeNS(null,"stroke-width","1"),y.setAttributeNS(null,"fill","none"),y.setAttributeNS(null,"fill-rule","evenodd");const w=U.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"fill-rule","nonzero");const A=U.createNS("http://www.w3.org/2000/svg","g");A.setAttributeNS(null,"transform","translate(3.0, 29.0)"),A.setAttributeNS(null,"fill","#000000");const P=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const oe of P){const ue=U.createNS("http://www.w3.org/2000/svg","ellipse");ue.setAttributeNS(null,"opacity","0.04"),ue.setAttributeNS(null,"cx","10.5"),ue.setAttributeNS(null,"cy","5.80029008"),ue.setAttributeNS(null,"rx",oe.rx),ue.setAttributeNS(null,"ry",oe.ry),A.appendChild(ue)}const k=U.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"fill",this._color);const O=U.createNS("http://www.w3.org/2000/svg","path");O.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),k.appendChild(O);const F=U.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"opacity","0.25"),F.setAttributeNS(null,"fill","#000000");const j=U.createNS("http://www.w3.org/2000/svg","path");j.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),F.appendChild(j);const G=U.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"transform","translate(6.0, 7.0)"),G.setAttributeNS(null,"fill","#FFFFFF");const X=U.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"transform","translate(8.0, 8.0)");const se=U.createNS("http://www.w3.org/2000/svg","circle");se.setAttributeNS(null,"fill","#000000"),se.setAttributeNS(null,"opacity","0.25"),se.setAttributeNS(null,"cx","5.5"),se.setAttributeNS(null,"cy","5.5"),se.setAttributeNS(null,"r","5.4999962");const ae=U.createNS("http://www.w3.org/2000/svg","circle");ae.setAttributeNS(null,"fill","#FFFFFF"),ae.setAttributeNS(null,"cx","5.5"),ae.setAttributeNS(null,"cy","5.5"),ae.setAttributeNS(null,"r","5.4999962"),X.appendChild(se),X.appendChild(ae),w.appendChild(A),w.appendChild(k),w.appendChild(F),w.appendChild(G),w.appendChild(X),a.appendChild(w),a.setAttributeNS(null,"height",c*this._scale+"px"),a.setAttributeNS(null,"width",f*this._scale+"px"),this._element.appendChild(a),this._offset=o.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(a=>{a.preventDefault()})),this._element.addEventListener("mousedown",(a=>{a.preventDefault()})),bo(this._element,this._anchor,"marker"),e&&e.className)for(const a of e.className.split(" "))this._element.classList.add(a);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),U.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=o.S.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const f=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[f,-1*(38.1-13.5+f)],"bottom-right":[-f,-1*(38.1-13.5+f)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var a,c;const f=(a=this._map)===null||a===void 0?void 0:a.terrain,y=this._map.transform.isLocationOccluded(this._lngLat);if(!f||y){const G=y?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==G&&(this._element.style.opacity=G))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const w=this._map,A=w.terrain.depthAtPoint(this._pos),P=w.terrain.getElevationForLngLatZoom(this._lngLat,w.transform.tileZoom);if(w.transform.lngLatToCameraDepth(this._lngLat,P)-A<.006)return void(this._element.style.opacity=this._opacity);const k=-this._offset.y/w.transform.pixelsPerMeter,O=Math.sin(w.getPitch()*Math.PI/180)*k,F=w.terrain.depthAtPoint(new o.P(this._pos.x,this._pos.y-this._offset.y)),j=w.transform.lngLatToCameraDepth(this._lngLat,P+O)-F>.006;!((c=this._popup)===null||c===void 0)&&c.isOpen()&&j&&this._popup.remove(),this._element.style.opacity=j?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=o.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,a){return(this._opacity===void 0||e===void 0&&a===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),a!==void 0&&(this._opacityWhenCovered=a),this._map&&this._updateOpacity(!0),this}}const Nr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let mn=0,Gs=!1;const Zs={maxWidth:100,unit:"metric"};function pl(m,e,a){const c=a&&a.maxWidth||100,f=m._container.clientHeight/2,y=m._container.clientWidth/2,w=m.unproject([y-c/2,f]),A=m.unproject([y+c/2,f]),P=Math.round(m.project(A).x-m.project(w).x),k=Math.min(c,P,m._container.clientWidth),O=w.distanceTo(A);if(a&&a.unit==="imperial"){const F=3.2808*O;F>5280?qs(e,k,F/5280,m._getUIString("ScaleControl.Miles")):qs(e,k,F,m._getUIString("ScaleControl.Feet"))}else a&&a.unit==="nautical"?qs(e,k,O/1852,m._getUIString("ScaleControl.NauticalMiles")):O>=1e3?qs(e,k,O/1e3,m._getUIString("ScaleControl.Kilometers")):qs(e,k,O,m._getUIString("ScaleControl.Meters"))}function qs(m,e,a,c){const f=(function(y){const w=Math.pow(10,`${Math.floor(y)}`.length-1);let A=y/w;return A=A>=10?10:A>=5?5:A>=3?3:A>=2?2:A>=1?1:(function(P){const k=Math.pow(10,Math.ceil(-Math.log(P)/Math.LN10));return Math.round(P*k)/k})(A),w*A})(a);m.style.width=e*(f/a)+"px",m.innerHTML=`${f}&nbsp;${c}`}const Qa={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},nc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function rc(m){if(m){if(typeof m=="number"){const e=Math.round(Math.abs(m)/Math.SQRT2);return{center:new o.P(0,0),top:new o.P(0,m),"top-left":new o.P(e,e),"top-right":new o.P(-e,e),bottom:new o.P(0,-m),"bottom-left":new o.P(e,-e),"bottom-right":new o.P(-e,-e),left:new o.P(m,0),right:new o.P(-m,0)}}if(m instanceof o.P||Array.isArray(m)){const e=o.P.convert(m);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:o.P.convert(m.center||[0,0]),top:o.P.convert(m.top||[0,0]),"top-left":o.P.convert(m["top-left"]||[0,0]),"top-right":o.P.convert(m["top-right"]||[0,0]),bottom:o.P.convert(m.bottom||[0,0]),"bottom-left":o.P.convert(m["bottom-left"]||[0,0]),"bottom-right":o.P.convert(m["bottom-right"]||[0,0]),left:o.P.convert(m.left||[0,0]),right:o.P.convert(m.right||[0,0])}}return rc(new o.P(0,0))}const au=L;T.AJAXError=o.cz,T.Event=o.l,T.Evented=o.E,T.LngLat=o.S,T.MercatorCoordinate=o.a1,T.Point=o.P,T.addProtocol=o.cA,T.config=o.a,T.removeProtocol=o.cB,T.AttributionControl=xi,T.BoxZoomHandler=ol,T.CanvasSource=Za,T.CooperativeGesturesHandler=rd,T.DoubleClickZoomHandler=cl,T.DragPanHandler=ec,T.DragRotateHandler=ul,T.EdgeInsets=Is,T.FullscreenControl=class extends o.E{constructor(m={}){super(),this._onFullscreenChange=()=>{var e;let a=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=a==null?void 0:a.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)a=a.shadowRoot.fullscreenElement;a===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,m&&m.container&&(m.container instanceof HTMLElement?this._container=m.container:o.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=U.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){U.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const m=this._fullscreenButton=U.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);U.create("span","maplibregl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.title=m}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new o.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new o.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},T.GeoJSONSource=wa,T.GeolocateControl=class extends o.E{constructor(m){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new o.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new o.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const a=new o.S(e.coords.longitude,e.coords.latitude),c=e.coords.accuracy,f=this._map.getBearing(),y=o.e({bearing:f},this.options.fitBoundsOptions),w=Ti.fromLngLat(a,c);this._map.fitBounds(w,y,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const a=new o.S(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&Gs)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new o.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this._geolocateButton=U.create("button","maplibregl-ctrl-geolocate",this._container),U.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=U.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new wo({element:this._dotElement}),this._circleElement=U.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new wo({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(a=>{const c=(a==null?void 0:a[0])instanceof ResizeObserverEntry;a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||c||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new o.l("trackuserlocationend")),this.fire(new o.l("userlocationlostfocus")))}))}},this.options=o.e({},Nr,m)}onAdd(m){return this._map=m,this._container=U.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return o._(this,arguments,void 0,(function*(e=!1){if(Zi!==void 0&&!e)return Zi;if(window.navigator.permissions===void 0)return Zi=!!window.navigator.geolocation,Zi;try{Zi=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Zi=!!window.navigator.geolocation}return Zi}))})().then((e=>this._finishSetupUI(e))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),U.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,mn=0,Gs=!1}_isOutOfMapMaxBounds(m){const e=this._map.getMaxBounds(),a=m.coords;return e&&(a.longitude<e.getWest()||a.longitude>e.getEast()||a.latitude<e.getSouth()||a.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const m=this._map.getBounds(),e=m.getSouthEast(),a=m.getNorthEast(),c=e.distanceTo(a),f=Math.ceil(this._accuracy/(c/this._map._container.clientHeight)*2);this._circleElement.style.width=`${f}px`,this._circleElement.style.height=`${f}px`}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":mn--,Gs=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new o.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.l("trackuserlocationstart")),this.fire(new o.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),mn++,mn>1?(m={maximumAge:6e5,timeout:0},Gs=!0):(m=this.options.positionOptions,Gs=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,m)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},T.GlobeControl=class{constructor(){this._toggleProjection=()=>{var m;const e=(m=this._map.getProjection())===null||m===void 0?void 0:m.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var m;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((m=this._map.getProjection())===null||m===void 0?void 0:m.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(m){return this._map=m,this._container=U.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=U.create("button","maplibregl-ctrl-globe",this._container),U.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){U.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},T.Hash=Aa,T.ImageSource=Ar,T.KeyboardHandler=Ka,T.LngLatBounds=Ti,T.LogoControl=Wi,T.Map=class extends Wu{constructor(m){var e,a;o.cw.mark(o.cx.create);const c=Object.assign(Object.assign(Object.assign({},ra),m),{canvasContextAttributes:Object.assign(Object.assign({},ra.canvasContextAttributes),m.canvasContextAttributes)});if(c.minZoom!=null&&c.maxZoom!=null&&c.minZoom>c.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(c.minPitch!=null&&c.maxPitch!=null&&c.minPitch>c.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(c.minPitch!=null&&c.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(c.maxPitch!=null&&c.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const f=new Li,y=new Mn;if(c.minZoom!==void 0&&f.setMinZoom(c.minZoom),c.maxZoom!==void 0&&f.setMaxZoom(c.maxZoom),c.minPitch!==void 0&&f.setMinPitch(c.minPitch),c.maxPitch!==void 0&&f.setMaxPitch(c.maxPitch),c.renderWorldCopies!==void 0&&f.setRenderWorldCopies(c.renderWorldCopies),super(f,y,{bearingSnap:c.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Ki,this._controls=[],this._mapId=o.a7(),this._contextLost=A=>{A.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new o.l("webglcontextlost",{originalEvent:A}))},this._contextRestored=A=>{this._setupPainter(),this.resize(),this._update(),this.fire(new o.l("webglcontextrestored",{originalEvent:A}))},this._onMapScroll=A=>{if(A.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=c.interactive,this._maxTileCacheSize=c.maxTileCacheSize,this._maxTileCacheZoomLevels=c.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},c.canvasContextAttributes),this._trackResize=c.trackResize===!0,this._bearingSnap=c.bearingSnap,this._centerClampedToGround=c.centerClampedToGround,this._refreshExpiredTiles=c.refreshExpiredTiles===!0,this._fadeDuration=c.fadeDuration,this._crossSourceCollisions=c.crossSourceCollisions===!0,this._collectResourceTiming=c.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Hr),c.locale),this._clickTolerance=c.clickTolerance,this._overridePixelRatio=c.pixelRatio,this._maxCanvasSize=c.maxCanvasSize,this.transformCameraUpdate=c.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=c.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=ke.addThrottleControl((()=>this.isMoving())),this._requestManager=new Ve(c.transformRequest),typeof c.container=="string"){if(this._container=document.getElementById(c.container),!this._container)throw new Error(`Container '${c.container}' not found.`)}else{if(!(c.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=c.container}if(c.maxBounds&&this.setMaxBounds(c.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let A=!1;const P=ga((k=>{this._trackResize&&!this._removed&&(this.resize(k),this.redraw())}),50);this._resizeObserver=new ResizeObserver((k=>{A?P(k):A=!0})),this._resizeObserver.observe(this._container)}this.handlers=new ru(this,c),this._hash=c.hash&&new Aa(typeof c.hash=="string"&&c.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:c.center,elevation:c.elevation,zoom:c.zoom,bearing:c.bearing,pitch:c.pitch,roll:c.roll}),c.bounds&&(this.resize(),this.fitBounds(c.bounds,o.e({},c.fitBoundsOptions,{duration:0}))));const w=typeof c.style=="string"||((a=(e=c.style)===null||e===void 0?void 0:e.projection)===null||a===void 0?void 0:a.type)!=="globe";this.resize(null,w),this._localIdeographFontFamily=c.localIdeographFontFamily,this._validateStyle=c.validateStyle,c.style&&this.setStyle(c.style,{localIdeographFontFamily:c.localIdeographFontFamily}),c.attributionControl&&this.addControl(new xi(typeof c.attributionControl=="boolean"?void 0:c.attributionControl)),c.maplibreLogo&&this.addControl(new Wi,c.logoPosition),this.on("style.load",(()=>{if(w||this._resizeTransform(),this.transform.unmodified){const A=o.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(A)}})),this.on("data",(A=>{this._update(A.dataType==="style"),this.fire(new o.l(`${A.dataType}data`,A))})),this.on("dataloading",(A=>{this.fire(new o.l(`${A.dataType}dataloading`,A))})),this.on("dataabort",(A=>{this.fire(new o.l("sourcedataabort",A))}))}_getMapId(){return this._mapId}setGlobalStateProperty(m,e){return this.style.setGlobalStateProperty(m,e),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(m,e){if(e===void 0&&(e=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new o.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const a=m.onAdd(this);this._controls.push(m);const c=this._controlPositions[e];return e.indexOf("bottom")!==-1?c.insertBefore(a,c.firstChild):c.appendChild(a),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new o.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(m);return e>-1&&this._controls.splice(e,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}coveringTiles(m){return Ie(this.transform,m)}calculateCameraOptionsFromTo(m,e,a,c){return c==null&&this.terrain&&(c=this.terrain.getElevationForLngLatZoom(a,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(m,e,a,c)}resize(m,e=!0){const[a,c]=this._containerDimensions(),f=this._getClampedPixelRatio(a,c);if(this._resizeCanvas(a,c,f),this.painter.resize(a,c,f),this.painter.overLimit()){const w=this.painter.context.gl;this._maxCanvasSize=[w.drawingBufferWidth,w.drawingBufferHeight];const A=this._getClampedPixelRatio(a,c);this._resizeCanvas(a,c,A),this.painter.resize(a,c,A)}this._resizeTransform(e);const y=!this._moving;return y&&(this.stop(),this.fire(new o.l("movestart",m)).fire(new o.l("move",m))),this.fire(new o.l("resize",m)),y&&this.fire(new o.l("moveend",m)),this}_resizeTransform(m=!0){var e;const[a,c]=this._containerDimensions();this.transform.resize(a,c,m),(e=this._requestedCameraState)===null||e===void 0||e.resize(a,c,m)}_getClampedPixelRatio(m,e){const{0:a,1:c}=this._maxCanvasSize,f=this.getPixelRatio(),y=m*f,w=e*f;return Math.min(y>a?a/y:1,w>c?c/w:1)*f}getPixelRatio(){var m;return(m=this._overridePixelRatio)!==null&&m!==void 0?m:devicePixelRatio}setPixelRatio(m){this._overridePixelRatio=m,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(m){return this.transform.setMaxBounds(Ti.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.setMinZoom(m),this._update(),this.getZoom()<m&&this.setZoom(m),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.setMaxZoom(m),this._update(),this.getZoom()>m&&this.setZoom(m),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.setMinPitch(m),this._update(),this.getPitch()<m&&this.setPitch(m),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(m>=this.transform.minPitch)return this.transform.setMaxPitch(m),this._update(),this.getPitch()>m&&this.setPitch(m),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.setRenderWorldCopies(m),this._update()}project(m){return this.transform.locationToScreenPoint(o.S.convert(m),this.style&&this.terrain)}unproject(m){return this.transform.screenPointToLocation(o.P.convert(m),this.terrain)}isMoving(){var m;return this._moving||((m=this.handlers)===null||m===void 0?void 0:m.isMoving())}isZooming(){var m;return this._zooming||((m=this.handlers)===null||m===void 0?void 0:m.isZooming())}isRotating(){var m;return this._rotating||((m=this.handlers)===null||m===void 0?void 0:m.isRotating())}_createDelegatedListener(m,e,a){if(m==="mouseenter"||m==="mouseover"){let c=!1;return{layers:e,listener:a,delegates:{mousemove:y=>{const w=e.filter((P=>this.getLayer(P))),A=w.length!==0?this.queryRenderedFeatures(y.point,{layers:w}):[];A.length?c||(c=!0,a.call(this,new $r(m,this,y.originalEvent,{features:A}))):c=!1},mouseout:()=>{c=!1}}}}if(m==="mouseleave"||m==="mouseout"){let c=!1;return{layers:e,listener:a,delegates:{mousemove:w=>{const A=e.filter((P=>this.getLayer(P)));(A.length!==0?this.queryRenderedFeatures(w.point,{layers:A}):[]).length?c=!0:c&&(c=!1,a.call(this,new $r(m,this,w.originalEvent)))},mouseout:w=>{c&&(c=!1,a.call(this,new $r(m,this,w.originalEvent)))}}}}{const c=f=>{const y=e.filter((A=>this.getLayer(A))),w=y.length!==0?this.queryRenderedFeatures(f.point,{layers:y}):[];w.length&&(f.features=w,a.call(this,f),delete f.features)};return{layers:e,listener:a,delegates:{[m]:c}}}}_saveDelegatedListener(m,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(e)}_removeDelegatedListener(m,e,a){if(!this._delegatedListeners||!this._delegatedListeners[m])return;const c=this._delegatedListeners[m];for(let f=0;f<c.length;f++){const y=c[f];if(y.listener===a&&y.layers.length===e.length&&y.layers.every((w=>e.includes(w)))){for(const w in y.delegates)this.off(w,y.delegates[w]);return void c.splice(f,1)}}}on(m,e,a){if(a===void 0)return super.on(m,e);const c=typeof e=="string"?[e]:e,f=this._createDelegatedListener(m,c,a);this._saveDelegatedListener(m,f);for(const y in f.delegates)this.on(y,f.delegates[y]);return{unsubscribe:()=>{this._removeDelegatedListener(m,c,a)}}}once(m,e,a){if(a===void 0)return super.once(m,e);const c=typeof e=="string"?[e]:e,f=this._createDelegatedListener(m,c,a);for(const y in f.delegates){const w=f.delegates[y];f.delegates[y]=(...A)=>{this._removeDelegatedListener(m,c,a),w(...A)}}this._saveDelegatedListener(m,f);for(const y in f.delegates)this.once(y,f.delegates[y]);return this}off(m,e,a){return a===void 0?super.off(m,e):(this._removeDelegatedListener(m,typeof e=="string"?[e]:e,a),this)}queryRenderedFeatures(m,e){if(!this.style)return[];let a;const c=m instanceof o.P||Array.isArray(m),f=c?m:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(c?{}:m)||{},f instanceof o.P||typeof f[0]=="number")a=[o.P.convert(f)];else{const y=o.P.convert(f[0]),w=o.P.convert(f[1]);a=[y,new o.P(w.x,y.y),w,new o.P(y.x,w.y),y]}return this.style.queryRenderedFeatures(a,e,this.transform)}querySourceFeatures(m,e){return this.style.querySourceFeatures(m,e)}setStyle(m,e){return(e=o.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&m?(this._diffStyle(m,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(m,e))}setTransformRequest(m){return this._requestManager.setTransformRequest(m),this}_getUIString(m){const e=this._locale[m];if(e==null)throw new Error(`Missing UI string '${m}'`);return e}_updateStyle(m,e){var a,c;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(m,e)));const f=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!m)),m?(this.style=new Vh(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof m=="string"?this.style.loadURL(m,e,f):this.style.loadJSON(m,e,f),this):((c=(a=this.style)===null||a===void 0?void 0:a.projection)===null||c===void 0||c.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Vh(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(m,e){if(typeof m=="string"){const a=this._requestManager.transformRequest(m,"Style");o.j(a,new AbortController).then((c=>{this._updateDiff(c.data,e)})).catch((c=>{c&&this.fire(new o.k(c))}))}else typeof m=="object"&&this._updateDiff(m,e)}_updateDiff(m,e){try{this.style.setState(m,e)&&this._update(!0)}catch(a){o.w(`Unable to perform style diff: ${a.message||a.error||a}.  Rebuilding the style from scratch.`),this._updateStyle(m,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():o.w("There is no style added to the map.")}addSource(m,e){return this._lazyInitEmptyStyle(),this.style.addSource(m,e),this._update(!0)}isSourceLoaded(m){const e=this.style&&this.style.sourceCaches[m];if(e!==void 0)return e.loaded();this.fire(new o.k(new Error(`There is no source with ID '${m}'`)))}setTerrain(m){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),m){const e=this.style.sourceCaches[m.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${m.source}`);this.terrain===null&&e.reload();for(const a in this.style._layers){const c=this.style._layers[a];c.type==="hillshade"&&c.source===m.source&&o.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),c.type==="color-relief"&&c.source===m.source&&o.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Ft(this.painter,e,m),this.painter.renderToTexture=new Vs(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=a=>{var c;a.dataType==="style"?this.terrain.sourceCache.freeRtt():a.dataType==="source"&&a.tile&&(a.sourceId!==m.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((c=a.source)===null||c===void 0?void 0:c.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(a.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new o.l("terrain",{terrain:m})),this}getTerrain(){var m,e;return(e=(m=this.terrain)===null||m===void 0?void 0:m.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const m=this.style&&this.style.sourceCaches;for(const e in m){const a=m[e]._tiles;for(const c in a){const f=a[c];if(f.state!=="loaded"&&f.state!=="errored")return!1}}return!0}removeSource(m){return this.style.removeSource(m),this._update(!0)}getSource(m){return this.style.getSource(m)}setSourceTileLodParams(m,e,a){if(a){const c=this.getSource(a);if(!c)throw new Error(`There is no source with ID "${a}", cannot set LOD parameters`);c.calculateTileZoom=dt(Math.max(1,m),Math.max(1,e))}else for(const c in this.style.sourceCaches)this.style.sourceCaches[c].getSource().calculateTileZoom=dt(Math.max(1,m),Math.max(1,e));return this._update(!0),this}refreshTiles(m,e){const a=this.style.sourceCaches[m];if(!a)throw new Error(`There is no source cache with ID "${m}", cannot refresh tile`);e===void 0?a.reload(!0):a.refreshTiles(e.map((c=>new o.a4(c.z,c.x,c.y))))}addImage(m,e,a={}){const{pixelRatio:c=1,sdf:f=!1,stretchX:y,stretchY:w,content:A,textFitWidth:P,textFitHeight:k}=a;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||o.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new o.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:O,height:F,data:j}=e,G=e;return this.style.addImage(m,{data:new o.R({width:O,height:F},new Uint8Array(j)),pixelRatio:c,stretchX:y,stretchY:w,content:A,textFitWidth:P,textFitHeight:k,sdf:f,version:0,userImage:G}),G.onAdd&&G.onAdd(this,m),this}}{const{width:O,height:F,data:j}=ee.getImageData(e);this.style.addImage(m,{data:new o.R({width:O,height:F},j),pixelRatio:c,stretchX:y,stretchY:w,content:A,textFitWidth:P,textFitHeight:k,sdf:f,version:0})}}updateImage(m,e){const a=this.style.getImage(m);if(!a)return this.fire(new o.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const c=e instanceof HTMLImageElement||o.b(e)?ee.getImageData(e):e,{width:f,height:y,data:w}=c;if(f===void 0||y===void 0)return this.fire(new o.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(f!==a.data.width||y!==a.data.height)return this.fire(new o.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const A=!(e instanceof HTMLImageElement||o.b(e));return a.data.replace(w,A),this.style.updateImage(m,a),this}getImage(m){return this.style.getImage(m)}hasImage(m){return m?!!this.style.getImage(m):(this.fire(new o.k(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m){return ke.getImage(this._requestManager.transformRequest(m,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(m,e){return this._lazyInitEmptyStyle(),this.style.addLayer(m,e),this._update(!0)}moveLayer(m,e){return this.style.moveLayer(m,e),this._update(!0)}removeLayer(m){return this.style.removeLayer(m),this._update(!0)}getLayer(m){return this.style.getLayer(m)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(m,e,a){return this.style.setLayerZoomRange(m,e,a),this._update(!0)}setFilter(m,e,a={}){return this.style.setFilter(m,e,a),this._update(!0)}getFilter(m){return this.style.getFilter(m)}setPaintProperty(m,e,a,c={}){return this.style.setPaintProperty(m,e,a,c),this._update(!0)}getPaintProperty(m,e){return this.style.getPaintProperty(m,e)}setLayoutProperty(m,e,a,c={}){return this.style.setLayoutProperty(m,e,a,c),this._update(!0)}getLayoutProperty(m,e){return this.style.getLayoutProperty(m,e)}setGlyphs(m,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(m,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(m,e,a={}){return this._lazyInitEmptyStyle(),this.style.addSprite(m,e,a,(c=>{c||this._update(!0)})),this}removeSprite(m){return this._lazyInitEmptyStyle(),this.style.removeSprite(m),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(m,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(m,e,(a=>{a||this._update(!0)})),this}setLight(m,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(m,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(m,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(m,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(m,e){return this.style.setFeatureState(m,e),this._update()}removeFeatureState(m,e){return this.style.removeFeatureState(m,e),this._update()}getFeatureState(m){return this.style.getFeatureState(m)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let m=0,e=0;return this._container&&(m=this._container.clientWidth||400,e=this._container.clientHeight||300),[m,e]}_setupContainer(){const m=this._container;m.classList.add("maplibregl-map");const e=this._canvasContainer=U.create("div","maplibregl-canvas-container",m);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=U.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const a=this._containerDimensions(),c=this._getClampedPixelRatio(a[0],a[1]);this._resizeCanvas(a[0],a[1],c);const f=this._controlContainer=U.create("div","maplibregl-control-container",m),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((w=>{y[w]=U.create("div",`maplibregl-ctrl-${w} `,f)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,e,a){this._canvas.width=Math.floor(a*m),this._canvas.height=Math.floor(a*e),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const m=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",(c=>{e={requestedAttributes:m},c&&(e.statusMessage=c.statusMessage,e.type=c.type)}),{once:!0});let a=null;if(a=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,m):this._canvas.getContext("webgl2",m)||this._canvas.getContext("webgl",m),!a){const c="Failed to initialize WebGL";throw e?(e.message=c,new Error(JSON.stringify(e))):new Error(c)}this.painter=new Zu(a,this.transform),le.testSupport(a)}migrateProjection(m,e){super.migrateProjection(m,e),this.painter.transform=m,this.fire(new o.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(m){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_render(m){var e,a,c,f,y;const w=this._idleTriggered?this._fadeDuration:0,A=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(m),this._removed)return;let P=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const F=this.transform.zoom,j=ee.now();this.style.zoomHistory.update(F,j);const G=new o.F(F,{now:j,fadeDuration:w,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition(),globalState:this.style.getGlobalState()}),X=G.crossFadingFactor();X===1&&X===this._crossFadingFactor||(P=!0,this._crossFadingFactor=X),this.style.update(G)}const k=((a=this.style.projection)===null||a===void 0?void 0:a.transitionState)>0!==A;(c=this.style.projection)===null||c===void 0||c.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((f=this.style.projection)===null||f===void 0?void 0:f.transitionState,(y=this.style.projection)===null||y===void 0?void 0:y.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||k)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,w,this._crossSourceCollisions,k),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:w,showPadding:this.showPadding}),this.fire(new o.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.cw.mark(o.cx.load),this.fire(new o.l("load"))),this.style&&(this.style.hasTransitions()||P)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const O=this._sourcesDirty||this._styleDirty||this._placementDirty;return O||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.l("idle")),!this._loaded||this._fullyLoaded||O||(this._fullyLoaded=!0,o.cw.mark(o.cx.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var m;this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),ke.removeThrottleControl(this._imageQueueHandle),(m=this._resizeObserver)===null||m===void 0||m.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e!=null&&e.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),U.remove(this._canvasContainer),U.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),o.cw.clearMetrics(),this._removed=!0,this.fire(new o.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,ee.frame(this._frameRequest,(m=>{o.cw.frame(m),this._frameRequest=null;try{this._render(m)}catch(e){if(!o.cy(e)&&!(function(a){return a.message===Xc})(e))throw e}}),(()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get version(){return Dn}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(m){return this._lazyInitEmptyStyle(),this.style.setProjection(m),this._update(!0)}},T.MapMouseEvent=$r,T.MapTouchEvent=Xl,T.MapWheelEvent=ed,T.Marker=wo,T.NavigationControl=class{constructor(m){this._updateZoomButtons=()=>{const e=this._map.getZoom(),a=e===this._map.getMaxZoom(),c=e===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=c,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",c.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,a)=>{const c=this._map._getUIString(`NavigationControl.${a}`);e.title=c,e.setAttribute("aria-label",c)},this.options=o.e({},ad,m),this._container=U.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(e=>this._map.zoomIn({},{originalEvent:e}))),U.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(e=>this._map.zoomOut({},{originalEvent:e}))),U.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})})),this._compassIcon=U.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new tc(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){U.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(m,e){const a=U.create("button",m,this._container);return a.type="button",a.addEventListener("click",e),a}},T.Popup=class extends o.E{constructor(m){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&U.remove(this._content),this._container&&(U.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new o.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=U.create("div","maplibregl-popup",this._map.getContainer()),this._tip=U.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const w of this.options.className.split(" "))this._container.classList.add(w);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=kn(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!e)return;const a=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let c=this.options.anchor;const f=rc(this.options.offset);if(!c){const w=this._container.offsetWidth,A=this._container.offsetHeight;let P;P=a.y+f.bottom.y<A?["top"]:a.y>this._map.transform.height-A?["bottom"]:[],a.x<w/2?P.push("left"):a.x>this._map.transform.width-w/2&&P.push("right"),c=P.length===0?"bottom":P.join("-")}let y=a.add(f[c]);this.options.subpixelPositioning||(y=y.round()),U.setTransform(this._container,`${ic[c]} translate(${y.x}px,${y.y}px)`),bo(this._container,c,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=o.e(Object.create(Qa),m)}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new o.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(m){return this._lngLat=o.S.convert(m),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(document.createTextNode(m))}setHTML(m){const e=document.createDocumentFragment(),a=document.createElement("body");let c;for(a.innerHTML=m;c=a.firstChild,c;)e.appendChild(c);return this.setDOMContent(e)}getMaxWidth(){var m;return(m=this._container)===null||m===void 0?void 0:m.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=U.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(m),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(m){return this._container&&this._container.classList.add(m),this}removeClassName(m){return this._container&&this._container.classList.remove(m),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){if(this._container)return this._container.classList.toggle(m)}setSubpixelPositioning(m){this.options.subpixelPositioning=m}_createCloseButton(){this.options.closeButton&&(this._closeButton=U.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(nc);m&&m.focus()}},T.RasterDEMTileSource=zn,T.RasterTileSource=Mr,T.ScaleControl=class{constructor(m){this._onMove=()=>{pl(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,pl(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Zs),m)}getDefaultPosition(){return"bottom-left"}onAdd(m){return this._map=m,this._container=U.create("div","maplibregl-ctrl maplibregl-ctrl-scale",m.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){U.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},T.ScrollZoomHandler=Us,T.Style=Vh,T.TerrainControl=class{constructor(m){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=m}onAdd(m){return this._map=m,this._container=U.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=U.create("button","maplibregl-ctrl-terrain",this._container),U.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){U.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},T.TwoFingersTouchPitchHandler=iu,T.TwoFingersTouchRotateHandler=ll,T.TwoFingersTouchZoomHandler=tu,T.TwoFingersTouchZoomRotateHandler=nd,T.VectorTileSource=fr,T.VideoSource=jo,T.addSourceType=(m,e)=>o._(void 0,void 0,void 0,(function*(){if(As(m))throw new Error(`A source type called "${m}" already exists.`);((a,c)=>{io[a]=c})(m,e)})),T.clearPrewarmedResources=function(){const m=ft;m&&(m.isPreloaded()&&m.numActive()===1?(m.release(be),ft=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},T.createTileMesh=jh,T.getMaxParallelImageRequests=function(){return o.a.MAX_PARALLEL_IMAGE_REQUESTS},T.getRTLTextPluginStatus=function(){return Yn().getRTLTextPluginStatus()},T.getVersion=function(){return au},T.getWorkerCount=function(){return Ke.workerCount},T.getWorkerUrl=function(){return o.a.WORKER_URL},T.importScriptInWorkers=function(m){return At().broadcast("IS",m)},T.prewarm=function(){Kt().acquire(be)},T.setMaxParallelImageRequests=function(m){o.a.MAX_PARALLEL_IMAGE_REQUESTS=m},T.setRTLTextPlugin=function(m,e){return Yn().setRTLTextPlugin(m,e)},T.setWorkerCount=function(m){Ke.workerCount=m},T.setWorkerUrl=function(m){o.a.WORKER_URL=m}}));var R=g;return R}))})(Wg)),Wg.exports}var Cm=FC();const UC=[{id:"tanshui-taiwan",name:"Tanshui, Taiwan",coordinates:[121.46258584635854,25.18136115573805]},{id:"fangshan-taiwan",name:"Fangshan, Taiwan",coordinates:[120.66209813218148,22.249258581382197]},{id:"toucheng-taiwan",name:"Toucheng, Taiwan",coordinates:[121.80145279380189,24.863592858849902]},{id:"dongyin-taiwan",name:"Dongyin, Taiwan",coordinates:[120.49296999999949,26.367330000000443]},{id:"yuanli-taiwan",name:"Yuanli, Taiwan",coordinates:[120.64548999999985,24.432460000000326]},{id:"jinhu-township-taiwan",name:"Jinhu Township, Taiwan",coordinates:[118.43943999999946,24.437479999999816]},{id:"budai-taiwan",name:"Budai, Taiwan",coordinates:[120.17046999999953,23.362789999999872]},{id:"huxi-township-taiwan",name:"Huxi Township, Taiwan",coordinates:[119.65616000000064,23.573629999999714]},{id:"jincheng-township-taiwan",name:"Jincheng Township, Taiwan",coordinates:[118.31584,24.413410000000344]},{id:"tainan-taiwan",name:"Tainan, Taiwan",coordinates:[120.18086199999875,22.99721]},{id:"taoyuan-taiwan",name:"Taoyuan, Taiwan",coordinates:[121.31111109999966,24.98888889999996]},{id:"nangan-taiwan",name:"Nangan, Taiwan",coordinates:[119.93435,26.15516]},{id:"magong-taiwan",name:"Magong, Taiwan",coordinates:[119.5745100000003,23.571549999999434]},{id:"xiyu-township-taiwan",name:"Xiyu Township, Taiwan",coordinates:[119.51201999999984,23.60192]},{id:"xiju-taiwan",name:"Xiju, Taiwan",coordinates:[119.93907578760941,25.973144107820715]},{id:"beigan-taiwan",name:"Beigan, Taiwan",coordinates:[119.98859,26.225399999999755]},{id:"pa-li-taiwan",name:"Pa-li, Taiwan",coordinates:[121.38319137135348,25.149983824511253]}];function Rb(p,h){const g=new Set;for(const L of h)for(const N of p)N.includes(L)&&g.add(JSON.stringify(N));const b=Array.from(g).map(L=>JSON.parse(L)),C=p.flat(),R=b.flat(),T=new Set(R),o=[];for(const L of T){const N=C.filter(Y=>Y===L).length,Z=R.filter(Y=>Y===L).length;N===Z&&o.push(L)}return o.sort()}function VC(p,h,g){const b=g.filter(C=>C.cableid===h.id&&(!C.resolved_at||C.resolved_at===""));if(b.length>0&&h.available_path){const C=b.map(T=>T.segment);if(Rb(h.available_path,C).includes(p.id))return"broken"}return"normal"}function GC(p,h,g){if(p.color)return p.color;const b=g.filter(C=>C.cableid===h.id&&(!C.resolved_at||C.resolved_at===""));if(b.length>0&&h.available_path){const C=b.map(T=>T.segment);if(Rb(h.available_path,C).includes(p.id))return"#ff0000"}return h.color||"#48A9FF"}async function ZC(){const h=Object.values(Object.assign({"../data/cables/apcn2.json":()=>Bi(()=>import("./apcn2-Bh9jGbNC.js"),[]),"../data/cables/apg.json":()=>Bi(()=>import("./apg-C1vLTMzs.js"),[]),"../data/cables/c2c.json":()=>Bi(()=>import("./c2c-CIlxF3Xy.js"),[]),"../data/cables/eac1.json":()=>Bi(()=>import("./eac1-BghIn5se.js"),[]),"../data/cables/eac2.json":()=>Bi(()=>import("./eac2-B1dtEGmT.js"),[]),"../data/cables/faster.json":()=>Bi(()=>import("./faster-V2HAUowD.js"),[]),"../data/cables/nacs.json":()=>Bi(()=>import("./nacs-C7uqQAFw.js"),[]),"../data/cables/ncp.json":()=>Bi(()=>import("./ncp-Dai6JBI_.js"),[]),"../data/cables/sjc2.json":()=>Bi(()=>import("./sjc2-B7r4FIKP.js"),[]),"../data/cables/tpkm3.json":()=>Bi(()=>import("./tpkm3-D-NJAXGL.js"),[]),"../data/cables/tse1.json":()=>Bi(()=>import("./tse1-igmh4_2Z.js"),[]),"../data/cables/twpk1.json":()=>Bi(()=>import("./twpk1-CKlBze6Z.js"),[]),"../data/cables/twpk3.json":()=>Bi(()=>import("./twpk3-Cpef6JXS.js"),[]),"../data/cables/twtk2.json":()=>Bi(()=>import("./twtk2-CAv4JbII.js"),[]),"../data/cables/twtm2.json":()=>Bi(()=>import("./twtm2-DvzU2CDB.js"),[]),"../data/cables/twtm3.json":()=>Bi(()=>import("./twtm3-BAru4NER.js"),[]),"../data/cables/twtp2.json":()=>Bi(()=>import("./twtp2-w_2Xomoa.js"),[]),"../data/cables/twtp3.json":()=>Bi(()=>import("./twtp3-BNNq2ktB.js"),[])})).map(async g=>(await g()).default);return Promise.all(h)}const zb=J.forwardRef(({map:p,cableFilter:h="all"})=>{const g=J.useRef(!1),b=J.useRef(new Set),C=J.useRef(null),{data:R,isLoading:T}=my({queryKey:["incidents"],queryFn:async()=>{try{const Z=await fetch("/data/incidents.json");if(!Z.ok)throw new Error(`Failed to fetch incidents: ${Z.status}`);return await Z.json()}catch(Z){console.error("Error loading data:",Z)}}}),{data:o,isLoading:L}=my({queryKey:["cables"],queryFn:async()=>await ZC()}),N=J.useMemo(()=>T||L,[T,L]);return J.useEffect(()=>{if(!p||N||(o==null?void 0:o.length)===0)return;const Z=[];o==null||o.forEach(U=>{U.segments.filter(le=>!le.hidden).forEach(le=>{const ie=VC(le,U,R||[]),me=GC(le,U,R||[]);(h==="all"||h==="normal"&&ie==="normal"||h==="broken"&&ie==="broken")&&(ie==="broken"&&Z.push({type:"Feature",properties:{cableName:U.name,segmentId:le.id,cableId:U.id,color:"#ff0000",status:"broken-glow",lineWidth:15,lineBlur:12,lineOpacity:.4},geometry:{type:"LineString",coordinates:le.coordinates}}),Z.push({type:"Feature",properties:{cableName:U.name,segmentId:le.id,cableId:U.id,color:me,status:ie,lineWidth:ie==="broken"?3:1.5,lineBlur:0,lineOpacity:1},geometry:{type:"LineString",coordinates:le.coordinates}}))})});const Y="all-cables-source",ee=p.getSource(Y);return ee?ee.setData({type:"FeatureCollection",features:Z}):p.addSource(Y,{type:"geojson",data:{type:"FeatureCollection",features:Z}}),!g.current&&p.getSource(Y)&&(p.addLayer({id:"cables-layer",type:"line",source:Y,layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":["get","color"],"line-width":["get","lineWidth"],"line-blur":["get","lineBlur"],"line-opacity":["get","lineOpacity"]}},"landing-marker-layer"),p.on("click","cables-layer",U=>{var Ce;const le=(Ce=U.features)==null?void 0:Ce.find(Se=>{var Ee;return((Ee=Se.properties)==null?void 0:Ee.status)!=="broken-glow"});if(!le)return;const ie=U.lngLat,me=le.properties;C.current&&C.current.remove(),C.current=new Cm.Popup({offset:25,closeButton:!0,closeOnClick:!1,className:"landing-point-popup",maxWidth:"250px"}).setLngLat(ie).setHTML(`
            <div style="padding: 10px 12px;">
              <h3 style="margin: 0 0 8px 0; padding-right: 20px; color: #48A9FF; font-size: 14px; font-weight: bold; word-wrap: break-word;">
                ${me==null?void 0:me.cableName}
              </h3>
              <p style="margin: 0 0 4px 0; color: #a9b4bc; font-size: 12px;">
                Segment: ${me==null?void 0:me.segmentId}
              </p>
              <div style="margin-top: 8px; padding-top: 8px; border-top: 1px solid #3F4045;">
                <p style="margin: 0; color: #6b7280; font-size: 11px; white-space: nowrap;">
                  ${ie.lat.toFixed(4)}N, ${ie.lng.toFixed(4)}E
                </p>
              </div>
            </div>
          `).addTo(p)}),p.on("mouseenter","cables-layer",()=>{p.getCanvas().style.cursor="pointer"}),p.on("mouseleave","cables-layer",()=>{p.getCanvas().style.cursor=""}),g.current=!0),o==null||o.forEach(U=>{var le;(le=U.equipments)==null||le.forEach(ie=>{const me=`marker-${ie.id}`;if(!b.current.has(me)){const Ce=document.createElement("div");Ce.className="equipment-marker landing-point-marker",Ce.style.width="12px",Ce.style.height="12px",Ce.style.borderRadius="50%",Ce.style.backgroundColor="#ffffff",Ce.style.boxShadow="0 0 15px rgba(255, 255, 255, 0.6)",Ce.style.cursor="pointer",new Cm.Marker({element:Ce,anchor:"center",pitchAlignment:"viewport",rotationAlignment:"viewport"}).setLngLat(ie.coordinate).addTo(p),Ce.addEventListener("click",()=>{C.current&&C.current.remove(),C.current=new Cm.Popup({offset:25,closeButton:!0,closeOnClick:!1,className:"landing-point-popup",maxWidth:"250px"}).setLngLat(ie.coordinate).setHTML(`
                <div style="padding: 10px 12px;">
                  <h3 style="margin: 0 0 8px 0; padding-right: 20px; color: #48A9FF; font-size: 14px; font-weight: bold; word-wrap: break-word;">
                    ${ie.name}
                  </h3>
                  <div style="margin-top: 8px; padding-top: 8px; border-top: 1px solid #3F4045;">
                    <p style="margin: 0; color: #6b7280; font-size: 11px; white-space: nowrap;">
                      ${ie.coordinate[1].toFixed(4)}N, ${ie.coordinate[0].toFixed(4)}E
                    </p>
                  </div>
                </div>
              `).addTo(p)}),b.current.add(me)}})}),()=>{C.current&&C.current.remove()}},[p,o,R,N,h]),null});zb.displayName="CableLayer";function qC({cableFilter:p="all"}){const h=J.useRef(null),g=J.useRef(null),b=J.useRef(null),C=J.useRef(null),[R,T]=J.useState(!1),[o]=J.useState(window.innerWidth<768);return J.useEffect(()=>{g.current||h.current&&(g.current=new Cm.Map({container:h.current,style:{version:8,sources:{map:{type:"vector",url:"https://lb.exptech.dev/api/v1/map/tiles/tiles.json"}},layers:[{id:"background",type:"background",paint:{"background-color":"#1f2025"}},{id:"county",type:"fill",source:"map","source-layer":"city",paint:{"fill-color":"#3F4045","fill-opacity":1}},{id:"town",type:"fill",source:"map","source-layer":"town",paint:{"fill-color":"#3F4045","fill-opacity":1}},{id:"county-outline",source:"map","source-layer":"city",type:"line",paint:{"line-color":"#a9b4bc"}},{id:"global",type:"fill",source:"map","source-layer":"global",paint:{"fill-color":"#3F4045","fill-opacity":1}}]},center:[121.6,23.5],zoom:6.8,minZoom:4,maxZoom:12,doubleClickZoom:!1,keyboard:!1,attributionControl:!1}),g.current.on("load",()=>{T(!0)}))},[]),J.useEffect(()=>{g.current&&(o?g.current.fitBounds([[118,21.2],[124,25.8]],{padding:20,duration:0}):g.current.fitBounds([[117,20],[130,28]],{padding:20,duration:0}))},[o]),J.useEffect(()=>{if(!g.current)return;const L=g.current,N=[];g.current.on("load",()=>{const Z=UC;for(const U of Z)N.push({type:"Feature",properties:{name:U.name,coordinates:U.coordinates},geometry:{type:"Point",coordinates:U.coordinates}});const Y="landing-marker-points";L.getSource(Y)||(L.addSource(Y,{type:"geojson",data:{type:"FeatureCollection",features:N}}),L.addLayer({id:"landing-marker-shadow-layer",type:"circle",source:Y,paint:{"circle-color":"#ffffff","circle-radius":12,"circle-blur":.8,"circle-opacity":.4}}),L.addLayer({id:"landing-marker-layer",type:"circle",source:Y,paint:{"circle-radius":7,"circle-color":"#ffffff"}}),L.on("click","landing-marker-layer",U=>{C.current&&C.current.remove();const le=U.features[0].properties,ie=JSON.parse(le.coordinates);C.current=new Cm.Popup({offset:25,closeButton:!0,closeOnClick:!1,className:"landing-point-popup",maxWidth:"250px"}).setLngLat([ie[0],ie[1]]).setHTML(`
            <div style="padding: 10px 12px;">
              <h3 style="margin: 0 0 8px 0; padding-right: 20px; color: #48A9FF; font-size: 14px; font-weight: bold; word-wrap: break-word;">
                ${le.name}
              </h3>
              <div style="margin-top: 8px; padding-top: 8px; border-top: 1px solid #3F4045;">
                <p style="margin: 0; color: #6b7280; font-size: 11px; white-space: nowrap;">
                  ${ie[1].toFixed(4)}N, ${ie[0].toFixed(4)}E
                </p>
              </div>
            </div>
          `).addTo(L)}),L.on("mouseenter","landing-marker-layer",()=>{L.getCanvas().style.cursor="pointer"}),L.on("mouseleave","landing-marker-layer",()=>{L.getCanvas().style.cursor=""}))})},[]),pe.jsxs("div",{style:{width:"100%",height:"100%"},children:[pe.jsx("div",{ref:h,style:{width:"100%",height:"100%"}}),R&&g.current&&pe.jsx(zb,{ref:b,map:g.current,cableFilter:p})]})}function $C(p,h){return J.useReducer((g,b)=>h[g][b]??g,p)}var Xd=p=>{const{present:h,children:g}=p,b=HC(h),C=typeof g=="function"?g({present:b.isPresent}):J.Children.only(g),R=Gn(b.ref,XC(C));return typeof g=="function"||b.isPresent?J.cloneElement(C,{ref:R}):null};Xd.displayName="Presence";function HC(p){const[h,g]=J.useState(),b=J.useRef(null),C=J.useRef(p),R=J.useRef("none"),T=p?"mounted":"unmounted",[o,L]=$C(T,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return J.useEffect(()=>{const N=Zg(b.current);R.current=o==="mounted"?N:"none"},[o]),ba(()=>{const N=b.current,Z=C.current;if(Z!==p){const ee=R.current,U=Zg(N);p?L("MOUNT"):U==="none"||(N==null?void 0:N.display)==="none"?L("UNMOUNT"):L(Z&&ee!==U?"ANIMATION_OUT":"UNMOUNT"),C.current=p}},[p,L]),ba(()=>{if(h){let N;const Z=h.ownerDocument.defaultView??window,Y=U=>{const ie=Zg(b.current).includes(CSS.escape(U.animationName));if(U.target===h&&ie&&(L("ANIMATION_END"),!C.current)){const me=h.style.animationFillMode;h.style.animationFillMode="forwards",N=Z.setTimeout(()=>{h.style.animationFillMode==="forwards"&&(h.style.animationFillMode=me)})}},ee=U=>{U.target===h&&(R.current=Zg(b.current))};return h.addEventListener("animationstart",ee),h.addEventListener("animationcancel",Y),h.addEventListener("animationend",Y),()=>{Z.clearTimeout(N),h.removeEventListener("animationstart",ee),h.removeEventListener("animationcancel",Y),h.removeEventListener("animationend",Y)}}else L("ANIMATION_END")},[h,L]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:J.useCallback(N=>{b.current=N?getComputedStyle(N):null,g(N)},[])}}function Zg(p){return(p==null?void 0:p.animationName)||"none"}function XC(p){var b,C;let h=(b=Object.getOwnPropertyDescriptor(p.props,"ref"))==null?void 0:b.get,g=h&&"isReactWarning"in h&&h.isReactWarning;return g?p.ref:(h=(C=Object.getOwnPropertyDescriptor(p,"ref"))==null?void 0:C.get,g=h&&"isReactWarning"in h&&h.isReactWarning,g?p.props.ref:p.props.ref||p.ref)}var[x_,kM]=Fm("Tooltip",[m_]),b_=m_(),Ib="TooltipProvider",YC=700,ky="tooltip.open",[WC,tv]=x_(Ib),Db=p=>{const{__scopeTooltip:h,delayDuration:g=YC,skipDelayDuration:b=300,disableHoverableContent:C=!1,children:R}=p,T=J.useRef(!0),o=J.useRef(!1),L=J.useRef(0);return J.useEffect(()=>{const N=L.current;return()=>window.clearTimeout(N)},[]),pe.jsx(WC,{scope:h,isOpenDelayedRef:T,delayDuration:g,onOpen:J.useCallback(()=>{window.clearTimeout(L.current),T.current=!1},[]),onClose:J.useCallback(()=>{window.clearTimeout(L.current),L.current=window.setTimeout(()=>T.current=!0,b)},[b]),isPointerInTransitRef:o,onPointerInTransitChange:J.useCallback(N=>{o.current=N},[]),disableHoverableContent:C,children:R})};Db.displayName=Ib;var zm="Tooltip",[KC,Vm]=x_(zm),kb=p=>{const{__scopeTooltip:h,children:g,open:b,defaultOpen:C,onOpenChange:R,disableHoverableContent:T,delayDuration:o}=p,L=tv(zm,p.__scopeTooltip),N=b_(h),[Z,Y]=J.useState(null),ee=u_(),U=J.useRef(0),le=T??L.disableHoverableContent,ie=o??L.delayDuration,me=J.useRef(!1),[Ce,Se]=Ty({prop:b,defaultProp:C??!1,onChange:tt=>{tt?(L.onOpen(),document.dispatchEvent(new CustomEvent(ky))):L.onClose(),R==null||R(tt)},caller:zm}),Ee=J.useMemo(()=>Ce?me.current?"delayed-open":"instant-open":"closed",[Ce]),ke=J.useCallback(()=>{window.clearTimeout(U.current),U.current=0,me.current=!1,Se(!0)},[Se]),Ve=J.useCallback(()=>{window.clearTimeout(U.current),U.current=0,Se(!1)},[Se]),ct=J.useCallback(()=>{window.clearTimeout(U.current),U.current=window.setTimeout(()=>{me.current=!0,Se(!0),U.current=0},ie)},[ie,Se]);return J.useEffect(()=>()=>{U.current&&(window.clearTimeout(U.current),U.current=0)},[]),pe.jsx(z0,{...N,children:pe.jsx(KC,{scope:h,contentId:ee,open:Ce,stateAttribute:Ee,trigger:Z,onTriggerChange:Y,onTriggerEnter:J.useCallback(()=>{L.isOpenDelayedRef.current?ct():ke()},[L.isOpenDelayedRef,ct,ke]),onTriggerLeave:J.useCallback(()=>{le?Ve():(window.clearTimeout(U.current),U.current=0)},[Ve,le]),onOpen:ke,onClose:Ve,disableHoverableContent:le,children:g})})};kb.displayName=zm;var Ly="TooltipTrigger",Lb=J.forwardRef((p,h)=>{const{__scopeTooltip:g,...b}=p,C=Vm(Ly,g),R=tv(Ly,g),T=b_(g),o=J.useRef(null),L=Gn(h,o,C.onTriggerChange),N=J.useRef(!1),Z=J.useRef(!1),Y=J.useCallback(()=>N.current=!1,[]);return J.useEffect(()=>()=>document.removeEventListener("pointerup",Y),[Y]),pe.jsx(I0,{asChild:!0,...T,children:pe.jsx(Rn.button,{"aria-describedby":C.open?C.contentId:void 0,"data-state":C.stateAttribute,...b,ref:L,onPointerMove:Ji(p.onPointerMove,ee=>{ee.pointerType!=="touch"&&!Z.current&&!R.isPointerInTransitRef.current&&(C.onTriggerEnter(),Z.current=!0)}),onPointerLeave:Ji(p.onPointerLeave,()=>{C.onTriggerLeave(),Z.current=!1}),onPointerDown:Ji(p.onPointerDown,()=>{C.open&&C.onClose(),N.current=!0,document.addEventListener("pointerup",Y,{once:!0})}),onFocus:Ji(p.onFocus,()=>{N.current||C.onOpen()}),onBlur:Ji(p.onBlur,C.onClose),onClick:Ji(p.onClick,C.onClose)})})});Lb.displayName=Ly;var iv="TooltipPortal",[QC,JC]=x_(iv,{forceMount:void 0}),Ob=p=>{const{__scopeTooltip:h,forceMount:g,children:b,container:C}=p,R=Vm(iv,h);return pe.jsx(QC,{scope:h,forceMount:g,children:pe.jsx(Xd,{present:g||R.open,children:pe.jsx(Qy,{asChild:!0,container:C,children:b})})})};Ob.displayName=iv;var mp="TooltipContent",Bb=J.forwardRef((p,h)=>{const g=JC(mp,p.__scopeTooltip),{forceMount:b=g.forceMount,side:C="top",...R}=p,T=Vm(mp,p.__scopeTooltip);return pe.jsx(Xd,{present:b||T.open,children:T.disableHoverableContent?pe.jsx(Nb,{side:C,...R,ref:h}):pe.jsx(eE,{side:C,...R,ref:h})})}),eE=J.forwardRef((p,h)=>{const g=Vm(mp,p.__scopeTooltip),b=tv(mp,p.__scopeTooltip),C=J.useRef(null),R=Gn(h,C),[T,o]=J.useState(null),{trigger:L,onClose:N}=g,Z=C.current,{onPointerInTransitChange:Y}=b,ee=J.useCallback(()=>{o(null),Y(!1)},[Y]),U=J.useCallback((le,ie)=>{const me=le.currentTarget,Ce={x:le.clientX,y:le.clientY},Se=rE(Ce,me.getBoundingClientRect()),Ee=aE(Ce,Se),ke=sE(ie.getBoundingClientRect()),Ve=lE([...Ee,...ke]);o(Ve),Y(!0)},[Y]);return J.useEffect(()=>()=>ee(),[ee]),J.useEffect(()=>{if(L&&Z){const le=me=>U(me,Z),ie=me=>U(me,L);return L.addEventListener("pointerleave",le),Z.addEventListener("pointerleave",ie),()=>{L.removeEventListener("pointerleave",le),Z.removeEventListener("pointerleave",ie)}}},[L,Z,U,ee]),J.useEffect(()=>{if(T){const le=ie=>{const me=ie.target,Ce={x:ie.clientX,y:ie.clientY},Se=(L==null?void 0:L.contains(me))||(Z==null?void 0:Z.contains(me)),Ee=!oE(Ce,T);Se?ee():Ee&&(ee(),N())};return document.addEventListener("pointermove",le),()=>document.removeEventListener("pointermove",le)}},[L,Z,T,N,ee]),pe.jsx(Nb,{...p,ref:R})}),[tE,iE]=x_(zm,{isInside:!1}),nE=Bw("TooltipContent"),Nb=J.forwardRef((p,h)=>{const{__scopeTooltip:g,children:b,"aria-label":C,onEscapeKeyDown:R,onPointerDownOutside:T,...o}=p,L=Vm(mp,g),N=b_(g),{onClose:Z}=L;return J.useEffect(()=>(document.addEventListener(ky,Z),()=>document.removeEventListener(ky,Z)),[Z]),J.useEffect(()=>{if(L.trigger){const Y=ee=>{const U=ee.target;U!=null&&U.contains(L.trigger)&&Z()};return window.addEventListener("scroll",Y,{capture:!0}),()=>window.removeEventListener("scroll",Y,{capture:!0})}},[L.trigger,Z]),pe.jsx(Gy,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:R,onPointerDownOutside:T,onFocusOutside:Y=>Y.preventDefault(),onDismiss:Z,children:pe.jsxs(D0,{"data-state":L.stateAttribute,...N,...o,ref:h,style:{...o.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[pe.jsx(nE,{children:b}),pe.jsx(tE,{scope:g,isInside:!0,children:pe.jsx(k2,{id:L.contentId,role:"tooltip",children:C||b})})]})})});Bb.displayName=mp;var jb="TooltipArrow",Fb=J.forwardRef((p,h)=>{const{__scopeTooltip:g,...b}=p,C=b_(g);return iE(jb,g).isInside?null:pe.jsx(k0,{...C,...b,ref:h})});Fb.displayName=jb;function rE(p,h){const g=Math.abs(h.top-p.y),b=Math.abs(h.bottom-p.y),C=Math.abs(h.right-p.x),R=Math.abs(h.left-p.x);switch(Math.min(g,b,C,R)){case R:return"left";case C:return"right";case g:return"top";case b:return"bottom";default:throw new Error("unreachable")}}function aE(p,h,g=5){const b=[];switch(h){case"top":b.push({x:p.x-g,y:p.y+g},{x:p.x+g,y:p.y+g});break;case"bottom":b.push({x:p.x-g,y:p.y-g},{x:p.x+g,y:p.y-g});break;case"left":b.push({x:p.x+g,y:p.y-g},{x:p.x+g,y:p.y+g});break;case"right":b.push({x:p.x-g,y:p.y-g},{x:p.x-g,y:p.y+g});break}return b}function sE(p){const{top:h,right:g,bottom:b,left:C}=p;return[{x:C,y:h},{x:g,y:h},{x:g,y:b},{x:C,y:b}]}function oE(p,h){const{x:g,y:b}=p;let C=!1;for(let R=0,T=h.length-1;R<h.length;T=R++){const o=h[R],L=h[T],N=o.x,Z=o.y,Y=L.x,ee=L.y;Z>b!=ee>b&&g<(Y-N)*(b-Z)/(ee-Z)+N&&(C=!C)}return C}function lE(p){const h=p.slice();return h.sort((g,b)=>g.x<b.x?-1:g.x>b.x?1:g.y<b.y?-1:g.y>b.y?1:0),cE(h)}function cE(p){if(p.length<=1)return p.slice();const h=[];for(let b=0;b<p.length;b++){const C=p[b];for(;h.length>=2;){const R=h[h.length-1],T=h[h.length-2];if((R.x-T.x)*(C.y-T.y)>=(R.y-T.y)*(C.x-T.x))h.pop();else break}h.push(C)}h.pop();const g=[];for(let b=p.length-1;b>=0;b--){const C=p[b];for(;g.length>=2;){const R=g[g.length-1],T=g[g.length-2];if((R.x-T.x)*(C.y-T.y)>=(R.y-T.y)*(C.x-T.x))g.pop();else break}g.push(C)}return g.pop(),h.length===1&&g.length===1&&h[0].x===g[0].x&&h[0].y===g[0].y?h:h.concat(g)}var uE=Db,hE=kb,dE=Lb,fE=Ob,pE=Bb,mE=Fb;function gE(p,h){return J.useReducer((g,b)=>h[g][b]??g,p)}var nv="ScrollArea",[Ub,LM]=Fm(nv),[_E,No]=Ub(nv),Vb=J.forwardRef((p,h)=>{const{__scopeScrollArea:g,type:b="hover",dir:C,scrollHideDelay:R=600,...T}=p,[o,L]=J.useState(null),[N,Z]=J.useState(null),[Y,ee]=J.useState(null),[U,le]=J.useState(null),[ie,me]=J.useState(null),[Ce,Se]=J.useState(0),[Ee,ke]=J.useState(0),[Ve,ct]=J.useState(!1),[tt,Qe]=J.useState(!1),at=Gn(h,Ct=>L(Ct)),ht=a0(C);return pe.jsx(_E,{scope:g,type:b,dir:ht,scrollHideDelay:R,scrollArea:o,viewport:N,onViewportChange:Z,content:Y,onContentChange:ee,scrollbarX:U,onScrollbarXChange:le,scrollbarXEnabled:Ve,onScrollbarXEnabledChange:ct,scrollbarY:ie,onScrollbarYChange:me,scrollbarYEnabled:tt,onScrollbarYEnabledChange:Qe,onCornerWidthChange:Se,onCornerHeightChange:ke,children:pe.jsx(Rn.div,{dir:ht,...T,ref:at,style:{position:"relative","--radix-scroll-area-corner-width":Ce+"px","--radix-scroll-area-corner-height":Ee+"px",...p.style}})})});Vb.displayName=nv;var Gb="ScrollAreaViewport",Zb=J.forwardRef((p,h)=>{const{__scopeScrollArea:g,children:b,nonce:C,...R}=p,T=No(Gb,g),o=J.useRef(null),L=Gn(h,o,T.onViewportChange);return pe.jsxs(pe.Fragment,{children:[pe.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:C}),pe.jsx(Rn.div,{"data-radix-scroll-area-viewport":"",...R,ref:L,style:{overflowX:T.scrollbarXEnabled?"scroll":"hidden",overflowY:T.scrollbarYEnabled?"scroll":"hidden",...p.style},children:pe.jsx("div",{ref:T.onContentChange,style:{minWidth:"100%",display:"table"},children:b})})]})});Zb.displayName=Gb;var Ec="ScrollAreaScrollbar",rv=J.forwardRef((p,h)=>{const{forceMount:g,...b}=p,C=No(Ec,p.__scopeScrollArea),{onScrollbarXEnabledChange:R,onScrollbarYEnabledChange:T}=C,o=p.orientation==="horizontal";return J.useEffect(()=>(o?R(!0):T(!0),()=>{o?R(!1):T(!1)}),[o,R,T]),C.type==="hover"?pe.jsx(yE,{...b,ref:h,forceMount:g}):C.type==="scroll"?pe.jsx(vE,{...b,ref:h,forceMount:g}):C.type==="auto"?pe.jsx(qb,{...b,ref:h,forceMount:g}):C.type==="always"?pe.jsx(av,{...b,ref:h}):null});rv.displayName=Ec;var yE=J.forwardRef((p,h)=>{const{forceMount:g,...b}=p,C=No(Ec,p.__scopeScrollArea),[R,T]=J.useState(!1);return J.useEffect(()=>{const o=C.scrollArea;let L=0;if(o){const N=()=>{window.clearTimeout(L),T(!0)},Z=()=>{L=window.setTimeout(()=>T(!1),C.scrollHideDelay)};return o.addEventListener("pointerenter",N),o.addEventListener("pointerleave",Z),()=>{window.clearTimeout(L),o.removeEventListener("pointerenter",N),o.removeEventListener("pointerleave",Z)}}},[C.scrollArea,C.scrollHideDelay]),pe.jsx(Xd,{present:g||R,children:pe.jsx(qb,{"data-state":R?"visible":"hidden",...b,ref:h})})}),vE=J.forwardRef((p,h)=>{const{forceMount:g,...b}=p,C=No(Ec,p.__scopeScrollArea),R=p.orientation==="horizontal",T=S_(()=>L("SCROLL_END"),100),[o,L]=gE("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return J.useEffect(()=>{if(o==="idle"){const N=window.setTimeout(()=>L("HIDE"),C.scrollHideDelay);return()=>window.clearTimeout(N)}},[o,C.scrollHideDelay,L]),J.useEffect(()=>{const N=C.viewport,Z=R?"scrollLeft":"scrollTop";if(N){let Y=N[Z];const ee=()=>{const U=N[Z];Y!==U&&(L("SCROLL"),T()),Y=U};return N.addEventListener("scroll",ee),()=>N.removeEventListener("scroll",ee)}},[C.viewport,R,L,T]),pe.jsx(Xd,{present:g||o!=="hidden",children:pe.jsx(av,{"data-state":o==="hidden"?"hidden":"visible",...b,ref:h,onPointerEnter:Ji(p.onPointerEnter,()=>L("POINTER_ENTER")),onPointerLeave:Ji(p.onPointerLeave,()=>L("POINTER_LEAVE"))})})}),qb=J.forwardRef((p,h)=>{const g=No(Ec,p.__scopeScrollArea),{forceMount:b,...C}=p,[R,T]=J.useState(!1),o=p.orientation==="horizontal",L=S_(()=>{if(g.viewport){const N=g.viewport.offsetWidth<g.viewport.scrollWidth,Z=g.viewport.offsetHeight<g.viewport.scrollHeight;T(o?N:Z)}},10);return gp(g.viewport,L),gp(g.content,L),pe.jsx(Xd,{present:b||R,children:pe.jsx(av,{"data-state":R?"visible":"hidden",...C,ref:h})})}),av=J.forwardRef((p,h)=>{const{orientation:g="vertical",...b}=p,C=No(Ec,p.__scopeScrollArea),R=J.useRef(null),T=J.useRef(0),[o,L]=J.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),N=Wb(o.viewport,o.content),Z={...b,sizes:o,onSizesChange:L,hasThumb:N>0&&N<1,onThumbChange:ee=>R.current=ee,onThumbPointerUp:()=>T.current=0,onThumbPointerDown:ee=>T.current=ee};function Y(ee,U){return CE(ee,T.current,o,U)}return g==="horizontal"?pe.jsx(xE,{...Z,ref:h,onThumbPositionChange:()=>{if(C.viewport&&R.current){const ee=C.viewport.scrollLeft,U=ux(ee,o,C.dir);R.current.style.transform=`translate3d(${U}px, 0, 0)`}},onWheelScroll:ee=>{C.viewport&&(C.viewport.scrollLeft=ee)},onDragScroll:ee=>{C.viewport&&(C.viewport.scrollLeft=Y(ee,C.dir))}}):g==="vertical"?pe.jsx(bE,{...Z,ref:h,onThumbPositionChange:()=>{if(C.viewport&&R.current){const ee=C.viewport.scrollTop,U=ux(ee,o);R.current.style.transform=`translate3d(0, ${U}px, 0)`}},onWheelScroll:ee=>{C.viewport&&(C.viewport.scrollTop=ee)},onDragScroll:ee=>{C.viewport&&(C.viewport.scrollTop=Y(ee))}}):null}),xE=J.forwardRef((p,h)=>{const{sizes:g,onSizesChange:b,...C}=p,R=No(Ec,p.__scopeScrollArea),[T,o]=J.useState(),L=J.useRef(null),N=Gn(h,L,R.onScrollbarXChange);return J.useEffect(()=>{L.current&&o(getComputedStyle(L.current))},[L]),pe.jsx(Hb,{"data-orientation":"horizontal",...C,ref:N,sizes:g,style:{bottom:0,left:R.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:R.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":w_(g)+"px",...p.style},onThumbPointerDown:Z=>p.onThumbPointerDown(Z.x),onDragScroll:Z=>p.onDragScroll(Z.x),onWheelScroll:(Z,Y)=>{if(R.viewport){const ee=R.viewport.scrollLeft+Z.deltaX;p.onWheelScroll(ee),Qb(ee,Y)&&Z.preventDefault()}},onResize:()=>{L.current&&R.viewport&&T&&b({content:R.viewport.scrollWidth,viewport:R.viewport.offsetWidth,scrollbar:{size:L.current.clientWidth,paddingStart:a_(T.paddingLeft),paddingEnd:a_(T.paddingRight)}})}})}),bE=J.forwardRef((p,h)=>{const{sizes:g,onSizesChange:b,...C}=p,R=No(Ec,p.__scopeScrollArea),[T,o]=J.useState(),L=J.useRef(null),N=Gn(h,L,R.onScrollbarYChange);return J.useEffect(()=>{L.current&&o(getComputedStyle(L.current))},[L]),pe.jsx(Hb,{"data-orientation":"vertical",...C,ref:N,sizes:g,style:{top:0,right:R.dir==="ltr"?0:void 0,left:R.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":w_(g)+"px",...p.style},onThumbPointerDown:Z=>p.onThumbPointerDown(Z.y),onDragScroll:Z=>p.onDragScroll(Z.y),onWheelScroll:(Z,Y)=>{if(R.viewport){const ee=R.viewport.scrollTop+Z.deltaY;p.onWheelScroll(ee),Qb(ee,Y)&&Z.preventDefault()}},onResize:()=>{L.current&&R.viewport&&T&&b({content:R.viewport.scrollHeight,viewport:R.viewport.offsetHeight,scrollbar:{size:L.current.clientHeight,paddingStart:a_(T.paddingTop),paddingEnd:a_(T.paddingBottom)}})}})}),[wE,$b]=Ub(Ec),Hb=J.forwardRef((p,h)=>{const{__scopeScrollArea:g,sizes:b,hasThumb:C,onThumbChange:R,onThumbPointerUp:T,onThumbPointerDown:o,onThumbPositionChange:L,onDragScroll:N,onWheelScroll:Z,onResize:Y,...ee}=p,U=No(Ec,g),[le,ie]=J.useState(null),me=Gn(h,at=>ie(at)),Ce=J.useRef(null),Se=J.useRef(""),Ee=U.viewport,ke=b.content-b.viewport,Ve=Ms(Z),ct=Ms(L),tt=S_(Y,10);function Qe(at){if(Ce.current){const ht=at.clientX-Ce.current.left,Ct=at.clientY-Ce.current.top;N({x:ht,y:Ct})}}return J.useEffect(()=>{const at=ht=>{const Ct=ht.target;(le==null?void 0:le.contains(Ct))&&Ve(ht,ke)};return document.addEventListener("wheel",at,{passive:!1}),()=>document.removeEventListener("wheel",at,{passive:!1})},[Ee,le,ke,Ve]),J.useEffect(ct,[b,ct]),gp(le,tt),gp(U.content,tt),pe.jsx(wE,{scope:g,scrollbar:le,hasThumb:C,onThumbChange:Ms(R),onThumbPointerUp:Ms(T),onThumbPositionChange:ct,onThumbPointerDown:Ms(o),children:pe.jsx(Rn.div,{...ee,ref:me,style:{position:"absolute",...ee.style},onPointerDown:Ji(p.onPointerDown,at=>{at.button===0&&(at.target.setPointerCapture(at.pointerId),Ce.current=le.getBoundingClientRect(),Se.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",U.viewport&&(U.viewport.style.scrollBehavior="auto"),Qe(at))}),onPointerMove:Ji(p.onPointerMove,Qe),onPointerUp:Ji(p.onPointerUp,at=>{const ht=at.target;ht.hasPointerCapture(at.pointerId)&&ht.releasePointerCapture(at.pointerId),document.body.style.webkitUserSelect=Se.current,U.viewport&&(U.viewport.style.scrollBehavior=""),Ce.current=null})})})}),r_="ScrollAreaThumb",Xb=J.forwardRef((p,h)=>{const{forceMount:g,...b}=p,C=$b(r_,p.__scopeScrollArea);return pe.jsx(Xd,{present:g||C.hasThumb,children:pe.jsx(SE,{ref:h,...b})})}),SE=J.forwardRef((p,h)=>{const{__scopeScrollArea:g,style:b,...C}=p,R=No(r_,g),T=$b(r_,g),{onThumbPositionChange:o}=T,L=Gn(h,Y=>T.onThumbChange(Y)),N=J.useRef(void 0),Z=S_(()=>{N.current&&(N.current(),N.current=void 0)},100);return J.useEffect(()=>{const Y=R.viewport;if(Y){const ee=()=>{if(Z(),!N.current){const U=EE(Y,o);N.current=U,o()}};return o(),Y.addEventListener("scroll",ee),()=>Y.removeEventListener("scroll",ee)}},[R.viewport,Z,o]),pe.jsx(Rn.div,{"data-state":T.hasThumb?"visible":"hidden",...C,ref:L,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...b},onPointerDownCapture:Ji(p.onPointerDownCapture,Y=>{const U=Y.target.getBoundingClientRect(),le=Y.clientX-U.left,ie=Y.clientY-U.top;T.onThumbPointerDown({x:le,y:ie})}),onPointerUp:Ji(p.onPointerUp,T.onThumbPointerUp)})});Xb.displayName=r_;var sv="ScrollAreaCorner",Yb=J.forwardRef((p,h)=>{const g=No(sv,p.__scopeScrollArea),b=!!(g.scrollbarX&&g.scrollbarY);return g.type!=="scroll"&&b?pe.jsx(TE,{...p,ref:h}):null});Yb.displayName=sv;var TE=J.forwardRef((p,h)=>{const{__scopeScrollArea:g,...b}=p,C=No(sv,g),[R,T]=J.useState(0),[o,L]=J.useState(0),N=!!(R&&o);return gp(C.scrollbarX,()=>{var Y;const Z=((Y=C.scrollbarX)==null?void 0:Y.offsetHeight)||0;C.onCornerHeightChange(Z),L(Z)}),gp(C.scrollbarY,()=>{var Y;const Z=((Y=C.scrollbarY)==null?void 0:Y.offsetWidth)||0;C.onCornerWidthChange(Z),T(Z)}),N?pe.jsx(Rn.div,{...b,ref:h,style:{width:R,height:o,position:"absolute",right:C.dir==="ltr"?0:void 0,left:C.dir==="rtl"?0:void 0,bottom:0,...p.style}}):null});function a_(p){return p?parseInt(p,10):0}function Wb(p,h){const g=p/h;return isNaN(g)?0:g}function w_(p){const h=Wb(p.viewport,p.content),g=p.scrollbar.paddingStart+p.scrollbar.paddingEnd,b=(p.scrollbar.size-g)*h;return Math.max(b,18)}function CE(p,h,g,b="ltr"){const C=w_(g),R=C/2,T=h||R,o=C-T,L=g.scrollbar.paddingStart+T,N=g.scrollbar.size-g.scrollbar.paddingEnd-o,Z=g.content-g.viewport,Y=b==="ltr"?[0,Z]:[Z*-1,0];return Kb([L,N],Y)(p)}function ux(p,h,g="ltr"){const b=w_(h),C=h.scrollbar.paddingStart+h.scrollbar.paddingEnd,R=h.scrollbar.size-C,T=h.content-h.viewport,o=R-b,L=g==="ltr"?[0,T]:[T*-1,0],N=vy(p,L);return Kb([0,T],[0,o])(N)}function Kb(p,h){return g=>{if(p[0]===p[1]||h[0]===h[1])return h[0];const b=(h[1]-h[0])/(p[1]-p[0]);return h[0]+b*(g-p[0])}}function Qb(p,h){return p>0&&p<h}var EE=(p,h=()=>{})=>{let g={left:p.scrollLeft,top:p.scrollTop},b=0;return(function C(){const R={left:p.scrollLeft,top:p.scrollTop},T=g.left!==R.left,o=g.top!==R.top;(T||o)&&h(),g=R,b=window.requestAnimationFrame(C)})(),()=>window.cancelAnimationFrame(b)};function S_(p,h){const g=Ms(p),b=J.useRef(0);return J.useEffect(()=>()=>window.clearTimeout(b.current),[]),J.useCallback(()=>{window.clearTimeout(b.current),b.current=window.setTimeout(g,h)},[g,h])}function gp(p,h){const g=Ms(h);ba(()=>{let b=0;if(p){const C=new ResizeObserver(()=>{cancelAnimationFrame(b),b=window.requestAnimationFrame(g)});return C.observe(p),()=>{window.cancelAnimationFrame(b),C.unobserve(p)}}},[p,g])}var Jb=Vb,ME=Zb,AE=Yb;const e1=J.forwardRef(({className:p,children:h,...g},b)=>pe.jsxs(Jb,{ref:b,className:kh("relative overflow-hidden",p),...g,children:[pe.jsx(ME,{className:"h-full w-full rounded-[inherit]",children:h}),pe.jsx(t1,{}),pe.jsx(AE,{})]}));e1.displayName=Jb.displayName;const t1=J.forwardRef(({className:p,orientation:h="vertical",...g},b)=>pe.jsx(rv,{ref:b,orientation:h,className:kh("flex touch-none select-none transition-colors",h==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",h==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",p),...g,children:pe.jsx(Xb,{className:"relative flex-1 rounded-full bg-gray-700"})}));t1.displayName=rv.displayName;function PE({cables:p,startDate:h,endDate:g}){const{t:b}=c_(),[C,R]=J.useState([]),[T,o]=J.useState({});J.useEffect(()=>{fetch("/data/incidents.json").then(U=>U.json()).then(U=>{R(U);const le={};p.forEach(ie=>{le[ie.id]=[{startTime:h,endTime:g,status:"online"}]}),U.forEach(ie=>{const me=ie.cableid;le[me]||(le[me]=[{startTime:h,endTime:g,status:"online"}]);const Ce=le[me].find(Se=>Se.status==="online"&&new Date(ie.date)>=Se.startTime&&new Date(ie.date)<=Se.endTime);if(Ce){const Se=new Date(ie.date),Ee=ie.resolved_at?new Date(ie.resolved_at):g;le[me]=le[me].filter(ke=>ke!==Ce),Se>Ce.startTime&&le[me].push({startTime:Ce.startTime,endTime:Se,status:"online"}),le[me].push({startTime:Se,endTime:Ee,status:ie.status}),Ee<Ce.endTime&&le[me].push({startTime:Ee,endTime:Ce.endTime,status:"online"})}}),Object.keys(le).forEach(ie=>{le[ie].sort((me,Ce)=>me.startTime.getTime()-Ce.startTime.getTime())}),o(le)}).catch(U=>console.error("Error loading incidents:",U))},[p,h,g]);const L=g.getTime()-h.getTime(),N=U=>{switch(U){case"online":return"var(--color-uptime-online)";case"disconnected":return"var(--color-uptime-disconnected)";case"partial_disconnected":return"var(--color-uptime-partial-disconnected)";case"notice":return"var(--color-uptime-notice)";default:return"var(--color-uptime-unknown)"}},Z=U=>{switch(U){case"online":return b("common.online");case"disconnected":return b("common.disconnected");case"partial_disconnected":return b("common.partial_disconnected");case"notice":return b("common.notice");default:return b("common.unknown")}},Y=U=>U.toLocaleDateString("en-US",{month:"short",year:"numeric"}),ee=U=>{const le=U.getHours()===0&&U.getMinutes()===0;return U.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",...le?{}:{hour:"2-digit",minute:"2-digit",hour12:!1}})};return pe.jsx(uE,{delayDuration:200,children:pe.jsxs("div",{className:"uptime-timeline",children:[pe.jsx(e1,{className:"timeline-scroll-area",children:pe.jsxs("div",{className:"timeline-content",children:[pe.jsx("div",{className:"cable-names",children:p.map(U=>pe.jsx("div",{className:"cable-name",children:U.name},U.id))}),pe.jsx("div",{className:"timeline-rows",children:p.map(U=>pe.jsx("div",{className:"cable-timeline",children:pe.jsx("div",{className:"timeline-row",children:pe.jsx("div",{className:"timeline-container",children:pe.jsx("div",{className:"timeline-segments",children:(T[U.id]||[]).map((le,ie)=>{const me=(le.startTime.getTime()-h.getTime())/L*100,Ce=(le.endTime.getTime()-le.startTime.getTime())/L*100,Se=C.find(Ee=>Ee.cableid===U.id&&new Date(Ee.date).getTime()===le.startTime.getTime());return pe.jsxs(hE,{children:[pe.jsx(dE,{asChild:!0,children:pe.jsx("div",{className:"timeline-segment",style:{left:`${me}%`,width:`${Ce}%`,backgroundColor:N(le.status)}})}),pe.jsx(fE,{children:pe.jsxs(pE,{className:"timeline-tooltip",sideOffset:5,children:[pe.jsxs("div",{className:"tooltip-content",children:[pe.jsx("div",{className:"tooltip-status",children:Z(le.status)}),pe.jsxs("div",{className:"tooltip-dates",children:[ee(le.startTime)," ","-",ee(le.endTime)]}),Se&&pe.jsx("div",{className:"tooltip-description",children:Se.description})]}),pe.jsx(mE,{className:"tooltip-arrow"})]})})]},ie)})})})})},U.id))})]})}),pe.jsxs("div",{className:"timeline-axis",children:[pe.jsx("span",{children:Y(h)}),pe.jsx("span",{children:Y(new Date(h.getTime()+L/2))}),pe.jsx("span",{children:Y(g)})]})]})})}function RE(){const{t:p}=c_(),h=()=>{const g=p("version.version",{returnObjects:!0});return pe.jsxs("div",{className:"version",children:[pe.jsx("h3",{children:p("version.history")}),pe.jsx("br",{}),Object.entries(g).reverse().map(([b,C])=>pe.jsxs("div",{children:[pe.jsxs("p",{children:[pe.jsx("b",{children:b}),":"," ",C.date]}),pe.jsx("ul",{children:Object.entries(C.changes).map(([R,T])=>pe.jsx("li",{children:T},R))})]},b))]})};return pe.jsxs("div",{className:"about-container",children:[pe.jsxs("div",{className:"about-section",children:[pe.jsx("p",{dangerouslySetInnerHTML:{__html:p("about.description")}}),pe.jsx("br",{}),pe.jsx("p",{dangerouslySetInnerHTML:{__html:p("about.developer")}}),pe.jsx("p",{dangerouslySetInnerHTML:{__html:p("about.techstack")}}),pe.jsx("br",{}),pe.jsx("p",{dangerouslySetInnerHTML:{__html:p("about.datacollect")}}),pe.jsx("br",{}),pe.jsx("p",{dangerouslySetInnerHTML:{__html:p("about.datasource")}}),pe.jsx("br",{}),pe.jsx("p",{dangerouslySetInnerHTML:{__html:p("about.sponsor")}}),pe.jsx("br",{}),pe.jsx("p",{dangerouslySetInnerHTML:{__html:p("about.github")}})]}),pe.jsx("br",{}),h()]})}function qg({isOpen:p,onClose:h,title:g,children:b,maxWidth:C="90vw"}){return p?pe.jsx("div",{className:"modal-overlay",children:pe.jsxs("div",{className:"modal-content",style:{maxWidth:C},children:[pe.jsxs("div",{className:"modal-header",children:[pe.jsx("h2",{className:"modal-title",children:g}),pe.jsx("button",{className:"modal-close",onClick:h,children:""})]}),pe.jsx("div",{className:"modal-body",children:b})]})}):null}function hx(){const{t:p}=c_(),[h,g]=J.useState(!1),{data:b}=my({queryKey:["incidents"],queryFn:async()=>{const T=await fetch("/data/incidents.json");if(!T.ok)throw new Error(`Failed to fetch incidents: ${T.status}`);const o=await T.json();return o.sort((L,N)=>new Date(N.date).getTime()-new Date(L.date).getTime()),o}}),C=T=>{const o=new Date(T),L=o.getHours()===0&&o.getMinutes()===0;return o.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",...L?{}:{hour:"2-digit",minute:"2-digit",hour12:!1}})},R=b==null?void 0:b.filter(T=>h?T.resolved_at&&T.resolved_at!=="":!T.resolved_at||T.resolved_at==="");return pe.jsxs("div",{className:"incident-list",children:[pe.jsxs("div",{className:"incident-list-header",children:[pe.jsx("h2",{className:"incident-list-title",children:p(h?"incidents.historicalTitle":"incidents.activeTitle")}),pe.jsx("button",{className:"toggle-button",onClick:()=>g(!h),children:p(h?"common.showActive":"common.showHistorical")})]}),pe.jsxs("div",{className:"incident-list-container",children:[R==null?void 0:R.map((T,o)=>pe.jsxs("div",{className:"incident-card",children:[pe.jsxs("div",{className:"incident-header",children:[pe.jsx("h3",{className:"incident-title",children:T.title}),pe.jsx("span",{className:`incident-status ${T.resolved_at&&T.resolved_at!==""?"status-resolved":"status-active"}`,children:T.resolved_at&&T.resolved_at!==""?p("common.resolved"):p("common.active")})]}),pe.jsxs("div",{className:"incident-timestamps",children:[pe.jsxs("p",{className:"incident-timestamp",children:[p("incidents.started_at"),":",C(T.date)]}),T.reparing_at&&T.reparing_at!==""&&pe.jsxs("p",{className:"incident-timestamp",children:[p("incidents.reparing_at"),":",C(T.reparing_at)]}),T.resolved_at&&T.resolved_at!==""&&pe.jsxs("p",{className:"incident-timestamp",children:[p("incidents.resolved_at"),":",C(T.resolved_at)]})]}),pe.jsx("p",{className:"incident-description",children:T.description})]},`${T.cableid}-${T.date}-${o}`)),(R==null?void 0:R.length)===0&&pe.jsx("div",{className:"incident-card",children:pe.jsx("p",{className:"incident-description",children:p(h?"common.noHistoricalIncidents":"common.noActiveIncidents")})})]})]})}function zE(){const[p,h]=J.useState(new Date);J.useEffect(()=>{const b=setInterval(()=>{h(new Date)},1e3);return()=>clearInterval(b)},[]);const g=b=>{const C=b.getFullYear(),R=String(b.getMonth()+1).padStart(2,"0"),T=String(b.getDate()).padStart(2,"0"),o=String(b.getHours()).padStart(2,"0"),L=String(b.getMinutes()).padStart(2,"0"),N=String(b.getSeconds()).padStart(2,"0");return`${C}/${R}/${T} ${o}:${L}:${N}`};return pe.jsx("div",{className:"tech-clock",children:pe.jsxs("div",{className:"time-display",children:[pe.jsx(Pw,{className:"time-icon"}),pe.jsx("span",{className:"time-text",children:g(p)})]})})}const vi=p=>typeof p=="string",wm=()=>{let p,h;const g=new Promise((b,C)=>{p=b,h=C});return g.resolve=p,g.reject=h,g},dx=p=>p==null?"":""+p,IE=(p,h,g)=>{p.forEach(b=>{h[b]&&(g[b]=h[b])})},DE=/###/g,fx=p=>p&&p.indexOf("###")>-1?p.replace(DE,"."):p,px=p=>!p||vi(p),Em=(p,h,g)=>{const b=vi(h)?h.split("."):h;let C=0;for(;C<b.length-1;){if(px(p))return{};const R=fx(b[C]);!p[R]&&g&&(p[R]=new g),Object.prototype.hasOwnProperty.call(p,R)?p=p[R]:p={},++C}return px(p)?{}:{obj:p,k:fx(b[C])}},mx=(p,h,g)=>{const{obj:b,k:C}=Em(p,h,Object);if(b!==void 0||h.length===1){b[C]=g;return}let R=h[h.length-1],T=h.slice(0,h.length-1),o=Em(p,T,Object);for(;o.obj===void 0&&T.length;)R=`${T[T.length-1]}.${R}`,T=T.slice(0,T.length-1),o=Em(p,T,Object),o!=null&&o.obj&&typeof o.obj[`${o.k}.${R}`]<"u"&&(o.obj=void 0);o.obj[`${o.k}.${R}`]=g},kE=(p,h,g,b)=>{const{obj:C,k:R}=Em(p,h,Object);C[R]=C[R]||[],C[R].push(g)},s_=(p,h)=>{const{obj:g,k:b}=Em(p,h);if(g&&Object.prototype.hasOwnProperty.call(g,b))return g[b]},LE=(p,h,g)=>{const b=s_(p,g);return b!==void 0?b:s_(h,g)},i1=(p,h,g)=>{for(const b in h)b!=="__proto__"&&b!=="constructor"&&(b in p?vi(p[b])||p[b]instanceof String||vi(h[b])||h[b]instanceof String?g&&(p[b]=h[b]):i1(p[b],h[b],g):p[b]=h[b]);return p},Wf=p=>p.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var OE={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const BE=p=>vi(p)?p.replace(/[&<>"'\/]/g,h=>OE[h]):p;class NE{constructor(h){this.capacity=h,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(h){const g=this.regExpMap.get(h);if(g!==void 0)return g;const b=new RegExp(h);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(h,b),this.regExpQueue.push(h),b}}const jE=[" ",",","?","!",";"],FE=new NE(20),UE=(p,h,g)=>{h=h||"",g=g||"";const b=jE.filter(T=>h.indexOf(T)<0&&g.indexOf(T)<0);if(b.length===0)return!0;const C=FE.getRegExp(`(${b.map(T=>T==="?"?"\\?":T).join("|")})`);let R=!C.test(p);if(!R){const T=p.indexOf(g);T>0&&!C.test(p.substring(0,T))&&(R=!0)}return R},Oy=(p,h,g=".")=>{if(!p)return;if(p[h])return Object.prototype.hasOwnProperty.call(p,h)?p[h]:void 0;const b=h.split(g);let C=p;for(let R=0;R<b.length;){if(!C||typeof C!="object")return;let T,o="";for(let L=R;L<b.length;++L)if(L!==R&&(o+=g),o+=b[L],T=C[o],T!==void 0){if(["string","number","boolean"].indexOf(typeof T)>-1&&L<b.length-1)continue;R+=L-R+1;break}C=T}return C},Im=p=>p==null?void 0:p.replace("_","-"),VE={type:"logger",log(p){this.output("log",p)},warn(p){this.output("warn",p)},error(p){this.output("error",p)},output(p,h){var g,b;(b=(g=console==null?void 0:console[p])==null?void 0:g.apply)==null||b.call(g,console,h)}};class o_{constructor(h,g={}){this.init(h,g)}init(h,g={}){this.prefix=g.prefix||"i18next:",this.logger=h||VE,this.options=g,this.debug=g.debug}log(...h){return this.forward(h,"log","",!0)}warn(...h){return this.forward(h,"warn","",!0)}error(...h){return this.forward(h,"error","")}deprecate(...h){return this.forward(h,"warn","WARNING DEPRECATED: ",!0)}forward(h,g,b,C){return C&&!this.debug?null:(vi(h[0])&&(h[0]=`${b}${this.prefix} ${h[0]}`),this.logger[g](h))}create(h){return new o_(this.logger,{prefix:`${this.prefix}:${h}:`,...this.options})}clone(h){return h=h||this.options,h.prefix=h.prefix||this.prefix,new o_(this.logger,h)}}var wc=new o_;class T_{constructor(){this.observers={}}on(h,g){return h.split(" ").forEach(b=>{this.observers[b]||(this.observers[b]=new Map);const C=this.observers[b].get(g)||0;this.observers[b].set(g,C+1)}),this}off(h,g){if(this.observers[h]){if(!g){delete this.observers[h];return}this.observers[h].delete(g)}}emit(h,...g){this.observers[h]&&Array.from(this.observers[h].entries()).forEach(([C,R])=>{for(let T=0;T<R;T++)C(...g)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([C,R])=>{for(let T=0;T<R;T++)C.apply(C,[h,...g])})}}class gx extends T_{constructor(h,g={ns:["translation"],defaultNS:"translation"}){super(),this.data=h||{},this.options=g,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(h){this.options.ns.indexOf(h)<0&&this.options.ns.push(h)}removeNamespaces(h){const g=this.options.ns.indexOf(h);g>-1&&this.options.ns.splice(g,1)}getResource(h,g,b,C={}){var N,Z;const R=C.keySeparator!==void 0?C.keySeparator:this.options.keySeparator,T=C.ignoreJSONStructure!==void 0?C.ignoreJSONStructure:this.options.ignoreJSONStructure;let o;h.indexOf(".")>-1?o=h.split("."):(o=[h,g],b&&(Array.isArray(b)?o.push(...b):vi(b)&&R?o.push(...b.split(R)):o.push(b)));const L=s_(this.data,o);return!L&&!g&&!b&&h.indexOf(".")>-1&&(h=o[0],g=o[1],b=o.slice(2).join(".")),L||!T||!vi(b)?L:Oy((Z=(N=this.data)==null?void 0:N[h])==null?void 0:Z[g],b,R)}addResource(h,g,b,C,R={silent:!1}){const T=R.keySeparator!==void 0?R.keySeparator:this.options.keySeparator;let o=[h,g];b&&(o=o.concat(T?b.split(T):b)),h.indexOf(".")>-1&&(o=h.split("."),C=g,g=o[1]),this.addNamespaces(g),mx(this.data,o,C),R.silent||this.emit("added",h,g,b,C)}addResources(h,g,b,C={silent:!1}){for(const R in b)(vi(b[R])||Array.isArray(b[R]))&&this.addResource(h,g,R,b[R],{silent:!0});C.silent||this.emit("added",h,g,b)}addResourceBundle(h,g,b,C,R,T={silent:!1,skipCopy:!1}){let o=[h,g];h.indexOf(".")>-1&&(o=h.split("."),C=b,b=g,g=o[1]),this.addNamespaces(g);let L=s_(this.data,o)||{};T.skipCopy||(b=JSON.parse(JSON.stringify(b))),C?i1(L,b,R):L={...L,...b},mx(this.data,o,L),T.silent||this.emit("added",h,g,b)}removeResourceBundle(h,g){this.hasResourceBundle(h,g)&&delete this.data[h][g],this.removeNamespaces(g),this.emit("removed",h,g)}hasResourceBundle(h,g){return this.getResource(h,g)!==void 0}getResourceBundle(h,g){return g||(g=this.options.defaultNS),this.getResource(h,g)}getDataByLanguage(h){return this.data[h]}hasLanguageSomeTranslations(h){const g=this.getDataByLanguage(h);return!!(g&&Object.keys(g)||[]).find(C=>g[C]&&Object.keys(g[C]).length>0)}toJSON(){return this.data}}var n1={processors:{},addPostProcessor(p){this.processors[p.name]=p},handle(p,h,g,b,C){return p.forEach(R=>{var T;h=((T=this.processors[R])==null?void 0:T.process(h,g,b,C))??h}),h}};const r1=Symbol("i18next/PATH_KEY");function GE(){const p=[],h=Object.create(null);let g;return h.get=(b,C)=>{var R;return(R=g==null?void 0:g.revoke)==null||R.call(g),C===r1?p:(p.push(C),g=Proxy.revocable(b,h),g.proxy)},Proxy.revocable(Object.create(null),h).proxy}function By(p,h){const{[r1]:g}=p(GE());return g.join((h==null?void 0:h.keySeparator)??".")}const _x={},yx=p=>!vi(p)&&typeof p!="boolean"&&typeof p!="number";class l_ extends T_{constructor(h,g={}){super(),IE(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],h,this),this.options=g,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=wc.create("translator")}changeLanguage(h){h&&(this.language=h)}exists(h,g={interpolation:{}}){const b={...g};if(h==null)return!1;const C=this.resolve(h,b);return(C==null?void 0:C.res)!==void 0}extractFromKey(h,g){let b=g.nsSeparator!==void 0?g.nsSeparator:this.options.nsSeparator;b===void 0&&(b=":");const C=g.keySeparator!==void 0?g.keySeparator:this.options.keySeparator;let R=g.ns||this.options.defaultNS||[];const T=b&&h.indexOf(b)>-1,o=!this.options.userDefinedKeySeparator&&!g.keySeparator&&!this.options.userDefinedNsSeparator&&!g.nsSeparator&&!UE(h,b,C);if(T&&!o){const L=h.match(this.interpolator.nestingRegexp);if(L&&L.length>0)return{key:h,namespaces:vi(R)?[R]:R};const N=h.split(b);(b!==C||b===C&&this.options.ns.indexOf(N[0])>-1)&&(R=N.shift()),h=N.join(C)}return{key:h,namespaces:vi(R)?[R]:R}}translate(h,g,b){let C=typeof g=="object"?{...g}:g;if(typeof C!="object"&&this.options.overloadTranslationOptionHandler&&(C=this.options.overloadTranslationOptionHandler(arguments)),typeof C=="object"&&(C={...C}),C||(C={}),h==null)return"";typeof h=="function"&&(h=By(h,{...this.options,...C})),Array.isArray(h)||(h=[String(h)]);const R=C.returnDetails!==void 0?C.returnDetails:this.options.returnDetails,T=C.keySeparator!==void 0?C.keySeparator:this.options.keySeparator,{key:o,namespaces:L}=this.extractFromKey(h[h.length-1],C),N=L[L.length-1];let Z=C.nsSeparator!==void 0?C.nsSeparator:this.options.nsSeparator;Z===void 0&&(Z=":");const Y=C.lng||this.language,ee=C.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((Y==null?void 0:Y.toLowerCase())==="cimode")return ee?R?{res:`${N}${Z}${o}`,usedKey:o,exactUsedKey:o,usedLng:Y,usedNS:N,usedParams:this.getUsedParamsDetails(C)}:`${N}${Z}${o}`:R?{res:o,usedKey:o,exactUsedKey:o,usedLng:Y,usedNS:N,usedParams:this.getUsedParamsDetails(C)}:o;const U=this.resolve(h,C);let le=U==null?void 0:U.res;const ie=(U==null?void 0:U.usedKey)||o,me=(U==null?void 0:U.exactUsedKey)||o,Ce=["[object Number]","[object Function]","[object RegExp]"],Se=C.joinArrays!==void 0?C.joinArrays:this.options.joinArrays,Ee=!this.i18nFormat||this.i18nFormat.handleAsObject,ke=C.count!==void 0&&!vi(C.count),Ve=l_.hasDefaultValue(C),ct=ke?this.pluralResolver.getSuffix(Y,C.count,C):"",tt=C.ordinal&&ke?this.pluralResolver.getSuffix(Y,C.count,{ordinal:!1}):"",Qe=ke&&!C.ordinal&&C.count===0,at=Qe&&C[`defaultValue${this.options.pluralSeparator}zero`]||C[`defaultValue${ct}`]||C[`defaultValue${tt}`]||C.defaultValue;let ht=le;Ee&&!le&&Ve&&(ht=at);const Ct=yx(ht),Rt=Object.prototype.toString.apply(ht);if(Ee&&ht&&Ct&&Ce.indexOf(Rt)<0&&!(vi(Se)&&Array.isArray(ht))){if(!C.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const Lt=this.options.returnedObjectHandler?this.options.returnedObjectHandler(ie,ht,{...C,ns:L}):`key '${o} (${this.language})' returned an object instead of string.`;return R?(U.res=Lt,U.usedParams=this.getUsedParamsDetails(C),U):Lt}if(T){const Lt=Array.isArray(ht),Gt=Lt?[]:{},Ht=Lt?me:ie;for(const Oe in ht)if(Object.prototype.hasOwnProperty.call(ht,Oe)){const it=`${Ht}${T}${Oe}`;Ve&&!le?Gt[Oe]=this.translate(it,{...C,defaultValue:yx(at)?at[Oe]:void 0,joinArrays:!1,ns:L}):Gt[Oe]=this.translate(it,{...C,joinArrays:!1,ns:L}),Gt[Oe]===it&&(Gt[Oe]=ht[Oe])}le=Gt}}else if(Ee&&vi(Se)&&Array.isArray(le))le=le.join(Se),le&&(le=this.extendTranslation(le,h,C,b));else{let Lt=!1,Gt=!1;!this.isValidLookup(le)&&Ve&&(Lt=!0,le=at),this.isValidLookup(le)||(Gt=!0,le=o);const Oe=(C.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&Gt?void 0:le,it=Ve&&at!==le&&this.options.updateMissing;if(Gt||Lt||it){if(this.logger.log(it?"updateKey":"missingKey",Y,N,o,it?at:le),T){const Ke=this.resolve(o,{...C,keySeparator:!1});Ke&&Ke.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let Xe=[];const St=this.languageUtils.getFallbackCodes(this.options.fallbackLng,C.lng||this.language);if(this.options.saveMissingTo==="fallback"&&St&&St[0])for(let Ke=0;Ke<St.length;Ke++)Xe.push(St[Ke]);else this.options.saveMissingTo==="all"?Xe=this.languageUtils.toResolveHierarchy(C.lng||this.language):Xe.push(C.lng||this.language);const be=(Ke,wt,ft)=>{var Kt;const Et=Ve&&ft!==le?ft:Oe;this.options.missingKeyHandler?this.options.missingKeyHandler(Ke,N,wt,Et,it,C):(Kt=this.backendConnector)!=null&&Kt.saveMissing&&this.backendConnector.saveMissing(Ke,N,wt,Et,it,C),this.emit("missingKey",Ke,N,wt,le)};this.options.saveMissing&&(this.options.saveMissingPlurals&&ke?Xe.forEach(Ke=>{const wt=this.pluralResolver.getSuffixes(Ke,C);Qe&&C[`defaultValue${this.options.pluralSeparator}zero`]&&wt.indexOf(`${this.options.pluralSeparator}zero`)<0&&wt.push(`${this.options.pluralSeparator}zero`),wt.forEach(ft=>{be([Ke],o+ft,C[`defaultValue${ft}`]||at)})}):be(Xe,o,at))}le=this.extendTranslation(le,h,C,U,b),Gt&&le===o&&this.options.appendNamespaceToMissingKey&&(le=`${N}${Z}${o}`),(Gt||Lt)&&this.options.parseMissingKeyHandler&&(le=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${N}${Z}${o}`:o,Lt?le:void 0,C))}return R?(U.res=le,U.usedParams=this.getUsedParamsDetails(C),U):le}extendTranslation(h,g,b,C,R){var L,N;if((L=this.i18nFormat)!=null&&L.parse)h=this.i18nFormat.parse(h,{...this.options.interpolation.defaultVariables,...b},b.lng||this.language||C.usedLng,C.usedNS,C.usedKey,{resolved:C});else if(!b.skipInterpolation){b.interpolation&&this.interpolator.init({...b,interpolation:{...this.options.interpolation,...b.interpolation}});const Z=vi(h)&&(((N=b==null?void 0:b.interpolation)==null?void 0:N.skipOnVariables)!==void 0?b.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let Y;if(Z){const U=h.match(this.interpolator.nestingRegexp);Y=U&&U.length}let ee=b.replace&&!vi(b.replace)?b.replace:b;if(this.options.interpolation.defaultVariables&&(ee={...this.options.interpolation.defaultVariables,...ee}),h=this.interpolator.interpolate(h,ee,b.lng||this.language||C.usedLng,b),Z){const U=h.match(this.interpolator.nestingRegexp),le=U&&U.length;Y<le&&(b.nest=!1)}!b.lng&&C&&C.res&&(b.lng=this.language||C.usedLng),b.nest!==!1&&(h=this.interpolator.nest(h,(...U)=>(R==null?void 0:R[0])===U[0]&&!b.context?(this.logger.warn(`It seems you are nesting recursively key: ${U[0]} in key: ${g[0]}`),null):this.translate(...U,g),b)),b.interpolation&&this.interpolator.reset()}const T=b.postProcess||this.options.postProcess,o=vi(T)?[T]:T;return h!=null&&(o!=null&&o.length)&&b.applyPostProcessor!==!1&&(h=n1.handle(o,h,g,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...C,usedParams:this.getUsedParamsDetails(b)},...b}:b,this)),h}resolve(h,g={}){let b,C,R,T,o;return vi(h)&&(h=[h]),h.forEach(L=>{if(this.isValidLookup(b))return;const N=this.extractFromKey(L,g),Z=N.key;C=Z;let Y=N.namespaces;this.options.fallbackNS&&(Y=Y.concat(this.options.fallbackNS));const ee=g.count!==void 0&&!vi(g.count),U=ee&&!g.ordinal&&g.count===0,le=g.context!==void 0&&(vi(g.context)||typeof g.context=="number")&&g.context!=="",ie=g.lngs?g.lngs:this.languageUtils.toResolveHierarchy(g.lng||this.language,g.fallbackLng);Y.forEach(me=>{var Ce,Se;this.isValidLookup(b)||(o=me,!_x[`${ie[0]}-${me}`]&&((Ce=this.utils)!=null&&Ce.hasLoadedNamespace)&&!((Se=this.utils)!=null&&Se.hasLoadedNamespace(o))&&(_x[`${ie[0]}-${me}`]=!0,this.logger.warn(`key "${C}" for languages "${ie.join(", ")}" won't get resolved as namespace "${o}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),ie.forEach(Ee=>{var ct;if(this.isValidLookup(b))return;T=Ee;const ke=[Z];if((ct=this.i18nFormat)!=null&&ct.addLookupKeys)this.i18nFormat.addLookupKeys(ke,Z,Ee,me,g);else{let tt;ee&&(tt=this.pluralResolver.getSuffix(Ee,g.count,g));const Qe=`${this.options.pluralSeparator}zero`,at=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(ee&&(g.ordinal&&tt.indexOf(at)===0&&ke.push(Z+tt.replace(at,this.options.pluralSeparator)),ke.push(Z+tt),U&&ke.push(Z+Qe)),le){const ht=`${Z}${this.options.contextSeparator||"_"}${g.context}`;ke.push(ht),ee&&(g.ordinal&&tt.indexOf(at)===0&&ke.push(ht+tt.replace(at,this.options.pluralSeparator)),ke.push(ht+tt),U&&ke.push(ht+Qe))}}let Ve;for(;Ve=ke.pop();)this.isValidLookup(b)||(R=Ve,b=this.getResource(Ee,me,Ve,g))}))})}),{res:b,usedKey:C,exactUsedKey:R,usedLng:T,usedNS:o}}isValidLookup(h){return h!==void 0&&!(!this.options.returnNull&&h===null)&&!(!this.options.returnEmptyString&&h==="")}getResource(h,g,b,C={}){var R;return(R=this.i18nFormat)!=null&&R.getResource?this.i18nFormat.getResource(h,g,b,C):this.resourceStore.getResource(h,g,b,C)}getUsedParamsDetails(h={}){const g=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],b=h.replace&&!vi(h.replace);let C=b?h.replace:h;if(b&&typeof h.count<"u"&&(C.count=h.count),this.options.interpolation.defaultVariables&&(C={...this.options.interpolation.defaultVariables,...C}),!b){C={...C};for(const R of g)delete C[R]}return C}static hasDefaultValue(h){const g="defaultValue";for(const b in h)if(Object.prototype.hasOwnProperty.call(h,b)&&g===b.substring(0,g.length)&&h[b]!==void 0)return!0;return!1}}class vx{constructor(h){this.options=h,this.supportedLngs=this.options.supportedLngs||!1,this.logger=wc.create("languageUtils")}getScriptPartFromCode(h){if(h=Im(h),!h||h.indexOf("-")<0)return null;const g=h.split("-");return g.length===2||(g.pop(),g[g.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(g.join("-"))}getLanguagePartFromCode(h){if(h=Im(h),!h||h.indexOf("-")<0)return h;const g=h.split("-");return this.formatLanguageCode(g[0])}formatLanguageCode(h){if(vi(h)&&h.indexOf("-")>-1){let g;try{g=Intl.getCanonicalLocales(h)[0]}catch{}return g&&this.options.lowerCaseLng&&(g=g.toLowerCase()),g||(this.options.lowerCaseLng?h.toLowerCase():h)}return this.options.cleanCode||this.options.lowerCaseLng?h.toLowerCase():h}isSupportedCode(h){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(h=this.getLanguagePartFromCode(h)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(h)>-1}getBestMatchFromCodes(h){if(!h)return null;let g;return h.forEach(b=>{if(g)return;const C=this.formatLanguageCode(b);(!this.options.supportedLngs||this.isSupportedCode(C))&&(g=C)}),!g&&this.options.supportedLngs&&h.forEach(b=>{if(g)return;const C=this.getScriptPartFromCode(b);if(this.isSupportedCode(C))return g=C;const R=this.getLanguagePartFromCode(b);if(this.isSupportedCode(R))return g=R;g=this.options.supportedLngs.find(T=>{if(T===R)return T;if(!(T.indexOf("-")<0&&R.indexOf("-")<0)&&(T.indexOf("-")>0&&R.indexOf("-")<0&&T.substring(0,T.indexOf("-"))===R||T.indexOf(R)===0&&R.length>1))return T})}),g||(g=this.getFallbackCodes(this.options.fallbackLng)[0]),g}getFallbackCodes(h,g){if(!h)return[];if(typeof h=="function"&&(h=h(g)),vi(h)&&(h=[h]),Array.isArray(h))return h;if(!g)return h.default||[];let b=h[g];return b||(b=h[this.getScriptPartFromCode(g)]),b||(b=h[this.formatLanguageCode(g)]),b||(b=h[this.getLanguagePartFromCode(g)]),b||(b=h.default),b||[]}toResolveHierarchy(h,g){const b=this.getFallbackCodes((g===!1?[]:g)||this.options.fallbackLng||[],h),C=[],R=T=>{T&&(this.isSupportedCode(T)?C.push(T):this.logger.warn(`rejecting language code not found in supportedLngs: ${T}`))};return vi(h)&&(h.indexOf("-")>-1||h.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&R(this.formatLanguageCode(h)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&R(this.getScriptPartFromCode(h)),this.options.load!=="currentOnly"&&R(this.getLanguagePartFromCode(h))):vi(h)&&R(this.formatLanguageCode(h)),b.forEach(T=>{C.indexOf(T)<0&&R(this.formatLanguageCode(T))}),C}}const xx={zero:0,one:1,two:2,few:3,many:4,other:5},bx={select:p=>p===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class ZE{constructor(h,g={}){this.languageUtils=h,this.options=g,this.logger=wc.create("pluralResolver"),this.pluralRulesCache={}}addRule(h,g){this.rules[h]=g}clearCache(){this.pluralRulesCache={}}getRule(h,g={}){const b=Im(h==="dev"?"en":h),C=g.ordinal?"ordinal":"cardinal",R=JSON.stringify({cleanedCode:b,type:C});if(R in this.pluralRulesCache)return this.pluralRulesCache[R];let T;try{T=new Intl.PluralRules(b,{type:C})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),bx;if(!h.match(/-|_/))return bx;const L=this.languageUtils.getLanguagePartFromCode(h);T=this.getRule(L,g)}return this.pluralRulesCache[R]=T,T}needsPlural(h,g={}){let b=this.getRule(h,g);return b||(b=this.getRule("dev",g)),(b==null?void 0:b.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(h,g,b={}){return this.getSuffixes(h,b).map(C=>`${g}${C}`)}getSuffixes(h,g={}){let b=this.getRule(h,g);return b||(b=this.getRule("dev",g)),b?b.resolvedOptions().pluralCategories.sort((C,R)=>xx[C]-xx[R]).map(C=>`${this.options.prepend}${g.ordinal?`ordinal${this.options.prepend}`:""}${C}`):[]}getSuffix(h,g,b={}){const C=this.getRule(h,b);return C?`${this.options.prepend}${b.ordinal?`ordinal${this.options.prepend}`:""}${C.select(g)}`:(this.logger.warn(`no plural rule found for: ${h}`),this.getSuffix("dev",g,b))}}const wx=(p,h,g,b=".",C=!0)=>{let R=LE(p,h,g);return!R&&C&&vi(g)&&(R=Oy(p,g,b),R===void 0&&(R=Oy(h,g,b))),R},ey=p=>p.replace(/\$/g,"$$$$");class qE{constructor(h={}){var g;this.logger=wc.create("interpolator"),this.options=h,this.format=((g=h==null?void 0:h.interpolation)==null?void 0:g.format)||(b=>b),this.init(h)}init(h={}){h.interpolation||(h.interpolation={escapeValue:!0});const{escape:g,escapeValue:b,useRawValueToEscape:C,prefix:R,prefixEscaped:T,suffix:o,suffixEscaped:L,formatSeparator:N,unescapeSuffix:Z,unescapePrefix:Y,nestingPrefix:ee,nestingPrefixEscaped:U,nestingSuffix:le,nestingSuffixEscaped:ie,nestingOptionsSeparator:me,maxReplaces:Ce,alwaysFormat:Se}=h.interpolation;this.escape=g!==void 0?g:BE,this.escapeValue=b!==void 0?b:!0,this.useRawValueToEscape=C!==void 0?C:!1,this.prefix=R?Wf(R):T||"{{",this.suffix=o?Wf(o):L||"}}",this.formatSeparator=N||",",this.unescapePrefix=Z?"":Y||"-",this.unescapeSuffix=this.unescapePrefix?"":Z||"",this.nestingPrefix=ee?Wf(ee):U||Wf("$t("),this.nestingSuffix=le?Wf(le):ie||Wf(")"),this.nestingOptionsSeparator=me||",",this.maxReplaces=Ce||1e3,this.alwaysFormat=Se!==void 0?Se:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const h=(g,b)=>(g==null?void 0:g.source)===b?(g.lastIndex=0,g):new RegExp(b,"g");this.regexp=h(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=h(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=h(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(h,g,b,C){var U;let R,T,o;const L=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},N=le=>{if(le.indexOf(this.formatSeparator)<0){const Se=wx(g,L,le,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(Se,void 0,b,{...C,...g,interpolationkey:le}):Se}const ie=le.split(this.formatSeparator),me=ie.shift().trim(),Ce=ie.join(this.formatSeparator).trim();return this.format(wx(g,L,me,this.options.keySeparator,this.options.ignoreJSONStructure),Ce,b,{...C,...g,interpolationkey:me})};this.resetRegExp();const Z=(C==null?void 0:C.missingInterpolationHandler)||this.options.missingInterpolationHandler,Y=((U=C==null?void 0:C.interpolation)==null?void 0:U.skipOnVariables)!==void 0?C.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:le=>ey(le)},{regex:this.regexp,safeValue:le=>this.escapeValue?ey(this.escape(le)):ey(le)}].forEach(le=>{for(o=0;R=le.regex.exec(h);){const ie=R[1].trim();if(T=N(ie),T===void 0)if(typeof Z=="function"){const Ce=Z(h,R,C);T=vi(Ce)?Ce:""}else if(C&&Object.prototype.hasOwnProperty.call(C,ie))T="";else if(Y){T=R[0];continue}else this.logger.warn(`missed to pass in variable ${ie} for interpolating ${h}`),T="";else!vi(T)&&!this.useRawValueToEscape&&(T=dx(T));const me=le.safeValue(T);if(h=h.replace(R[0],me),Y?(le.regex.lastIndex+=T.length,le.regex.lastIndex-=R[0].length):le.regex.lastIndex=0,o++,o>=this.maxReplaces)break}}),h}nest(h,g,b={}){let C,R,T;const o=(L,N)=>{const Z=this.nestingOptionsSeparator;if(L.indexOf(Z)<0)return L;const Y=L.split(new RegExp(`${Z}[ ]*{`));let ee=`{${Y[1]}`;L=Y[0],ee=this.interpolate(ee,T);const U=ee.match(/'/g),le=ee.match(/"/g);(((U==null?void 0:U.length)??0)%2===0&&!le||le.length%2!==0)&&(ee=ee.replace(/'/g,'"'));try{T=JSON.parse(ee),N&&(T={...N,...T})}catch(ie){return this.logger.warn(`failed parsing options string in nesting for key ${L}`,ie),`${L}${Z}${ee}`}return T.defaultValue&&T.defaultValue.indexOf(this.prefix)>-1&&delete T.defaultValue,L};for(;C=this.nestingRegexp.exec(h);){let L=[];T={...b},T=T.replace&&!vi(T.replace)?T.replace:T,T.applyPostProcessor=!1,delete T.defaultValue;const N=/{.*}/.test(C[1])?C[1].lastIndexOf("}")+1:C[1].indexOf(this.formatSeparator);if(N!==-1&&(L=C[1].slice(N).split(this.formatSeparator).map(Z=>Z.trim()).filter(Boolean),C[1]=C[1].slice(0,N)),R=g(o.call(this,C[1].trim(),T),T),R&&C[0]===h&&!vi(R))return R;vi(R)||(R=dx(R)),R||(this.logger.warn(`missed to resolve ${C[1]} for nesting ${h}`),R=""),L.length&&(R=L.reduce((Z,Y)=>this.format(Z,Y,b.lng,{...b,interpolationkey:C[1].trim()}),R.trim())),h=h.replace(C[0],R),this.regexp.lastIndex=0}return h}}const $E=p=>{let h=p.toLowerCase().trim();const g={};if(p.indexOf("(")>-1){const b=p.split("(");h=b[0].toLowerCase().trim();const C=b[1].substring(0,b[1].length-1);h==="currency"&&C.indexOf(":")<0?g.currency||(g.currency=C.trim()):h==="relativetime"&&C.indexOf(":")<0?g.range||(g.range=C.trim()):C.split(";").forEach(T=>{if(T){const[o,...L]=T.split(":"),N=L.join(":").trim().replace(/^'+|'+$/g,""),Z=o.trim();g[Z]||(g[Z]=N),N==="false"&&(g[Z]=!1),N==="true"&&(g[Z]=!0),isNaN(N)||(g[Z]=parseInt(N,10))}})}return{formatName:h,formatOptions:g}},Sx=p=>{const h={};return(g,b,C)=>{let R=C;C&&C.interpolationkey&&C.formatParams&&C.formatParams[C.interpolationkey]&&C[C.interpolationkey]&&(R={...R,[C.interpolationkey]:void 0});const T=b+JSON.stringify(R);let o=h[T];return o||(o=p(Im(b),C),h[T]=o),o(g)}},HE=p=>(h,g,b)=>p(Im(g),b)(h);class XE{constructor(h={}){this.logger=wc.create("formatter"),this.options=h,this.init(h)}init(h,g={interpolation:{}}){this.formatSeparator=g.interpolation.formatSeparator||",";const b=g.cacheInBuiltFormats?Sx:HE;this.formats={number:b((C,R)=>{const T=new Intl.NumberFormat(C,{...R});return o=>T.format(o)}),currency:b((C,R)=>{const T=new Intl.NumberFormat(C,{...R,style:"currency"});return o=>T.format(o)}),datetime:b((C,R)=>{const T=new Intl.DateTimeFormat(C,{...R});return o=>T.format(o)}),relativetime:b((C,R)=>{const T=new Intl.RelativeTimeFormat(C,{...R});return o=>T.format(o,R.range||"day")}),list:b((C,R)=>{const T=new Intl.ListFormat(C,{...R});return o=>T.format(o)})}}add(h,g){this.formats[h.toLowerCase().trim()]=g}addCached(h,g){this.formats[h.toLowerCase().trim()]=Sx(g)}format(h,g,b,C={}){const R=g.split(this.formatSeparator);if(R.length>1&&R[0].indexOf("(")>1&&R[0].indexOf(")")<0&&R.find(o=>o.indexOf(")")>-1)){const o=R.findIndex(L=>L.indexOf(")")>-1);R[0]=[R[0],...R.splice(1,o)].join(this.formatSeparator)}return R.reduce((o,L)=>{var Y;const{formatName:N,formatOptions:Z}=$E(L);if(this.formats[N]){let ee=o;try{const U=((Y=C==null?void 0:C.formatParams)==null?void 0:Y[C.interpolationkey])||{},le=U.locale||U.lng||C.locale||C.lng||b;ee=this.formats[N](o,le,{...Z,...C,...U})}catch(U){this.logger.warn(U)}return ee}else this.logger.warn(`there was no format function for ${N}`);return o},h)}}const YE=(p,h)=>{p.pending[h]!==void 0&&(delete p.pending[h],p.pendingCount--)};class WE extends T_{constructor(h,g,b,C={}){var R,T;super(),this.backend=h,this.store=g,this.services=b,this.languageUtils=b.languageUtils,this.options=C,this.logger=wc.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=C.maxParallelReads||10,this.readingCalls=0,this.maxRetries=C.maxRetries>=0?C.maxRetries:5,this.retryTimeout=C.retryTimeout>=1?C.retryTimeout:350,this.state={},this.queue=[],(T=(R=this.backend)==null?void 0:R.init)==null||T.call(R,b,C.backend,C)}queueLoad(h,g,b,C){const R={},T={},o={},L={};return h.forEach(N=>{let Z=!0;g.forEach(Y=>{const ee=`${N}|${Y}`;!b.reload&&this.store.hasResourceBundle(N,Y)?this.state[ee]=2:this.state[ee]<0||(this.state[ee]===1?T[ee]===void 0&&(T[ee]=!0):(this.state[ee]=1,Z=!1,T[ee]===void 0&&(T[ee]=!0),R[ee]===void 0&&(R[ee]=!0),L[Y]===void 0&&(L[Y]=!0)))}),Z||(o[N]=!0)}),(Object.keys(R).length||Object.keys(T).length)&&this.queue.push({pending:T,pendingCount:Object.keys(T).length,loaded:{},errors:[],callback:C}),{toLoad:Object.keys(R),pending:Object.keys(T),toLoadLanguages:Object.keys(o),toLoadNamespaces:Object.keys(L)}}loaded(h,g,b){const C=h.split("|"),R=C[0],T=C[1];g&&this.emit("failedLoading",R,T,g),!g&&b&&this.store.addResourceBundle(R,T,b,void 0,void 0,{skipCopy:!0}),this.state[h]=g?-1:2,g&&b&&(this.state[h]=0);const o={};this.queue.forEach(L=>{kE(L.loaded,[R],T),YE(L,h),g&&L.errors.push(g),L.pendingCount===0&&!L.done&&(Object.keys(L.loaded).forEach(N=>{o[N]||(o[N]={});const Z=L.loaded[N];Z.length&&Z.forEach(Y=>{o[N][Y]===void 0&&(o[N][Y]=!0)})}),L.done=!0,L.errors.length?L.callback(L.errors):L.callback())}),this.emit("loaded",o),this.queue=this.queue.filter(L=>!L.done)}read(h,g,b,C=0,R=this.retryTimeout,T){if(!h.length)return T(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:h,ns:g,fcName:b,tried:C,wait:R,callback:T});return}this.readingCalls++;const o=(N,Z)=>{if(this.readingCalls--,this.waitingReads.length>0){const Y=this.waitingReads.shift();this.read(Y.lng,Y.ns,Y.fcName,Y.tried,Y.wait,Y.callback)}if(N&&Z&&C<this.maxRetries){setTimeout(()=>{this.read.call(this,h,g,b,C+1,R*2,T)},R);return}T(N,Z)},L=this.backend[b].bind(this.backend);if(L.length===2){try{const N=L(h,g);N&&typeof N.then=="function"?N.then(Z=>o(null,Z)).catch(o):o(null,N)}catch(N){o(N)}return}return L(h,g,o)}prepareLoading(h,g,b={},C){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),C&&C();vi(h)&&(h=this.languageUtils.toResolveHierarchy(h)),vi(g)&&(g=[g]);const R=this.queueLoad(h,g,b,C);if(!R.toLoad.length)return R.pending.length||C(),null;R.toLoad.forEach(T=>{this.loadOne(T)})}load(h,g,b){this.prepareLoading(h,g,{},b)}reload(h,g,b){this.prepareLoading(h,g,{reload:!0},b)}loadOne(h,g=""){const b=h.split("|"),C=b[0],R=b[1];this.read(C,R,"read",void 0,void 0,(T,o)=>{T&&this.logger.warn(`${g}loading namespace ${R} for language ${C} failed`,T),!T&&o&&this.logger.log(`${g}loaded namespace ${R} for language ${C}`,o),this.loaded(h,T,o)})}saveMissing(h,g,b,C,R,T={},o=()=>{}){var L,N,Z,Y,ee;if((N=(L=this.services)==null?void 0:L.utils)!=null&&N.hasLoadedNamespace&&!((Y=(Z=this.services)==null?void 0:Z.utils)!=null&&Y.hasLoadedNamespace(g))){this.logger.warn(`did not save key "${b}" as the namespace "${g}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(b==null||b==="")){if((ee=this.backend)!=null&&ee.create){const U={...T,isUpdate:R},le=this.backend.create.bind(this.backend);if(le.length<6)try{let ie;le.length===5?ie=le(h,g,b,C,U):ie=le(h,g,b,C),ie&&typeof ie.then=="function"?ie.then(me=>o(null,me)).catch(o):o(null,ie)}catch(ie){o(ie)}else le(h,g,b,C,o,U)}!h||!h[0]||this.store.addResource(h[0],g,b,C)}}}const Tx=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:p=>{let h={};if(typeof p[1]=="object"&&(h=p[1]),vi(p[1])&&(h.defaultValue=p[1]),vi(p[2])&&(h.tDescription=p[2]),typeof p[2]=="object"||typeof p[3]=="object"){const g=p[3]||p[2];Object.keys(g).forEach(b=>{h[b]=g[b]})}return h},interpolation:{escapeValue:!0,format:p=>p,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),Cx=p=>{var h,g;return vi(p.ns)&&(p.ns=[p.ns]),vi(p.fallbackLng)&&(p.fallbackLng=[p.fallbackLng]),vi(p.fallbackNS)&&(p.fallbackNS=[p.fallbackNS]),((g=(h=p.supportedLngs)==null?void 0:h.indexOf)==null?void 0:g.call(h,"cimode"))<0&&(p.supportedLngs=p.supportedLngs.concat(["cimode"])),typeof p.initImmediate=="boolean"&&(p.initAsync=p.initImmediate),p},$g=()=>{},KE=p=>{Object.getOwnPropertyNames(Object.getPrototypeOf(p)).forEach(g=>{typeof p[g]=="function"&&(p[g]=p[g].bind(p))})};class Dm extends T_{constructor(h={},g){if(super(),this.options=Cx(h),this.services={},this.logger=wc,this.modules={external:[]},KE(this),g&&!this.isInitialized&&!h.isClone){if(!this.options.initAsync)return this.init(h,g),this;setTimeout(()=>{this.init(h,g)},0)}}init(h={},g){this.isInitializing=!0,typeof h=="function"&&(g=h,h={}),h.defaultNS==null&&h.ns&&(vi(h.ns)?h.defaultNS=h.ns:h.ns.indexOf("translation")<0&&(h.defaultNS=h.ns[0]));const b=Tx();this.options={...b,...this.options,...Cx(h)},this.options.interpolation={...b.interpolation,...this.options.interpolation},h.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=h.keySeparator),h.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=h.nsSeparator);const C=N=>N?typeof N=="function"?new N:N:null;if(!this.options.isClone){this.modules.logger?wc.init(C(this.modules.logger),this.options):wc.init(null,this.options);let N;this.modules.formatter?N=this.modules.formatter:N=XE;const Z=new vx(this.options);this.store=new gx(this.options.resources,this.options);const Y=this.services;Y.logger=wc,Y.resourceStore=this.store,Y.languageUtils=Z,Y.pluralResolver=new ZE(Z,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==b.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),N&&(!this.options.interpolation.format||this.options.interpolation.format===b.interpolation.format)&&(Y.formatter=C(N),Y.formatter.init&&Y.formatter.init(Y,this.options),this.options.interpolation.format=Y.formatter.format.bind(Y.formatter)),Y.interpolator=new qE(this.options),Y.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},Y.backendConnector=new WE(C(this.modules.backend),Y.resourceStore,Y,this.options),Y.backendConnector.on("*",(U,...le)=>{this.emit(U,...le)}),this.modules.languageDetector&&(Y.languageDetector=C(this.modules.languageDetector),Y.languageDetector.init&&Y.languageDetector.init(Y,this.options.detection,this.options)),this.modules.i18nFormat&&(Y.i18nFormat=C(this.modules.i18nFormat),Y.i18nFormat.init&&Y.i18nFormat.init(this)),this.translator=new l_(this.services,this.options),this.translator.on("*",(U,...le)=>{this.emit(U,...le)}),this.modules.external.forEach(U=>{U.init&&U.init(this)})}if(this.format=this.options.interpolation.format,g||(g=$g),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const N=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);N.length>0&&N[0]!=="dev"&&(this.options.lng=N[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(N=>{this[N]=(...Z)=>this.store[N](...Z)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(N=>{this[N]=(...Z)=>(this.store[N](...Z),this)});const o=wm(),L=()=>{const N=(Z,Y)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),o.resolve(Y),g(Z,Y)};if(this.languages&&!this.isInitialized)return N(null,this.t.bind(this));this.changeLanguage(this.options.lng,N)};return this.options.resources||!this.options.initAsync?L():setTimeout(L,0),o}loadResources(h,g=$g){var R,T;let b=g;const C=vi(h)?h:this.language;if(typeof h=="function"&&(b=h),!this.options.resources||this.options.partialBundledLanguages){if((C==null?void 0:C.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return b();const o=[],L=N=>{if(!N||N==="cimode")return;this.services.languageUtils.toResolveHierarchy(N).forEach(Y=>{Y!=="cimode"&&o.indexOf(Y)<0&&o.push(Y)})};C?L(C):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(Z=>L(Z)),(T=(R=this.options.preload)==null?void 0:R.forEach)==null||T.call(R,N=>L(N)),this.services.backendConnector.load(o,this.options.ns,N=>{!N&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),b(N)})}else b(null)}reloadResources(h,g,b){const C=wm();return typeof h=="function"&&(b=h,h=void 0),typeof g=="function"&&(b=g,g=void 0),h||(h=this.languages),g||(g=this.options.ns),b||(b=$g),this.services.backendConnector.reload(h,g,R=>{C.resolve(),b(R)}),C}use(h){if(!h)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!h.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return h.type==="backend"&&(this.modules.backend=h),(h.type==="logger"||h.log&&h.warn&&h.error)&&(this.modules.logger=h),h.type==="languageDetector"&&(this.modules.languageDetector=h),h.type==="i18nFormat"&&(this.modules.i18nFormat=h),h.type==="postProcessor"&&n1.addPostProcessor(h),h.type==="formatter"&&(this.modules.formatter=h),h.type==="3rdParty"&&this.modules.external.push(h),this}setResolvedLanguage(h){if(!(!h||!this.languages)&&!(["cimode","dev"].indexOf(h)>-1)){for(let g=0;g<this.languages.length;g++){const b=this.languages[g];if(!(["cimode","dev"].indexOf(b)>-1)&&this.store.hasLanguageSomeTranslations(b)){this.resolvedLanguage=b;break}}!this.resolvedLanguage&&this.languages.indexOf(h)<0&&this.store.hasLanguageSomeTranslations(h)&&(this.resolvedLanguage=h,this.languages.unshift(h))}}changeLanguage(h,g){this.isLanguageChangingTo=h;const b=wm();this.emit("languageChanging",h);const C=o=>{this.language=o,this.languages=this.services.languageUtils.toResolveHierarchy(o),this.resolvedLanguage=void 0,this.setResolvedLanguage(o)},R=(o,L)=>{L?this.isLanguageChangingTo===h&&(C(L),this.translator.changeLanguage(L),this.isLanguageChangingTo=void 0,this.emit("languageChanged",L),this.logger.log("languageChanged",L)):this.isLanguageChangingTo=void 0,b.resolve((...N)=>this.t(...N)),g&&g(o,(...N)=>this.t(...N))},T=o=>{var Z,Y;!h&&!o&&this.services.languageDetector&&(o=[]);const L=vi(o)?o:o&&o[0],N=this.store.hasLanguageSomeTranslations(L)?L:this.services.languageUtils.getBestMatchFromCodes(vi(o)?[o]:o);N&&(this.language||C(N),this.translator.language||this.translator.changeLanguage(N),(Y=(Z=this.services.languageDetector)==null?void 0:Z.cacheUserLanguage)==null||Y.call(Z,N)),this.loadResources(N,ee=>{R(ee,N)})};return!h&&this.services.languageDetector&&!this.services.languageDetector.async?T(this.services.languageDetector.detect()):!h&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(T):this.services.languageDetector.detect(T):T(h),b}getFixedT(h,g,b){const C=(R,T,...o)=>{let L;typeof T!="object"?L=this.options.overloadTranslationOptionHandler([R,T].concat(o)):L={...T},L.lng=L.lng||C.lng,L.lngs=L.lngs||C.lngs,L.ns=L.ns||C.ns,L.keyPrefix!==""&&(L.keyPrefix=L.keyPrefix||b||C.keyPrefix);const N=this.options.keySeparator||".";let Z;return L.keyPrefix&&Array.isArray(R)?Z=R.map(Y=>(typeof Y=="function"&&(Y=By(Y,{...this.options,...T})),`${L.keyPrefix}${N}${Y}`)):(typeof R=="function"&&(R=By(R,{...this.options,...T})),Z=L.keyPrefix?`${L.keyPrefix}${N}${R}`:R),this.t(Z,L)};return vi(h)?C.lng=h:C.lngs=h,C.ns=g,C.keyPrefix=b,C}t(...h){var g;return(g=this.translator)==null?void 0:g.translate(...h)}exists(...h){var g;return(g=this.translator)==null?void 0:g.exists(...h)}setDefaultNamespace(h){this.options.defaultNS=h}hasLoadedNamespace(h,g={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const b=g.lng||this.resolvedLanguage||this.languages[0],C=this.options?this.options.fallbackLng:!1,R=this.languages[this.languages.length-1];if(b.toLowerCase()==="cimode")return!0;const T=(o,L)=>{const N=this.services.backendConnector.state[`${o}|${L}`];return N===-1||N===0||N===2};if(g.precheck){const o=g.precheck(this,T);if(o!==void 0)return o}return!!(this.hasResourceBundle(b,h)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||T(b,h)&&(!C||T(R,h)))}loadNamespaces(h,g){const b=wm();return this.options.ns?(vi(h)&&(h=[h]),h.forEach(C=>{this.options.ns.indexOf(C)<0&&this.options.ns.push(C)}),this.loadResources(C=>{b.resolve(),g&&g(C)}),b):(g&&g(),Promise.resolve())}loadLanguages(h,g){const b=wm();vi(h)&&(h=[h]);const C=this.options.preload||[],R=h.filter(T=>C.indexOf(T)<0&&this.services.languageUtils.isSupportedCode(T));return R.length?(this.options.preload=C.concat(R),this.loadResources(T=>{b.resolve(),g&&g(T)}),b):(g&&g(),Promise.resolve())}dir(h){var C,R;if(h||(h=this.resolvedLanguage||(((C=this.languages)==null?void 0:C.length)>0?this.languages[0]:this.language)),!h)return"rtl";try{const T=new Intl.Locale(h);if(T&&T.getTextInfo){const o=T.getTextInfo();if(o&&o.direction)return o.direction}}catch{}const g=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],b=((R=this.services)==null?void 0:R.languageUtils)||new vx(Tx());return h.toLowerCase().indexOf("-latn")>1?"ltr":g.indexOf(b.getLanguagePartFromCode(h))>-1||h.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(h={},g){return new Dm(h,g)}cloneInstance(h={},g=$g){const b=h.forkResourceStore;b&&delete h.forkResourceStore;const C={...this.options,...h,isClone:!0},R=new Dm(C);if((h.debug!==void 0||h.prefix!==void 0)&&(R.logger=R.logger.clone(h)),["store","services","language"].forEach(o=>{R[o]=this[o]}),R.services={...this.services},R.services.utils={hasLoadedNamespace:R.hasLoadedNamespace.bind(R)},b){const o=Object.keys(this.store.data).reduce((L,N)=>(L[N]={...this.store.data[N]},L[N]=Object.keys(L[N]).reduce((Z,Y)=>(Z[Y]={...L[N][Y]},Z),L[N]),L),{});R.store=new gx(o,C),R.services.resourceStore=R.store}return R.translator=new l_(R.services,C),R.translator.on("*",(o,...L)=>{R.emit(o,...L)}),R.init(C,g),R.translator.options=C,R.translator.backendConnector.services.utils={hasLoadedNamespace:R.hasLoadedNamespace.bind(R)},R}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Ga=Dm.createInstance();Ga.createInstance=Dm.createInstance;Ga.createInstance;Ga.dir;Ga.init;Ga.loadResources;Ga.reloadResources;Ga.use;Ga.changeLanguage;Ga.getFixedT;Ga.t;Ga.exists;Ga.setDefaultNamespace;Ga.hasLoadedNamespace;Ga.loadNamespaces;Ga.loadLanguages;const{slice:QE,forEach:JE}=[];function eM(p){return JE.call(QE.call(arguments,1),h=>{if(h)for(const g in h)p[g]===void 0&&(p[g]=h[g])}),p}function tM(p){return typeof p!="string"?!1:[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(g=>g.test(p))}const Ex=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,iM=function(p,h){const b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},C=encodeURIComponent(h);let R=`${p}=${C}`;if(b.maxAge>0){const T=b.maxAge-0;if(Number.isNaN(T))throw new Error("maxAge should be a Number");R+=`; Max-Age=${Math.floor(T)}`}if(b.domain){if(!Ex.test(b.domain))throw new TypeError("option domain is invalid");R+=`; Domain=${b.domain}`}if(b.path){if(!Ex.test(b.path))throw new TypeError("option path is invalid");R+=`; Path=${b.path}`}if(b.expires){if(typeof b.expires.toUTCString!="function")throw new TypeError("option expires is invalid");R+=`; Expires=${b.expires.toUTCString()}`}if(b.httpOnly&&(R+="; HttpOnly"),b.secure&&(R+="; Secure"),b.sameSite)switch(typeof b.sameSite=="string"?b.sameSite.toLowerCase():b.sameSite){case!0:R+="; SameSite=Strict";break;case"lax":R+="; SameSite=Lax";break;case"strict":R+="; SameSite=Strict";break;case"none":R+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return b.partitioned&&(R+="; Partitioned"),R},Mx={create(p,h,g,b){let C=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};g&&(C.expires=new Date,C.expires.setTime(C.expires.getTime()+g*60*1e3)),b&&(C.domain=b),document.cookie=iM(p,h,C)},read(p){const h=`${p}=`,g=document.cookie.split(";");for(let b=0;b<g.length;b++){let C=g[b];for(;C.charAt(0)===" ";)C=C.substring(1,C.length);if(C.indexOf(h)===0)return C.substring(h.length,C.length)}return null},remove(p,h){this.create(p,"",-1,h)}};var nM={name:"cookie",lookup(p){let{lookupCookie:h}=p;if(h&&typeof document<"u")return Mx.read(h)||void 0},cacheUserLanguage(p,h){let{lookupCookie:g,cookieMinutes:b,cookieDomain:C,cookieOptions:R}=h;g&&typeof document<"u"&&Mx.create(g,p,b,C,R)}},rM={name:"querystring",lookup(p){var b;let{lookupQuerystring:h}=p,g;if(typeof window<"u"){let{search:C}=window.location;!window.location.search&&((b=window.location.hash)==null?void 0:b.indexOf("?"))>-1&&(C=window.location.hash.substring(window.location.hash.indexOf("?")));const T=C.substring(1).split("&");for(let o=0;o<T.length;o++){const L=T[o].indexOf("=");L>0&&T[o].substring(0,L)===h&&(g=T[o].substring(L+1))}}return g}},aM={name:"hash",lookup(p){var C;let{lookupHash:h,lookupFromHashIndex:g}=p,b;if(typeof window<"u"){const{hash:R}=window.location;if(R&&R.length>2){const T=R.substring(1);if(h){const o=T.split("&");for(let L=0;L<o.length;L++){const N=o[L].indexOf("=");N>0&&o[L].substring(0,N)===h&&(b=o[L].substring(N+1))}}if(b)return b;if(!b&&g>-1){const o=R.match(/\/([a-zA-Z-]*)/g);return Array.isArray(o)?(C=o[typeof g=="number"?g:0])==null?void 0:C.replace("/",""):void 0}}}return b}};let Kf=null;const Ax=()=>{if(Kf!==null)return Kf;try{if(Kf=typeof window<"u"&&window.localStorage!==null,!Kf)return!1;const p="i18next.translate.boo";window.localStorage.setItem(p,"foo"),window.localStorage.removeItem(p)}catch{Kf=!1}return Kf};var sM={name:"localStorage",lookup(p){let{lookupLocalStorage:h}=p;if(h&&Ax())return window.localStorage.getItem(h)||void 0},cacheUserLanguage(p,h){let{lookupLocalStorage:g}=h;g&&Ax()&&window.localStorage.setItem(g,p)}};let Qf=null;const Px=()=>{if(Qf!==null)return Qf;try{if(Qf=typeof window<"u"&&window.sessionStorage!==null,!Qf)return!1;const p="i18next.translate.boo";window.sessionStorage.setItem(p,"foo"),window.sessionStorage.removeItem(p)}catch{Qf=!1}return Qf};var oM={name:"sessionStorage",lookup(p){let{lookupSessionStorage:h}=p;if(h&&Px())return window.sessionStorage.getItem(h)||void 0},cacheUserLanguage(p,h){let{lookupSessionStorage:g}=h;g&&Px()&&window.sessionStorage.setItem(g,p)}},lM={name:"navigator",lookup(p){const h=[];if(typeof navigator<"u"){const{languages:g,userLanguage:b,language:C}=navigator;if(g)for(let R=0;R<g.length;R++)h.push(g[R]);b&&h.push(b),C&&h.push(C)}return h.length>0?h:void 0}},cM={name:"htmlTag",lookup(p){let{htmlTag:h}=p,g;const b=h||(typeof document<"u"?document.documentElement:null);return b&&typeof b.getAttribute=="function"&&(g=b.getAttribute("lang")),g}},uM={name:"path",lookup(p){var C;let{lookupFromPathIndex:h}=p;if(typeof window>"u")return;const g=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(g)?(C=g[typeof h=="number"?h:0])==null?void 0:C.replace("/",""):void 0}},hM={name:"subdomain",lookup(p){var C,R;let{lookupFromSubdomainIndex:h}=p;const g=typeof h=="number"?h+1:1,b=typeof window<"u"&&((R=(C=window.location)==null?void 0:C.hostname)==null?void 0:R.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i));if(b)return b[g]}};let a1=!1;try{document.cookie,a1=!0}catch{}const s1=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];a1||s1.splice(1,1);const dM=()=>({order:s1,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:p=>p});class o1{constructor(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(h,g)}init(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=h,this.options=eM(g,this.options||{},dM()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=C=>C.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=b,this.addDetector(nM),this.addDetector(rM),this.addDetector(sM),this.addDetector(oM),this.addDetector(lM),this.addDetector(cM),this.addDetector(uM),this.addDetector(hM),this.addDetector(aM)}addDetector(h){return this.detectors[h.name]=h,this}detect(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,g=[];return h.forEach(b=>{if(this.detectors[b]){let C=this.detectors[b].lookup(this.options);C&&typeof C=="string"&&(C=[C]),C&&(g=g.concat(C))}}),g=g.filter(b=>b!=null&&!tM(b)).map(b=>this.options.convertDetectedLanguage(b)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?g:g.length>0?g[0]:null}cacheUserLanguage(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;g&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(h)>-1||g.forEach(b=>{this.detectors[b]&&this.detectors[b].cacheUserLanguage(h,this.options)}))}}o1.type="languageDetector";const fM={active:"Active",resolved:"Resolved",noActiveIncidents:"No active incidents",noHistoricalIncidents:"No historical incidents",showActive:"Show Active",showHistorical:"Show Historical",online:"Online",disconnected:"Disconnected",partial_disconnected:"Partial Disconnected",notice:"Notice",unknown:"Unknown"},pM={all:"Mixed",normal:"Normal",broken:"Broken"},mM={title:"Important Notice",message:'This map is a dynamic submarine cable map dedicated to providing the most up-to-date status on submarine cables connected to Taiwan.<br><br>The data presented on this site is derived from publicly available intelligence sources and multiple third-party monitoring systems (including but not limited to routing information, packet latency, and packet loss rates). Through analysis and inference, it identifies potential disruptions in submarine communication cables.<br><br>Please note that the website may not reflect the most current or accurate status. The information provided is for reference only and should be verified with the official sources of each submarine cable.<br><br>If you are interested in contributing information, please refer to the contact details available in the "About" window located at the bottom left corner.',acknowledge:"I Understand",dontShowAgain:"Don't show this warning again"},gM={title:"Incidents List",activeTitle:"Active Incidents",historicalTitle:"Historical Incidents",started_at:"Started at",reparing_at:"Estimated Reparing at",resolved_at:"Resolved at",show:"Show Incidents"},_M={title:"Cables Uptime Timeline",show:"Show Cables Uptime Timeline"},yM={title:"About",show:"Show About",description:"Taiwan Submarine Cable Map is an interactive map that shows the status and historical incidents of Taiwan's submarine cables.",developer:"This project is developed by <a href='https://seadog007.work/en'>seadog007</a> with Cursor AI",datacollect:"Data collected by... Still me, you can contact me on <a href='https://t.me/seadog007'>Telegram</a> or <a href='https://www.facebook.com/seadog007'>Facebook</a>",datasource:"Data source: Ministry of the Interior - National Land Management Agency, Ministry of the Interior - Department of Land Administration, <a href='https://www.fa.gov.tw/'>Fisheries Agency, Council of Agriculture</a>, <a href='http://www.cht.com.tw/'>Chunghwa Telecom</a>, <a href='https://www.tainan.gov.tw/'>Tainan City Government</a>, <a href='https://retn.net/'>RETN</a>, <a href='https://submarinenetworks.com/'>Submarine Networks</a>, <a href='https://submarinecablemap.com/'>Submarine Cable Map</a>, <a href='https://smokeping.fast-line.tw/'>Fast Line</a>, OKTW",techstack:"The project is developed using Typescript, Vite, and React, and uses Google Spreadsheet for data management. The data is automatically updated and converted to static format using Github Action, and deployed on GitHub Pages. The data collection and conversion took about one week.",github:"GitHub Repository: <a href='https://github.com/seadog007/smc.peering.tw/'>Map (Public)</a>, <a href='https://github.com/seadog007/tw-submarine-cable/'>Cable Data (Private)</a>",sponsor:"This project is sponsored by <a href='https://www.twds.com.tw/'>TWDS</a> and the members ofits sub-project <a href='https://stuix.io/'>STUIX</a><br>TWDS aims to promote the Peering ecosystem in Taiwan, avoiding the situation where traffic needs to be routed out of the country and then back to the country. We also introduce lots of forgien network cache to help establish the Peering ecosystem in Taiwan. The sponsor link of related projects is <a href='https://sponsor.twds.com.tw/'>TWDS Sponsor Link</a>"},vM={history:"Version History",version:{"1.0.0":{date:"2025-06-15",changes:["Initial release"]},"1.0.1":{date:"2025-06-16",changes:["UI Improvements","Added Estimated Reparing Time and Resolved Time"]},"1.1.0":{date:"2025-06-18",changes:["Added Version History"]},"1.1.1":{date:"2025-06-18",changes:["Added EAC1 Segment E Cable Data"]},"1.2.0":{date:"2025-06-19",changes:["Added Mobile Version Map"]},"1.2.1":{date:"2025-06-19",changes:["Fixed Mobile Button Position"]},"1.2.2":{date:"2025-06-21",changes:["Added NCP S5, S6, S1.4 Cable Data"]},"1.2.3":{date:"2025-07-11",changes:["Added Hover Info when mouse is on the cable"]},"1.2.4":{date:"2025-07-12",changes:["Added TSE-1 Cable Data"]},"1.2.5":{date:"2025-07-12",changes:["Updated APCN2 to accurate version"]},"1.2.6":{date:"2025-07-12",changes:["Updated C2C Cable Data, Added Seg 2C, 3A"]},"1.3.0":{date:"2025-07-13",changes:["Fixed Button Layer","Improved Map Usability","Added Important Notice Window aka Disclaimer","Fixed Initial Language Setting","Added Monitoring Data Sources"]},"1.3.1":{date:"2025-07-14",changes:["Added SEO Related Settings","Updated TM2, TM3, TP3 Cable Data"]},"1.3.2":{date:"2025-07-14",changes:["Fixed cable data build script"]},"1.3.3":{date:"2025-08-22",changes:["Added SJC2 S4 Cable Data"]},"2.0.0":{date:"2025-09-03",changes:["Changed Leaflet Map to Maplibre GL feat. w/ whes1015","Improved Map Usability","Added Clock for Current Time","Added New Language Selector","Added Cable Filter","Updated About Window"]},"2.0.1":{date:"2025-09-13",changes:["Trying to fix performance issue"]},"2.0.2":{date:"2025-09-14",changes:["Trying to fix performance issue"]},"2.1.0":{date:"2025-09-14",changes:["Made cable data smoother"]}}},xM={common:fM,filter:pM,warning:mM,incidents:gM,timeline:_M,about:yM,version:vM},bM={active:"",resolved:"",noActiveIncidents:"",noHistoricalIncidents:"",showActive:"",showHistorical:"",online:"",disconnected:"",partial_disconnected:"",notice:"",unknown:""},wM={all:"",normal:"",broken:""},SM={title:"",message:"<br><br><br><br>",acknowledge:"",dontShowAgain:""},TM={title:"",activeTitle:"",historicalTitle:"",started_at:"",reparing_at:"",resolved_at:""},CM={title:"",show:""},EM={title:"",show:"",description:"",developer:" <a href='https://seadog007.work/'>seadog007</a>  Cursor AI ",datacollect:" <a href='https://t.me/seadog007'>Telegram</a>  <a href='https://www.facebook.com/seadog007'>Facebook</a> ",datasource:"<a href='https://www.fa.gov.tw/'></a><a href='http://www.cht.com.tw/'></a><a href='https://www.tainan.gov.tw/'></a><a href='https://retn.net/'>RETN</a><a href='https://submarinenetworks.com/'>Submarine Networks</a><a href='https://submarinecablemap.com/'>Submarine Cable Map</a><a href='https://smokeping.fast-line.tw/'>Fast Line </a>OKTW",techstack:" Typescript  Vite  React  Google Spreadsheet  Github Action  GitHub Pages ",github:"GitHub <a href='https://github.com/seadog007/smc.peering.tw/'> ()</a><a href='https://github.com/seadog007/tw-submarine-cable/'> ()</a>",sponsor:" <a href='https://www.twds.com.tw/'>TWDS</a>  <a href='https://stuix.io/'>STUIX</a> <br>TWDS  Peering  Peering <a href='https://sponsor.twds.com.tw/'>TWDS </a>"},MM={history:"",version:{"1.0.0":{date:"2025-06-15",changes:[""]},"1.0.1":{date:"2025-06-16",changes:["UI ",""]},"1.1.0":{date:"2025-06-18",changes:[""]},"1.1.1":{date:"2025-06-18",changes:[" EAC1 Segment E "]},"1.2.0":{date:"2025-06-19",changes:[""]},"1.2.1":{date:"2025-06-19",changes:[""]},"1.2.2":{date:"2025-06-21",changes:[" NCP S5, S6, S1.4 "]},"1.2.3":{date:"2025-07-11",changes:[" Hover "]},"1.2.4":{date:"2025-07-12",changes:[" TSE-1 "]},"1.2.5":{date:"2025-07-12",changes:[" APCN2 "]},"1.2.6":{date:"2025-07-12",changes:[" C2C  Seg 2C, 3A"]},"1.3.0":{date:"2025-07-13",changes:["",""," aka ","",""]},"1.3.1":{date:"2025-07-14",changes:[" SEO "," TM2TM3TP3 "]},"1.3.2":{date:"2025-07-14",changes:[""]},"1.3.3":{date:"2025-08-22",changes:[" SJC2 S4 "]},"2.0.0":{date:"2025-09-03",changes:[" Leaflet Map  Maplibre GL feat. w/ whes1015","","","","",""]},"2.0.1":{date:"2025-09-13",changes:[""]},"2.0.2":{date:"2025-09-14",changes:[""]},"2.1.0":{date:"2025-09-14",changes:[""]}}},AM={common:bM,filter:wM,warning:SM,incidents:TM,timeline:CM,about:EM,version:MM};Ga.use(o1).use(fw).init({supportedLngs:["en","zh-TW"],resources:{en:{translation:xM},"zh-TW":{translation:AM}},fallbackLng:"en",interpolation:{escapeValue:!1}});const l1=new Date,PM=new Date(l1.getTime()-365*24*60*60*1e3);function RM(){const{t:p,i18n:h}=c_(),[g,b]=J.useState(!1),[C,R]=J.useState(!1),[T,o]=J.useState(!1),[L,N]=J.useState(!1),[Z,Y]=J.useState(!1),[ee,U]=J.useState(window.innerWidth<768),[le,ie]=J.useState([]),[me,Ce]=J.useState("all");J.useEffect(()=>{const Ct=()=>{const Rt=window.innerWidth<768;U(Rt)};return window.addEventListener("resize",Ct),()=>window.removeEventListener("resize",Ct)},[]),J.useEffect(()=>{localStorage.getItem("hasSeenWarning")||N(!0)},[]),J.useEffect(()=>{(async()=>{const Rt=Object.assign({"/src/data/cables/apcn2.json":()=>Bi(()=>import("./apcn2-Bh9jGbNC.js"),[]),"/src/data/cables/apg.json":()=>Bi(()=>import("./apg-C1vLTMzs.js"),[]),"/src/data/cables/c2c.json":()=>Bi(()=>import("./c2c-CIlxF3Xy.js"),[]),"/src/data/cables/eac1.json":()=>Bi(()=>import("./eac1-BghIn5se.js"),[]),"/src/data/cables/eac2.json":()=>Bi(()=>import("./eac2-B1dtEGmT.js"),[]),"/src/data/cables/faster.json":()=>Bi(()=>import("./faster-V2HAUowD.js"),[]),"/src/data/cables/nacs.json":()=>Bi(()=>import("./nacs-C7uqQAFw.js"),[]),"/src/data/cables/ncp.json":()=>Bi(()=>import("./ncp-Dai6JBI_.js"),[]),"/src/data/cables/sjc2.json":()=>Bi(()=>import("./sjc2-B7r4FIKP.js"),[]),"/src/data/cables/tpkm3.json":()=>Bi(()=>import("./tpkm3-D-NJAXGL.js"),[]),"/src/data/cables/tse1.json":()=>Bi(()=>import("./tse1-igmh4_2Z.js"),[]),"/src/data/cables/twpk1.json":()=>Bi(()=>import("./twpk1-CKlBze6Z.js"),[]),"/src/data/cables/twpk3.json":()=>Bi(()=>import("./twpk3-Cpef6JXS.js"),[]),"/src/data/cables/twtk2.json":()=>Bi(()=>import("./twtk2-CAv4JbII.js"),[]),"/src/data/cables/twtm2.json":()=>Bi(()=>import("./twtm2-DvzU2CDB.js"),[]),"/src/data/cables/twtm3.json":()=>Bi(()=>import("./twtm3-BAru4NER.js"),[]),"/src/data/cables/twtp2.json":()=>Bi(()=>import("./twtp2-w_2Xomoa.js"),[]),"/src/data/cables/twtp3.json":()=>Bi(()=>import("./twtp3-BNNq2ktB.js"),[])}),Lt=[];for(const Gt in Rt){const Ht=await Rt[Gt]();Lt.push({id:Ht.default.id,name:Ht.default.name})}ie(Lt)})()},[]);const Se=()=>b(!0),Ee=()=>b(!1),ke=()=>R(!0),Ve=()=>R(!1),ct=()=>o(!0),tt=()=>o(!1),Qe=()=>{N(!1),Z&&localStorage.setItem("hasSeenWarning","true")},at=Ct=>{Ct.startsWith("lang-")&&h.changeLanguage(Ct.replace("lang-",""))},ht=Ct=>{Ct.startsWith("filter-")&&Ce(Ct.replace("filter-",""))};return pe.jsx("div",{className:"app select-none",children:pe.jsx("div",{className:"app-content",children:pe.jsxs("div",{className:"app-container",children:[pe.jsx("div",{className:"map-section",children:pe.jsx(qC,{cableFilter:me})}),pe.jsxs("div",{className:"control-panel",children:[pe.jsx(zE,{}),pe.jsxs("div",{className:"selector-container horizontal",children:[pe.jsxs(ax,{onValueChange:at,value:`lang-${h.language}`,children:[pe.jsxs(ox,{className:"control-select",children:[pe.jsx(Dw,{className:"select-icon"}),pe.jsx(sx,{placeholder:"Language"})]}),pe.jsxs(lx,{className:"control-select-content",children:[pe.jsx(bm,{value:"lang-en",className:"control-select-item",children:"English"}),pe.jsx(bm,{value:"lang-zh-TW",className:"control-select-item",children:""})]})]}),pe.jsxs(ax,{onValueChange:ht,value:`filter-${me}`,children:[pe.jsxs(ox,{className:"control-select",children:[pe.jsx(zw,{className:"select-icon"}),pe.jsx(sx,{placeholder:"Filter"})]}),pe.jsxs(lx,{className:"control-select-content",children:[pe.jsx(bm,{value:"filter-all",className:"control-select-item",children:p("filter.all")||""}),pe.jsx(bm,{value:"filter-normal",className:"control-select-item",children:p("filter.normal")||""}),pe.jsx(bm,{value:"filter-broken",className:"control-select-item",children:p("filter.broken")||""})]})]})]})]}),ee&&pe.jsx("button",{onClick:ct,className:"incident-button",title:p("incident.show"),children:pe.jsx("svg",{className:"incident-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:pe.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),pe.jsx("button",{onClick:Se,className:"timeline-button",title:p("timeline.show"),children:pe.jsx("svg",{className:"timeline-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:pe.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),pe.jsx("button",{onClick:ke,className:"about-button",title:p("about.show"),children:pe.jsx("svg",{className:"about-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:pe.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),!ee&&pe.jsx("div",{className:`incident-section ${ee?"full-width":""}`,children:pe.jsx(hx,{})}),ee&&pe.jsx(qg,{isOpen:T,onClose:tt,title:p("incidents.title"),children:pe.jsx(hx,{})}),pe.jsx(qg,{isOpen:g,onClose:Ee,title:p("timeline.title"),children:pe.jsx(PE,{cables:le,startDate:PM,endDate:l1})}),pe.jsx(qg,{isOpen:C,onClose:Ve,title:p("about.title"),children:pe.jsx(RE,{})}),pe.jsx(qg,{isOpen:L,onClose:Qe,title:p("warning.title"),maxWidth:"550px",children:pe.jsxs("div",{className:"warning-content",children:[pe.jsx("p",{dangerouslySetInnerHTML:{__html:p("warning.message")}}),pe.jsx("div",{className:"warning-checkbox",children:pe.jsxs("label",{children:[pe.jsx("input",{type:"checkbox",checked:Z,onChange:Ct=>Y(Ct.target.checked)}),pe.jsx("span",{children:p("warning.dontShowAgain")})]})}),pe.jsx("button",{className:"warning-acknowledge-btn",onClick:Qe,children:p("warning.acknowledge")})]})})]})})})}const zM=new B1;y1.createRoot(document.getElementById("root")).render(pe.jsx(J.StrictMode,{children:pe.jsx(V1,{client:zM,children:pe.jsx(RM,{})})}));
